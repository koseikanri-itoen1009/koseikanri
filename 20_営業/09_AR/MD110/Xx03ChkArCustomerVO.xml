<?xml version="1.0" encoding='Windows-31J'?>
<!DOCTYPE ViewObject SYSTEM "jbo_03_01.dtd">

<ViewObject
   Name="Xx03ChkArCustomerVO"
   BindingStyle="Oracle"
   CustomQuery="true"
   RowClass="oracle.apps.xx03.ar.input.server.Xx03ChkArCustomerVORowImpl"
   ComponentClass="oracle.apps.xx03.ar.input.server.Xx03ChkArCustomerVOImpl"
   MsgBundleClass="oracle.jbo.common.JboResourceBundle"
   FetchMode="FETCH_AS_NEEDED"
   UseGlueCode="false" >
   <SQLQuery><![CDATA[
SELECT COUNT(1)   customer_cnt
  FROM xx03_ar_customer_lov_v xaclv
      ,hz_cust_accounts       hca
      ,xxcmm_cust_accounts    xca
 WHERE xaclv.customer_id = :1
   AND ( EXISTS
          (SELECT 'X'
             FROM fnd_lookup_values   flv
                 ,per_all_people_f    ppf
                 ,fnd_user            fu
            WHERE flv.lookup_type           = 'XXCFR1_SALES_SECURITY'
              AND flv.language              = USERENV( 'LANG' )
              AND flv.enabled_flag          = 'Y'
              AND ( flv.start_date_active IS NULL
                 OR flv.start_date_active <= TRUNC( SYSDATE ))
              AND ( flv.end_date_active   IS NULL
                 OR flv.end_date_active   >= TRUNC( SYSDATE ))
              AND fu.employee_id            = ppf.person_id
              AND ppf.current_employee_flag = 'Y'
              AND TRUNC( SYSDATE )    BETWEEN ppf.effective_start_date
                                          AND ppf.effective_end_date
              AND ppf.attribute28           = flv.lookup_code
              AND fu.user_id                = fnd_profile.value( 'USER_ID' )
          )
        OR
         EXISTS
          (SELECT 'X'
             FROM hz_cust_accounts       hca2
                 ,xxcmm_cust_accounts    xca2
                 ,per_all_people_f       ppf
                 ,fnd_user               fu
            WHERE fu.user_id                = fnd_profile.value( 'USER_ID' )
              AND fu.employee_id            = ppf.person_id
              AND ppf.current_employee_flag = 'Y'
              AND TRUNC( SYSDATE )    BETWEEN ppf.effective_start_date
                                          AND ppf.effective_end_date
              AND ppf.attribute28           = xca2.management_base_code
              AND xca2.customer_id          = hca2.cust_account_id
              AND hca2.account_number       = xca.sale_base_code
              AND hca2.customer_class_code  = '1'
           UNION ALL
           SELECT 'X'
             FROM per_all_people_f       ppf
                 ,fnd_user               fu
            WHERE fu.user_id                = fnd_profile.value( 'USER_ID' )
              AND fu.employee_id            = ppf.person_id
              AND ppf.current_employee_flag = 'Y'
              AND TRUNC( SYSDATE )    BETWEEN ppf.effective_start_date
                                          AND ppf.effective_end_date
              AND ppf.attribute28           = xca.sale_base_code
          )
       )
   AND hca.cust_account_id = xca.customer_id
   AND hca.cust_account_id = xaclv.customer_id
   ]]></SQLQuery>
   <DesignTime>
      <Attr Name="_isCodegen" Value="true" />
      <Attr Name="_version" Value="9.0.3.14.00" />
      <Attr Name="_CodeGenFlagNew" Value="36" />
   </DesignTime>
   <ViewAttribute
      Name="CustomerCnt"
      IsPersistent="false"
      Precision="15"
      Scale="0"
      Type="oracle.jbo.domain.Number"
      ColumnType="NUMBER"
      AliasName="CUSTOMER_CNT"
      Expression="CUSTOMER_CNT"
      SQLType="NUMERIC" >
   </ViewAttribute>
</ViewObject>
