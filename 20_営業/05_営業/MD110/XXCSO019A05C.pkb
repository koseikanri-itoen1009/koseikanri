CREATE OR REPLACE PACKAGE BODY APPS.XXCSO019A05C
AS
/*****************************************************************************************
 * Copyright(c)Sumisho Computer Systems Corporation, 2008. All rights reserved.
 *
 * Package Name            : XXCSO019A05C(body)
 * Description             : 要求の発行画面から
 *                           訪問売上計画管理表を帳票に出力します。
 * MD.050                  : 営業システム構築プロジェクトアドオン：
 *                           訪問売上計画管理表
 * Version                 : 1.9
 *
 * Program List
 * ---------------------- ----------------------------------------------------------
 *  Name                   Description
 * ---------------------- ----------------------------------------------------------
 *  get_gvm_type           一般／自販機／ＭＣ取得
 *  get_tgt_amt            売上計画取得
 *  get_rslt_amt           売上実績取得
 *  get_rslt_other_sales_amt  他拠点納品分売上実績取得
 *  get_visit_sign         訪問記号取得
 *  get_i_tgt_vis_num      訪問計画取得(一般用)
 *  get_v_tgt_vis_num      訪問計画取得(自販機用)
 *  get_i_rslt_vis_num     訪問実績取得(一般用)
 *  get_v_rslt_vis_num     訪問実績取得(自販機用)
 *  get_m_rslt_vis_num     訪問実績取得(MC用)
 *  get_e_rslt_vis_num     訪問実績取得(有効訪問用)
 *  get_business_high_type_code  業態大分類コード取得
 *  get_business_high_type_name  業態大分類名取得
 *  get_route_number       ルートNo取得
 *  get_rslt_amt_in_month  売上実績(年月指定)取得
 *  init                   初期処理 (A-1)
 *  chek_param             パラメータチェック (A-2)
 *  get_ticket1            帳票種別1-営業員別 (A-3-1,A-3-2)
 *  up_plsql_tab1          営業員別-PLSQL表の更新 (A-3-3)
 *  get_ticket2            帳票種別2-営業員グループ別 (A-4-1,A-4-2)
 *  up_plsql_tab2          営業員グループ別-PLSQL表の更新 (A-4-3)
 *  get_ticket3            帳票種別3-営業員拠点/課別 (A-5-1,A-5-2)
 *  up_plsql_tab3          拠点/課別-PLSQL表の更新 (A-5-3)
 *  get_ticket4            帳票種別4-地区営業部/部別 (A-6-1,A-6-2)
 *  up_plsql_tab4          地区営業部/部別-PLSQL表の更新 (A-6-3)
 *  get_ticket5            帳票種別5-地区営業本部別 (A-7-1,A-7-2)
 *  up_plsql_tab5          地域営業本部別別-PLSQL表の更新 (A-7-3)
 *  insert_wrk_table       ワークテーブルへの出力 (A-3-4,A-4-4,A-5-4,A-6-4,A-7-4)
 *  act_svf                SVF起動 (A-8)
 *  del_wrk_tbl_data       ワークテーブルデータ削除 (A-9)
 *  submain                メイン処理プロシージャ
 *                         SVF起動APIエラーチェック(A-10)
 *  main                   コンカレント実行ファイル登録プロシージャ
 *                         終了処理 (A-11)
 *  debug                  デバッグログ出力
 *
 * Change Record
 * ------------- ----- ---------------- -------------------------------------------------
 *  Date          Ver.  Editor           Description
 * ------------- ----- ---------------- -------------------------------------------------
 *  2009-01-10    1.0   Seirin.Kin        新規作成
 *  2009-03-03    1.1   Kazuyo.Hosoi      SVF起動API埋め込み
 *  2009-03-13    1.1   Kazuyo.Hosoi      【障害対応047・057】顧客区分、ステータス抽出条件変更
 *  2009-04-27    1.2   Daisuke.Abe       【売上計画出力対応】T1_0689,T1_0692,T1_0694,T1_0695
 *  2009-04-27    1.2   Daisuke.Abe       【売上計画出力対応】T1_0734,T1_0739,T1_0744,T1_0745
 *  2009-04-27    1.2   Daisuke.Abe       【売上計画出力対応】T1_0751
 *  2009-05-19    1.3   Hiroshi.Ogawa     障害番号：T1_0945,T1_1021,T1_1024,T1_1027,T1_1028
 *  2009-05-19    1.3   Hiroshi.Ogawa     障害番号：T1_1029,T1_1031,T1_1033,T1_1037,T1_1056
 *  2009-06-02    1.3   Daisuke.Abe       PT対応
 *  2009-06-26    1.4   Satomura.Kazuo    統合テスト障害番号0000016対応
 *  2009-07-02    1.5   Hiroshi.Ogawa     障害番号：0000312
 *  2009-08-03    1.6   Satomura.Kazuo    統合テスト障害番号0000911対応
 *  2009-08-03    1.7   Mio.Maruyama      統合テスト障害番号0001105対応
 *  2009-08-03    1.8   Satomura.Kazuo    統合テスト障害番号0001271対応
 *                                        統合テスト障害番号0001317対応
 *  2018-02-28    1.9   Kazuhiro.Nara     E_本稼動_14884対応
 *****************************************************************************************/
--
--#######################  固定グローバル定数宣言部 START   #######################
--
  --TODO単体テスト終了時にFALSEに変更
  --デバッグログ出力する／しない
  CB_DEBUG_LOG              CONSTANT BOOLEAN      := TRUE;
  --エラー発生処理番号
  CB_DO_ERROR_NO            CONSTANT VARCHAR2(10) := 'NULL';
  --帳票ワークテーブル削除する／しない
  CB_DO_DELETE         CONSTANT BOOLEAN           := TRUE;
--
  --ステータス・コード
  cv_status_normal          CONSTANT VARCHAR2(1) := xxccp_common_pkg.set_status_normal; --正常:0
  cv_status_warn            CONSTANT VARCHAR2(1) := xxccp_common_pkg.set_status_warn;   --警告:1
  cv_status_error           CONSTANT VARCHAR2(1) := xxccp_common_pkg.set_status_error;  --異常:2
  --WHOカラム
  cn_created_by             CONSTANT NUMBER      := fnd_global.user_id;         --CREATED_BY
  cd_creation_date          CONSTANT DATE        := SYSDATE;                    --CREATION_DATE
  cn_last_updated_by        CONSTANT NUMBER      := fnd_global.user_id;         --LAST_UPDATED_BY
  cd_last_update_date       CONSTANT DATE        := SYSDATE;                    --LAST_UPDATE_DATE
  cn_last_update_login      CONSTANT NUMBER      := fnd_global.login_id;        --LAST_UPDATE_LOGIN
  cn_request_id             CONSTANT NUMBER      := fnd_global.conc_request_id; --REQUEST_ID
  cn_program_application_id CONSTANT NUMBER      := fnd_global.prog_appl_id;    --PROGRAM_APPLICATION_ID
  cn_program_id             CONSTANT NUMBER      := fnd_global.conc_program_id; --PROGRAM_ID
  cd_program_update_date    CONSTANT DATE        := SYSDATE;                    --PROGRAM_UPDATE_DATE
  cv_msg_part               CONSTANT VARCHAR2(3) := ' : ';
  cv_msg_cont               CONSTANT VARCHAR2(3) := '.';
  cv_msg_pnt                CONSTANT VARCHAR2(3) := ',';
  cv_lf                     CONSTANT VARCHAR2(1) := CHR(10);
--
--################################  固定部 END   ##################################
--
--#######################  固定グローバル変数宣言部 START   #######################
--
  gv_out_msg       VARCHAR2(2000);
  gv_sep_msg       VARCHAR2(2000);
  gv_exec_user     VARCHAR2(100);
  gv_conc_name     VARCHAR2(30);
  gv_conc_status   VARCHAR2(30);
  gn_target_cnt    NUMBER;                    -- 対象件数
  gn_normal_cnt    NUMBER;                    -- 正常件数
  gn_error_cnt     NUMBER;                    -- エラー件数
  gn_warn_cnt      NUMBER;                    -- スキップ件数
--
--################################  固定部 END   ##################################
--
--##########################  固定共通例外宣言部 START  ###########################
--
  --*** 処理部共通例外 ***
  global_process_expt       EXCEPTION;
  --*** 共通関数例外 ***
  global_api_expt           EXCEPTION;
  --*** 共通関数OTHERS例外 ***
  global_api_others_expt    EXCEPTION;
--
  PRAGMA EXCEPTION_INIT(global_api_others_expt,-20000);
--
--################################  固定部 END   ##################################
--
  -- ===============================
  -- ユーザー定義グローバル定数
  -- ===============================
  cv_resp_id                CONSTANT VARCHAR2(10)  := 'resp_id';           -- 職責ID
  cv_pkg_name               CONSTANT VARCHAR2(100) := 'XXCSO019A05C';      -- パッケージ名
  cv_app_name               CONSTANT VARCHAR2(5)   := 'XXCSO';             -- アプリケーション短縮名
  cv_tab_samari             CONSTANT VARCHAR2(100) := 'XXCSO_SUM_VISIT_SALE_REP';-- サマリテーブル
  cv_gvm_g                  CONSTANT VARCHAR2(1)   := '1';                 -- 一般
  cv_gvm_v                  CONSTANT VARCHAR2(1)   := '2';                 -- 自販機
  cv_gvm_m                  CONSTANT VARCHAR2(1)   := '3';                 -- MC
  cv_true                   CONSTANT VARCHAR2(4)   := 'TRUE';              -- VARCHAR2型のTRUE
  cv_false                  CONSTANT VARCHAR2(5)   := 'FALSE';             -- VARCHAR2型のFALSE
  cv_cust_class_cd1         CONSTANT VARCHAR2(2)   := '13';                -- 法人顧客
  cv_cust_class_cd2         CONSTANT VARCHAR2(2)   := '14';                -- 売掛管理顧客
  cv_cust_class_cd3         CONSTANT VARCHAR2(2)   := '10';                -- 顧客
  cv_cust_class_cd4         CONSTANT VARCHAR2(2)   := '12';                -- 上様顧客
  cv_cust_class_cd5         CONSTANT VARCHAR2(2)   := '15';                -- 巡回
  cv_cust_class_cd6         CONSTANT VARCHAR2(2)   := '16';                -- 問屋帳合先
  cv_cust_class_cd7         CONSTANT VARCHAR2(2)   := '17';                -- 計画
  cv_cust_status1           CONSTANT VARCHAR2(2)   := '80';                -- 顧客ステータス(更正債権)
  cv_cust_status2           CONSTANT VARCHAR2(2)   := '90';                -- 顧客ステータス(中止決裁)
  cv_cust_status3           CONSTANT VARCHAR2(2)   := '99';                -- 顧客ステータス(対象外)
  cv_cust_status4           CONSTANT VARCHAR2(2)   := '20';                -- 顧客ステータスMC)
  cv_cust_status5           CONSTANT VARCHAR2(2)   := '25';                -- 顧客ステータス(SP承認)
  cv_cust_status6           CONSTANT VARCHAR2(2)   := '30';                -- 顧客ステータス(承認済)
  cv_cust_status7           CONSTANT VARCHAR2(2)   := '10';                -- 顧客ステータス(MC候補)
  cv_cust_status8           CONSTANT VARCHAR2(2)   := '40';                -- 顧客ステータス(顧客)
  cv_cust_status9           CONSTANT VARCHAR2(2)   := '50';                -- 顧客ステータス(休止)
  cv_sum_org_type1          CONSTANT VARCHAR2(1)   := '1';                 -- 顧客コード
  cv_sum_org_type2          CONSTANT VARCHAR2(1)   := '2';                 -- 従業員番号
  cv_sum_org_type3          CONSTANT VARCHAR2(1)   := '3';                 -- 営業グループ番号
  cv_sum_org_type4          CONSTANT VARCHAR2(1)   := '4';                 -- 拠点コード
  cv_sum_org_type5          CONSTANT VARCHAR2(1)   := '5';                 -- 地区営業部コード
  cv_month_date_div1        CONSTANT VARCHAR2(1)   := '1';                 -- 月日区分(月別)
  cv_month_date_div2        CONSTANT VARCHAR2(1)   := '2';                 -- 月日区分(日別)
  cv_report_1               CONSTANT VARCHAR2(1)   := '1';                 -- 帳票種別1-営業員別
  cv_report_2               CONSTANT VARCHAR2(1)   := '2';                 -- 帳票種別2-営業グループ別
  cv_report_3               CONSTANT VARCHAR2(1)   := '3';                 -- 帳票種別3-拠点/課別
  cv_report_4               CONSTANT VARCHAR2(1)   := '4';                 -- 帳票種別4-地区営業部別/部別
  cv_report_5               CONSTANT VARCHAR2(1)   := '5';                 -- 帳票種別5-地域営業本部
  cn_line_kind1             CONSTANT NUMBER(5)     := 1;                   -- 帳票出力位置ヘッダ部
  cn_line_kind2             CONSTANT NUMBER(5)     := 2;                   -- 帳票出力位置売り上げ明細部
  cn_line_kind3             CONSTANT NUMBER(5)     := 3;                   -- 帳票出力位置売り上げ中計部
  cn_line_kind4             CONSTANT NUMBER(5)     := 4;                   -- 帳票出力位置売り上げ合計部
  cn_line_kind5             CONSTANT NUMBER(5)     := 5;                   -- 帳票出力位置訪問中計部
  cn_line_kind6             CONSTANT NUMBER(5)     := 6;                   -- 帳票出力位置訪問合計部
  cn_line_kind7             CONSTANT NUMBER(5)     := 7;                   -- 帳票出力位置訪問内容合計部
  cn_idx_sales_ippn         CONSTANT NUMBER(1)     := 1;                   -- 本体部配列番号（売上中計部：一般）
  cn_idx_sales_vd           CONSTANT NUMBER(1)     := 2;                   -- 本体部配列番号（売上中計部：自販機）
  cn_idx_sales_sum          CONSTANT NUMBER(1)     := 3;                   -- 本体部配列番号（売上中計部：合計）
  cn_idx_visit_ippn         CONSTANT NUMBER(1)     := 4;                   -- 本体部配列番号（訪問中計部：一般）
  cn_idx_visit_vd           CONSTANT NUMBER(1)     := 5;                   -- 本体部配列番号（訪問中計部：自販機）
  cn_idx_visit_mc           CONSTANT NUMBER(1)     := 6;                   -- 本体部配列番号（訪問中計部：ＭＣ）
  cn_idx_visit_sum          CONSTANT NUMBER(1)     := 7;                   -- 本体部配列番号（訪問中計部：合計）
  cn_idx_visit_dsc          CONSTANT NUMBER(1)     := 8;                   -- 本体部配列番号（訪問内容）
  cn_idx_max                CONSTANT NUMBER(1)     := cn_idx_visit_dsc;    -- 最大値
  cv_flg_y                  CONSTANT VARCHAR2(1)   := 'Y';                 -- 営業グループリーダ(フラグ)
  cv_flg_n                  CONSTANT VARCHAR2(1)   := 'N';                 -- 営業員(フラグ)
  cv_mc                     CONSTANT VARCHAR2(2)   := 'MC';
  /* 2009.09.08 K.Satomura 0001271対応 START */
  cd_process_date           CONSTANT DATE          := xxccp_common_pkg2.get_process_date; -- 業務処理日付
  /* 2009.09.08 K.Satomura 0001271対応 END */
  -- 訪問売上計画管理表帳票種別参照タイプ
  cv_rep_lookup_type_code   CONSTANT VARCHAR2(100) := 'XXCSO1_VST_SLS_REP_KIND';
  cv_lookup_type_dai        CONSTANT VARCHAR2(100) := 'XXCMM_CUST_GYOTAI_DAI';
  cv_lookup_type_chu        CONSTANT VARCHAR2(100) := 'XXCMM_CUST_GYOTAI_CHU';
  cv_lookup_type_syo        CONSTANT VARCHAR2(100) := 'XXCMM_CUST_GYOTAI_SHO';
  cv_svf_form_def_no        CONSTANT VARCHAR2(100) := '1';                 -- フォーム様式ファイル名DEF番号
  cv_svf_query_def_no       CONSTANT VARCHAR2(100) := '2';                 -- クエリー様式ファイル名DEF番号
--
  -- メッセージコード
  cv_tkn_number_01          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00411';  -- 基準年月
  cv_tkn_number_02          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00412';  -- 帳票種別
  cv_tkn_number_03          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00130';  -- 拠点コード
  cv_tkn_number_04          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00133';  -- 拠点コードを選択してください。
  cv_tkn_number_05          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00508';  -- 期間はYYYYMMの型で指定してください。
  cv_tkn_number_06          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00157';  -- 基準年月は未来日付は入力できません。
  cv_tkn_number_07          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00134';  -- XXXXは実行権限がありません。
  cv_tkn_number_08          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00024';
  -- 未訪問顧客一覧のデータ抽出に失敗しました、処理を終了します。（SQLエラー：ORA-XXXX ・・・）システム管理者に連絡して      ください。
  cv_tkn_number_09          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00135';
  -- SVF起動APIでエラーが発生しました。システム管理者に連絡してください。
  cv_tkn_number_10          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00119';
  -- 未訪問顧客一覧帳票ワークテーブルのデータ削除に失敗しました、処理を終了します。（SQLエラー：ORA-XXXX ・・・）システ      ム管理者に連絡してください。
  cv_tkn_number_11          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00140';  -- (データがありません。)
  cv_tkn_number_12          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00173';  -- 参照タイプなし
  /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 START */
  cv_tkn_number_13          CONSTANT VARCHAR2(100) := 'APP-XXCSO1-00539';
  /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 END */
--
  -- トークンコード
  cv_tkn_entry              CONSTANT VARCHAR2(5)   := 'ENTRY' ;             -- ENTRY
  cv_tkn_table              CONSTANT VARCHAR2(5)   := 'TABLE' ;             -- TABLE
  cv_tkn_api_name           CONSTANT VARCHAR2(10)  := 'API_NAME' ;          -- API_NAME
  cv_tkn_errmsg             CONSTANT VARCHAR2(10)  := 'ERR_MSG' ;           -- ERR_MSG
  cv_tkn_cnt                CONSTANT VARCHAR2(10)  := 'COUNT' ;             -- COUNT
  cv_tkn_task_name          CONSTANT VARCHAR2(10)  := 'TASK_NAME' ;         -- TASK_NAME
  cv_tkn_lookup_type_name   CONSTANT VARCHAR2(20)  := 'LOOKUP_TYPE_NAME' ;  -- LOOKUP_TYPE_NAME
  /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 START */
  cv_tkn_item               CONSTANT VARCHAR2(100) := 'ITEM';
  /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 END */
  -- DEBUG_LOG用メッセージ
--
  -- ===============================
  -- ユーザー定義グローバル変数
  -- ===============================
--
  -- ===============================
  -- ユーザー定義グローバル型
  -- ===============================
  -- グローバル変数
  gn_resp_id                NUMBER(9);                                              -- 職責ID
  gv_report_meaning         VARCHAR2(100);                                          -- 帳票種別名
  gv_svf_form_name          VARCHAR2(50);                                           -- フォーム様式ファイル名
  gv_svf_query_name         VARCHAR2(50);                                           -- クエリー様式ファイル名
  gt_employee_number        xxcso_resource_relations_v2.employee_number%TYPE;       -- 従業員番号
  gt_work_base_code         xxcso_resource_relations_v2.work_base_code_new%TYPE;    -- 勤務地拠点コード
  gt_group_number           xxcso_resource_relations_v2.group_number_new%TYPE;      -- グループ番号
  gt_position_code          xxcso_resource_relations_v2.position_code_new%TYPE;     -- 職位コード
  gt_job_type_code          xxcso_resource_relations_v2.job_type_code_new%TYPE;     -- 職種コード
  gt_group_leader_flag      xxcso_resource_relations_v2.group_leader_flag_new%TYPE; -- グループ長区分
  gv_report_type            VARCHAR2(9);                                            -- 入力された帳票種別
  gv_base_code              VARCHAR2(9);                                            -- 入力された拠点コード
  gd_year_month_day         DATE;                                                   -- 基準年月の１日
  gd_year_month_lastday     DATE;                                                   -- 基準年月の末日
  gd_online_sysdate         DATE;                                                   -- 発令日判断用
  gv_online_sysdate         VARCHAR2(8);                                            -- 発令日判断テスト用
  gv_year_month             VARCHAR2(6);                                            -- 入力された基準年月
  gd_year_month             DATE;                                                   -- 入力された基準年月のDate型
  gv_year_month_prev        VARCHAR2(6);                                            -- 基準年月の先月
  gv_year_prev              VARCHAR2(6);                                            -- 基準年月の先年
  gn_operation_days         NUMBER(5);                                              -- 稼動日数
  gn_operation_all_days     NUMBER(5);                                              -- 稼動可能日数
  gv_work_base_code         xxcso_resource_relations_v2.work_base_code_new%TYPE;    -- 勤務地拠点コード
  gv_is_salesman            VARCHAR2(6);                                            -- ログインユーザが営業員
  gv_is_groupleader         VARCHAR2(6);                                            -- ログインユーザがグループリーダ
/* 20090702_Ogawa_0000312 START*/
  gn_rsrc_attr_group_id     NUMBER;                                                 -- 属性グループID（担当営業員）
  gn_rtn_attr_group_id      NUMBER;                                                 -- 属性グループID（ルートNo）
/* 20090702_Ogawa_0000312 END*/
  -- 1日分売上計画、売上実績などの項目を保持するレコード型定義
  TYPE g_get_one_day_date_rtype IS RECORD(
    plan_vs_amt             xxcso_rep_visit_sale_plan.plan_vs_amt_1%TYPE,           -- 売上計画,訪問計画
    rslt_vs_amt             xxcso_rep_visit_sale_plan.rslt_vs_amt_1%TYPE,           -- 売上実績,訪問実績
    rslt_other_sales_amt    xxcso_rep_visit_sale_plan.rslt_other_sales_amt_1%TYPE,  -- 売上実績（他拠点納品分）
    effective_num           xxcso_rep_visit_sale_plan.effective_num_1%TYPE,         -- 有効軒数
    visit_sign              VARCHAR2(20)                                            -- 結合訪問記号
  );
  -- １ヵ月分の売上計画、売上実績などの項目を保持するテーブル型定義
  TYPE g_get_one_day_ttype IS TABLE OF g_get_one_day_date_rtype INDEX BY PLS_INTEGER;
  -- 抽出データ情報格納レコード型定義
  TYPE g_get_month_data_rtype IS RECORD(
    up_base_code               xxcso_rep_visit_sale_plan.up_base_code%TYPE,              -- 拠点コード（親）
    up_hub_name                xxcso_rep_visit_sale_plan.up_hub_name%TYPE,               -- 拠点名称（親）
    base_code                  xxcso_rep_visit_sale_plan.base_code%TYPE,                 -- 拠点コード
    hub_name                   xxcso_rep_visit_sale_plan.hub_name%TYPE,                  -- 拠点名称
    group_number               xxcso_rep_visit_sale_plan.group_number%TYPE,              -- 営業グループ番号
    group_name                 xxcso_rep_visit_sale_plan.group_name%TYPE,                -- 営業グループ名
    employee_number            xxcso_rep_visit_sale_plan.employee_number%TYPE,           -- 営業員コード
    employee_name              xxcso_rep_visit_sale_plan.employee_name%TYPE,             -- 営業員名
    business_high_type         xxcso_rep_visit_sale_plan.business_high_type%TYPE,        -- 業態（大分類）
    business_high_name         xxcso_rep_visit_sale_plan.business_high_name%TYPE,        -- 業態（大分類）名
    gvm_type                   xxcso_rep_visit_sale_plan.gvm_type%TYPE,                  -- 一般／自販機／ＭＣ
    account_number             xxcso_rep_visit_sale_plan.account_number%TYPE,            -- 顧客コード
    customer_name              xxcso_rep_visit_sale_plan.customer_name%TYPE,             -- 顧客名
    route_no                   xxcso_rep_visit_sale_plan.route_no%TYPE,                  -- ルートNo
    last_year_rslt_sales_amt   xxcso_rep_visit_sale_plan.last_year_rslt_sales_amt%TYPE,  -- 前年実績
    last_mon_rslt_sales_amt    xxcso_rep_visit_sale_plan.last_mon_rslt_sales_amt%TYPE,   -- 先月実績
    new_customer_num           xxcso_rep_visit_sale_plan.new_customer_num%TYPE,          -- 新規顧客件数
    new_vendor_num             xxcso_rep_visit_sale_plan.new_vendor_num%TYPE,            -- 新規ＶＤ件数
    new_customer_amt           xxcso_rep_visit_sale_plan.new_customer_amt%TYPE,          -- 新規顧客売上実績
    new_vendor_amt             xxcso_rep_visit_sale_plan.new_vendor_amt%TYPE,            -- 新規ＶＤ売上実績
    plan_sales_amt             xxcso_rep_visit_sale_plan.plan_sales_amt%TYPE,            -- 売上予算
    l_get_one_day_tab          g_get_one_day_ttype,                                      -- 日別データ格納テーブル型
    vis_a_num                  NUMBER(9),                                                -- 訪問Ａ件数
    vis_b_num                  NUMBER(9),                                                -- 訪問Ｂ件数
    vis_c_num                  NUMBER(9),                                                -- 訪問Ｃ件数
    vis_d_num                  NUMBER(9),                                                -- 訪問Ｄ件数
    vis_e_num                  NUMBER(9),                                                -- 訪問Ｅ件数
    vis_f_num                  NUMBER(9),                                                -- 訪問Ｆ件数
    vis_g_num                  NUMBER(9),                                                -- 訪問Ｇ件数
    vis_h_num                  NUMBER(9),                                                -- 訪問Ｈ件数
    vis_i_num                  NUMBER(9),                                                -- 訪問ⅰ件数
    vis_j_num                  NUMBER(9),                                                -- 訪問Ｊ件数
    vis_k_num                  NUMBER(9),                                                -- 訪問Ｋ件数
    vis_l_num                  NUMBER(9),                                                -- 訪問Ｌ件数
    vis_m_num                  NUMBER(9),                                                -- 訪問Ｍ件数
    vis_n_num                  NUMBER(9),                                                -- 訪問Ｎ件数
    vis_o_num                  NUMBER(9),                                                -- 訪問Ｏ件数
    vis_p_num                  NUMBER(9),                                                -- 訪問Ｐ件数
    vis_q_num                  NUMBER(9),                                                -- 訪問Ｑ件数
    vis_r_num                  NUMBER(9),                                                -- 訪問Ｒ件数
    vis_s_num                  NUMBER(9),                                                -- 訪問Ｓ件数
    vis_t_num                  NUMBER(9),                                                -- 訪問Ｔ件数
    vis_u_num                  NUMBER(9),                                                -- 訪問Ｕ件数
    vis_v_num                  NUMBER(9),                                                -- 訪問Ｖ件数
    vis_w_num                  NUMBER(9),                                                -- 訪問Ｗ件数
    vis_x_num                  NUMBER(9),                                                -- 訪問Ｘ件数
    vis_y_num                  NUMBER(9),                                                -- 訪問Ｙ件数
    vis_z_num                  NUMBER(9)                                                 -- 訪問Ｚ件数
  );
  -- 抽出データ情報格納テーブル型定義
  TYPE g_get_month_square_ttype IS TABLE OF g_get_month_data_rtype INDEX BY PLS_INTEGER;
  -- 営業員別帳票レコード（帳票１）
  TYPE g_one_day_rtype1 IS RECORD(
    tgt_amt             xxcso_sum_visit_sale_rep.tgt_amt%TYPE,                -- 売上計画
    rslt_amt            xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 売上実績
    rslt_center_amt     xxcso_sum_visit_sale_rep.rslt_center_amt%TYPE,        -- 内他拠点＿売上実績
    tgt_vis_num         xxcso_sum_visit_sale_rep.tgt_vis_num%TYPE,            -- 訪問計画
    vis_num             xxcso_sum_visit_sale_rep.vis_num%TYPE,                -- 訪問実績
    vis_sales_num       xxcso_sum_visit_sale_rep.vis_sales_num%TYPE,          -- 有効軒数
    vis_new_num         xxcso_sum_visit_sale_rep.vis_new_num%TYPE,            -- 訪問実績（新規)
    vis_vd_new_num      xxcso_sum_visit_sale_rep.vis_vd_new_num%TYPE,         -- 訪問実績（VD：新規）
    visit_sign          VARCHAR2(20),                                         -- 結合訪問記号
    vis_a_num           NUMBER(9),                                            -- 訪問Ａ件数
    vis_b_num           NUMBER(9),                                            -- 訪問Ｂ件数
    vis_c_num           NUMBER(9),                                            -- 訪問Ｃ件数
    vis_d_num           NUMBER(9),                                            -- 訪問Ｄ件数
    vis_e_num           NUMBER(9),                                            -- 訪問Ｅ件数
    vis_f_num           NUMBER(9),                                            -- 訪問Ｆ件数
    vis_g_num           NUMBER(9),                                            -- 訪問Ｇ件数
    vis_h_num           NUMBER(9),                                            -- 訪問Ｈ件数
    vis_i_num           NUMBER(9),                                            -- 訪問ⅰ件数
    vis_j_num           NUMBER(9),                                            -- 訪問Ｊ件数
    vis_k_num           NUMBER(9),                                            -- 訪問Ｋ件数
    vis_l_num           NUMBER(9),                                            -- 訪問Ｌ件数
    vis_m_num           NUMBER(9),                                            -- 訪問Ｍ件数
    vis_n_num           NUMBER(9),                                            -- 訪問Ｎ件数
    vis_o_num           NUMBER(9),                                            -- 訪問Ｏ件数
    vis_p_num           NUMBER(9),                                            -- 訪問Ｐ件数
    vis_q_num           NUMBER(9),                                            -- 訪問Ｑ件数
    vis_r_num           NUMBER(9),                                            -- 訪問Ｒ件数
    vis_s_num           NUMBER(9),                                            -- 訪問Ｓ件数
    vis_t_num           NUMBER(9),                                            -- 訪問Ｔ件数
    vis_u_num           NUMBER(9),                                            -- 訪問Ｕ件数
    vis_v_num           NUMBER(9),                                            -- 訪問Ｖ件数
    vis_w_num           NUMBER(9),                                            -- 訪問Ｗ件数
    vis_x_num           NUMBER(9),                                            -- 訪問Ｘ件数
    vis_y_num           NUMBER(9),                                            -- 訪問Ｙ件数
    vis_z_num           NUMBER(9)                                             -- 訪問Ｚ件数
  );
  TYPE g_one_day_ttype1 IS TABLE OF g_one_day_rtype1 INDEX BY PLS_INTEGER;
  TYPE g_month_rtype1 IS RECORD(
    work_base_code      xxcso_resource_relations_v2.work_base_code_new%TYPE,  -- 勤務地拠点コード
    base_name           xxcso_resource_relations_v2.work_base_name_new%TYPE,  -- 勤務地拠点名
    employee_number     xxcso_resource_relations_v2.employee_number%TYPE,     -- 従業員番号
    name                xxcso_resource_relations_v2.full_name%TYPE,           -- 従業員名
    gvm_type            xxcso_rep_visit_sale_plan.gvm_type%TYPE,              -- 一般／自販機／ＭＣ
    account_number      xxcso_cust_accounts_v.account_number%TYPE,            -- 顧客コード
    party_name          xxcso_cust_accounts_v.party_name%TYPE,                -- 顧客名
    route_number        xxcso_cust_routes_v2.route_number%TYPE,               -- ルートNo
    business_high_type  xxcso_rep_visit_sale_plan.business_high_type%TYPE,    -- 業態（大分類）
    business_high_name  xxcso_rep_visit_sale_plan.business_high_name%TYPE,    -- 業態（大分類）名
    l_one_day_tab       g_one_day_ttype1,                                     -- 日別データ格納
    cust_new_num        xxcso_sum_visit_sale_rep.cust_new_num%TYPE,           -- 顧客件数（新規）
    cust_vd_new_num     xxcso_sum_visit_sale_rep.cust_vd_new_num%TYPE,        -- 顧客件数（VD：新規）
    rslt_amty           xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 前年実績
    rslt_amtm           xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 先月実績
    tgt_sales_prsn_total_amt xxcso_sum_visit_sale_rep.tgt_sales_prsn_total_amt%TYPE   -- 月別売上予算
  );
  -- 営業グループ別（帳票２）
  TYPE g_one_day_rtype2 IS RECORD(
    tgt_amt             xxcso_sum_visit_sale_rep.tgt_amt%TYPE,                -- 売上計画
    tgt_new_amt         xxcso_sum_visit_sale_rep.tgt_new_amt%TYPE,            -- 売上計画（新規）
    tgt_vd_new_amt      xxcso_sum_visit_sale_rep.tgt_vd_new_amt%TYPE,         -- 売上計画（VD：新規）
    tgt_vd_amt          xxcso_sum_visit_sale_rep.tgt_vd_amt%TYPE,             -- 売上計画（VD）
    tgt_other_new_amt   xxcso_sum_visit_sale_rep.tgt_other_new_amt%TYPE,      -- 売上計画（VD以外：新規）
    tgt_other_amt       xxcso_sum_visit_sale_rep.tgt_other_amt%TYPE,          -- 売上計画（VD以外）
    rslt_amt            xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 売上実績
    rslt_new_amt        xxcso_sum_visit_sale_rep.rslt_new_amt%TYPE,           -- 売上実績（新規）
    rslt_vd_new_amt     xxcso_sum_visit_sale_rep.rslt_vd_new_amt%TYPE,        -- 売上実績（VD：新規）
    rslt_vd_amt         xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 売上実績（VD）
    rslt_other_new_amt  xxcso_sum_visit_sale_rep.rslt_other_new_amt%TYPE,     -- 売上実績（VD以外：新規）
    rslt_other_amt      xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 売上実績（VD以外）
    rslt_center_amt     xxcso_sum_visit_sale_rep.rslt_center_amt%TYPE,        -- 内他拠点＿売上実績
    tgt_vis_num         xxcso_sum_visit_sale_rep.tgt_vis_num%TYPE,            -- 訪問計画
    tgt_vis_new_num     xxcso_sum_visit_sale_rep.tgt_vis_new_num%TYPE,        -- 訪問計画（新規）
    tgt_vis_vd_new_num  xxcso_sum_visit_sale_rep.tgt_vis_vd_new_num%TYPE,     -- 訪問計画（VD：新規）
    tgt_vis_vd_num      xxcso_sum_visit_sale_rep.tgt_vis_vd_num%TYPE,         -- 訪問計画（VD）
    tgt_vis_other_new_num     xxcso_sum_visit_sale_rep.tgt_vis_other_new_num%TYPE,  -- 訪問計画（VD以外：新規）
    tgt_vis_mc_num      xxcso_sum_visit_sale_rep.tgt_vis_mc_num%TYPE,         -- 訪問計画(MC)
    tgt_vis_other_num   xxcso_sum_visit_sale_rep.tgt_vis_other_num%TYPE,      -- 訪問計画（VD以外）
    vis_num             xxcso_sum_visit_sale_rep.vis_num%TYPE,                -- 訪問実績
    vis_new_num         xxcso_sum_visit_sale_rep.vis_new_num%TYPE,            -- 訪問実績（新規）
    vis_vd_new_num      xxcso_sum_visit_sale_rep.vis_vd_new_num%TYPE,         -- 訪問実績（VD：新規）
    vis_vd_num          xxcso_sum_visit_sale_rep.vis_vd_num%TYPE,             -- 訪問実績（VD）
    vis_other_new_num   xxcso_sum_visit_sale_rep.vis_other_new_num%TYPE,      -- 訪問実績（VD以外：新規）
    vis_other_num       xxcso_sum_visit_sale_rep.vis_other_num%TYPE,          -- 訪問実績（VD以外）
    vis_mc_num          xxcso_sum_visit_sale_rep.vis_mc_num%TYPE,             -- 訪問実績(MC)
    vis_sales_num       xxcso_sum_visit_sale_rep.vis_sales_num%TYPE,          -- 有効軒数
    vis_a_num           NUMBER(9),                                            -- 訪問Ａ件数
    vis_b_num           NUMBER(9),                                            -- 訪問Ｂ件数
    vis_c_num           NUMBER(9),                                            -- 訪問Ｃ件数
    vis_d_num           NUMBER(9),                                            -- 訪問Ｄ件数
    vis_e_num           NUMBER(9),                                            -- 訪問Ｅ件数
    vis_f_num           NUMBER(9),                                            -- 訪問Ｆ件数
    vis_g_num           NUMBER(9),                                            -- 訪問Ｇ件数
    vis_h_num           NUMBER(9),                                            -- 訪問Ｈ件数
    vis_i_num           NUMBER(9),                                            -- 訪問ⅰ件数
    vis_j_num           NUMBER(9),                                            -- 訪問Ｊ件数
    vis_k_num           NUMBER(9),                                            -- 訪問Ｋ件数
    vis_l_num           NUMBER(9),                                            -- 訪問Ｌ件数
    vis_m_num           NUMBER(9),                                            -- 訪問Ｍ件数
    vis_n_num           NUMBER(9),                                            -- 訪問Ｎ件数
    vis_o_num           NUMBER(9),                                            -- 訪問Ｏ件数
    vis_p_num           NUMBER(9),                                            -- 訪問Ｐ件数
    vis_q_num           NUMBER(9),                                            -- 訪問Ｑ件数
    vis_r_num           NUMBER(9),                                            -- 訪問Ｒ件数
    vis_s_num           NUMBER(9),                                            -- 訪問Ｓ件数
    vis_t_num           NUMBER(9),                                            -- 訪問Ｔ件数
    vis_u_num           NUMBER(9),                                            -- 訪問Ｕ件数
    vis_v_num           NUMBER(9),                                            -- 訪問Ｖ件数
    vis_w_num           NUMBER(9),                                            -- 訪問Ｗ件数
    vis_x_num           NUMBER(9),                                            -- 訪問Ｘ件数
    vis_y_num           NUMBER(9),                                            -- 訪問Ｙ件数
    vis_z_num           NUMBER(9)                                             -- 訪問Ｚ件数
  );
  TYPE g_one_day_ttype2 IS TABLE OF g_one_day_rtype2 INDEX BY PLS_INTEGER;
  TYPE g_month_rtype2 IS RECORD(
    work_base_code      xxcso_resource_relations_v2.work_base_code_new%TYPE,  -- 勤務地拠点コード
    base_name           xxcso_resource_relations_v2.work_base_name_new%TYPE,  -- 勤務地拠点名
    group_number        xxcso_resource_relations_v2.group_number_new%TYPE,    -- 営業グループ番号
    group_name          VARCHAR2(160),                                        -- 営業グループ名
    employee_number     xxcso_resource_relations_v2.employee_number%TYPE,     -- 従業員番号
    name                xxcso_resource_relations_v2.full_name%TYPE,           -- 従業員名
    gvm_type            xxcso_rep_visit_sale_plan.gvm_type%TYPE,              -- 一般／自販機／ＭＣ
    l_one_day_tab       g_one_day_ttype2,                                     -- 日別データ格納（テーブル型）
    rslt_amty           xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 前年実績
    rslt_vd_amty        xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 前年実績（VD）
    rslt_other_amty     xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 前年実績（VD以外）
    rslt_amtm           xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 先月実績
    rslt_vd_amtm        xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 先月実績（VD）
    rslt_other_amtm     xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 先月実績（VD以外）
    cust_new_num        xxcso_sum_visit_sale_rep.cust_new_num%TYPE,           -- 顧客件数（新規）
    cust_vd_new_num     xxcso_sum_visit_sale_rep.cust_vd_new_num%TYPE,        -- 顧客件数（VD：新規）
    cust_other_new_num  xxcso_sum_visit_sale_rep.cust_other_new_num%TYPE,     -- 顧客件数（VD以外：新規）
    tgt_sales_prsn_total_amt xxcso_sum_visit_sale_rep.tgt_sales_prsn_total_amt%TYPE   -- 月別売上予算
  );
  -- 拠点/課別（帳票３）
  TYPE g_one_day_rtype3 IS RECORD(
    tgt_amt                   xxcso_sum_visit_sale_rep.tgt_amt%TYPE,           -- 売上計画
    tgt_new_amt               xxcso_sum_visit_sale_rep.tgt_new_amt%TYPE,       -- 売上計画（新規）
    tgt_vd_new_amt            xxcso_sum_visit_sale_rep.tgt_vd_new_amt%TYPE,    -- 売上計画（VD：新規）
    tgt_vd_amt                xxcso_sum_visit_sale_rep.tgt_vd_amt%TYPE,        -- 売上計画（VD）
    tgt_other_new_amt         xxcso_sum_visit_sale_rep.tgt_other_new_amt%TYPE, -- 売上計画（VD以外：新規）
    tgt_other_amt             xxcso_sum_visit_sale_rep.tgt_other_amt%TYPE,     -- 売上計画（VD以外）
    rslt_amt                  xxcso_sum_visit_sale_rep.rslt_amt%TYPE,          -- 売上実績
    rslt_new_amt              xxcso_sum_visit_sale_rep.rslt_new_amt%TYPE,      -- 売上実績（新規）
    rslt_vd_new_amt           xxcso_sum_visit_sale_rep.rslt_vd_new_amt%TYPE,   -- 売上実績（VD：新規）
    rslt_vd_amt               xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,       -- 売上実績（VD）
    rslt_other_new_amt        xxcso_sum_visit_sale_rep.rslt_other_new_amt%TYPE,-- 売上実績（VD以外：新規）
    rslt_other_amt            xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,    -- 売上実績（VD以外）
    rslt_center_amt           xxcso_sum_visit_sale_rep.rslt_center_amt%TYPE,   -- 内他拠点＿売上実績
    rslt_center_vd_amt        xxcso_sum_visit_sale_rep.rslt_center_vd_amt%TYPE,    -- 内他拠点＿売上実績（VD）
    rslt_center_other_amt     xxcso_sum_visit_sale_rep.rslt_center_other_amt%TYPE, -- 内他拠点＿売上実績（VD以外）
    tgt_vis_num               xxcso_sum_visit_sale_rep.tgt_vis_num%TYPE,       -- 訪問計画
    tgt_vis_new_num           xxcso_sum_visit_sale_rep.tgt_vis_new_num%TYPE,   -- 訪問計画（新規）
    tgt_vis_vd_new_num        xxcso_sum_visit_sale_rep.tgt_vis_vd_new_num%TYPE,-- 訪問計画（VD：新規）
    tgt_vis_vd_num            xxcso_sum_visit_sale_rep.tgt_vis_vd_num%TYPE,    -- 訪問計画（VD）
    tgt_vis_other_new_num     xxcso_sum_visit_sale_rep.tgt_vis_other_new_num%TYPE,-- 訪問計画（VD以外：新規）
    tgt_vis_other_num         xxcso_sum_visit_sale_rep.tgt_vis_other_num%TYPE, -- 訪問計画（VD以外）
    tgt_vis_mc_num            xxcso_sum_visit_sale_rep.tgt_vis_mc_num%TYPE,    -- 訪問計画(MC)
    vis_num                   xxcso_sum_visit_sale_rep.vis_num%TYPE,           -- 訪問実績
    vis_new_num               xxcso_sum_visit_sale_rep.vis_new_num%TYPE,       -- 訪問実績（新規）
    vis_vd_new_num            xxcso_sum_visit_sale_rep.vis_vd_new_num%TYPE,    -- 訪問実績（VD：新規）
    vis_vd_num                xxcso_sum_visit_sale_rep.vis_vd_num%TYPE,        -- 訪問実績（VD）
    vis_other_new_num         xxcso_sum_visit_sale_rep.vis_other_new_num%TYPE, -- 訪問実績（VD以外：新規）
    vis_other_num             xxcso_sum_visit_sale_rep.vis_other_num%TYPE,     -- 訪問実績（VD以外）
    vis_mc_num                xxcso_sum_visit_sale_rep.vis_mc_num%TYPE,        -- 訪問実績(MC)
    vis_sales_num             xxcso_sum_visit_sale_rep.vis_sales_num%TYPE,     -- 有効軒数
    vis_a_num                 NUMBER(9),                                       -- 訪問Ａ件数
    vis_b_num                 NUMBER(9),                                       -- 訪問Ｂ件数
    vis_c_num                 NUMBER(9),                                       -- 訪問Ｃ件数
    vis_d_num                 NUMBER(9),                                       -- 訪問Ｄ件数
    vis_e_num                 NUMBER(9),                                       -- 訪問Ｅ件数
    vis_f_num                 NUMBER(9),                                       -- 訪問Ｆ件数
    vis_g_num                 NUMBER(9),                                       -- 訪問Ｇ件数
    vis_h_num                 NUMBER(9),                                       -- 訪問Ｈ件数
    vis_i_num                 NUMBER(9),                                       -- 訪問ⅰ件数
    vis_j_num                 NUMBER(9),                                       -- 訪問Ｊ件数
    vis_k_num                 NUMBER(9),                                       -- 訪問Ｋ件数
    vis_l_num                 NUMBER(9),                                       -- 訪問Ｌ件数
    vis_m_num                 NUMBER(9),                                       -- 訪問Ｍ件数
    vis_n_num                 NUMBER(9),                                       -- 訪問Ｎ件数
    vis_o_num                 NUMBER(9),                                       -- 訪問Ｏ件数
    vis_p_num                 NUMBER(9),                                       -- 訪問Ｐ件数
    vis_q_num                 NUMBER(9),                                       -- 訪問Ｑ件数
    vis_r_num                 NUMBER(9),                                       -- 訪問Ｒ件数
    vis_s_num                 NUMBER(9),                                       -- 訪問Ｓ件数
    vis_t_num                 NUMBER(9),                                       -- 訪問Ｔ件数
    vis_u_num                 NUMBER(9),                                       -- 訪問Ｕ件数
    vis_v_num                 NUMBER(9),                                       -- 訪問Ｖ件数
    vis_w_num                 NUMBER(9),                                       -- 訪問Ｗ件数
    vis_x_num                 NUMBER(9),                                       -- 訪問Ｘ件数
    vis_y_num                 NUMBER(9),                                       -- 訪問Ｙ件数
    vis_z_num                 NUMBER(9)                                        -- 訪問Ｚ件数
  );
  TYPE g_one_day_ttype3 IS TABLE OF g_one_day_rtype3 INDEX BY PLS_INTEGER;
  TYPE g_month_rtype3 IS RECORD(
    work_base_code            xxcso_resource_relations_v2.work_base_code_new%TYPE,  -- 勤務地拠点コード
    base_name                 xxcso_resource_relations_v2.work_base_name_new%TYPE,  -- 勤務地拠点名
    group_number              xxcso_resource_relations_v2.group_number_new%TYPE,    -- 営業グループ番号
    group_name                VARCHAR2(160),                                        -- 営業グループ名
    gvm_type                  xxcso_rep_visit_sale_plan.gvm_type%TYPE,              -- 一般／自販機／ＭＣ
    l_one_day_tab             g_one_day_ttype3,                                     -- 日別データ格納（テーブル型）
    cust_new_num              xxcso_sum_visit_sale_rep.cust_new_num%TYPE,           -- 顧客件数（新規）
    cust_vd_new_num           xxcso_sum_visit_sale_rep.cust_vd_new_num%TYPE,        -- 顧客件数（VD：新規）
    cust_other_new_num        xxcso_sum_visit_sale_rep.cust_other_new_num%TYPE,     -- 顧客件数（VD以外：新規）
    rslt_amty                 xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 前年実績
    rslt_vd_amty              xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 前年実績（VD）
    rslt_other_amty           xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 前年実績（VD以外）
    rslt_amtm                 xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 先月実績
    rslt_vd_amtm              xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 先月実績（VD）
    rslt_other_amtm           xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 先月実績（VD以外）
    tgt_sales_prsn_total_amt  xxcso_sum_visit_sale_rep.tgt_sales_prsn_total_amt%TYPE   -- 月別売上予算
  );
  -- 地区営業部別（帳票４）
  TYPE g_one_day_rtype4 IS RECORD(
    rslt_amt                  xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 売上実績
    rslt_new_amt              xxcso_sum_visit_sale_rep.rslt_new_amt%TYPE,           -- 売上実績（新規）
    rslt_vd_new_amt           xxcso_sum_visit_sale_rep.rslt_vd_new_amt%TYPE,        -- 売上実績（VD：新規）
    rslt_vd_amt               xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 売上実績（VD）
    rslt_other_new_amt        xxcso_sum_visit_sale_rep.rslt_other_new_amt%TYPE,     -- 売上実績（VD以外：新規）
    rslt_other_amt            xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 売上実績（VD以外）
    rslt_center_amt           xxcso_sum_visit_sale_rep.rslt_center_amt%TYPE,        -- 内他拠点＿売上実績
    rslt_center_vd_amt        xxcso_sum_visit_sale_rep.rslt_center_vd_amt%TYPE,     -- 内他拠点＿売上実績（VD）
    rslt_center_other_amt     xxcso_sum_visit_sale_rep.rslt_center_other_amt%TYPE,  -- 内他拠点＿売上実績（VD以外）
    vis_num                   xxcso_sum_visit_sale_rep.vis_num%TYPE,                -- 訪問実績
    vis_new_num               xxcso_sum_visit_sale_rep.vis_new_num%TYPE,            -- 訪問実績（新規）
    vis_vd_new_num            xxcso_sum_visit_sale_rep.vis_vd_new_num%TYPE,         -- 訪問実績（VD：新規）
    vis_vd_num                xxcso_sum_visit_sale_rep.vis_vd_num%TYPE,             -- 訪問実績（VD）
    vis_other_new_num         xxcso_sum_visit_sale_rep.vis_other_new_num%TYPE,      -- 訪問実績（VD以外：新規）
    vis_other_num             xxcso_sum_visit_sale_rep.vis_other_num%TYPE,          -- 訪問実績（VD以外）
    vis_mc_num                xxcso_sum_visit_sale_rep.vis_mc_num%TYPE,             -- 訪問実績(MC)
    vis_sales_num             xxcso_sum_visit_sale_rep.vis_sales_num%TYPE,          -- 有効軒数
    vis_a_num                 NUMBER(9),                                            -- 訪問Ａ件数
    vis_b_num                 NUMBER(9),                                            -- 訪問Ｂ件数
    vis_c_num                 NUMBER(9),                                            -- 訪問Ｃ件数
    vis_d_num                 NUMBER(9),                                            -- 訪問Ｄ件数
    vis_e_num                 NUMBER(9),                                            -- 訪問Ｅ件数
    vis_f_num                 NUMBER(9),                                            -- 訪問Ｆ件数
    vis_g_num                 NUMBER(9),                                            -- 訪問Ｇ件数
    vis_h_num                 NUMBER(9),                                            -- 訪問Ｈ件数
    vis_i_num                 NUMBER(9),                                            -- 訪問ⅰ件数
    vis_j_num                 NUMBER(9),                                            -- 訪問Ｊ件数
    vis_k_num                 NUMBER(9),                                            -- 訪問Ｋ件数
    vis_l_num                 NUMBER(9),                                            -- 訪問Ｌ件数
    vis_m_num                 NUMBER(9),                                            -- 訪問Ｍ件数
    vis_n_num                 NUMBER(9),                                            -- 訪問Ｎ件数
    vis_o_num                 NUMBER(9),                                            -- 訪問Ｏ件数
    vis_p_num                 NUMBER(9),                                            -- 訪問Ｐ件数
    vis_q_num                 NUMBER(9),                                            -- 訪問Ｑ件数
    vis_r_num                 NUMBER(9),                                            -- 訪問Ｒ件数
    vis_s_num                 NUMBER(9),                                            -- 訪問Ｓ件数
    vis_t_num                 NUMBER(9),                                            -- 訪問Ｔ件数
    vis_u_num                 NUMBER(9),                                            -- 訪問Ｕ件数
    vis_v_num                 NUMBER(9),                                            -- 訪問Ｖ件数
    vis_w_num                 NUMBER(9),                                            -- 訪問Ｗ件数
    vis_x_num                 NUMBER(9),                                            -- 訪問Ｘ件数
    vis_y_num                 NUMBER(9),                                            -- 訪問Ｙ件数
    vis_z_num                 NUMBER(9)                                             -- 訪問Ｚ件数
  );
  TYPE g_one_day_ttype4 IS TABLE OF g_one_day_rtype4 INDEX BY PLS_INTEGER;
  TYPE g_month_rtype4 IS RECORD(
    base_code_par             xxcso_aff_base_level_v.base_code%TYPE,                -- 勤務地拠点コード(親)(拠点コード)
    base_name_par             xxcso_aff_base_v2.base_name%TYPE,                     -- 勤務地拠点名(親)(拠点名)
    base_code_chi             xxcso_aff_base_level_v.child_base_code%TYPE,          -- 勤務地拠点コード
    base_name_chi             xxcso_aff_base_v2.base_name%TYPE,                     -- 勤務地拠点名
    gvm_type                  xxcso_rep_visit_sale_plan.gvm_type%TYPE,              -- 一般／自販機／ＭＣ
    l_one_day_tab             g_one_day_ttype4,                                     -- 日別データ格納（テーブル型）
    cust_new_num              xxcso_sum_visit_sale_rep.cust_new_num%TYPE,           -- 顧客件数（新規）
    cust_vd_new_num           xxcso_sum_visit_sale_rep.cust_vd_new_num%TYPE,        -- 顧客件数（VD：新規）
    cust_other_new_num        xxcso_sum_visit_sale_rep.cust_other_new_num%TYPE,     -- 顧客件数（VD以外：新規）
    rslt_amty                 xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 前年実績
    rslt_vd_amty              xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 前年実績（VD）
    rslt_other_amty           xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 前年実績（VD以外）
    rslt_amtm                 xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 先月実績
    rslt_vd_amtm              xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 先月実績（VD）
    rslt_other_amtm           xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 先月実績（VD以外）
    tgt_sales_prsn_total_amt  xxcso_sum_visit_sale_rep.tgt_sales_prsn_total_amt%TYPE   -- 月別売上予算
  );
  -- 地域営業本部（帳票５）
  TYPE g_one_day_rtype5 IS RECORD(
    rslt_amt                  xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 売上実績
    rslt_new_amt              xxcso_sum_visit_sale_rep.rslt_new_amt%TYPE,           -- 売上実績（新規）
    rslt_vd_new_amt           xxcso_sum_visit_sale_rep.rslt_vd_new_amt%TYPE,        -- 売上実績（VD：新規）
    rslt_vd_amt               xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 売上実績（VD）
    rslt_other_new_amt        xxcso_sum_visit_sale_rep.rslt_other_new_amt%TYPE,     -- 売上実績（VD以外：新規）
    rslt_other_amt            xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 売上実績（VD以外）
    rslt_center_amt           xxcso_sum_visit_sale_rep.rslt_center_amt%TYPE,        -- 内他拠点＿売上実績
    rslt_center_vd_amt        xxcso_sum_visit_sale_rep.rslt_center_vd_amt%TYPE,     -- 内他拠点＿売上実績（VD）
    rslt_center_other_amt     xxcso_sum_visit_sale_rep.rslt_center_other_amt%TYPE,  -- 内他拠点＿売上実績（VD以外）
    vis_num                   xxcso_sum_visit_sale_rep.vis_num%TYPE,                -- 訪問実績
    vis_new_num               xxcso_sum_visit_sale_rep.vis_new_num%TYPE,            -- 訪問実績（新規）
    vis_vd_new_num            xxcso_sum_visit_sale_rep.vis_vd_new_num%TYPE,         -- 訪問実績（VD：新規）
    vis_vd_num                xxcso_sum_visit_sale_rep.vis_vd_num%TYPE,             -- 訪問実績（VD）
    vis_other_new_num         xxcso_sum_visit_sale_rep.vis_other_new_num%TYPE,      -- 訪問実績（VD以外：新規）
    vis_other_num             xxcso_sum_visit_sale_rep.vis_other_num%TYPE,          -- 訪問実績（VD以外）
    vis_mc_num                xxcso_sum_visit_sale_rep.vis_mc_num%TYPE,             -- 訪問実績(MC)
    vis_sales_num             xxcso_sum_visit_sale_rep.vis_sales_num%TYPE,          -- 有効軒数
    vis_a_num                 NUMBER(9),                                            -- 訪問Ａ件数
    vis_b_num                 NUMBER(9),                                            -- 訪問Ｂ件数
    vis_c_num                 NUMBER(9),                                            -- 訪問Ｃ件数
    vis_d_num                 NUMBER(9),                                            -- 訪問Ｄ件数
    vis_e_num                 NUMBER(9),                                            -- 訪問Ｅ件数
    vis_f_num                 NUMBER(9),                                            -- 訪問Ｆ件数
    vis_g_num                 NUMBER(9),                                            -- 訪問Ｇ件数
    vis_h_num                 NUMBER(9),                                            -- 訪問Ｈ件数
    vis_i_num                 NUMBER(9),                                            -- 訪問ⅰ件数
    vis_j_num                 NUMBER(9),                                            -- 訪問Ｊ件数
    vis_k_num                 NUMBER(9),                                            -- 訪問Ｋ件数
    vis_l_num                 NUMBER(9),                                            -- 訪問Ｌ件数
    vis_m_num                 NUMBER(9),                                            -- 訪問Ｍ件数
    vis_n_num                 NUMBER(9),                                            -- 訪問Ｎ件数
    vis_o_num                 NUMBER(9),                                            -- 訪問Ｏ件数
    vis_p_num                 NUMBER(9),                                            -- 訪問Ｐ件数
    vis_q_num                 NUMBER(9),                                            -- 訪問Ｑ件数
    vis_r_num                 NUMBER(9),                                            -- 訪問Ｒ件数
    vis_s_num                 NUMBER(9),                                            -- 訪問Ｓ件数
    vis_t_num                 NUMBER(9),                                            -- 訪問Ｔ件数
    vis_u_num                 NUMBER(9),                                            -- 訪問Ｕ件数
    vis_v_num                 NUMBER(9),                                            -- 訪問Ｖ件数
    vis_w_num                 NUMBER(9),                                            -- 訪問Ｗ件数
    vis_x_num                 NUMBER(9),                                            -- 訪問Ｘ件数
    vis_y_num                 NUMBER(9),                                            -- 訪問Ｙ件数
    vis_z_num                 NUMBER(9)                                             -- 訪問Ｚ件数
  );
  TYPE g_one_day_ttype5 IS TABLE OF g_one_day_rtype5 INDEX BY PLS_INTEGER;
  TYPE g_month_rtype5 IS RECORD(
    base_code_par             xxcso_aff_base_level_v.base_code%TYPE,                -- 勤務地拠点コード(親)(拠点コード)
    base_name_par             xxcso_aff_base_v2.base_name%TYPE,                     -- 勤務地拠点名(親)(拠点名)
    base_code_chi             xxcso_aff_base_level_v.child_base_code%TYPE,          -- 勤務地拠点コード
    base_name_chi             xxcso_aff_base_v2.base_name%TYPE,                     -- 勤務地拠点名
    gvm_type                  xxcso_rep_visit_sale_plan.gvm_type%TYPE,              -- 一般／自販機／ＭＣ
    l_one_day_tab             g_one_day_ttype5,                                     -- 日別データ格納（テーブル型）
    cust_new_num              xxcso_sum_visit_sale_rep.cust_new_num%TYPE,           -- 顧客件数（新規）
    cust_vd_new_num           xxcso_sum_visit_sale_rep.cust_vd_new_num%TYPE,        -- 顧客件数（VD：新規）
    cust_other_new_num        xxcso_sum_visit_sale_rep.cust_other_new_num%TYPE,     -- 顧客件数（VD以外：新規）
    rslt_amty                 xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 前年実績
    rslt_vd_amty              xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 前年実績（VD）
    rslt_other_amty           xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 前年実績（VD以外）
    rslt_amtm                 xxcso_sum_visit_sale_rep.rslt_amt%TYPE,               -- 先月実績
    rslt_vd_amtm              xxcso_sum_visit_sale_rep.rslt_vd_amt%TYPE,            -- 先月実績（VD）
    rslt_other_amtm           xxcso_sum_visit_sale_rep.rslt_other_amt%TYPE,         -- 先月実績（VD以外）
    tgt_sales_prsn_total_amt  xxcso_sum_visit_sale_rep.tgt_sales_prsn_total_amt%TYPE   -- 月別売上予算
  );
--
/* 20090519_Ogawa_T1_1033 START*/
  /**********************************************************************************
   * Procedure Name   : get_group_name
   * Description      : グループ名称取得
  ***********************************************************************************/
  FUNCTION get_group_name(
    iv_base_code         IN  VARCHAR2     -- 拠点コード
   ,iv_group_number      IN  VARCHAR2     -- グループ番号
   ,id_standard_date     IN  DATE         -- 基準日
  ) RETURN VARCHAR2
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    lv_last_name           VARCHAR2(40);
--
  BEGIN
    SELECT  SUBSTRB(inn_v.last_name || 'グループ', 1, 40)
    INTO    lv_last_name
/* 20090702_Ogawa_0000312 START*/
    FROM    (SELECT  inn_v2.employee_number
                    ,inn_v2.last_name
                    ,inn_v2.group_grade
             FROM    (SELECT  xrrv.employee_number            employee_number
                             ,xrrv.last_name                  last_name
                             ,xrrv.group_grade_new            group_grade
                      FROM    xxcso_resource_relations_v2  xrrv
                      WHERE   TO_DATE(xrrv.issue_date,'YYYYMMDD') <= id_standard_date
                        AND   xrrv.work_base_code_new              = iv_base_code
                        AND   NVL(xrrv.group_number_new, ' ')      = NVL(iv_group_number, ' ')
                        AND   xrrv.group_leader_flag_new           = 'Y'
                      UNION ALL
                      SELECT  xrrv.employee_number            employee_number
                             ,xrrv.last_name                  last_name
                             ,xrrv.group_grade_old            group_grade
                      FROM    xxcso_resource_relations_v2  xrrv
                      WHERE   TO_DATE(xrrv.issue_date,'YYYYMMDD')  > id_standard_date
                        AND   xrrv.work_base_code_old              = iv_base_code
                        AND   NVL(xrrv.group_number_old, ' ')      = NVL(iv_group_number, ' ')
                        AND   xrrv.group_leader_flag_old           = 'Y'
                     ) inn_v2
--  FROM    (SELECT  xrrv.employee_number         employee_number
--                  ,xrrv.last_name               last_name
--                  ,(CASE
--                      WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= id_standard_date) THEN
--                        NVL(xrrv.group_grade_new, ' ')
--                      ELSE
--                        NVL(xrrv.group_grade_old, ' ')
--                    END
--                   )                            group_grade
--           FROM    xxcso_resource_relations_v2  xrrv
--           /* 20090602_abe_PT START*/
--           WHERE   (
--                     (      TO_DATE(xrrv.issue_date,'YYYYMMDD') <= id_standard_date
--                       AND  xrrv.work_base_code_new = iv_base_code
--                     )
--                     OR
--                     (      TO_DATE(xrrv.issue_date,'YYYYMMDD') > id_standard_date
--                       AND  xrrv.work_base_code_old = iv_base_code
--                     )
--                   )
--           --WHERE   (CASE
--           --           WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= id_standard_date) THEN
--           --             xrrv.work_base_code_new
--           --           ELSE
--           --             xrrv.work_base_code_old
--           --         END
--           --        ) = iv_base_code
--           /* 20090602_abe_PT END*/
--             AND   (CASE
--                      WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= id_standard_date) THEN
--                        NVL(xrrv.group_number_new, ' ')
--                      ELSE
--                        NVL(xrrv.group_number_old, ' ')
--                    END
--                   ) = NVL(iv_group_number, ' ')
--             AND   (CASE
--                      WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= id_standard_date) THEN
--                        xrrv.group_leader_flag_new
--                      ELSE
--                        xrrv.group_leader_flag_old
--                    END
--                   ) = 'Y'
/* 20090702_Ogawa_0000312 END*/
             ORDER BY  TO_NUMBER(group_grade)  ASC
                      ,employee_number         ASC
            ) inn_v
    WHERE   ROWNUM = 1
    ;
--
    RETURN lv_last_name;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN NULL;
  END get_group_name;
--
  /**********************************************************************************
   * Procedure Name   : get_route_bit
   * Description      : 訪問予定回数取得
  ***********************************************************************************/
  FUNCTION get_route_bit(
    iv_route_no          IN  VARCHAR2     -- ルートNo
   ,iv_year_month        IN  VARCHAR2     -- 年月
   ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_bit_num             NUMBER;
    ld_date                DATE;
    ln_day_index           NUMBER;
--
  BEGIN
--
    IF (iv_route_no IS NULL) THEN
      RETURN 1;
    END IF;
--
    IF (INSTR(iv_route_no,'-') > 0) THEN
      RETURN 1;
    END IF;
--
    ld_date := TO_DATE((iv_year_month || LPAD(in_day_index, 2, '0')), 'YYYYMMDD');
    ln_day_index := TO_CHAR(ld_date,'D') - 1;
    IF (ln_day_index = 0) THEN
      ln_day_index := 7;
    END IF;
--
    ln_bit_num := NVL(TO_NUMBER(SUBSTRB(iv_route_no, ln_day_index, 1)), 0);
    IF (ln_bit_num = 0) THEN
      ln_bit_num := 1;
    END IF;
--
    RETURN ln_bit_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_route_bit;
--
  /**********************************************************************************
   * Procedure Name   : get_gvm_type
   * Description      : 一般／自販機／ＭＣ取得
  ***********************************************************************************/
  FUNCTION get_gvm_type(
    iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
   ,iv_business_low_type IN  VARCHAR2     -- 業態コード（小分類）
  ) RETURN VARCHAR2
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    lv_gvm_type           VARCHAR2(1);
--
  BEGIN
    IF (iv_customer_status IN (cv_cust_status4, cv_cust_status5, cv_cust_status6)) THEN
      lv_gvm_type := cv_gvm_m;
    ELSE
      IF (xxcso_route_common_pkg.iscustomervendor(iv_business_low_type) = cv_true) THEN
        lv_gvm_type := cv_gvm_v;
      ELSE
        lv_gvm_type := cv_gvm_g;
      END IF;
    END IF;
--
    RETURN lv_gvm_type;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN NULL;
  END get_gvm_type;
--
  /**********************************************************************************
   * Procedure Name   : get_tgt_amt
   * Description      : 売上計画取得
  ***********************************************************************************/
   FUNCTION get_tgt_amt(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_tgt_amt               xxcso_sum_visit_sale_rep.tgt_amt%TYPE;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  NVL(xsvsr.tgt_amt,0)
    INTO    ln_tgt_amt
    FROM    xxcso_sum_visit_sale_rep   xsvsr
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
    ;
--
    RETURN ln_tgt_amt;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_tgt_amt;
--
  /**********************************************************************************
   * Procedure Name   : get_rslt_amt
   * Description      : 売上実績取得
  ***********************************************************************************/
   FUNCTION get_rslt_amt(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_amt              xxcso_sum_visit_sale_rep.rslt_amt%TYPE;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  NVL(xsvsr.rslt_amt,0)
    INTO    ln_rslt_amt
    FROM    xxcso_sum_visit_sale_rep   xsvsr
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
    ;
--
    RETURN ln_rslt_amt;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_rslt_amt;
--
  /**********************************************************************************
   * Procedure Name   : get_rslt_other_sales_amt
   * Description      : 他拠点納品分売上実績取得
  ***********************************************************************************/
   FUNCTION get_rslt_other_sales_amt(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_center_amt       xxcso_sum_visit_sale_rep.rslt_center_amt%TYPE;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  NVL(xsvsr.rslt_center_amt,0)
    INTO    ln_rslt_center_amt
    FROM    xxcso_sum_visit_sale_rep   xsvsr
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
    ;
--
    RETURN ln_rslt_center_amt;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_rslt_other_sales_amt;
--
  /**********************************************************************************
   * Procedure Name   : get_visit_sign
   * Description      : 訪問実績記号取得
  ***********************************************************************************/
   FUNCTION get_visit_sign(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
    ,id_cnvs_date         IN  DATE         -- 顧客獲得日
    ,iv_vist_target_div   IN  VARCHAR2     -- 訪問対象区分
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN VARCHAR2
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    lv_visit_sign            VARCHAR2(20);
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  SUBSTRB(
              (CASE
                 WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--                AND (xcav.customer_status IN (
                  AND (iv_customer_status IN (
/* 20090702_Ogawa_0000312 END*/
                                                 cv_cust_status4
                                                ,cv_cust_status5
                                                ,cv_cust_status6
                                               )
                      )
                 THEN
                   '*' || (CASE WHEN (xsvsr.vis_a_num > 0) THEN 'A' END)
                       || (CASE WHEN (xsvsr.vis_b_num > 0) THEN 'B' END)
                       || (CASE WHEN (xsvsr.vis_c_num > 0) THEN 'C' END)
                       || (CASE WHEN (xsvsr.vis_d_num > 0) THEN 'D' END)
                       || (CASE WHEN (xsvsr.vis_e_num > 0) THEN 'E' END)
                       || (CASE WHEN (xsvsr.vis_f_num > 0) THEN 'F' END)
                       || (CASE WHEN (xsvsr.vis_g_num > 0) THEN 'G' END)
                       || (CASE WHEN (xsvsr.vis_h_num > 0) THEN 'H' END)
                       || (CASE WHEN (xsvsr.vis_i_num > 0) THEN 'I' END)
                       || (CASE WHEN (xsvsr.vis_j_num > 0) THEN 'J' END)
                       || (CASE WHEN (xsvsr.vis_k_num > 0) THEN 'K' END)
                       || (CASE WHEN (xsvsr.vis_l_num > 0) THEN 'L' END)
                       || (CASE WHEN (xsvsr.vis_m_num > 0) THEN 'M' END)
                       || (CASE WHEN (xsvsr.vis_n_num > 0) THEN 'N' END)
                       || (CASE WHEN (xsvsr.vis_o_num > 0) THEN 'O' END)
                       || (CASE WHEN (xsvsr.vis_p_num > 0) THEN 'P' END)
                       || (CASE WHEN (xsvsr.vis_q_num > 0) THEN 'Q' END)
                       || (CASE WHEN (xsvsr.vis_r_num > 0) THEN 'R' END)
                       || (CASE WHEN (xsvsr.vis_s_num > 0) THEN 'S' END)
                       || (CASE WHEN (xsvsr.vis_t_num > 0) THEN 'T' END)
                       || (CASE WHEN (xsvsr.vis_u_num > 0) THEN 'U' END)
                       || (CASE WHEN (xsvsr.vis_v_num > 0) THEN 'V' END)
                       || (CASE WHEN (xsvsr.vis_w_num > 0) THEN 'W' END)
                       || (CASE WHEN (xsvsr.vis_x_num > 0) THEN 'X' END)
                       || (CASE WHEN (xsvsr.vis_y_num > 0) THEN 'Y' END)
                       || (CASE WHEN (xsvsr.vis_z_num > 0) THEN 'Z' END)
                 WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--                AND (xcav.cnvs_date > TO_DATE(lv_date,'YYYYMMDD'))
                  AND (id_cnvs_date > TO_DATE(lv_date,'YYYYMMDD'))
/* 20090702_Ogawa_0000312 END*/
                 THEN
                   '*' || (CASE WHEN (xsvsr.vis_a_num > 0) THEN 'A' END)
                       || (CASE WHEN (xsvsr.vis_b_num > 0) THEN 'B' END)
                       || (CASE WHEN (xsvsr.vis_c_num > 0) THEN 'C' END)
                       || (CASE WHEN (xsvsr.vis_d_num > 0) THEN 'D' END)
                       || (CASE WHEN (xsvsr.vis_e_num > 0) THEN 'E' END)
                       || (CASE WHEN (xsvsr.vis_f_num > 0) THEN 'F' END)
                       || (CASE WHEN (xsvsr.vis_g_num > 0) THEN 'G' END)
                       || (CASE WHEN (xsvsr.vis_h_num > 0) THEN 'H' END)
                       || (CASE WHEN (xsvsr.vis_i_num > 0) THEN 'I' END)
                       || (CASE WHEN (xsvsr.vis_j_num > 0) THEN 'J' END)
                       || (CASE WHEN (xsvsr.vis_k_num > 0) THEN 'K' END)
                       || (CASE WHEN (xsvsr.vis_l_num > 0) THEN 'L' END)
                       || (CASE WHEN (xsvsr.vis_m_num > 0) THEN 'M' END)
                       || (CASE WHEN (xsvsr.vis_n_num > 0) THEN 'N' END)
                       || (CASE WHEN (xsvsr.vis_o_num > 0) THEN 'O' END)
                       || (CASE WHEN (xsvsr.vis_p_num > 0) THEN 'P' END)
                       || (CASE WHEN (xsvsr.vis_q_num > 0) THEN 'Q' END)
                       || (CASE WHEN (xsvsr.vis_r_num > 0) THEN 'R' END)
                       || (CASE WHEN (xsvsr.vis_s_num > 0) THEN 'S' END)
                       || (CASE WHEN (xsvsr.vis_t_num > 0) THEN 'T' END)
                       || (CASE WHEN (xsvsr.vis_u_num > 0) THEN 'U' END)
                       || (CASE WHEN (xsvsr.vis_v_num > 0) THEN 'V' END)
                       || (CASE WHEN (xsvsr.vis_w_num > 0) THEN 'W' END)
                       || (CASE WHEN (xsvsr.vis_x_num > 0) THEN 'X' END)
                       || (CASE WHEN (xsvsr.vis_y_num > 0) THEN 'Y' END)
                       || (CASE WHEN (xsvsr.vis_z_num > 0) THEN 'Z' END)
                 WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--                AND (xcav.vist_target_div = '1')
                  AND (iv_vist_target_div = '1')
/* 20090702_Ogawa_0000312 END*/
                 THEN
                   '*' || (CASE WHEN (xsvsr.vis_a_num > 0) THEN 'A' END)
                       || (CASE WHEN (xsvsr.vis_b_num > 0) THEN 'B' END)
                       || (CASE WHEN (xsvsr.vis_c_num > 0) THEN 'C' END)
                       || (CASE WHEN (xsvsr.vis_d_num > 0) THEN 'D' END)
                       || (CASE WHEN (xsvsr.vis_e_num > 0) THEN 'E' END)
                       || (CASE WHEN (xsvsr.vis_f_num > 0) THEN 'F' END)
                       || (CASE WHEN (xsvsr.vis_g_num > 0) THEN 'G' END)
                       || (CASE WHEN (xsvsr.vis_h_num > 0) THEN 'H' END)
                       || (CASE WHEN (xsvsr.vis_i_num > 0) THEN 'I' END)
                       || (CASE WHEN (xsvsr.vis_j_num > 0) THEN 'J' END)
                       || (CASE WHEN (xsvsr.vis_k_num > 0) THEN 'K' END)
                       || (CASE WHEN (xsvsr.vis_l_num > 0) THEN 'L' END)
                       || (CASE WHEN (xsvsr.vis_m_num > 0) THEN 'M' END)
                       || (CASE WHEN (xsvsr.vis_n_num > 0) THEN 'N' END)
                       || (CASE WHEN (xsvsr.vis_o_num > 0) THEN 'O' END)
                       || (CASE WHEN (xsvsr.vis_p_num > 0) THEN 'P' END)
                       || (CASE WHEN (xsvsr.vis_q_num > 0) THEN 'Q' END)
                       || (CASE WHEN (xsvsr.vis_r_num > 0) THEN 'R' END)
                       || (CASE WHEN (xsvsr.vis_s_num > 0) THEN 'S' END)
                       || (CASE WHEN (xsvsr.vis_t_num > 0) THEN 'T' END)
                       || (CASE WHEN (xsvsr.vis_u_num > 0) THEN 'U' END)
                       || (CASE WHEN (xsvsr.vis_v_num > 0) THEN 'V' END)
                       || (CASE WHEN (xsvsr.vis_w_num > 0) THEN 'W' END)
                       || (CASE WHEN (xsvsr.vis_x_num > 0) THEN 'X' END)
                       || (CASE WHEN (xsvsr.vis_y_num > 0) THEN 'Y' END)
                       || (CASE WHEN (xsvsr.vis_z_num > 0) THEN 'Z' END)
                 WHEN (xsvsr.rslt_amt = 0)
                 THEN
                   '*'
                 ELSE
                   NULL
               END
              )
             ,1
             ,20
            )
    INTO    lv_visit_sign
/* 20090702_Ogawa_0000312 START*/
    FROM    xxcso_sum_visit_sale_rep   xsvsr
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
--  FROM    xxcso_cust_accounts_v      xcav
--         ,xxcso_sum_visit_sale_rep   xsvsr
--  WHERE   xcav.account_number   = iv_account_number
--    AND   xcav.sale_base_code   = iv_base_code
--    AND   xsvsr.sum_org_type    = cv_sum_org_type1
--    AND   xsvsr.sum_org_code    = xcav.account_number
--    AND   xsvsr.group_base_code = xcav.sale_base_code
--    AND   xsvsr.month_date_div  = cv_month_date_div2
--    AND   xsvsr.sales_date      = lv_date
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN lv_visit_sign;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN NULL;
  END get_visit_sign;
--
  /**********************************************************************************
   * Procedure Name   : get_i_tgt_vis_num
   * Description      : 訪問計画取得(一般用)
  ***********************************************************************************/
   FUNCTION get_i_tgt_vis_num(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
    ,id_cnvs_date         IN  DATE         -- 顧客獲得日
    ,iv_vist_target_div   IN  VARCHAR2     -- 訪問対象区分
    ,iv_business_low_type IN  VARCHAR2     -- 業態小分類
    ,iv_route_number      IN  VARCHAR2     -- ルートNo
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_tgt_vis_num           NUMBER;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  (CASE
               WHEN (xsvsr.tgt_amt > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
/* 20090702_Ogawa_0000312 END*/
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) <> cv_true
                    )
               THEN
                 XXCSO019A05C.get_route_bit(
/* 20090702_Ogawa_0000312 START*/
--                 xcrv.route_number
                   iv_route_number
/* 20090702_Ogawa_0000312 END*/
                  ,iv_year_month
                  ,in_day_index
                 )
               WHEN (xsvsr.tgt_amt > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date IS NULL)
--              AND (xcav.customer_status IN (
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date IS NULL)
                AND (iv_customer_status IN (
/* 20090702_Ogawa_0000312 END*/
                                               cv_cust_status8
                                              ,cv_cust_status9
                                              ,cv_cust_status3
                                             )
                    )
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) <> cv_true
                    )
               THEN
                 XXCSO019A05C.get_route_bit(
/* 20090702_Ogawa_0000312 START*/
--                 xcrv.route_number
                   iv_route_number
/* 20090702_Ogawa_0000312 END*/
                  ,iv_year_month
                  ,in_day_index
                 )
               ELSE
                 0
             END
            )
    INTO    ln_tgt_vis_num
    FROM    xxcso_sum_visit_sale_rep   xsvsr
/* 20090702_Ogawa_0000312 START*/
    WHERE   xsvsr.sum_org_type     = cv_sum_org_type1
      AND   xsvsr.sum_org_code     = iv_account_number
      AND   xsvsr.group_base_code  = iv_base_code
      AND   xsvsr.month_date_div   = cv_month_date_div2
      AND   xsvsr.sales_date       = lv_date
--         ,xxcso_cust_accounts_v      xcav
--         ,xxcso_cust_routes_v2       xcrv
--  WHERE   xcav.account_number    = iv_account_number
--    AND   xcav.sale_base_code    = iv_base_code
--    AND   xsvsr.sum_org_type     = cv_sum_org_type1
--    AND   xsvsr.sum_org_code     = xcav.account_number
--    AND   xsvsr.group_base_code  = xcav.sale_base_code
--    AND   xsvsr.month_date_div   = cv_month_date_div2
--    AND   xsvsr.sales_date       = lv_date
--    AND   xcrv.account_number(+) = xcav.account_number
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN ln_tgt_vis_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_i_tgt_vis_num;
--
  /**********************************************************************************
   * Procedure Name   : get_v_tgt_vis_num
   * Description      : 訪問計画取得(一般用)
  ***********************************************************************************/
   FUNCTION get_v_tgt_vis_num(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
    ,id_cnvs_date         IN  DATE         -- 顧客獲得日
    ,iv_vist_target_div   IN  VARCHAR2     -- 訪問対象区分
    ,iv_business_low_type IN  VARCHAR2     -- 業態小分類
    ,iv_route_number      IN  VARCHAR2     -- ルートNo
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_tgt_vis_num           NUMBER;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  (CASE
               WHEN (xsvsr.tgt_amt > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
/* 20090702_Ogawa_0000312 END*/
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) = cv_true
                    )
               THEN
                 XXCSO019A05C.get_route_bit(
/* 20090702_Ogawa_0000312 START*/
--                 xcrv.route_number
                   iv_route_number
/* 20090702_Ogawa_0000312 END*/
                  ,iv_year_month
                  ,in_day_index
                 )
               WHEN (xsvsr.tgt_amt > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date IS NULL)
--              AND (xcav.customer_status IN (
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date IS NULL)
                AND (iv_customer_status IN (
/* 20090702_Ogawa_0000312 END*/
                                               cv_cust_status8
                                              ,cv_cust_status9
                                              ,cv_cust_status3
                                             )
                    )
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) = cv_true
                    )
               THEN
                 XXCSO019A05C.get_route_bit(
/* 20090702_Ogawa_0000312 START*/
--                 xcrv.route_number
                   iv_route_number
/* 20090702_Ogawa_0000312 END*/
                  ,iv_year_month
                  ,in_day_index
                 )
               ELSE
                 0
             END
            )
    INTO    ln_tgt_vis_num
    FROM    xxcso_sum_visit_sale_rep   xsvsr
/* 20090702_Ogawa_0000312 START*/
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
--         ,xxcso_cust_accounts_v      xcav
--         ,xxcso_cust_routes_v2       xcrv
--  WHERE   xcav.account_number   = iv_account_number
--    AND   xcav.sale_base_code   = iv_base_code
--    AND   xsvsr.sum_org_type    = cv_sum_org_type1
--    AND   xsvsr.sum_org_code    = xcav.account_number
--    AND   xsvsr.group_base_code = xcav.sale_base_code
--    AND   xsvsr.month_date_div  = cv_month_date_div2
--    AND   xsvsr.sales_date      = lv_date
--    AND   xcrv.account_number(+) = xcav.account_number
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN ln_tgt_vis_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_v_tgt_vis_num;
--
  /**********************************************************************************
   * Procedure Name   : get_i_rslt_vis_num
   * Description      : 訪問実績取得(一般用)
  ***********************************************************************************/
   FUNCTION get_i_rslt_vis_num(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
    ,id_cnvs_date         IN  DATE         -- 顧客獲得日
    ,iv_vist_target_div   IN  VARCHAR2     -- 訪問対象区分
    ,iv_business_low_type IN  VARCHAR2     -- 業態小分類
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_vis_num          NUMBER;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  (CASE
               WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
/* 20090702_Ogawa_0000312 END*/
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) <> cv_true
                    )
               THEN
                 xsvsr.vis_num
               WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date IS NULL)
--              AND (xcav.customer_status IN (
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date IS NULL)
                AND (iv_customer_status IN (
/* 20090702_Ogawa_0000312 END*/
                                               cv_cust_status8
                                              ,cv_cust_status9
                                              ,cv_cust_status3
                                             )
                    )
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) <> cv_true
                    )
               THEN
                 xsvsr.vis_num
               ELSE
                 0
             END
            )
    INTO    ln_rslt_vis_num
    FROM    xxcso_sum_visit_sale_rep   xsvsr
/* 20090702_Ogawa_0000312 START*/
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
--         ,xxcso_cust_accounts_v      xcav
--  WHERE   xcav.account_number   = iv_account_number
--    AND   xcav.sale_base_code   = iv_base_code
--    AND   xsvsr.sum_org_type    = cv_sum_org_type1
--    AND   xsvsr.sum_org_code    = xcav.account_number
--    AND   xsvsr.group_base_code = xcav.sale_base_code
--    AND   xsvsr.month_date_div  = cv_month_date_div2
--    AND   xsvsr.sales_date      = lv_date
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN ln_rslt_vis_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_i_rslt_vis_num;
--
  /**********************************************************************************
   * Procedure Name   : get_v_rslt_vis_num
   * Description      : 訪問実績取得(自販機用)
  ***********************************************************************************/
   FUNCTION get_v_rslt_vis_num(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
    ,id_cnvs_date         IN  DATE         -- 顧客獲得日
    ,iv_vist_target_div   IN  VARCHAR2     -- 訪問対象区分
    ,iv_business_low_type IN  VARCHAR2     -- 業態小分類
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_vis_num          NUMBER;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  (CASE
               WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
/* 20090702_Ogawa_0000312 END*/
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) = cv_true
                    )
               THEN
                 xsvsr.vis_num
               WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
--              AND (xcav.cnvs_date IS NULL)
--              AND (xcav.customer_status IN (
                AND (iv_vist_target_div = '1')
                AND (id_cnvs_date IS NULL)
                AND (iv_customer_status IN (
/* 20090702_Ogawa_0000312 END*/
                                               cv_cust_status8
                                              ,cv_cust_status9
                                              ,cv_cust_status3
                                             )
                    )
                AND (xxcso_route_common_pkg.iscustomervendor(
/* 20090702_Ogawa_0000312 START*/
--                     xcav.business_low_type
                       iv_business_low_type
/* 20090702_Ogawa_0000312 END*/
                     ) = cv_true
                    )
               THEN
                 xsvsr.vis_num
               ELSE
                 0
             END
            )
    INTO    ln_rslt_vis_num
    FROM    xxcso_sum_visit_sale_rep   xsvsr
/* 20090702_Ogawa_0000312 START*/
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
--         ,xxcso_cust_accounts_v      xcav
--  WHERE   xcav.account_number   = iv_account_number
--    AND   xcav.sale_base_code   = iv_base_code
--    AND   xsvsr.sum_org_type    = cv_sum_org_type1
--    AND   xsvsr.sum_org_code    = xcav.account_number
--    AND   xsvsr.group_base_code = xcav.sale_base_code
--    AND   xsvsr.month_date_div  = cv_month_date_div2
--    AND   xsvsr.sales_date      = lv_date
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN ln_rslt_vis_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_v_rslt_vis_num;
--
  /**********************************************************************************
   * Procedure Name   : get_m_rslt_vis_num
   * Description      : 訪問実績取得(MC用)
  ***********************************************************************************/
   FUNCTION get_m_rslt_vis_num(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_customer_status   IN  VARCHAR2     -- 顧客ステータス
    ,id_cnvs_date         IN  DATE         -- 顧客獲得日
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_vis_num          NUMBER;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  (CASE
               WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.cnvs_date > TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                AND (id_cnvs_date > TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
/* 20090702_Ogawa_0000312 END*/
               THEN
                 xsvsr.vis_num
               WHEN (xsvsr.vis_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.cnvs_date IS NULL)
--              AND (xcav.customer_status IN (
                AND (id_cnvs_date IS NULL)
                AND (iv_customer_status IN (
/* 20090702_Ogawa_0000312 END*/
                                               cv_cust_status7
                                              ,cv_cust_status4
                                              ,cv_cust_status5
                                              ,cv_cust_status6
                                             )
                    )
               THEN
                 xsvsr.vis_num
               ELSE
                 0
             END
            )
    INTO    ln_rslt_vis_num
    FROM    xxcso_sum_visit_sale_rep   xsvsr
/* 20090702_Ogawa_0000312 START*/
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
--         ,xxcso_cust_accounts_v      xcav
--  WHERE   xcav.account_number   = iv_account_number
--    AND   xcav.sale_base_code   = iv_base_code
--    AND   xsvsr.sum_org_type    = cv_sum_org_type1
--    AND   xsvsr.sum_org_code    = xcav.account_number
--    AND   xsvsr.group_base_code = xcav.sale_base_code
--    AND   xsvsr.month_date_div  = cv_month_date_div2
--    AND   xsvsr.sales_date      = lv_date
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN ln_rslt_vis_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_m_rslt_vis_num;
--
  /**********************************************************************************
   * Procedure Name   : get_e_rslt_vis_num
   * Description      : 訪問実績取得(有効訪問用)
  ***********************************************************************************/
   FUNCTION get_e_rslt_vis_num(
     iv_base_code         IN  VARCHAR2     -- 拠点コード
    ,iv_account_number    IN  VARCHAR2     -- 顧客コード
/* 20090702_Ogawa_0000312 START*/
    ,iv_vist_target_div   IN  VARCHAR2     -- 訪問対象区分
/* 20090702_Ogawa_0000312 END*/
    ,iv_year_month        IN  VARCHAR2     -- 年月
    ,in_day_index         IN  NUMBER       -- 日
  ) RETURN NUMBER
  IS
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_vis_num          NUMBER;
    lv_date                  VARCHAR2(8);
--
  BEGIN
--
    lv_date := iv_year_month || LPAD(in_day_index, 2, '0');
--
    SELECT  (CASE
               WHEN (xsvsr.vis_sales_num > 0)
/* 20090702_Ogawa_0000312 START*/
--              AND (xcav.vist_target_div = '1')
                AND (iv_vist_target_div = '1')
/* 20090702_Ogawa_0000312 END*/
               THEN
                 xsvsr.vis_sales_num
               ELSE
                 0
             END
            )
    INTO    ln_rslt_vis_num
    FROM    xxcso_sum_visit_sale_rep   xsvsr
/* 20090702_Ogawa_0000312 START*/
    WHERE   xsvsr.sum_org_type    = cv_sum_org_type1
      AND   xsvsr.sum_org_code    = iv_account_number
      AND   xsvsr.group_base_code = iv_base_code
      AND   xsvsr.month_date_div  = cv_month_date_div2
      AND   xsvsr.sales_date      = lv_date
--         ,xxcso_cust_accounts_v      xcav
--  WHERE   xcav.account_number   = iv_account_number
--    AND   xcav.sale_base_code   = iv_base_code
--    AND   xsvsr.sum_org_type    = cv_sum_org_type1
--    AND   xsvsr.sum_org_code    = xcav.account_number
--    AND   xsvsr.group_base_code = xcav.sale_base_code
--    AND   xsvsr.month_date_div  = cv_month_date_div2
--    AND   xsvsr.sales_date      = lv_date
/* 20090702_Ogawa_0000312 END*/
    ;
--
    RETURN ln_rslt_vis_num;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_e_rslt_vis_num;
--
/* 20090702_Ogawa_0000312 START*/
  /**********************************************************************************
   * Procedure Name   : get_business_high_type_code
   * Description      : 業態大分類コード取得
  ***********************************************************************************/
  FUNCTION get_business_high_type_code(
    iv_business_low_type IN  VARCHAR2     -- 業態小分類
  ) RETURN VARCHAR2
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'get_business_high_type_code';    -- プログラム名
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    lv_business_low_type_code          fnd_lookup_values_vl.lookup_code%TYPE;
--
  BEGIN
--
    SELECT  dai.lookup_code
    INTO    lv_business_low_type_code
    FROM    fnd_lookup_values_vl  sho
           ,fnd_lookup_values_vl  chu
           ,fnd_lookup_values_vl  dai
    WHERE   sho.lookup_type = cv_lookup_type_syo
      AND   chu.lookup_type = cv_lookup_type_chu
      AND   dai.lookup_type = cv_lookup_type_dai
      AND   chu.lookup_code = sho.attribute1
      AND   dai.lookup_code = chu.attribute1
      AND   sho.enabled_flag = cv_flg_y
      AND   chu.enabled_flag = cv_flg_y
      AND   dai.enabled_flag = cv_flg_y
      AND   NVL(sho.start_date_active, gd_online_sysdate) <= gd_online_sysdate
      AND   NVL(sho.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
      AND   NVL(chu.start_date_active, gd_online_sysdate) <= gd_online_sysdate
      AND   NVL(chu.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
      AND   NVL(dai.start_date_active, gd_online_sysdate) <= gd_online_sysdate
      AND   NVL(dai.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
      AND   sho.lookup_code = iv_business_low_type
    ;
--
    RETURN lv_business_low_type_code;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN NULL;
  END get_business_high_type_code;
--
  /**********************************************************************************
   * Procedure Name   : get_business_high_type_name
   * Description      : 業態大分類名取得
  ***********************************************************************************/
  FUNCTION get_business_high_type_name(
    iv_business_low_type IN  VARCHAR2     -- 業態小分類
  ) RETURN VARCHAR2
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'get_business_high_type_name';    -- プログラム名
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    lv_business_low_type_name          fnd_lookup_values_vl.meaning%TYPE;
--
  BEGIN
--
    SELECT  dai.meaning
    INTO    lv_business_low_type_name
    FROM    fnd_lookup_values_vl  sho
           ,fnd_lookup_values_vl  chu
           ,fnd_lookup_values_vl  dai
    WHERE   sho.lookup_type = cv_lookup_type_syo
      AND   chu.lookup_type = cv_lookup_type_chu
      AND   dai.lookup_type = cv_lookup_type_dai
      AND   chu.lookup_code = sho.attribute1
      AND   dai.lookup_code = chu.attribute1
      AND   sho.enabled_flag = cv_flg_y
      AND   chu.enabled_flag = cv_flg_y
      AND   dai.enabled_flag = cv_flg_y
      AND   NVL(sho.start_date_active, gd_online_sysdate) <= gd_online_sysdate
      AND   NVL(sho.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
      AND   NVL(chu.start_date_active, gd_online_sysdate) <= gd_online_sysdate
      AND   NVL(chu.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
      AND   NVL(dai.start_date_active, gd_online_sysdate) <= gd_online_sysdate
      AND   NVL(dai.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
      AND   sho.lookup_code = iv_business_low_type
    ;
--
    RETURN lv_business_low_type_name;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN NULL;
  END get_business_high_type_name;
--
  /**********************************************************************************
   * Procedure Name   : get_route_number
   * Description      : ルートNo取得
  ***********************************************************************************/
  FUNCTION get_route_number(
    in_organization_profile_id  IN  NUMBER  -- 組織プロファイルID
  ) RETURN VARCHAR2
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'get_route_number';    -- プログラム名
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    lv_route_number          hz_org_profiles_ext_b.c_ext_attr2%TYPE;
--
  BEGIN
    SELECT  hopeb.c_ext_attr2
    INTO    lv_route_number
    FROM    hz_org_profiles_ext_b   hopeb
    WHERE   hopeb.attr_group_id                        = gn_rtn_attr_group_id
      AND   hopeb.organization_profile_id              = in_organization_profile_id
      AND   hopeb.d_ext_attr3                         <= gd_online_sysdate
      AND   NVL(hopeb.d_ext_attr4, gd_online_sysdate) >= gd_online_sysdate
    ;
--
    RETURN lv_route_number;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN NULL;
  END get_route_number;
--
  /**********************************************************************************
   * Procedure Name   : get_rslt_amt_in_month
   * Description      : 売上実績(年月指定)取得
  ***********************************************************************************/
  FUNCTION get_rslt_amt_in_month(
     iv_account_number    IN  VARCHAR2     -- 顧客コード
    ,iv_year_month        IN  VARCHAR2     -- 年月
  ) RETURN NUMBER
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'get_rslt_amt_in_month';    -- プログラム名
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
    ln_rslt_amt          NUMBER;
--
  BEGIN
    SELECT  SUM(xsvsr.rslt_amt)
    INTO    ln_rslt_amt
    FROM    xxcso_sum_visit_sale_rep   xsvsr
    WHERE   xsvsr.sum_org_type       = cv_sum_org_type1
      AND   xsvsr.sum_org_code       = iv_account_number
      AND   xsvsr.month_date_div     = cv_month_date_div1
      AND   xsvsr.sales_date         = iv_year_month
    ;
--
    RETURN ln_rslt_amt;
--
  EXCEPTION
    WHEN OTHERS THEN
      RETURN 0;
  END get_rslt_amt_in_month;
--
/* 20090702_Ogawa_0000312 END*/
  /**********************************************************************************
   * Procedure Name   : sum_resources
   * Description      : 出力対象リソース集計
  ***********************************************************************************/
  PROCEDURE sum_resources(
    iv_base_code          IN  VARCHAR2     -- 拠点コード
  )
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'sum_resources';    -- プログラム名
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    -- *** ローカル変数 ***
--
  BEGIN
--
    INSERT INTO xxcso_tmp_rep_vsp_rsrcs(
       base_code
      ,group_number
      ,group_leader_flag
      ,group_grade
      ,employee_number
      ,employee_name
      ,created_by
      ,creation_date
      ,last_updated_by
      ,last_update_date
      ,last_update_login
      ,request_id
      ,program_application_id
      ,program_id
      ,program_update_date
    )
/* 20090702_Ogawa_0000312 START*/
    SELECT  xrrv.work_base_code_new
           ,xrrv.group_number_new
           ,xrrv.group_leader_flag_new
           ,xrrv.group_grade_new
           ,xrrv.employee_number
           ,xrrv.full_name
           ,cn_created_by
           ,cd_creation_date
           ,cn_last_updated_by
           ,cd_last_update_date
           ,cn_last_update_login
           ,cn_request_id
           ,cn_program_application_id
           ,cn_program_id
           ,cd_program_update_date
    FROM    xxcso_resource_relations_v2  xrrv
    WHERE   TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
      AND   xrrv.work_base_code_new = iv_base_code
      AND   (
             (gv_is_groupleader = cv_false)
             OR
             (
              (gv_is_groupleader = cv_true)
              AND
              (NVL(xrrv.group_number_new, ' ') = gt_group_number)
             )
            )
      AND   (
             (gv_is_salesman = cv_false)
             OR
             (
              (gv_is_salesman = cv_true)
              AND
              (xrrv.employee_number = gt_employee_number)
             )
            )
    UNION ALL
    SELECT  xrrv.work_base_code_old
           ,xrrv.group_number_old
           ,xrrv.group_leader_flag_old
           ,xrrv.group_grade_old
           ,xrrv.employee_number
           ,xrrv.full_name
           ,cn_created_by
           ,cd_creation_date
           ,cn_last_updated_by
           ,cd_last_update_date
           ,cn_last_update_login
           ,cn_request_id
           ,cn_program_application_id
           ,cn_program_id
           ,cd_program_update_date
    FROM    xxcso_resource_relations_v2  xrrv
    WHERE   TO_DATE(xrrv.issue_date,'YYYYMMDD')  > gd_online_sysdate
      AND   xrrv.work_base_code_old = iv_base_code
      AND   (
             (gv_is_groupleader = cv_false)
             OR
             (
              (gv_is_groupleader = cv_true)
              AND
              (NVL(xrrv.group_number_old, ' ') = gt_group_number)
             )
            )
      AND   (
             (gv_is_salesman = cv_false)
             OR
             (
              (gv_is_salesman = cv_true)
              AND
              (xrrv.employee_number = gt_employee_number)
             )
            )
--  SELECT  (CASE
--             WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate) THEN
--               xrrv.work_base_code_new
--             ELSE
--               xrrv.work_base_code_old
--           END
--          )
--         ,(CASE
--             WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate) THEN
--               xrrv.group_number_new
--             ELSE
--               xrrv.group_number_old
--           END
--          )
--         ,(CASE
--             WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate) THEN
--               xrrv.group_leader_flag_new
--             ELSE
--               xrrv.group_leader_flag_old
--           END
--          )
--         ,(CASE
--             WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate) THEN
--               xrrv.group_grade_new
--             ELSE
--               xrrv.group_grade_old
--           END
--          )
--         ,xrrv.employee_number
--         ,xrrv.full_name
--         ,cn_created_by
--         ,cd_creation_date
--         ,cn_last_updated_by
--         ,cd_last_update_date
--         ,cn_last_update_login
--         ,cn_request_id
--         ,cn_program_application_id
--         ,cn_program_id
--         ,cd_program_update_date
--  FROM    xxcso_resource_relations_v2  xrrv
--  /* 20090602_abe_PT START*/
--  WHERE   (
--             (     TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--              AND  xrrv.work_base_code_new = iv_base_code
--             )
--             OR
--             (     TO_DATE(xrrv.issue_date,'YYYYMMDD') > gd_online_sysdate
--              AND  xrrv.work_base_code_old = iv_base_code
--             )
--          ) 
--  --WHERE   (CASE
--  --           WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate) THEN
--  --             xrrv.work_base_code_new
--  --           ELSE
--  --             xrrv.work_base_code_old
--  --         END
--  --        )                                      = iv_base_code
--  /* 20090602_abe_PT END*/
--    AND   (
--           (gv_is_groupleader = cv_false)
--           OR
--           (
--            (gv_is_groupleader = cv_true)
--            AND
--            (CASE
--               WHEN (TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate) THEN
--                 NVL(xrrv.group_number_new, ' ')
--               ELSE
--                 NVL(xrrv.group_number_old, ' ')
--             END
--            ) = gt_group_number
--           )
--          )
--    AND   (
--           (gv_is_salesman = cv_false)
--           OR
--           (
--            (gv_is_salesman = cv_true)
--            AND
--            (xrrv.employee_number = gt_employee_number)
--           )
--          )
/* 20090702_Ogawa_0000312 END*/
    ;
--
  END sum_resources;
--
  /**********************************************************************************
   * Procedure Name   : sum_visit_sales
   * Description      : 売上訪問計画集計(顧客別日別)
  ***********************************************************************************/
  PROCEDURE sum_visit_sales
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'sum_visit_sales';    -- プログラム名
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    /* 2009.09.08 K.Satomura 0001271対応 START */
    ct_prof_op_vd_dai  CONSTANT fnd_profile_options.profile_option_name%TYPE := 'XXCSO1_VD_GYOUTAI_CD_DAI';
    ct_lookup_type_dai CONSTANT fnd_lookup_values_vl.lookup_type%TYPE        := 'XXCMM_CUST_GYOTAI_DAI';
    ct_lookup_type_chu CONSTANT fnd_lookup_values_vl.lookup_type%TYPE        := 'XXCMM_CUST_GYOTAI_CHU';
    ct_lookup_type_syo CONSTANT fnd_lookup_values_vl.lookup_type%TYPE        := 'XXCMM_CUST_GYOTAI_SHO';
    --
-- Ver.1.9 [E_本稼動_14884] ADD START
    cv_visit_target_posi    CONSTANT VARCHAR2(1) := '1';   -- 顧客マスタ.訪問対象区分「1」(訪問対象・商談可)
    cv_visit_target_imposi  CONSTANT VARCHAR2(1) := '2';   -- 顧客マスタ.訪問対象区分「2」(訪問対象・商談不可)
    cv_visit_target_vd      CONSTANT VARCHAR2(1) := '5';   -- 顧客マスタ.訪問対象区分「5」(訪問対象・VD)
-- Ver.1.9 [E_本稼動_14884] ADD END
    /* 2009.09.08 K.Satomura 0001271対応 END */
    -- *** ローカル変数 ***
    /* 2009.08.03 K.Satomura 0000911対応 START */
    lv_date      VARCHAR2(8);
    ln_route_bit NUMBER; -- 訪問予定回数
    /* 2009.08.03 K.Satomura 0000911対応 END */
    /* 2009.09.08 K.Satomura 0001271対応 START */
    lt_profile_option_value fnd_profile_option_values.profile_option_value%TYPE;
    --
    /* 2009.09.08 K.Satomura 0001271対応 END */
    -- *** ローカルカーソル ***
    /* 2009.08.03 K.Satomura 0000911対応 START */
    -- 基本項目を取得するカーソル
    CURSOR tmp_rep_vs_plan_cur
    IS
      SELECT  xcav.base_code       base_code       -- 勤務地拠点コード
             ,xcav.group_number    group_number    -- 営業グループ番号
             ,xcav.employee_number employee_number -- 従業員コード
             ,xcav.employee_name   employee_name   -- 従業員名
             ,(CASE
                 WHEN xcav.customer_status IN (cv_cust_status4, cv_cust_status5, cv_cust_status6) THEN
                   cv_gvm_m
                 ELSE
                   CASE
                     /* 2009.09.08 K.Satomura 0001271対応 START */
                     --WHEN xxcso_route_common_pkg.iscustomervendor(xcav.business_low_type) = cv_true THEN
                     WHEN xcav.is_customer_vendor = cv_true THEN
                     /* 2009.09.08 K.Satomura 0001271対応 END */
                       cv_gvm_v
                     ELSE
                       cv_gvm_g
                   END
               END
              )                    gvm_type       -- 一般／自販機／ＭＣ
             ,xcav.account_number  account_number -- 顧客コード
             ,xcav.party_name      customer_name  -- 顧客名
             ,xcav.route_number    route_number
             ,(CASE
                 WHEN (xcav.new_point_div IN ('1', '2'))
                   AND (TO_CHAR(xcav.cnvs_date,'YYYYMM') = gv_year_month)
                 THEN
                   1
                 ELSE
                   0
               END
              )                    new_customer_num -- 新規顧客件数
             ,(CASE
                 WHEN (xcav.new_point_div IN ('1','2'))
                   AND (TO_CHAR(xcav.cnvs_date,'YYYYMM') = gv_year_month)
                   AND (CASE
                          WHEN xcav.customer_status IN (cv_cust_status4, cv_cust_status5, cv_cust_status6) THEN
                            cv_gvm_m
                          ELSE
                            CASE
                              /* 2009.09.08 K.Satomura 0001271対応 START */
                              --WHEN xxcso_route_common_pkg.iscustomervendor(xcav.business_low_type) = cv_true THEN
                              WHEN xcav.is_customer_vendor = cv_true THEN
                              /* 2009.09.08 K.Satomura 0001271対応 END */
                                cv_gvm_v
                              ELSE
                                cv_gvm_g
                          END
                        END
                       ) = cv_gvm_v
                 THEN
                   1
                 ELSE
                   0
               END
              )                      new_vendor_num    -- 新規ＶＤ件数
             ,xcav.business_low_type business_low_type -- 業態（小分類）
             ,xcav.customer_status   customer_status   -- 顧客ステータス
             ,xcav.cnvs_date         cnvs_date         -- 顧客獲得日
             ,xcav.vist_target_div   vist_target_div   -- 訪問対象区分
             ,xcav.sale_base_code    sale_base_code    -- 売上拠点コード
             /* 2009.09.08 K.Satomura 0001271対応 START */
             ,xcav.is_customer_vendor is_customer_vendor -- ＶＤ区分
             /* 2009.09.08 K.Satomura 0001271対応 END */
      FROM (
        SELECT /*+ ORDERED USE_NL(hor,hop,hpa,hca,xca) */
               xtr.base_code         base_code
              ,xtr.group_number      group_number
              ,xtr.employee_number   employee_number
              ,xtr.employee_name     employee_name
              ,xca.sale_base_code    sale_base_code
              ,xca.business_low_type business_low_type
              ,hpa.duns_number_c     customer_status
              ,hca.account_number    account_number
              ,hpa.party_name        party_name
              ,xca.new_point_div     new_point_div
              ,xca.cnvs_date         cnvs_date
              ,xca.vist_target_div   vist_target_div
              ,xxcso019a05c.get_route_number(
                 hop.organization_profile_id
              )                      route_number
              /* 2009.09.08 K.Satomura 0001271対応 START */
              ,NVL(
                 (
                   SELECT (
                            CASE dai.lookup_code
                              WHEN lt_profile_option_value THEN
                                cv_true
                              ELSE
                                cv_false
                            END
                          ) is_customer_vendor
                   FROM   fnd_lookup_values_vl dai
                         ,fnd_lookup_values_vl chu
                         ,fnd_lookup_values_vl syo
                   WHERE  syo.lookup_type                                     = ct_lookup_type_syo
                   AND    chu.lookup_type                                     = ct_lookup_type_chu
                   AND    dai.lookup_type                                     = ct_lookup_type_dai
                   AND    syo.lookup_code                                     = xca.business_low_type
                   AND    chu.lookup_code                                     = syo.attribute1
                   AND    dai.lookup_code                                     = chu.attribute1
                   AND    syo.enabled_flag                                    = cv_flg_y
                   AND    chu.enabled_flag                                    = cv_flg_y
                   AND    dai.enabled_flag                                    = cv_flg_y
                   AND    NVL(dai.start_date_active, TRUNC(cd_process_date)) <= TRUNC(cd_process_date)
                   AND    NVL(dai.end_date_active,   TRUNC(cd_process_date)) >= TRUNC(cd_process_date)
                   AND    NVL(chu.start_date_active, TRUNC(cd_process_date)) <= TRUNC(cd_process_date)
                   AND    NVL(chu.end_date_active,   TRUNC(cd_process_date)) >= TRUNC(cd_process_date)
                   AND    NVL(syo.start_date_active, TRUNC(cd_process_date)) <= TRUNC(cd_process_date)
                   AND    NVL(syo.end_date_active,   TRUNC(cd_process_date)) >= TRUNC(cd_process_date)
                 ), cv_false)        is_customer_vendor
              /* 2009.09.08 K.Satomura 0001271対応 END */
        FROM   xxcso_tmp_rep_vsp_rsrcs    xtr
              ,hz_org_profiles_ext_b      hor
              ,hz_organization_profiles   hop
              ,hz_parties                 hpa
              ,hz_cust_accounts           hca
              ,xxcmm_cust_accounts        xca
        WHERE  hor.attr_group_id                       = gn_rsrc_attr_group_id
        AND    hor.c_ext_attr1                         = xtr.employee_number
        AND    hor.d_ext_attr1                        <= gd_online_sysdate
        AND    NVL(hor.d_ext_attr2,gd_online_sysdate) >= gd_online_sysdate
        AND    hop.organization_profile_id             = hor.organization_profile_id
        AND    hop.effective_end_date                  IS NULL
        AND    hpa.party_id                            = hop.party_id
        AND    hca.party_id                            = hpa.party_id
        AND    xca.customer_id(+)                      = hca.cust_account_id
        AND    (
                 (
                   EXISTS(
                     SELECT 1
                     FROM   hz_cust_accounts hca1
                           ,hz_parties       hpa1
                     WHERE  hpa1.party_id                         = hpa.party_id
                     AND    TO_CHAR(hpa1.creation_date,'YYYYMM') <= gv_year_month
                     AND    hca1.party_id                         = hpa1.party_id
                     AND    (
                              (
                                    (NVL(hca1.customer_class_code, cv_cust_class_cd3) = cv_cust_class_cd3)
                                AND (hpa1.duns_number_c IN (cv_cust_status7, cv_cust_status4, cv_cust_status5
                                                           ,cv_cust_status6, cv_cust_status8, cv_cust_status9))
                              )
                            OR
                              (
                                    (hca1.customer_class_code = cv_cust_class_cd4)
                                AND (hpa1.duns_number_c IN (cv_cust_status6 ,cv_cust_status8))
                              )
                            OR
                              (
                                    (hca1.customer_class_code IN (cv_cust_class_cd5, cv_cust_class_cd6, cv_cust_class_cd7))
                                AND (hpa1.duns_number_c = cv_cust_status3)
                              )
                            )
                   )
                 )
               OR
                 (
                   EXISTS(
                     SELECT 1
                     FROM   xxcso_sum_visit_sale_rep  xsv
                     WHERE  xsv.sum_org_type    = cv_sum_org_type1
                     AND    xsv.sum_org_code    = hca.account_number
                     AND    xsv.group_base_code = xca.sale_base_code
                     AND    xsv.month_date_div  = cv_month_date_div1
                     AND    xsv.sales_date      = gv_year_month
                   )
                 )
               )
      ) xcav
    ;
    --
    -- 基本情報のレコードタイプ・配列
    TYPE l_tmp_rep_vs_plan_ttype IS TABLE OF tmp_rep_vs_plan_cur%ROWTYPE INDEX BY BINARY_INTEGER;
    lt_tmp_rep_vs_plan_tab l_tmp_rep_vs_plan_ttype; -- 基本情報の配列
    --
    -- クイックコードのレコードタイプ・配列
    TYPE l_lookup_rtype IS RECORD(
       lookup_code fnd_lookup_values_vl.lookup_code%TYPE
      ,meaning     fnd_lookup_values_vl.meaning%TYPE
    );
    --
    TYPE l_lookup_ttype IS TABLE OF l_lookup_rtype INDEX BY BINARY_INTEGER;
    lt_lookup_tab l_lookup_ttype;
    --
    -- 実績のレコードタイプ・配列
    TYPE l_result_amt_rtype IS RECORD(
       last_year_rslt_sales_amt NUMBER -- 前年実績
      ,last_mon_rslt_sales_amt  NUMBER -- 先月実績
    );
    --
    TYPE l_result_amt_ttype IS TABLE OF l_result_amt_rtype INDEX BY BINARY_INTEGER;
    lt_result_amt_tab l_result_amt_ttype;
    --
    -- 売上系項目の配列
    TYPE l_sales_rtype IS RECORD(
       plan_vs_amt          xxcso_tmp_rep_vs_plan.plan_vs_amt_1%TYPE          -- 売上／訪問計画
      ,rslt_vs_amt          xxcso_tmp_rep_vs_plan.rslt_vs_amt_1%TYPE          -- 売上／訪問実績
      ,rslt_other_sales_amt xxcso_tmp_rep_vs_plan.rslt_other_sales_amt_1%TYPE -- 売上実績（他拠点納品分）
    );
    --
    TYPE l_sales_ttype IS TABLE OF l_sales_rtype INDEX BY BINARY_INTEGER;
    lt_sales_tab l_sales_ttype;
    --
    -- 訪問系項目の配列
    TYPE l_visit_rtype IS RECORD(
       visit_sign    xxcso_tmp_rep_vs_plan.visit_sign_1%TYPE      -- 訪問記号
      ,tgt_vis_i_num xxcso_tmp_rep_vs_plan.tgt_vis_i_num_1%TYPE   -- 訪問計画(一般)
      ,tgt_vis_v_num xxcso_tmp_rep_vs_plan.tgt_vis_v_num_1%TYPE   -- 訪問計画(自販)
      ,rslt_vis_i_num xxcso_tmp_rep_vs_plan.rslt_vis_i_num_1%TYPE -- 訪問実績(一般)
      ,rslt_vis_v_num xxcso_tmp_rep_vs_plan.rslt_vis_v_num_1%TYPE -- 訪問実績(自販)
      ,rslt_vis_m_num xxcso_tmp_rep_vs_plan.rslt_vis_m_num_1%TYPE -- 訪問実績(MC)
      ,rslt_vis_e_num xxcso_tmp_rep_vs_plan.rslt_vis_e_num_1%TYPE -- 訪問実績(有効訪問)
    );
    --
    TYPE l_visit_ttype IS TABLE OF l_visit_rtype INDEX BY BINARY_INTEGER;
    lt_visit_tab l_visit_ttype;
    --
    /* 2009.08.03 K.Satomura 0000911対応 END */
--
  BEGIN
--
    /* 2009.09.08 K.Satomura 0001271対応 START */
    lt_profile_option_value := fnd_profile.value(ct_prof_op_vd_dai);
    --
    /* 2009.09.08 K.Satomura 0001271対応 END */
/* 2009.08.03 K.Satomura 0000911対応 START */
--    INSERT INTO xxcso_tmp_rep_vs_plan(
--       base_code
--      ,group_number
--      ,employee_number
--      ,employee_name
--      ,business_high_type
--      ,business_high_name
--      ,gvm_type
--      ,account_number
--      ,customer_name
--      ,route_no
--      ,last_year_rslt_sales_amt
--      ,last_mon_rslt_sales_amt
--      ,new_customer_num
--      ,new_vendor_num
--      ,plan_vs_amt_1
--      ,plan_vs_amt_2
--      ,plan_vs_amt_3
--      ,plan_vs_amt_4
--      ,plan_vs_amt_5
--      ,plan_vs_amt_6
--      ,plan_vs_amt_7
--      ,plan_vs_amt_8
--      ,plan_vs_amt_9
--      ,plan_vs_amt_10
--      ,plan_vs_amt_11
--      ,plan_vs_amt_12
--      ,plan_vs_amt_13
--      ,plan_vs_amt_14
--      ,plan_vs_amt_15
--      ,plan_vs_amt_16
--      ,plan_vs_amt_17
--      ,plan_vs_amt_18
--      ,plan_vs_amt_19
--      ,plan_vs_amt_20
--      ,plan_vs_amt_21
--      ,plan_vs_amt_22
--      ,plan_vs_amt_23
--      ,plan_vs_amt_24
--      ,plan_vs_amt_25
--      ,plan_vs_amt_26
--      ,plan_vs_amt_27
--      ,plan_vs_amt_28
--      ,plan_vs_amt_29
--      ,plan_vs_amt_30
--      ,plan_vs_amt_31
--      ,rslt_vs_amt_1
--      ,rslt_vs_amt_2
--      ,rslt_vs_amt_3
--      ,rslt_vs_amt_4
--      ,rslt_vs_amt_5
--      ,rslt_vs_amt_6
--      ,rslt_vs_amt_7
--      ,rslt_vs_amt_8
--      ,rslt_vs_amt_9
--      ,rslt_vs_amt_10
--      ,rslt_vs_amt_11
--      ,rslt_vs_amt_12
--      ,rslt_vs_amt_13
--      ,rslt_vs_amt_14
--      ,rslt_vs_amt_15
--      ,rslt_vs_amt_16
--      ,rslt_vs_amt_17
--      ,rslt_vs_amt_18
--      ,rslt_vs_amt_19
--      ,rslt_vs_amt_20
--      ,rslt_vs_amt_21
--      ,rslt_vs_amt_22
--      ,rslt_vs_amt_23
--      ,rslt_vs_amt_24
--      ,rslt_vs_amt_25
--      ,rslt_vs_amt_26
--      ,rslt_vs_amt_27
--      ,rslt_vs_amt_28
--      ,rslt_vs_amt_29
--      ,rslt_vs_amt_30
--      ,rslt_vs_amt_31
--      ,rslt_other_sales_amt_1
--      ,rslt_other_sales_amt_2
--      ,rslt_other_sales_amt_3
--      ,rslt_other_sales_amt_4
--      ,rslt_other_sales_amt_5
--      ,rslt_other_sales_amt_6
--      ,rslt_other_sales_amt_7
--      ,rslt_other_sales_amt_8
--      ,rslt_other_sales_amt_9
--      ,rslt_other_sales_amt_10
--      ,rslt_other_sales_amt_11
--      ,rslt_other_sales_amt_12
--      ,rslt_other_sales_amt_13
--      ,rslt_other_sales_amt_14
--      ,rslt_other_sales_amt_15
--      ,rslt_other_sales_amt_16
--      ,rslt_other_sales_amt_17
--      ,rslt_other_sales_amt_18
--      ,rslt_other_sales_amt_19
--      ,rslt_other_sales_amt_20
--      ,rslt_other_sales_amt_21
--      ,rslt_other_sales_amt_22
--      ,rslt_other_sales_amt_23
--      ,rslt_other_sales_amt_24
--      ,rslt_other_sales_amt_25
--      ,rslt_other_sales_amt_26
--      ,rslt_other_sales_amt_27
--      ,rslt_other_sales_amt_28
--      ,rslt_other_sales_amt_29
--      ,rslt_other_sales_amt_30
--      ,rslt_other_sales_amt_31
--      ,visit_sign_1
--      ,visit_sign_2
--      ,visit_sign_3
--      ,visit_sign_4
--      ,visit_sign_5
--      ,visit_sign_6
--      ,visit_sign_7
--      ,visit_sign_8
--      ,visit_sign_9
--      ,visit_sign_10
--      ,visit_sign_11
--      ,visit_sign_12
--      ,visit_sign_13
--      ,visit_sign_14
--      ,visit_sign_15
--      ,visit_sign_16
--      ,visit_sign_17
--      ,visit_sign_18
--      ,visit_sign_19
--      ,visit_sign_20
--      ,visit_sign_21
--      ,visit_sign_22
--      ,visit_sign_23
--      ,visit_sign_24
--      ,visit_sign_25
--      ,visit_sign_26
--      ,visit_sign_27
--      ,visit_sign_28
--      ,visit_sign_29
--      ,visit_sign_30
--      ,visit_sign_31
--      ,tgt_vis_i_num_1
--      ,tgt_vis_i_num_2
--      ,tgt_vis_i_num_3
--      ,tgt_vis_i_num_4
--      ,tgt_vis_i_num_5
--      ,tgt_vis_i_num_6
--      ,tgt_vis_i_num_7
--      ,tgt_vis_i_num_8
--      ,tgt_vis_i_num_9
--      ,tgt_vis_i_num_10
--      ,tgt_vis_i_num_11
--      ,tgt_vis_i_num_12
--      ,tgt_vis_i_num_13
--      ,tgt_vis_i_num_14
--      ,tgt_vis_i_num_15
--      ,tgt_vis_i_num_16
--      ,tgt_vis_i_num_17
--      ,tgt_vis_i_num_18
--      ,tgt_vis_i_num_19
--      ,tgt_vis_i_num_20
--      ,tgt_vis_i_num_21
--      ,tgt_vis_i_num_22
--      ,tgt_vis_i_num_23
--      ,tgt_vis_i_num_24
--      ,tgt_vis_i_num_25
--      ,tgt_vis_i_num_26
--      ,tgt_vis_i_num_27
--      ,tgt_vis_i_num_28
--      ,tgt_vis_i_num_29
--      ,tgt_vis_i_num_30
--      ,tgt_vis_i_num_31
--      ,tgt_vis_v_num_1
--      ,tgt_vis_v_num_2
--      ,tgt_vis_v_num_3
--      ,tgt_vis_v_num_4
--      ,tgt_vis_v_num_5
--      ,tgt_vis_v_num_6
--      ,tgt_vis_v_num_7
--      ,tgt_vis_v_num_8
--      ,tgt_vis_v_num_9
--      ,tgt_vis_v_num_10
--      ,tgt_vis_v_num_11
--      ,tgt_vis_v_num_12
--      ,tgt_vis_v_num_13
--      ,tgt_vis_v_num_14
--      ,tgt_vis_v_num_15
--      ,tgt_vis_v_num_16
--      ,tgt_vis_v_num_17
--      ,tgt_vis_v_num_18
--      ,tgt_vis_v_num_19
--      ,tgt_vis_v_num_20
--      ,tgt_vis_v_num_21
--      ,tgt_vis_v_num_22
--      ,tgt_vis_v_num_23
--      ,tgt_vis_v_num_24
--      ,tgt_vis_v_num_25
--      ,tgt_vis_v_num_26
--      ,tgt_vis_v_num_27
--      ,tgt_vis_v_num_28
--      ,tgt_vis_v_num_29
--      ,tgt_vis_v_num_30
--      ,tgt_vis_v_num_31
--      ,rslt_vis_i_num_1
--      ,rslt_vis_i_num_2
--      ,rslt_vis_i_num_3
--      ,rslt_vis_i_num_4
--      ,rslt_vis_i_num_5
--      ,rslt_vis_i_num_6
--      ,rslt_vis_i_num_7
--      ,rslt_vis_i_num_8
--      ,rslt_vis_i_num_9
--      ,rslt_vis_i_num_10
--      ,rslt_vis_i_num_11
--      ,rslt_vis_i_num_12
--      ,rslt_vis_i_num_13
--      ,rslt_vis_i_num_14
--      ,rslt_vis_i_num_15
--      ,rslt_vis_i_num_16
--      ,rslt_vis_i_num_17
--      ,rslt_vis_i_num_18
--      ,rslt_vis_i_num_19
--      ,rslt_vis_i_num_20
--      ,rslt_vis_i_num_21
--      ,rslt_vis_i_num_22
--      ,rslt_vis_i_num_23
--      ,rslt_vis_i_num_24
--      ,rslt_vis_i_num_25
--      ,rslt_vis_i_num_26
--      ,rslt_vis_i_num_27
--      ,rslt_vis_i_num_28
--      ,rslt_vis_i_num_29
--      ,rslt_vis_i_num_30
--      ,rslt_vis_i_num_31
--      ,rslt_vis_v_num_1
--      ,rslt_vis_v_num_2
--      ,rslt_vis_v_num_3
--      ,rslt_vis_v_num_4
--      ,rslt_vis_v_num_5
--      ,rslt_vis_v_num_6
--      ,rslt_vis_v_num_7
--      ,rslt_vis_v_num_8
--      ,rslt_vis_v_num_9
--      ,rslt_vis_v_num_10
--      ,rslt_vis_v_num_11
--      ,rslt_vis_v_num_12
--      ,rslt_vis_v_num_13
--      ,rslt_vis_v_num_14
--      ,rslt_vis_v_num_15
--      ,rslt_vis_v_num_16
--      ,rslt_vis_v_num_17
--      ,rslt_vis_v_num_18
--      ,rslt_vis_v_num_19
--      ,rslt_vis_v_num_20
--      ,rslt_vis_v_num_21
--      ,rslt_vis_v_num_22
--      ,rslt_vis_v_num_23
--      ,rslt_vis_v_num_24
--      ,rslt_vis_v_num_25
--      ,rslt_vis_v_num_26
--      ,rslt_vis_v_num_27
--      ,rslt_vis_v_num_28
--      ,rslt_vis_v_num_29
--      ,rslt_vis_v_num_30
--      ,rslt_vis_v_num_31
--      ,rslt_vis_m_num_1
--      ,rslt_vis_m_num_2
--      ,rslt_vis_m_num_3
--      ,rslt_vis_m_num_4
--      ,rslt_vis_m_num_5
--      ,rslt_vis_m_num_6
--      ,rslt_vis_m_num_7
--      ,rslt_vis_m_num_8
--      ,rslt_vis_m_num_9
--      ,rslt_vis_m_num_10
--      ,rslt_vis_m_num_11
--      ,rslt_vis_m_num_12
--      ,rslt_vis_m_num_13
--      ,rslt_vis_m_num_14
--      ,rslt_vis_m_num_15
--      ,rslt_vis_m_num_16
--      ,rslt_vis_m_num_17
--      ,rslt_vis_m_num_18
--      ,rslt_vis_m_num_19
--      ,rslt_vis_m_num_20
--      ,rslt_vis_m_num_21
--      ,rslt_vis_m_num_22
--      ,rslt_vis_m_num_23
--      ,rslt_vis_m_num_24
--      ,rslt_vis_m_num_25
--      ,rslt_vis_m_num_26
--      ,rslt_vis_m_num_27
--      ,rslt_vis_m_num_28
--      ,rslt_vis_m_num_29
--      ,rslt_vis_m_num_30
--      ,rslt_vis_m_num_31
--      ,rslt_vis_e_num_1
--      ,rslt_vis_e_num_2
--      ,rslt_vis_e_num_3
--      ,rslt_vis_e_num_4
--      ,rslt_vis_e_num_5
--      ,rslt_vis_e_num_6
--      ,rslt_vis_e_num_7
--      ,rslt_vis_e_num_8
--      ,rslt_vis_e_num_9
--      ,rslt_vis_e_num_10
--      ,rslt_vis_e_num_11
--      ,rslt_vis_e_num_12
--      ,rslt_vis_e_num_13
--      ,rslt_vis_e_num_14
--      ,rslt_vis_e_num_15
--      ,rslt_vis_e_num_16
--      ,rslt_vis_e_num_17
--      ,rslt_vis_e_num_18
--      ,rslt_vis_e_num_19
--      ,rslt_vis_e_num_20
--      ,rslt_vis_e_num_21
--      ,rslt_vis_e_num_22
--      ,rslt_vis_e_num_23
--      ,rslt_vis_e_num_24
--      ,rslt_vis_e_num_25
--      ,rslt_vis_e_num_26
--      ,rslt_vis_e_num_27
--      ,rslt_vis_e_num_28
--      ,rslt_vis_e_num_29
--      ,rslt_vis_e_num_30
--      ,rslt_vis_e_num_31
--      ,created_by
--      ,creation_date
--      ,last_updated_by
--      ,last_update_date
--      ,last_update_login
--      ,request_id
--      ,program_application_id
--      ,program_id
--      ,program_update_date
--    )
--/* 20090702_Ogawa_0000312 START*/
----  SELECT  xtrvr.base_code              sale_base_code
----         ,xtrvr.group_number           group_number
----         ,xtrvr.employee_number        employee_number
----         ,xtrvr.employee_name          employee_name
--    SELECT  xcav.base_code               sale_base_code
--           ,xcav.group_number            group_number
--           ,xcav.employee_number         employee_number
--           ,xcav.employee_name           employee_name
--/* 20090702_Ogawa_0000312 END*/
--           ,(CASE
--/* 20090702_Ogawa_0000312 START*/
----             WHEN (biz.business_low_type IS NOT NULL) THEN
----               biz.business_high_type
--               WHEN (xcav.business_low_type IS NOT NULL) THEN
--                 XXCSO019A05C.get_business_high_type_code(
--                   xcav.business_low_type
--                 )
--/* 20090702_Ogawa_0000312 END*/
--               ELSE
--                 NULL
--             END
--            )                            business_high_type
--           ,(CASE
--/* 20090702_Ogawa_0000312 START*/
----             WHEN (biz.business_low_type IS NOT NULL) THEN
----               biz.business_high_name
--               WHEN (xcav.business_low_type IS NOT NULL) THEN
--                 XXCSO019A05C.get_business_high_type_name(
--                   xcav.business_low_type
--                 )
--/* 20090702_Ogawa_0000312 END*/
--               ELSE
--                 cv_mc
--             END
--            )                            business_high_name
--           ,XXCSO019A05C.get_gvm_type(
--              xcav.customer_status
--             ,xcav.business_low_type
--            )                            gvm_type
--           ,xcav.account_number          account_number
--           ,xcav.party_name              customer_name
--/* 20090702_Ogawa_0000312 START*/
----         ,rtn.route_number             route_no
----         ,xsvsry.rslt_amt              last_year_rslt_sales_amt
----         ,xsvsrm.rslt_amt              last_mon_rslt_sales_amt
--           ,xcav.route_number            route_no
--           ,XXCSO019A05C.get_rslt_amt_in_month(
--              xcav.account_number
--             ,gv_year_prev
--            )                            last_year_rslt_sales_amt
--           ,XXCSO019A05C.get_rslt_amt_in_month(
--              xcav.account_number
--             ,gv_year_month_prev
--            )                            last_mon_rslt_sales_amt
--/* 20090702_Ogawa_0000312 END*/
--           ,(CASE
--               WHEN (xcav.new_point_div IN ('1','2'))
--                AND (TO_CHAR(xcav.cnvs_date,'YYYYMM') = gv_year_month)
--               THEN
--                 1
--               ELSE
--                 0
--             END
--            )                            new_customer_num
--           ,(CASE
--               WHEN (xcav.new_point_div IN ('1','2'))
--                AND (TO_CHAR(xcav.cnvs_date,'YYYYMM') = gv_year_month)
--                AND (XXCSO019A05C.get_gvm_type(
--                       xcav.customer_status
--                      ,xcav.business_low_type
--                     ) = cv_gvm_v
--                    )
--               THEN
--                 1
--               ELSE
--                 0
--             END
--            )                            new_vendor_num
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,1
--            )                            plan_vs_amt_1
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,2
--            )                            plan_vs_amt_2
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,3
--            )                            plan_vs_amt_3
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,4
--            )                            plan_vs_amt_4
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,5
--            )                            plan_vs_amt_5
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,6
--            )                            plan_vs_amt_6
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,7
--            )                            plan_vs_amt_7
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,8
--            )                            plan_vs_amt_8
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,9
--            )                            plan_vs_amt_9
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,10
--            )                            plan_vs_amt_10
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,11
--            )                            plan_vs_amt_11
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,12
--            )                            plan_vs_amt_12
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,13
--            )                            plan_vs_amt_13
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,14
--            )                            plan_vs_amt_14
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,15
--            )                            plan_vs_amt_15
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,16
--            )                            plan_vs_amt_16
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,17
--            )                            plan_vs_amt_17
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,18
--            )                            plan_vs_amt_18
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,19
--            )                            plan_vs_amt_19
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,20
--            )                            plan_vs_amt_20
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,21
--            )                            plan_vs_amt_21
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,22
--            )                            plan_vs_amt_22
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,23
--            )                            plan_vs_amt_23
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,24
--            )                            plan_vs_amt_24
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,25
--            )                            plan_vs_amt_25
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,26
--            )                            plan_vs_amt_26
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,27
--            )                            plan_vs_amt_27
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,28
--            )                            plan_vs_amt_28
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,29
--            )                            plan_vs_amt_29
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,30
--            )                            plan_vs_amt_30
--           ,XXCSO019A05C.get_tgt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,31
--            )                            plan_vs_amt_31
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,1
--            )                            rslt_vs_amt_1
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,2
--            )                            rslt_vs_amt_2
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,3
--            )                            rslt_vs_amt_3
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,4
--            )                            rslt_vs_amt_4
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,5
--            )                            rslt_vs_amt_5
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,6
--            )                            rslt_vs_amt_6
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,7
--            )                            rslt_vs_amt_7
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,8
--            )                            rslt_vs_amt_8
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,9
--            )                            rslt_vs_amt_9
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,10
--            )                            rslt_vs_amt_10
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,11
--            )                            rslt_vs_amt_11
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,12
--            )                            rslt_vs_amt_12
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,13
--            )                            rslt_vs_amt_13
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,14
--            )                            rslt_vs_amt_14
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,15
--            )                            rslt_vs_amt_15
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,16
--            )                            rslt_vs_amt_16
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,17
--            )                            rslt_vs_amt_17
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,18
--            )                            rslt_vs_amt_18
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,19
--            )                            rslt_vs_amt_19
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,20
--            )                            rslt_vs_amt_20
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,21
--            )                            rslt_vs_amt_21
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,22
--            )                            rslt_vs_amt_22
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,23
--            )                            rslt_vs_amt_23
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,24
--            )                            rslt_vs_amt_24
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,25
--            )                            rslt_vs_amt_25
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,26
--            )                            rslt_vs_amt_26
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,27
--            )                            rslt_vs_amt_27
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,28
--            )                            rslt_vs_amt_28
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,29
--            )                            rslt_vs_amt_29
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,30
--            )                            rslt_vs_amt_30
--           ,XXCSO019A05C.get_rslt_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,31
--            )                            rslt_vs_amt_31
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,1
--            )                            rslt_other_sales_amt_1
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,2
--            )                            rslt_other_sales_amt_2
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,3
--            )                            rslt_other_sales_amt_3
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,4
--            )                            rslt_other_sales_amt_4
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,5
--            )                            rslt_other_sales_amt_5
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,6
--            )                            rslt_other_sales_amt_6
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,7
--            )                            rslt_other_sales_amt_7
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,8
--            )                            rslt_other_sales_amt_8
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,9
--            )                            rslt_other_sales_amt_9
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,10
--            )                            rslt_other_sales_amt_10
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,11
--            )                            rslt_other_sales_amt_11
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,12
--            )                            rslt_other_sales_amt_12
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,13
--            )                            rslt_other_sales_amt_13
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,14
--            )                            rslt_other_sales_amt_14
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,15
--            )                            rslt_other_sales_amt_15
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,16
--            )                            rslt_other_sales_amt_16
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,17
--            )                            rslt_other_sales_amt_17
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,18
--            )                            rslt_other_sales_amt_18
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,19
--            )                            rslt_other_sales_amt_19
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,20
--            )                            rslt_other_sales_amt_20
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,21
--            )                            rslt_other_sales_amt_21
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,22
--            )                            rslt_other_sales_amt_22
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,23
--            )                            rslt_other_sales_amt_23
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,24
--            )                            rslt_other_sales_amt_24
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,25
--            )                            rslt_other_sales_amt_25
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,26
--            )                            rslt_other_sales_amt_26
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,27
--            )                            rslt_other_sales_amt_27
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,28
--            )                            rslt_other_sales_amt_28
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,29
--            )                            rslt_other_sales_amt_29
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,30
--            )                            rslt_other_sales_amt_30
--           ,XXCSO019A05C.get_rslt_other_sales_amt(
--              xcav.sale_base_code
--             ,xcav.account_number
--             ,gv_year_month
--             ,31
--            )                            rslt_other_sales_amt_31
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            visit_sign_1
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            visit_sign_2
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            visit_sign_3
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            visit_sign_4
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            visit_sign_5
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            visit_sign_6
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            visit_sign_7
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            visit_sign_8
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            visit_sign_9
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            visit_sign_10
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            visit_sign_11
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            visit_sign_12
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            visit_sign_13
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            visit_sign_14
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            visit_sign_15
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            visit_sign_16
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            visit_sign_17
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            visit_sign_18
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            visit_sign_19
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            visit_sign_20
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            visit_sign_21
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            visit_sign_22
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            visit_sign_23
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            visit_sign_24
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            visit_sign_25
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            visit_sign_26
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            visit_sign_27
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            visit_sign_28
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            visit_sign_29
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            visit_sign_30
--           ,XXCSO019A05C.get_visit_sign(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            visit_sign_31
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            tgt_vis_i_num_1
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            tgt_vis_i_num_2
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            tgt_vis_i_num_3
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            tgt_vis_i_num_4
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            tgt_vis_i_num_5
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            tgt_vis_i_num_6
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            tgt_vis_i_num_7
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            tgt_vis_i_num_8
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            tgt_vis_i_num_9
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            tgt_vis_i_num_10
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            tgt_vis_i_num_11
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            tgt_vis_i_num_12
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            tgt_vis_i_num_13
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            tgt_vis_i_num_14
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            tgt_vis_i_num_15
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            tgt_vis_i_num_16
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            tgt_vis_i_num_17
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            tgt_vis_i_num_18
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            tgt_vis_i_num_19
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            tgt_vis_i_num_20
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            tgt_vis_i_num_21
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            tgt_vis_i_num_22
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            tgt_vis_i_num_23
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            tgt_vis_i_num_24
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            tgt_vis_i_num_25
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            tgt_vis_i_num_26
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            tgt_vis_i_num_27
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            tgt_vis_i_num_28
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            tgt_vis_i_num_29
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            tgt_vis_i_num_30
--           ,XXCSO019A05C.get_i_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            tgt_vis_i_num_31
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            tgt_vis_v_num_1
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            tgt_vis_v_num_2
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            tgt_vis_v_num_3
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            tgt_vis_v_num_4
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            tgt_vis_v_num_5
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            tgt_vis_v_num_6
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            tgt_vis_v_num_7
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            tgt_vis_v_num_8
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            tgt_vis_v_num_9
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            tgt_vis_v_num_10
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            tgt_vis_v_num_11
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            tgt_vis_v_num_12
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            tgt_vis_v_num_13
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            tgt_vis_v_num_14
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            tgt_vis_v_num_15
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            tgt_vis_v_num_16
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            tgt_vis_v_num_17
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            tgt_vis_v_num_18
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            tgt_vis_v_num_19
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            tgt_vis_v_num_20
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            tgt_vis_v_num_21
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            tgt_vis_v_num_22
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            tgt_vis_v_num_23
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            tgt_vis_v_num_24
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            tgt_vis_v_num_25
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            tgt_vis_v_num_26
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            tgt_vis_v_num_27
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            tgt_vis_v_num_28
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            tgt_vis_v_num_29
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            tgt_vis_v_num_30
--           ,XXCSO019A05C.get_v_tgt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--             ,xcav.route_number
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            tgt_vis_v_num_31
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            rslt_vis_i_num_1
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            rslt_vis_i_num_2
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            rslt_vis_i_num_3
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            rslt_vis_i_num_4
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            rslt_vis_i_num_5
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            rslt_vis_i_num_6
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            rslt_vis_i_num_7
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            rslt_vis_i_num_8
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            rslt_vis_i_num_9
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            rslt_vis_i_num_10
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            rslt_vis_i_num_11
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            rslt_vis_i_num_12
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            rslt_vis_i_num_13
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            rslt_vis_i_num_14
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            rslt_vis_i_num_15
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            rslt_vis_i_num_16
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            rslt_vis_i_num_17
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            rslt_vis_i_num_18
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            rslt_vis_i_num_19
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            rslt_vis_i_num_20
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            rslt_vis_i_num_21
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            rslt_vis_i_num_22
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            rslt_vis_i_num_23
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            rslt_vis_i_num_24
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            rslt_vis_i_num_25
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            rslt_vis_i_num_26
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            rslt_vis_i_num_27
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            rslt_vis_i_num_28
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            rslt_vis_i_num_29
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            rslt_vis_i_num_30
--           ,XXCSO019A05C.get_i_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            rslt_vis_i_num_31
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            rslt_vis_v_num_1
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            rslt_vis_v_num_2
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            rslt_vis_v_num_3
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            rslt_vis_v_num_4
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            rslt_vis_v_num_5
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            rslt_vis_v_num_6
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            rslt_vis_v_num_7
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            rslt_vis_v_num_8
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            rslt_vis_v_num_9
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            rslt_vis_v_num_10
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            rslt_vis_v_num_11
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            rslt_vis_v_num_12
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            rslt_vis_v_num_13
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            rslt_vis_v_num_14
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            rslt_vis_v_num_15
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            rslt_vis_v_num_16
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            rslt_vis_v_num_17
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            rslt_vis_v_num_18
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            rslt_vis_v_num_19
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            rslt_vis_v_num_20
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            rslt_vis_v_num_21
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            rslt_vis_v_num_22
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            rslt_vis_v_num_23
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            rslt_vis_v_num_24
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            rslt_vis_v_num_25
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            rslt_vis_v_num_26
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            rslt_vis_v_num_27
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            rslt_vis_v_num_28
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            rslt_vis_v_num_29
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            rslt_vis_v_num_30
--           ,XXCSO019A05C.get_v_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--             ,xcav.vist_target_div
--             ,xcav.business_low_type
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            rslt_vis_v_num_31
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            rslt_vis_m_num_1
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            rslt_vis_m_num_2
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            rslt_vis_m_num_3
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            rslt_vis_m_num_4
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            rslt_vis_m_num_5
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            rslt_vis_m_num_6
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            rslt_vis_m_num_7
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            rslt_vis_m_num_8
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            rslt_vis_m_num_9
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            rslt_vis_m_num_10
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            rslt_vis_m_num_11
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            rslt_vis_m_num_12
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            rslt_vis_m_num_13
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            rslt_vis_m_num_14
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            rslt_vis_m_num_15
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            rslt_vis_m_num_16
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            rslt_vis_m_num_17
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            rslt_vis_m_num_18
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            rslt_vis_m_num_19
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            rslt_vis_m_num_20
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            rslt_vis_m_num_21
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            rslt_vis_m_num_22
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            rslt_vis_m_num_23
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            rslt_vis_m_num_24
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            rslt_vis_m_num_25
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            rslt_vis_m_num_26
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            rslt_vis_m_num_27
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            rslt_vis_m_num_28
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            rslt_vis_m_num_29
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            rslt_vis_m_num_30
--           ,XXCSO019A05C.get_m_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.customer_status
--             ,xcav.cnvs_date
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            rslt_vis_m_num_31
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,1
--            )                            rslt_vis_e_num_1
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,2
--            )                            rslt_vis_e_num_2
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,3
--            )                            rslt_vis_e_num_3
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,4
--            )                            rslt_vis_e_num_4
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,5
--            )                            rslt_vis_e_num_5
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,6
--            )                            rslt_vis_e_num_6
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,7
--            )                            rslt_vis_e_num_7
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,8
--            )                            rslt_vis_e_num_8
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,9
--            )                            rslt_vis_e_num_9
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,10
--            )                            rslt_vis_e_num_10
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,11
--            )                            rslt_vis_e_num_11
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,12
--            )                            rslt_vis_e_num_12
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,13
--            )                            rslt_vis_e_num_13
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,14
--            )                            rslt_vis_e_num_14
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,15
--            )                            rslt_vis_e_num_15
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,16
--            )                            rslt_vis_e_num_16
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,17
--            )                            rslt_vis_e_num_17
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,18
--            )                            rslt_vis_e_num_18
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,19
--            )                            rslt_vis_e_num_19
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,20
--            )                            rslt_vis_e_num_20
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,21
--            )                            rslt_vis_e_num_21
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,22
--            )                            rslt_vis_e_num_22
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,23
--            )                            rslt_vis_e_num_23
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,24
--            )                            rslt_vis_e_num_24
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,25
--            )                            rslt_vis_e_num_25
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,26
--            )                            rslt_vis_e_num_26
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,27
--            )                            rslt_vis_e_num_27
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,28
--            )                            rslt_vis_e_num_28
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,29
--            )                            rslt_vis_e_num_29
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,30
--            )                            rslt_vis_e_num_30
--           ,XXCSO019A05C.get_e_rslt_vis_num(
--              xcav.sale_base_code
--             ,xcav.account_number
--/* 20090702_Ogawa_0000312 START*/
--             ,xcav.vist_target_div
--/* 20090702_Ogawa_0000312 END*/
--             ,gv_year_month
--             ,31
--            )                            rslt_vis_e_num_31
--           ,cn_created_by
--           ,cd_creation_date
--           ,cn_last_updated_by
--           ,cd_last_update_date
--           ,cn_last_update_login
--           ,cn_request_id
--           ,cn_program_application_id
--           ,cn_program_id
--           ,cd_program_update_date
--/* 20090702_Ogawa_0000312 START*/
--    FROM    (
--             SELECT  /*+ ORDERED USE_NL(rsrc,hop,hp,hca,xca) */
--                     xtrvr.base_code            base_code
--                    ,xtrvr.group_number         group_number
--                    ,xtrvr.employee_number      employee_number
--                    ,xtrvr.employee_name        employee_name
--                    ,xca.sale_base_code         sale_base_code
--                    ,xca.business_low_type      business_low_type
--                    ,hp.duns_number_c           customer_status
--                    ,hca.account_number         account_number
--                    ,hp.party_name              party_name
--                    ,xca.new_point_div          new_point_div
--                    ,xca.cnvs_date              cnvs_date
--                    ,xca.vist_target_div        vist_target_div
--                    ,XXCSO019A05C.get_route_number(
--                       hop.organization_profile_id
--                     )                          route_number
--             FROM    xxcso_tmp_rep_vsp_rsrcs    xtrvr
--                    ,hz_org_profiles_ext_b      rsrc
--                    ,hz_organization_profiles   hop
--                    ,hz_parties                 hp
--                    ,hz_cust_accounts           hca
--                    ,xxcmm_cust_accounts        xca
--             WHERE   rsrc.attr_group_id                       = gn_rsrc_attr_group_id
--               AND   rsrc.c_ext_attr1                         = xtrvr.employee_number
--               AND   rsrc.d_ext_attr1                        <= gd_online_sysdate
--               AND   NVL(rsrc.d_ext_attr2,gd_online_sysdate) >= gd_online_sysdate
--               AND   hop.organization_profile_id              = rsrc.organization_profile_id
--               AND   hop.effective_end_date                   IS NULL
--               AND   hp.party_id                              = hop.party_id
--               AND   hca.party_id                             = hp.party_id
--               AND   xca.customer_id(+)                       = hca.cust_account_id
--               AND   (
--                       (EXISTS
--                         (SELECT  1
--                          FROM    hz_cust_accounts        hca1
--                                 ,hz_parties              hp1
--                          WHERE   hp1.party_id                         = hp.party_id
--                            AND   TO_CHAR(hp1.creation_date,'YYYYMM') <= gv_year_month
--                            AND   hca1.party_id                        = hp1.party_id
--                            AND   (
--                                    (
--                                      (NVL(hca1.customer_class_code, cv_cust_class_cd3)
--                                         = cv_cust_class_cd3
--                                      )
--                                      AND
--                                      (hp1.duns_number_c IN (
--                                                                  cv_cust_status7
--                                                                 ,cv_cust_status4
--                                                                 ,cv_cust_status5
--                                                                 ,cv_cust_status6
--                                                                 ,cv_cust_status8
--                                                                 ,cv_cust_status9
--                                                                )
--                                      )
--                                    )
--                                    OR
--                                    (
--                                      (hca1.customer_class_code = cv_cust_class_cd4)
--                                      AND
--                                      (hp1.duns_number_c IN (
--                                                                  cv_cust_status6
--                                                                 ,cv_cust_status8
--                                                                )
--                                      )
--                                    )
--                                    OR
--                                    (
--                                      (hca1.customer_class_code IN (
--                                                                      cv_cust_class_cd5
--                                                                     ,cv_cust_class_cd6
--                                                                     ,cv_cust_class_cd7
--                                                                    )
--                                      )
--                                      AND
--                                      (hp1.duns_number_c = cv_cust_status3)
--                                    )
--                                  )
--                         )
--                       )
--                       OR
--                       (EXISTS
--                         (SELECT  1
--                          FROM    xxcso_sum_visit_sale_rep  xsvsr
--                          WHERE   xsvsr.sum_org_type        = cv_sum_org_type1
--                            AND   xsvsr.sum_org_code        = hca.account_number
--                            AND   xsvsr.group_base_code     = xca.sale_base_code
--                            AND   xsvsr.month_date_div      = cv_month_date_div1
--                            AND   xsvsr.sales_date          = gv_year_month
--                         )
--                       )
--                     )
--            )  xcav
/* 2009.08.03 K.Satomura 0000911対応 END */
--  FROM    xxcso_tmp_rep_vsp_rsrcs      xtrvr
--         ,xxcso_resource_custs_v2      rsrc
--         ,xxcso_cust_accounts_v        xcav
--         ,xxcso_cust_routes_v2         rtn
--         ,xxcso_sum_visit_sale_rep     xsvsry
--         ,xxcso_sum_visit_sale_rep     xsvsrm
--         ,(SELECT  sho.lookup_code  business_low_type
--                  ,dai.lookup_code  business_high_type
--                  ,dai.meaning      business_high_name
--           FROM    fnd_lookup_values_vl  sho
--                  ,fnd_lookup_values_vl  chu
--                  ,fnd_lookup_values_vl  dai
--           WHERE   sho.lookup_type = cv_lookup_type_syo
--             AND   chu.lookup_type = cv_lookup_type_chu
--             AND   dai.lookup_type = cv_lookup_type_dai
--             AND   chu.lookup_code = sho.attribute1
--             AND   dai.lookup_code = chu.attribute1
--             AND   sho.enabled_flag = cv_flg_y
--             AND   chu.enabled_flag = cv_flg_y
--             AND   dai.enabled_flag = cv_flg_y
--             AND   NVL(sho.start_date_active, gd_online_sysdate) <= gd_online_sysdate
--             AND   NVL(sho.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
--             AND   NVL(chu.start_date_active, gd_online_sysdate) <= gd_online_sysdate
--             AND   NVL(chu.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
--             AND   NVL(dai.start_date_active, gd_online_sysdate) <= gd_online_sysdate
--             AND   NVL(dai.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
--          )                            biz
--  WHERE   rsrc.employee_number         = xtrvr.employee_number
--    AND   xcav.account_number          = rsrc.account_number
--    AND   rtn.account_number(+)        = xcav.account_number
--    AND   xsvsry.sum_org_type(+)       = cv_sum_org_type1
--    AND   xsvsry.sum_org_code(+)       = xcav.account_number
--    AND   xsvsry.group_base_code(+)    = xcav.sale_base_code
--    AND   xsvsry.month_date_div(+)     = cv_month_date_div1
--    AND   xsvsry.sales_date(+)         = gv_year_prev
--    AND   xsvsrm.sum_org_type(+)       = cv_sum_org_type1
--    AND   xsvsrm.sum_org_code(+)       = xcav.account_number
--    AND   xsvsrm.group_base_code(+)    = xcav.sale_base_code
--    AND   xsvsrm.month_date_div(+)     = cv_month_date_div1
--    AND   xsvsrm.sales_date(+)         = gv_year_month_prev
--    AND   biz.business_low_type(+)     = xcav.business_low_type
--    AND   (
--            (EXISTS
--              (SELECT  1
--               FROM    xxcso_cust_accounts_v   xcav1
--                      ,hz_parties              hp
--               WHERE   hp.party_id                         = xcav1.party_id
--                 AND   TO_CHAR(hp.creation_date,'YYYYMM') <= gv_year_month
--                 AND   xcav1.account_number                = xcav.account_number
--                 AND   (
--                         (
--                           (NVL(xcav1.customer_class_code, cv_cust_class_cd3)
--                              = cv_cust_class_cd3
--                           )
--                           AND
--                           (xcav1.customer_status IN (
--                                                       cv_cust_status7
--                                                      ,cv_cust_status4
--                                                      ,cv_cust_status5
--                                                      ,cv_cust_status6
--                                                      ,cv_cust_status8
--                                                      ,cv_cust_status9
--                                                     )
--                           )
--                         )
--                         OR
--                         (
--                           (xcav1.customer_class_code = cv_cust_class_cd4)
--                           AND
--                           (xcav1.customer_status IN (
--                                                       cv_cust_status6
--                                                      ,cv_cust_status8
--                                                     )
--                           )
--                         )
--                         OR
--                         (
--                           (xcav1.customer_class_code IN (
--                                                           cv_cust_class_cd5
--                                                          ,cv_cust_class_cd6
--                                                          ,cv_cust_class_cd7
--                                                         )
--                           )
--                           AND
--                           (xcav1.customer_status = cv_cust_status3)
--                         )
--                       )
--              )
--            )
--            OR
--            (EXISTS
--              (SELECT  1
--               FROM    xxcso_sum_visit_sale_rep  xsvsr
--               WHERE   xsvsr.sum_org_type        = cv_sum_org_type1
--                 AND   xsvsr.sum_org_code        = xcav.account_number
--                 AND   xsvsr.group_base_code     = xcav.sale_base_code
--                 AND   xsvsr.month_date_div      = cv_month_date_div1
--                 AND   xsvsr.sales_date          = gv_year_month
--              )
--            )
--          )
/* 20090702_Ogawa_0000312 END*/
    /* 2009.08.03 K.Satomura 0000911対応 START */
    --;
    /* 2009.08.03 K.Satomura 0000911対応 END */
--
    /* 2009.08.03 K.Satomura 0000911対応 START */
    lt_tmp_rep_vs_plan_tab.DELETE;
    lt_lookup_tab.DELETE;
    lt_result_amt_tab.DELETE;
    --
    -- 基本項目取得
    OPEN tmp_rep_vs_plan_cur;
    FETCH tmp_rep_vs_plan_cur BULK COLLECT INTO lt_tmp_rep_vs_plan_tab;
    CLOSE tmp_rep_vs_plan_cur;
    --
    -- 基本項目以外取得
    <<get_loop>>
    /* 2009.08.18 M.Maruyama 0001105対応 START */
--    FOR i IN lt_tmp_rep_vs_plan_tab.FIRST..lt_tmp_rep_vs_plan_tab.LAST LOOP
    FOR i IN 1..lt_tmp_rep_vs_plan_tab.COUNT LOOP
    /* 2009.08.18 M.Maruyama 0001105対応 END */
      BEGIN
        SELECT dai.lookup_code business_high_type -- 業態（大分類）
              ,dai.meaning     business_high_name -- 業態（大分類）名
        INTO   lt_lookup_tab(i).lookup_code
              ,lt_lookup_tab(i).meaning
        FROM   fnd_lookup_values_vl sho
              ,fnd_lookup_values_vl chu
              ,fnd_lookup_values_vl dai
        WHERE  sho.lookup_type                                = cv_lookup_type_syo
        AND    chu.lookup_type                                = cv_lookup_type_chu
        AND    dai.lookup_type                                = cv_lookup_type_dai
        AND    chu.lookup_code                                = sho.attribute1
        AND    dai.lookup_code                                = chu.attribute1
        AND    sho.enabled_flag                               = cv_flg_y
        AND    chu.enabled_flag                               = cv_flg_y
        AND    dai.enabled_flag                               = cv_flg_y
        AND    NVL(sho.start_date_active, gd_online_sysdate) <= gd_online_sysdate
        AND    NVL(sho.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
        AND    NVL(chu.start_date_active, gd_online_sysdate) <= gd_online_sysdate
        AND    NVL(chu.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
        AND    NVL(dai.start_date_active, gd_online_sysdate) <= gd_online_sysdate
        AND    NVL(dai.end_date_active, gd_online_sysdate)   >= gd_online_sysdate
        AND    sho.lookup_code                                = lt_tmp_rep_vs_plan_tab(i).business_low_type
        ;
      EXCEPTION
        WHEN OTHERS THEN
          lt_lookup_tab(i).lookup_code := NULL;
          lt_lookup_tab(i).meaning     := cv_mc;
          --
      END;
      --
      -- 前年実績取得
      BEGIN
        SELECT SUM(xsvsr.rslt_amt)
        INTO   lt_result_amt_tab(i).last_year_rslt_sales_amt
        FROM   xxcso_sum_visit_sale_rep   xsvsr
        WHERE  xsvsr.sum_org_type   = cv_sum_org_type1
        AND    xsvsr.sum_org_code   = lt_tmp_rep_vs_plan_tab(i).account_number
        AND    xsvsr.month_date_div = cv_month_date_div1
        AND    xsvsr.sales_date     = gv_year_prev
        ;
      EXCEPTION
        WHEN OTHERS THEN
          lt_result_amt_tab(i).last_year_rslt_sales_amt := 0;
          --
      END;
      --
      -- 先月実績取得
      BEGIN
        SELECT SUM(xsvsr.rslt_amt)
        INTO   lt_result_amt_tab(i).last_mon_rslt_sales_amt
        FROM   xxcso_sum_visit_sale_rep   xsvsr
        WHERE  xsvsr.sum_org_type   = cv_sum_org_type1
        AND    xsvsr.sum_org_code   = lt_tmp_rep_vs_plan_tab(i).account_number
        AND    xsvsr.month_date_div = cv_month_date_div1
        AND    xsvsr.sales_date     = gv_year_month_prev
        ;
      EXCEPTION
        WHEN OTHERS THEN
          lt_result_amt_tab(i).last_mon_rslt_sales_amt := 0;
          --
      END;
      --
      -- 売上系各項目・訪問系各項目取得
      lt_sales_tab.DELETE;
      lt_visit_tab.DELETE;
      --
      <<get_sales_visit_loop>>
      FOR n IN 1..31 LOOP
        lv_date := gv_year_month || LPAD(n, 2, '0');
        --
        -- 訪問記号・訪問計画(一般)取得
        ln_route_bit := xxcso019a05c.get_route_bit(
                           lt_tmp_rep_vs_plan_tab(i).route_number
                          ,gv_year_month
                          ,n
                        );
        --
        BEGIN
          SELECT NVL(xsvsr.tgt_amt, 0)         tgt_amt         -- 売上／訪問計画
                ,NVL(xsvsr.rslt_amt, 0)        rslt_amt        -- 売上／訪問実績
                ,NVL(xsvsr.rslt_center_amt, 0) rslt_center_amt -- 売上実績（他拠点納品分）
                ,SUBSTRB(
                   (
                     CASE
                       WHEN (xsvsr.vis_num > 0)
                         AND (lt_tmp_rep_vs_plan_tab(i).customer_status IN (cv_cust_status4, cv_cust_status5, cv_cust_status6))
                       THEN
                         '*' || (CASE WHEN (xsvsr.vis_a_num > 0) THEN 'A' END)
                             || (CASE WHEN (xsvsr.vis_b_num > 0) THEN 'B' END)
                             || (CASE WHEN (xsvsr.vis_c_num > 0) THEN 'C' END)
                             || (CASE WHEN (xsvsr.vis_d_num > 0) THEN 'D' END)
                             || (CASE WHEN (xsvsr.vis_e_num > 0) THEN 'E' END)
                             || (CASE WHEN (xsvsr.vis_f_num > 0) THEN 'F' END)
                             || (CASE WHEN (xsvsr.vis_g_num > 0) THEN 'G' END)
                             || (CASE WHEN (xsvsr.vis_h_num > 0) THEN 'H' END)
                             || (CASE WHEN (xsvsr.vis_i_num > 0) THEN 'I' END)
                             || (CASE WHEN (xsvsr.vis_j_num > 0) THEN 'J' END)
                             || (CASE WHEN (xsvsr.vis_k_num > 0) THEN 'K' END)
                             || (CASE WHEN (xsvsr.vis_l_num > 0) THEN 'L' END)
                             || (CASE WHEN (xsvsr.vis_m_num > 0) THEN 'M' END)
                             || (CASE WHEN (xsvsr.vis_n_num > 0) THEN 'N' END)
                             || (CASE WHEN (xsvsr.vis_o_num > 0) THEN 'O' END)
                             || (CASE WHEN (xsvsr.vis_p_num > 0) THEN 'P' END)
                             || (CASE WHEN (xsvsr.vis_q_num > 0) THEN 'Q' END)
                             || (CASE WHEN (xsvsr.vis_r_num > 0) THEN 'R' END)
                             || (CASE WHEN (xsvsr.vis_s_num > 0) THEN 'S' END)
                             || (CASE WHEN (xsvsr.vis_t_num > 0) THEN 'T' END)
                             || (CASE WHEN (xsvsr.vis_u_num > 0) THEN 'U' END)
                             || (CASE WHEN (xsvsr.vis_v_num > 0) THEN 'V' END)
                             || (CASE WHEN (xsvsr.vis_w_num > 0) THEN 'W' END)
                             || (CASE WHEN (xsvsr.vis_x_num > 0) THEN 'X' END)
                             || (CASE WHEN (xsvsr.vis_y_num > 0) THEN 'Y' END)
                             || (CASE WHEN (xsvsr.vis_z_num > 0) THEN 'Z' END)
                       WHEN (xsvsr.vis_num > 0)
                         AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date > TO_DATE(lv_date,'YYYYMMDD'))
                       THEN
                         '*' || (CASE WHEN (xsvsr.vis_a_num > 0) THEN 'A' END)
                             || (CASE WHEN (xsvsr.vis_b_num > 0) THEN 'B' END)
                             || (CASE WHEN (xsvsr.vis_c_num > 0) THEN 'C' END)
                             || (CASE WHEN (xsvsr.vis_d_num > 0) THEN 'D' END)
                             || (CASE WHEN (xsvsr.vis_e_num > 0) THEN 'E' END)
                             || (CASE WHEN (xsvsr.vis_f_num > 0) THEN 'F' END)
                             || (CASE WHEN (xsvsr.vis_g_num > 0) THEN 'G' END)
                             || (CASE WHEN (xsvsr.vis_h_num > 0) THEN 'H' END)
                             || (CASE WHEN (xsvsr.vis_i_num > 0) THEN 'I' END)
                             || (CASE WHEN (xsvsr.vis_j_num > 0) THEN 'J' END)
                             || (CASE WHEN (xsvsr.vis_k_num > 0) THEN 'K' END)
                             || (CASE WHEN (xsvsr.vis_l_num > 0) THEN 'L' END)
                             || (CASE WHEN (xsvsr.vis_m_num > 0) THEN 'M' END)
                             || (CASE WHEN (xsvsr.vis_n_num > 0) THEN 'N' END)
                             || (CASE WHEN (xsvsr.vis_o_num > 0) THEN 'O' END)
                             || (CASE WHEN (xsvsr.vis_p_num > 0) THEN 'P' END)
                             || (CASE WHEN (xsvsr.vis_q_num > 0) THEN 'Q' END)
                             || (CASE WHEN (xsvsr.vis_r_num > 0) THEN 'R' END)
                             || (CASE WHEN (xsvsr.vis_s_num > 0) THEN 'S' END)
                             || (CASE WHEN (xsvsr.vis_t_num > 0) THEN 'T' END)
                             || (CASE WHEN (xsvsr.vis_u_num > 0) THEN 'U' END)
                             || (CASE WHEN (xsvsr.vis_v_num > 0) THEN 'V' END)
                             || (CASE WHEN (xsvsr.vis_w_num > 0) THEN 'W' END)
                             || (CASE WHEN (xsvsr.vis_x_num > 0) THEN 'X' END)
                             || (CASE WHEN (xsvsr.vis_y_num > 0) THEN 'Y' END)
                             || (CASE WHEN (xsvsr.vis_z_num > 0) THEN 'Z' END)
                       WHEN (xsvsr.vis_num > 0)
                         /* 2009.09.08 K.Satomura 0001317対応 START */
                         --AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                         /* 2009.09.08 K.Satomura 0001317対応 END */
                       THEN
                         '*' || (CASE WHEN (xsvsr.vis_a_num > 0) THEN 'A' END)
                             || (CASE WHEN (xsvsr.vis_b_num > 0) THEN 'B' END)
                             || (CASE WHEN (xsvsr.vis_c_num > 0) THEN 'C' END)
                             || (CASE WHEN (xsvsr.vis_d_num > 0) THEN 'D' END)
                             || (CASE WHEN (xsvsr.vis_e_num > 0) THEN 'E' END)
                             || (CASE WHEN (xsvsr.vis_f_num > 0) THEN 'F' END)
                             || (CASE WHEN (xsvsr.vis_g_num > 0) THEN 'G' END)
                             || (CASE WHEN (xsvsr.vis_h_num > 0) THEN 'H' END)
                             || (CASE WHEN (xsvsr.vis_i_num > 0) THEN 'I' END)
                             || (CASE WHEN (xsvsr.vis_j_num > 0) THEN 'J' END)
                             || (CASE WHEN (xsvsr.vis_k_num > 0) THEN 'K' END)
                             || (CASE WHEN (xsvsr.vis_l_num > 0) THEN 'L' END)
                             || (CASE WHEN (xsvsr.vis_m_num > 0) THEN 'M' END)
                             || (CASE WHEN (xsvsr.vis_n_num > 0) THEN 'N' END)
                             || (CASE WHEN (xsvsr.vis_o_num > 0) THEN 'O' END)
                             || (CASE WHEN (xsvsr.vis_p_num > 0) THEN 'P' END)
                             || (CASE WHEN (xsvsr.vis_q_num > 0) THEN 'Q' END)
                             || (CASE WHEN (xsvsr.vis_r_num > 0) THEN 'R' END)
                             || (CASE WHEN (xsvsr.vis_s_num > 0) THEN 'S' END)
                             || (CASE WHEN (xsvsr.vis_t_num > 0) THEN 'T' END)
                             || (CASE WHEN (xsvsr.vis_u_num > 0) THEN 'U' END)
                             || (CASE WHEN (xsvsr.vis_v_num > 0) THEN 'V' END)
                             || (CASE WHEN (xsvsr.vis_w_num > 0) THEN 'W' END)
                             || (CASE WHEN (xsvsr.vis_x_num > 0) THEN 'X' END)
                             || (CASE WHEN (xsvsr.vis_y_num > 0) THEN 'Y' END)
                             || (CASE WHEN (xsvsr.vis_z_num > 0) THEN 'Z' END)
                       WHEN (xsvsr.rslt_amt = 0) THEN
                         '*'
                       ELSE
                         NULL
                     END
                   ), 1, 20
                 ) visit_sign -- 訪問記号
                ,(CASE
                    WHEN (xsvsr.tgt_amt > 0)
-- Ver.1.9 [E_本稼動_14884] MOD START
--                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div IN (cv_visit_target_posi, cv_visit_target_imposi, cv_visit_target_vd))
-- Ver.1.9 [E_本稼動_14884] MOD END
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date <= TO_DATE(xsvsr.sales_date, 'YYYYMMDD'))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) <> cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor <> cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      ln_route_bit
                    WHEN (xsvsr.tgt_amt > 0)
-- Ver.1.9 [E_本稼動_14884] MOD START
--                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div IN (cv_visit_target_posi, cv_visit_target_imposi, cv_visit_target_vd))
-- Ver.1.9 [E_本稼動_14884] MOD END
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date IS NULL)
                      AND (lt_tmp_rep_vs_plan_tab(i).customer_status IN (cv_cust_status8, cv_cust_status9, cv_cust_status3))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) <> cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor <> cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      ln_route_bit
                    ELSE
                      0
                  END
                 ) tgt_vis_i_num -- 訪問計画(一般)
                ,(CASE
                    WHEN (xsvsr.tgt_amt > 0)
-- Ver.1.9 [E_本稼動_14884] MOD START
--                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div IN (cv_visit_target_posi, cv_visit_target_imposi, cv_visit_target_vd))
-- Ver.1.9 [E_本稼動_14884] MOD END
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) = cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor = cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      ln_route_bit
                    WHEN (xsvsr.tgt_amt > 0)
-- Ver.1.9 [E_本稼動_14884] MOD START
--                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div IN (cv_visit_target_posi, cv_visit_target_imposi, cv_visit_target_vd))
-- Ver.1.9 [E_本稼動_14884] MOD END
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date IS NULL)
                      AND (lt_tmp_rep_vs_plan_tab(i).customer_status IN (cv_cust_status8, cv_cust_status9, cv_cust_status3))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) = cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor = cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      ln_route_bit
                    ELSE
                      0
                  END
                 ) tgt_vis_v_num -- 訪問計画(自販)
                ,(CASE
                    WHEN (xsvsr.vis_num > 0)
                      /* 2009.09.08 K.Satomura 0001317対応 START */
                      --AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      /* 2009.09.08 K.Satomura 0001317対応 END */
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) <> cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor <> cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      xsvsr.vis_num
                    WHEN (xsvsr.vis_num > 0)
                      /* 2009.09.08 K.Satomura 0001317対応 START */
                      --AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      /* 2009.09.08 K.Satomura 0001317対応 END */
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date IS NULL)
                      AND (lt_tmp_rep_vs_plan_tab(i).customer_status IN (cv_cust_status8, cv_cust_status9, cv_cust_status3))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) <> cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor <> cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      xsvsr.vis_num
                    ELSE
                      0
                  END
                 ) tgt_vis_i_num -- 訪問実績(一般)
                ,(CASE
                    WHEN (xsvsr.vis_num > 0)
                      /* 2009.09.08 K.Satomura 0001317対応 START */
                      --AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      /* 2009.09.08 K.Satomura 0001317対応 END */
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date <= TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) = cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor = cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      xsvsr.vis_num
                    WHEN (xsvsr.vis_num > 0)
                      /* 2009.09.08 K.Satomura 0001317対応 START */
                      --AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      /* 2009.09.08 K.Satomura 0001317対応 END */
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date IS NULL)
                      AND (lt_tmp_rep_vs_plan_tab(i).customer_status IN (cv_cust_status8, cv_cust_status9, cv_cust_status3))
                      /* 2009.09.08 K.Satomura 0001271対応 START */
                      --AND (xxcso_route_common_pkg.iscustomervendor(lt_tmp_rep_vs_plan_tab(i).business_low_type) = cv_true)
                      AND (lt_tmp_rep_vs_plan_tab(i).is_customer_vendor = cv_true)
                      /* 2009.09.08 K.Satomura 0001271対応 END */
                    THEN
                      xsvsr.vis_num
                    ELSE
                      0
                  END
                 ) rslt_vis_v_num -- 訪問実績(自販)
                ,(CASE
                    WHEN (xsvsr.vis_num > 0)
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date > TO_DATE(xsvsr.sales_date,'YYYYMMDD'))
                    THEN
                      xsvsr.vis_num
                    WHEN (xsvsr.vis_num > 0)
                      AND (lt_tmp_rep_vs_plan_tab(i).cnvs_date IS NULL)
                      AND (lt_tmp_rep_vs_plan_tab(i).customer_status IN (cv_cust_status7,cv_cust_status4,cv_cust_status5,cv_cust_status6))
                    THEN
                      xsvsr.vis_num
                    ELSE
                      0
                  END
                 ) rslt_vis_m_num -- 訪問実績(MC)
                ,(CASE
                    WHEN (xsvsr.vis_sales_num > 0)
                      /* 2009.09.08 K.Satomura 0001317対応 START */
                      --AND (lt_tmp_rep_vs_plan_tab(i).vist_target_div = '1')
                      /* 2009.09.08 K.Satomura 0001317対応 END */
                    THEN
                      xsvsr.vis_sales_num
                    ELSE
                      0
                  END
                 ) rslt_vis_e_num -- 訪問実績(有効訪問)
          INTO   lt_sales_tab(n).plan_vs_amt          -- 売上／訪問計画
                ,lt_sales_tab(n).rslt_vs_amt          -- 売上／訪問実績
                ,lt_sales_tab(n).rslt_other_sales_amt -- 売上実績（他拠点納品分）
                ,lt_visit_tab(n).visit_sign           -- 訪問記号
                ,lt_visit_tab(n).tgt_vis_i_num        -- 訪問計画(一般)
                ,lt_visit_tab(n).tgt_vis_v_num        -- 訪問計画(自販)
                ,lt_visit_tab(n).rslt_vis_i_num       -- 訪問実績(一般)
                ,lt_visit_tab(n).rslt_vis_v_num       -- 訪問実績(自販)
                ,lt_visit_tab(n).rslt_vis_m_num       -- 訪問実績(MC)
                ,lt_visit_tab(n).rslt_vis_e_num       -- 訪問実績(有効訪問)
          FROM   xxcso_sum_visit_sale_rep xsvsr
          WHERE  xsvsr.sum_org_type    = cv_sum_org_type1
          AND    xsvsr.sum_org_code    = lt_tmp_rep_vs_plan_tab(i).account_number
          AND    xsvsr.group_base_code = lt_tmp_rep_vs_plan_tab(i).sale_base_code
          AND    xsvsr.month_date_div  = cv_month_date_div2
          AND    xsvsr.sales_date      = lv_date
          ;
        EXCEPTION
          WHEN OTHERS THEN
            lt_sales_tab(n).plan_vs_amt          := 0;
            lt_sales_tab(n).rslt_vs_amt          := 0;
            lt_sales_tab(n).rslt_other_sales_amt := 0;
            lt_visit_tab(n).visit_sign           := NULL;
            lt_visit_tab(n).tgt_vis_i_num        := 0;
            lt_visit_tab(n).tgt_vis_v_num        := 0;
            lt_visit_tab(n).rslt_vis_i_num       := 0;
            lt_visit_tab(n).rslt_vis_v_num       := 0;
            lt_visit_tab(n).rslt_vis_m_num       := 0;
            lt_visit_tab(n).rslt_vis_e_num       := 0;
            --
        END;
        --
      END LOOP get_sales_visit_loop;
      --
      -- 売上訪問計画管理表顧客集計ワークテーブル作成
      INSERT INTO xxcso_tmp_rep_vs_plan(
         base_code                -- 拠点コード
        ,group_number             -- 営業グループ番号
        ,employee_number          -- 営業員コード
        ,employee_name            -- 営業員名
        ,business_high_type       -- 業態（大分類）
        ,business_high_name       -- 業態（大分類）名
        ,gvm_type                 -- 一般／自販機／ＭＣ
        ,account_number           -- 顧客コード
        ,customer_name            -- 顧客名
        ,route_no                 -- ルートNo
        ,last_year_rslt_sales_amt -- 前年実績
        ,last_mon_rslt_sales_amt  -- 先月実績
        ,new_customer_num         -- 新規顧客件数
        ,new_vendor_num           -- 新規ＶＤ件数
        ,plan_vs_amt_1            -- １日－売上／訪問計画
        ,plan_vs_amt_2            -- ２日－売上／訪問計画
        ,plan_vs_amt_3            -- ３日－売上／訪問計画
        ,plan_vs_amt_4            -- ４日－売上／訪問計画
        ,plan_vs_amt_5            -- ５日－売上／訪問計画
        ,plan_vs_amt_6            -- ６日－売上／訪問計画
        ,plan_vs_amt_7            -- ７日－売上／訪問計画
        ,plan_vs_amt_8            -- ８日－売上／訪問計画
        ,plan_vs_amt_9            -- ９日－売上／訪問計画
        ,plan_vs_amt_10           -- １０日－売上／訪問計画
        ,plan_vs_amt_11           -- １１日－売上／訪問計画
        ,plan_vs_amt_12           -- １２日－売上／訪問計画
        ,plan_vs_amt_13           -- １３日－売上／訪問計画
        ,plan_vs_amt_14           -- １４日－売上／訪問計画
        ,plan_vs_amt_15           -- １５日－売上／訪問計画
        ,plan_vs_amt_16           -- １６日－売上／訪問計画
        ,plan_vs_amt_17           -- １７日－売上／訪問計画
        ,plan_vs_amt_18           -- １８日－売上／訪問計画
        ,plan_vs_amt_19           -- １９日－売上／訪問計画
        ,plan_vs_amt_20           -- ２０日－売上／訪問計画
        ,plan_vs_amt_21           -- ２１日－売上／訪問計画
        ,plan_vs_amt_22           -- ２２日－売上／訪問計画
        ,plan_vs_amt_23           -- ２３日－売上／訪問計画
        ,plan_vs_amt_24           -- ２４日－売上／訪問計画
        ,plan_vs_amt_25           -- ２５日－売上／訪問計画
        ,plan_vs_amt_26           -- ２６日－売上／訪問計画
        ,plan_vs_amt_27           -- ２７日－売上／訪問計画
        ,plan_vs_amt_28           -- ２８日－売上／訪問計画
        ,plan_vs_amt_29           -- ２９日－売上／訪問計画
        ,plan_vs_amt_30           -- ３０日－売上／訪問計画
        ,plan_vs_amt_31           -- ３１日－売上／訪問計画
        ,rslt_vs_amt_1            -- １日－売上／訪問実績
        ,rslt_vs_amt_2            -- ２日－売上／訪問実績
        ,rslt_vs_amt_3            -- ３日－売上／訪問実績
        ,rslt_vs_amt_4            -- ４日－売上／訪問実績
        ,rslt_vs_amt_5            -- ５日－売上／訪問実績
        ,rslt_vs_amt_6            -- ６日－売上／訪問実績
        ,rslt_vs_amt_7            -- ７日－売上／訪問実績
        ,rslt_vs_amt_8            -- ８日－売上／訪問実績
        ,rslt_vs_amt_9            -- ９日－売上／訪問実績
        ,rslt_vs_amt_10           -- １０日－売上／訪問実績
        ,rslt_vs_amt_11           -- １１日－売上／訪問実績
        ,rslt_vs_amt_12           -- １２日－売上／訪問実績
        ,rslt_vs_amt_13           -- １３日－売上／訪問実績
        ,rslt_vs_amt_14           -- １４日－売上／訪問実績
        ,rslt_vs_amt_15           -- １５日－売上／訪問実績
        ,rslt_vs_amt_16           -- １６日－売上／訪問実績
        ,rslt_vs_amt_17           -- １７日－売上／訪問実績
        ,rslt_vs_amt_18           -- １８日－売上／訪問実績
        ,rslt_vs_amt_19           -- １９日－売上／訪問実績
        ,rslt_vs_amt_20           -- ２０日－売上／訪問実績
        ,rslt_vs_amt_21           -- ２１日－売上／訪問実績
        ,rslt_vs_amt_22           -- ２２日－売上／訪問実績
        ,rslt_vs_amt_23           -- ２３日－売上／訪問実績
        ,rslt_vs_amt_24           -- ２４日－売上／訪問実績
        ,rslt_vs_amt_25           -- ２５日－売上／訪問実績
        ,rslt_vs_amt_26           -- ２６日－売上／訪問実績
        ,rslt_vs_amt_27           -- ２７日－売上／訪問実績
        ,rslt_vs_amt_28           -- ２８日－売上／訪問実績
        ,rslt_vs_amt_29           -- ２９日－売上／訪問実績
        ,rslt_vs_amt_30           -- ３０日－売上／訪問実績
        ,rslt_vs_amt_31           -- ３１日－売上／訪問実績
        ,rslt_other_sales_amt_1   -- １日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_2   -- ２日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_3   -- ３日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_4   -- ４日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_5   -- ５日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_6   -- ６日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_7   -- ７日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_8   -- ８日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_9   -- ９日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_10  -- １０日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_11  -- １１日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_12  -- １２日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_13  -- １３日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_14  -- １４日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_15  -- １５日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_16  -- １６日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_17  -- １７日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_18  -- １８日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_19  -- １９日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_20  -- ２０日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_21  -- ２１日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_22  -- ２２日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_23  -- ２３日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_24  -- ２４日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_25  -- ２５日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_26  -- ２６日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_27  -- ２７日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_28  -- ２８日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_29  -- ２９日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_30  -- ３０日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_31  -- ３１日－売上実績（他拠点納品分）
        ,visit_sign_1             -- １日－訪問記号
        ,visit_sign_2             -- ２日－訪問記号
        ,visit_sign_3             -- ３日－訪問記号
        ,visit_sign_4             -- ４日－訪問記号
        ,visit_sign_5             -- ５日－訪問記号
        ,visit_sign_6             -- ６日－訪問記号
        ,visit_sign_7             -- ７日－訪問記号
        ,visit_sign_8             -- ８日－訪問記号
        ,visit_sign_9             -- ９日－訪問記号
        ,visit_sign_10            -- １０日－訪問記号
        ,visit_sign_11            -- １１日－訪問記号
        ,visit_sign_12            -- １２日－訪問記号
        ,visit_sign_13            -- １３日－訪問記号
        ,visit_sign_14            -- １４日－訪問記号
        ,visit_sign_15            -- １５日－訪問記号
        ,visit_sign_16            -- １６日－訪問記号
        ,visit_sign_17            -- １７日－訪問記号
        ,visit_sign_18            -- １８日－訪問記号
        ,visit_sign_19            -- １９日－訪問記号
        ,visit_sign_20            -- ２０日－訪問記号
        ,visit_sign_21            -- ２１日－訪問記号
        ,visit_sign_22            -- ２２日－訪問記号
        ,visit_sign_23            -- ２３日－訪問記号
        ,visit_sign_24            -- ２４日－訪問記号
        ,visit_sign_25            -- ２５日－訪問記号
        ,visit_sign_26            -- ２６日－訪問記号
        ,visit_sign_27            -- ２７日－訪問記号
        ,visit_sign_28            -- ２８日－訪問記号
        ,visit_sign_29            -- ２９日－訪問記号
        ,visit_sign_30            -- ３０日－訪問記号
        ,visit_sign_31            -- ３１日－訪問記号
        ,tgt_vis_i_num_1          -- １日－訪問計画(一般)
        ,tgt_vis_i_num_2          -- ２日－訪問計画(一般)
        ,tgt_vis_i_num_3          -- ３日－訪問計画(一般)
        ,tgt_vis_i_num_4          -- ４日－訪問計画(一般)
        ,tgt_vis_i_num_5          -- ５日－訪問計画(一般)
        ,tgt_vis_i_num_6          -- ６日－訪問計画(一般)
        ,tgt_vis_i_num_7          -- ７日－訪問計画(一般)
        ,tgt_vis_i_num_8          -- ８日－訪問計画(一般)
        ,tgt_vis_i_num_9          -- ９日－訪問計画(一般)
        ,tgt_vis_i_num_10         -- １０日－訪問計画(一般)
        ,tgt_vis_i_num_11         -- １１日－訪問計画(一般)
        ,tgt_vis_i_num_12         -- １２日－訪問計画(一般)
        ,tgt_vis_i_num_13         -- １３日－訪問計画(一般)
        ,tgt_vis_i_num_14         -- １４日－訪問計画(一般)
        ,tgt_vis_i_num_15         -- １５日－訪問計画(一般)
        ,tgt_vis_i_num_16         -- １６日－訪問計画(一般)
        ,tgt_vis_i_num_17         -- １７日－訪問計画(一般)
        ,tgt_vis_i_num_18         -- １８日－訪問計画(一般)
        ,tgt_vis_i_num_19         -- １９日－訪問計画(一般)
        ,tgt_vis_i_num_20         -- ２０日－訪問計画(一般)
        ,tgt_vis_i_num_21         -- ２１日－訪問計画(一般)
        ,tgt_vis_i_num_22         -- ２２日－訪問計画(一般)
        ,tgt_vis_i_num_23         -- ２３日－訪問計画(一般)
        ,tgt_vis_i_num_24         -- ２４日－訪問計画(一般)
        ,tgt_vis_i_num_25         -- ２５日－訪問計画(一般)
        ,tgt_vis_i_num_26         -- ２６日－訪問計画(一般)
        ,tgt_vis_i_num_27         -- ２７日－訪問計画(一般)
        ,tgt_vis_i_num_28         -- ２８日－訪問計画(一般)
        ,tgt_vis_i_num_29         -- ２９日－訪問計画(一般)
        ,tgt_vis_i_num_30         -- ３０日－訪問計画(一般)
        ,tgt_vis_i_num_31         -- ３１日－訪問計画(一般)
        ,tgt_vis_v_num_1          -- １日－訪問計画(自販)
        ,tgt_vis_v_num_2          -- ２日－訪問計画(自販)
        ,tgt_vis_v_num_3          -- ３日－訪問計画(自販)
        ,tgt_vis_v_num_4          -- ４日－訪問計画(自販)
        ,tgt_vis_v_num_5          -- ５日－訪問計画(自販)
        ,tgt_vis_v_num_6          -- ６日－訪問計画(自販)
        ,tgt_vis_v_num_7          -- ７日－訪問計画(自販)
        ,tgt_vis_v_num_8          -- ８日－訪問計画(自販)
        ,tgt_vis_v_num_9          -- ９日－訪問計画(自販)
        ,tgt_vis_v_num_10         -- １０日－訪問計画(自販)
        ,tgt_vis_v_num_11         -- １１日－訪問計画(自販)
        ,tgt_vis_v_num_12         -- １２日－訪問計画(自販)
        ,tgt_vis_v_num_13         -- １３日－訪問計画(自販)
        ,tgt_vis_v_num_14         -- １４日－訪問計画(自販)
        ,tgt_vis_v_num_15         -- １５日－訪問計画(自販)
        ,tgt_vis_v_num_16         -- １６日－訪問計画(自販)
        ,tgt_vis_v_num_17         -- １７日－訪問計画(自販)
        ,tgt_vis_v_num_18         -- １８日－訪問計画(自販)
        ,tgt_vis_v_num_19         -- １９日－訪問計画(自販)
        ,tgt_vis_v_num_20         -- ２０日－訪問計画(自販)
        ,tgt_vis_v_num_21         -- ２１日－訪問計画(自販)
        ,tgt_vis_v_num_22         -- ２２日－訪問計画(自販)
        ,tgt_vis_v_num_23         -- ２３日－訪問計画(自販)
        ,tgt_vis_v_num_24         -- ２４日－訪問計画(自販)
        ,tgt_vis_v_num_25         -- ２５日－訪問計画(自販)
        ,tgt_vis_v_num_26         -- ２６日－訪問計画(自販)
        ,tgt_vis_v_num_27         -- ２７日－訪問計画(自販)
        ,tgt_vis_v_num_28         -- ２８日－訪問計画(自販)
        ,tgt_vis_v_num_29         -- ２９日－訪問計画(自販)
        ,tgt_vis_v_num_30         -- ３０日－訪問計画(自販)
        ,tgt_vis_v_num_31         -- ３１日－訪問計画(自販)
        ,rslt_vis_i_num_1         -- １日－訪問実績(一般)
        ,rslt_vis_i_num_2         -- ２日－訪問実績(一般)
        ,rslt_vis_i_num_3         -- ３日－訪問実績(一般)
        ,rslt_vis_i_num_4         -- ４日－訪問実績(一般)
        ,rslt_vis_i_num_5         -- ５日－訪問実績(一般)
        ,rslt_vis_i_num_6         -- ６日－訪問実績(一般)
        ,rslt_vis_i_num_7         -- ７日－訪問実績(一般)
        ,rslt_vis_i_num_8         -- ８日－訪問実績(一般)
        ,rslt_vis_i_num_9         -- ９日－訪問実績(一般)
        ,rslt_vis_i_num_10        -- １０日－訪問実績(一般)
        ,rslt_vis_i_num_11        -- １１日－訪問実績(一般)
        ,rslt_vis_i_num_12        -- １２日－訪問実績(一般)
        ,rslt_vis_i_num_13        -- １３日－訪問実績(一般)
        ,rslt_vis_i_num_14        -- １４日－訪問実績(一般)
        ,rslt_vis_i_num_15        -- １５日－訪問実績(一般)
        ,rslt_vis_i_num_16        -- １６日－訪問実績(一般)
        ,rslt_vis_i_num_17        -- １７日－訪問実績(一般)
        ,rslt_vis_i_num_18        -- １８日－訪問実績(一般)
        ,rslt_vis_i_num_19        -- １９日－訪問実績(一般)
        ,rslt_vis_i_num_20        -- ２０日－訪問実績(一般)
        ,rslt_vis_i_num_21        -- ２１日－訪問実績(一般)
        ,rslt_vis_i_num_22        -- ２２日－訪問実績(一般)
        ,rslt_vis_i_num_23        -- ２３日－訪問実績(一般)
        ,rslt_vis_i_num_24        -- ２４日－訪問実績(一般)
        ,rslt_vis_i_num_25        -- ２５日－訪問実績(一般)
        ,rslt_vis_i_num_26        -- ２６日－訪問実績(一般)
        ,rslt_vis_i_num_27        -- ２７日－訪問実績(一般)
        ,rslt_vis_i_num_28        -- ２８日－訪問実績(一般)
        ,rslt_vis_i_num_29        -- ２９日－訪問実績(一般)
        ,rslt_vis_i_num_30        -- ３０日－訪問実績(一般)
        ,rslt_vis_i_num_31        -- ３１日－訪問実績(一般)
        ,rslt_vis_v_num_1         -- １日－訪問実績(自販)
        ,rslt_vis_v_num_2         -- ２日－訪問実績(自販)
        ,rslt_vis_v_num_3         -- ３日－訪問実績(自販)
        ,rslt_vis_v_num_4         -- ４日－訪問実績(自販)
        ,rslt_vis_v_num_5         -- ５日－訪問実績(自販)
        ,rslt_vis_v_num_6         -- ６日－訪問実績(自販)
        ,rslt_vis_v_num_7         -- ７日－訪問実績(自販)
        ,rslt_vis_v_num_8         -- ８日－訪問実績(自販)
        ,rslt_vis_v_num_9         -- ９日－訪問実績(自販)
        ,rslt_vis_v_num_10        -- １０日－訪問実績(自販)
        ,rslt_vis_v_num_11        -- １１日－訪問実績(自販)
        ,rslt_vis_v_num_12        -- １２日－訪問実績(自販)
        ,rslt_vis_v_num_13        -- １３日－訪問実績(自販)
        ,rslt_vis_v_num_14        -- １４日－訪問実績(自販)
        ,rslt_vis_v_num_15        -- １５日－訪問実績(自販)
        ,rslt_vis_v_num_16        -- １６日－訪問実績(自販)
        ,rslt_vis_v_num_17        -- １７日－訪問実績(自販)
        ,rslt_vis_v_num_18        -- １８日－訪問実績(自販)
        ,rslt_vis_v_num_19        -- １９日－訪問実績(自販)
        ,rslt_vis_v_num_20        -- ２０日－訪問実績(自販)
        ,rslt_vis_v_num_21        -- ２１日－訪問実績(自販)
        ,rslt_vis_v_num_22        -- ２２日－訪問実績(自販)
        ,rslt_vis_v_num_23        -- ２３日－訪問実績(自販)
        ,rslt_vis_v_num_24        -- ２４日－訪問実績(自販)
        ,rslt_vis_v_num_25        -- ２５日－訪問実績(自販)
        ,rslt_vis_v_num_26        -- ２６日－訪問実績(自販)
        ,rslt_vis_v_num_27        -- ２７日－訪問実績(自販)
        ,rslt_vis_v_num_28        -- ２８日－訪問実績(自販)
        ,rslt_vis_v_num_29        -- ２９日－訪問実績(自販)
        ,rslt_vis_v_num_30        -- ３０日－訪問実績(自販)
        ,rslt_vis_v_num_31        -- ３１日－訪問実績(自販)
        ,rslt_vis_m_num_1         -- １日－訪問実績(MC)
        ,rslt_vis_m_num_2         -- ２日－訪問実績(MC)
        ,rslt_vis_m_num_3         -- ３日－訪問実績(MC)
        ,rslt_vis_m_num_4         -- ４日－訪問実績(MC)
        ,rslt_vis_m_num_5         -- ５日－訪問実績(MC)
        ,rslt_vis_m_num_6         -- ６日－訪問実績(MC)
        ,rslt_vis_m_num_7         -- ７日－訪問実績(MC)
        ,rslt_vis_m_num_8         -- ８日－訪問実績(MC)
        ,rslt_vis_m_num_9         -- ９日－訪問実績(MC)
        ,rslt_vis_m_num_10        -- １０日－訪問実績(MC)
        ,rslt_vis_m_num_11        -- １１日－訪問実績(MC)
        ,rslt_vis_m_num_12        -- １２日－訪問実績(MC)
        ,rslt_vis_m_num_13        -- １３日－訪問実績(MC)
        ,rslt_vis_m_num_14        -- １４日－訪問実績(MC)
        ,rslt_vis_m_num_15        -- １５日－訪問実績(MC)
        ,rslt_vis_m_num_16        -- １６日－訪問実績(MC)
        ,rslt_vis_m_num_17        -- １７日－訪問実績(MC)
        ,rslt_vis_m_num_18        -- １８日－訪問実績(MC)
        ,rslt_vis_m_num_19        -- １９日－訪問実績(MC)
        ,rslt_vis_m_num_20        -- ２０日－訪問実績(MC)
        ,rslt_vis_m_num_21        -- ２１日－訪問実績(MC)
        ,rslt_vis_m_num_22        -- ２２日－訪問実績(MC)
        ,rslt_vis_m_num_23        -- ２３日－訪問実績(MC)
        ,rslt_vis_m_num_24        -- ２４日－訪問実績(MC)
        ,rslt_vis_m_num_25        -- ２５日－訪問実績(MC)
        ,rslt_vis_m_num_26        -- ２６日－訪問実績(MC)
        ,rslt_vis_m_num_27        -- ２７日－訪問実績(MC)
        ,rslt_vis_m_num_28        -- ２８日－訪問実績(MC)
        ,rslt_vis_m_num_29        -- ２９日－訪問実績(MC)
        ,rslt_vis_m_num_30        -- ３０日－訪問実績(MC)
        ,rslt_vis_m_num_31        -- ３１日－訪問実績(MC)
        ,rslt_vis_e_num_1         -- １日－訪問実績(有効訪問)
        ,rslt_vis_e_num_2         -- ２日－訪問実績(有効訪問)
        ,rslt_vis_e_num_3         -- ３日－訪問実績(有効訪問)
        ,rslt_vis_e_num_4         -- ４日－訪問実績(有効訪問)
        ,rslt_vis_e_num_5         -- ５日－訪問実績(有効訪問)
        ,rslt_vis_e_num_6         -- ６日－訪問実績(有効訪問)
        ,rslt_vis_e_num_7         -- ７日－訪問実績(有効訪問)
        ,rslt_vis_e_num_8         -- ８日－訪問実績(有効訪問)
        ,rslt_vis_e_num_9         -- ９日－訪問実績(有効訪問)
        ,rslt_vis_e_num_10        -- １０日－訪問実績(有効訪問)
        ,rslt_vis_e_num_11        -- １１日－訪問実績(有効訪問)
        ,rslt_vis_e_num_12        -- １２日－訪問実績(有効訪問)
        ,rslt_vis_e_num_13        -- １３日－訪問実績(有効訪問)
        ,rslt_vis_e_num_14        -- １４日－訪問実績(有効訪問)
        ,rslt_vis_e_num_15        -- １５日－訪問実績(有効訪問)
        ,rslt_vis_e_num_16        -- １６日－訪問実績(有効訪問)
        ,rslt_vis_e_num_17        -- １７日－訪問実績(有効訪問)
        ,rslt_vis_e_num_18        -- １８日－訪問実績(有効訪問)
        ,rslt_vis_e_num_19        -- １９日－訪問実績(有効訪問)
        ,rslt_vis_e_num_20        -- ２０日－訪問実績(有効訪問)
        ,rslt_vis_e_num_21        -- ２１日－訪問実績(有効訪問)
        ,rslt_vis_e_num_22        -- ２２日－訪問実績(有効訪問)
        ,rslt_vis_e_num_23        -- ２３日－訪問実績(有効訪問)
        ,rslt_vis_e_num_24        -- ２４日－訪問実績(有効訪問)
        ,rslt_vis_e_num_25        -- ２５日－訪問実績(有効訪問)
        ,rslt_vis_e_num_26        -- ２６日－訪問実績(有効訪問)
        ,rslt_vis_e_num_27        -- ２７日－訪問実績(有効訪問)
        ,rslt_vis_e_num_28        -- ２８日－訪問実績(有効訪問)
        ,rslt_vis_e_num_29        -- ２９日－訪問実績(有効訪問)
        ,rslt_vis_e_num_30        -- ３０日－訪問実績(有効訪問)
        ,rslt_vis_e_num_31        -- ３１日－訪問実績(有効訪問)
        ,created_by               -- 作成者
        ,creation_date            -- 作成日
        ,last_updated_by          -- 最終更新者
        ,last_update_date         -- 最終更新日
        ,last_update_login        -- 最終更新ログイン
        ,request_id               -- 要求ID
        ,program_application_id   -- コンカレント・プログラム・アプリケーションID
        ,program_id               -- コンカレント・プログラムID
        ,program_update_date      -- プログラム更新日
      )
      VALUES (
         lt_tmp_rep_vs_plan_tab(i).base_code           -- 拠点コード
        ,lt_tmp_rep_vs_plan_tab(i).group_number        -- 営業グループ番号
        ,lt_tmp_rep_vs_plan_tab(i).employee_number     -- 営業員コード
        ,lt_tmp_rep_vs_plan_tab(i).employee_name       -- 営業員名
        ,lt_lookup_tab(i).lookup_code                  -- 業態（大分類）
        ,lt_lookup_tab(i).meaning                      -- 業態（大分類）名
        ,lt_tmp_rep_vs_plan_tab(i).gvm_type            -- 一般／自販機／ＭＣ
        ,lt_tmp_rep_vs_plan_tab(i).account_number      -- 顧客コード
        ,lt_tmp_rep_vs_plan_tab(i).customer_name       -- 顧客名
        ,lt_tmp_rep_vs_plan_tab(i).route_number        -- ルートNo
        ,lt_result_amt_tab(i).last_year_rslt_sales_amt -- 前年実績
        ,lt_result_amt_tab(i).last_mon_rslt_sales_amt  -- 先月実績
        ,lt_tmp_rep_vs_plan_tab(i).new_customer_num    -- 新規顧客件数
        ,lt_tmp_rep_vs_plan_tab(i).new_vendor_num      -- 新規ＶＤ件数
        ,lt_sales_tab(1).plan_vs_amt                   -- １日－売上／訪問計画
        ,lt_sales_tab(2).plan_vs_amt                   -- ２日－売上／訪問計画
        ,lt_sales_tab(3).plan_vs_amt                   -- ３日－売上／訪問計画
        ,lt_sales_tab(4).plan_vs_amt                   -- ４日－売上／訪問計画
        ,lt_sales_tab(5).plan_vs_amt                   -- ５日－売上／訪問計画
        ,lt_sales_tab(6).plan_vs_amt                   -- ６日－売上／訪問計画
        ,lt_sales_tab(7).plan_vs_amt                   -- ７日－売上／訪問計画
        ,lt_sales_tab(8).plan_vs_amt                   -- ８日－売上／訪問計画
        ,lt_sales_tab(9).plan_vs_amt                   -- ９日－売上／訪問計画
        ,lt_sales_tab(10).plan_vs_amt                  -- １０日－売上／訪問計画
        ,lt_sales_tab(11).plan_vs_amt                  -- １１日－売上／訪問計画
        ,lt_sales_tab(12).plan_vs_amt                  -- １２日－売上／訪問計画
        ,lt_sales_tab(13).plan_vs_amt                  -- １３日－売上／訪問計画
        ,lt_sales_tab(14).plan_vs_amt                  -- １４日－売上／訪問計画
        ,lt_sales_tab(15).plan_vs_amt                  -- １５日－売上／訪問計画
        ,lt_sales_tab(16).plan_vs_amt                  -- １６日－売上／訪問計画
        ,lt_sales_tab(17).plan_vs_amt                  -- １７日－売上／訪問計画
        ,lt_sales_tab(18).plan_vs_amt                  -- １８日－売上／訪問計画
        ,lt_sales_tab(19).plan_vs_amt                  -- １９日－売上／訪問計画
        ,lt_sales_tab(20).plan_vs_amt                  -- ２０日－売上／訪問計画
        ,lt_sales_tab(21).plan_vs_amt                  -- ２１日－売上／訪問計画
        ,lt_sales_tab(22).plan_vs_amt                  -- ２２日－売上／訪問計画
        ,lt_sales_tab(23).plan_vs_amt                  -- ２３日－売上／訪問計画
        ,lt_sales_tab(24).plan_vs_amt                  -- ２４日－売上／訪問計画
        ,lt_sales_tab(25).plan_vs_amt                  -- ２５日－売上／訪問計画
        ,lt_sales_tab(26).plan_vs_amt                  -- ２６日－売上／訪問計画
        ,lt_sales_tab(27).plan_vs_amt                  -- ２７日－売上／訪問計画
        ,lt_sales_tab(28).plan_vs_amt                  -- ２８日－売上／訪問計画
        ,lt_sales_tab(29).plan_vs_amt                  -- ２９日－売上／訪問計画
        ,lt_sales_tab(30).plan_vs_amt                  -- ３０日－売上／訪問計画
        ,lt_sales_tab(31).plan_vs_amt                  -- ３１日－売上／訪問計画
        ,lt_sales_tab(1).rslt_vs_amt                   -- １日－売上／訪問実績
        ,lt_sales_tab(2).rslt_vs_amt                   -- ２日－売上／訪問実績
        ,lt_sales_tab(3).rslt_vs_amt                   -- ３日－売上／訪問実績
        ,lt_sales_tab(4).rslt_vs_amt                   -- ４日－売上／訪問実績
        ,lt_sales_tab(5).rslt_vs_amt                   -- ５日－売上／訪問実績
        ,lt_sales_tab(6).rslt_vs_amt                   -- ６日－売上／訪問実績
        ,lt_sales_tab(7).rslt_vs_amt                   -- ７日－売上／訪問実績
        ,lt_sales_tab(8).rslt_vs_amt                   -- ８日－売上／訪問実績
        ,lt_sales_tab(9).rslt_vs_amt                   -- ９日－売上／訪問実績
        ,lt_sales_tab(10).rslt_vs_amt                  -- １０日－売上／訪問実績
        ,lt_sales_tab(11).rslt_vs_amt                  -- １１日－売上／訪問実績
        ,lt_sales_tab(12).rslt_vs_amt                  -- １２日－売上／訪問実績
        ,lt_sales_tab(13).rslt_vs_amt                  -- １３日－売上／訪問実績
        ,lt_sales_tab(14).rslt_vs_amt                  -- １４日－売上／訪問実績
        ,lt_sales_tab(15).rslt_vs_amt                  -- １５日－売上／訪問実績
        ,lt_sales_tab(16).rslt_vs_amt                  -- １６日－売上／訪問実績
        ,lt_sales_tab(17).rslt_vs_amt                  -- １７日－売上／訪問実績
        ,lt_sales_tab(18).rslt_vs_amt                  -- １８日－売上／訪問実績
        ,lt_sales_tab(19).rslt_vs_amt                  -- １９日－売上／訪問実績
        ,lt_sales_tab(20).rslt_vs_amt                  -- ２０日－売上／訪問実績
        ,lt_sales_tab(21).rslt_vs_amt                  -- ２１日－売上／訪問実績
        ,lt_sales_tab(22).rslt_vs_amt                  -- ２２日－売上／訪問実績
        ,lt_sales_tab(23).rslt_vs_amt                  -- ２３日－売上／訪問実績
        ,lt_sales_tab(24).rslt_vs_amt                  -- ２４日－売上／訪問実績
        ,lt_sales_tab(25).rslt_vs_amt                  -- ２５日－売上／訪問実績
        ,lt_sales_tab(26).rslt_vs_amt                  -- ２６日－売上／訪問実績
        ,lt_sales_tab(27).rslt_vs_amt                  -- ２７日－売上／訪問実績
        ,lt_sales_tab(28).rslt_vs_amt                  -- ２８日－売上／訪問実績
        ,lt_sales_tab(29).rslt_vs_amt                  -- ２９日－売上／訪問実績
        ,lt_sales_tab(30).rslt_vs_amt                  -- ３０日－売上／訪問実績
        ,lt_sales_tab(31).rslt_vs_amt                  -- ３１日－売上／訪問実績
        ,lt_sales_tab(1).rslt_other_sales_amt          -- １日－売上実績（他拠点納品分）
        ,lt_sales_tab(2).rslt_other_sales_amt          -- ２日－売上実績（他拠点納品分）
        ,lt_sales_tab(3).rslt_other_sales_amt          -- ３日－売上実績（他拠点納品分）
        ,lt_sales_tab(4).rslt_other_sales_amt          -- ４日－売上実績（他拠点納品分）
        ,lt_sales_tab(5).rslt_other_sales_amt          -- ５日－売上実績（他拠点納品分）
        ,lt_sales_tab(6).rslt_other_sales_amt          -- ６日－売上実績（他拠点納品分）
        ,lt_sales_tab(7).rslt_other_sales_amt          -- ７日－売上実績（他拠点納品分）
        ,lt_sales_tab(8).rslt_other_sales_amt          -- ８日－売上実績（他拠点納品分）
        ,lt_sales_tab(9).rslt_other_sales_amt          -- ９日－売上実績（他拠点納品分）
        ,lt_sales_tab(10).rslt_other_sales_amt         -- １０日－売上実績（他拠点納品分）
        ,lt_sales_tab(11).rslt_other_sales_amt         -- １１日－売上実績（他拠点納品分）
        ,lt_sales_tab(12).rslt_other_sales_amt         -- １２日－売上実績（他拠点納品分）
        ,lt_sales_tab(13).rslt_other_sales_amt         -- １３日－売上実績（他拠点納品分）
        ,lt_sales_tab(14).rslt_other_sales_amt         -- １４日－売上実績（他拠点納品分）
        ,lt_sales_tab(15).rslt_other_sales_amt         -- １５日－売上実績（他拠点納品分）
        ,lt_sales_tab(16).rslt_other_sales_amt         -- １６日－売上実績（他拠点納品分）
        ,lt_sales_tab(17).rslt_other_sales_amt         -- １７日－売上実績（他拠点納品分）
        ,lt_sales_tab(18).rslt_other_sales_amt         -- １８日－売上実績（他拠点納品分）
        ,lt_sales_tab(19).rslt_other_sales_amt         -- １９日－売上実績（他拠点納品分）
        ,lt_sales_tab(20).rslt_other_sales_amt         -- ２０日－売上実績（他拠点納品分）
        ,lt_sales_tab(21).rslt_other_sales_amt         -- ２１日－売上実績（他拠点納品分）
        ,lt_sales_tab(22).rslt_other_sales_amt         -- ２２日－売上実績（他拠点納品分）
        ,lt_sales_tab(23).rslt_other_sales_amt         -- ２３日－売上実績（他拠点納品分）
        ,lt_sales_tab(24).rslt_other_sales_amt         -- ２４日－売上実績（他拠点納品分）
        ,lt_sales_tab(25).rslt_other_sales_amt         -- ２５日－売上実績（他拠点納品分）
        ,lt_sales_tab(26).rslt_other_sales_amt         -- ２６日－売上実績（他拠点納品分）
        ,lt_sales_tab(27).rslt_other_sales_amt         -- ２７日－売上実績（他拠点納品分）
        ,lt_sales_tab(28).rslt_other_sales_amt         -- ２８日－売上実績（他拠点納品分）
        ,lt_sales_tab(29).rslt_other_sales_amt         -- ２９日－売上実績（他拠点納品分）
        ,lt_sales_tab(30).rslt_other_sales_amt         -- ３０日－売上実績（他拠点納品分）
        ,lt_sales_tab(31).rslt_other_sales_amt         -- ３１日－売上実績（他拠点納品分）
        ,lt_visit_tab(1).visit_sign                    -- １日－訪問記号
        ,lt_visit_tab(2).visit_sign                    -- ２日－訪問記号
        ,lt_visit_tab(3).visit_sign                    -- ３日－訪問記号
        ,lt_visit_tab(4).visit_sign                    -- ４日－訪問記号
        ,lt_visit_tab(5).visit_sign                    -- ５日－訪問記号
        ,lt_visit_tab(6).visit_sign                    -- ６日－訪問記号
        ,lt_visit_tab(7).visit_sign                    -- ７日－訪問記号
        ,lt_visit_tab(8).visit_sign                    -- ８日－訪問記号
        ,lt_visit_tab(9).visit_sign                    -- ９日－訪問記号
        ,lt_visit_tab(10).visit_sign                   -- １０日－訪問記号
        ,lt_visit_tab(11).visit_sign                   -- １１日－訪問記号
        ,lt_visit_tab(12).visit_sign                   -- １２日－訪問記号
        ,lt_visit_tab(13).visit_sign                   -- １３日－訪問記号
        ,lt_visit_tab(14).visit_sign                   -- １４日－訪問記号
        ,lt_visit_tab(15).visit_sign                   -- １５日－訪問記号
        ,lt_visit_tab(16).visit_sign                   -- １６日－訪問記号
        ,lt_visit_tab(17).visit_sign                   -- １７日－訪問記号
        ,lt_visit_tab(18).visit_sign                   -- １８日－訪問記号
        ,lt_visit_tab(19).visit_sign                   -- １９日－訪問記号
        ,lt_visit_tab(20).visit_sign                   -- ２０日－訪問記号
        ,lt_visit_tab(21).visit_sign                   -- ２１日－訪問記号
        ,lt_visit_tab(22).visit_sign                   -- ２２日－訪問記号
        ,lt_visit_tab(23).visit_sign                   -- ２３日－訪問記号
        ,lt_visit_tab(24).visit_sign                   -- ２４日－訪問記号
        ,lt_visit_tab(25).visit_sign                   -- ２５日－訪問記号
        ,lt_visit_tab(26).visit_sign                   -- ２６日－訪問記号
        ,lt_visit_tab(27).visit_sign                   -- ２７日－訪問記号
        ,lt_visit_tab(28).visit_sign                   -- ２８日－訪問記号
        ,lt_visit_tab(29).visit_sign                   -- ２９日－訪問記号
        ,lt_visit_tab(30).visit_sign                   -- ３０日－訪問記号
        ,lt_visit_tab(31).visit_sign                   -- ３１日－訪問記号
        ,lt_visit_tab(1).tgt_vis_i_num                 -- １日－訪問計画(一般)
        ,lt_visit_tab(2).tgt_vis_i_num                 -- ２日－訪問計画(一般)
        ,lt_visit_tab(3).tgt_vis_i_num                 -- ３日－訪問計画(一般)
        ,lt_visit_tab(4).tgt_vis_i_num                 -- ４日－訪問計画(一般)
        ,lt_visit_tab(5).tgt_vis_i_num                 -- ５日－訪問計画(一般)
        ,lt_visit_tab(6).tgt_vis_i_num                 -- ６日－訪問計画(一般)
        ,lt_visit_tab(7).tgt_vis_i_num                 -- ７日－訪問計画(一般)
        ,lt_visit_tab(8).tgt_vis_i_num                 -- ８日－訪問計画(一般)
        ,lt_visit_tab(9).tgt_vis_i_num                 -- ９日－訪問計画(一般)
        ,lt_visit_tab(10).tgt_vis_i_num                -- １０日－訪問計画(一般)
        ,lt_visit_tab(11).tgt_vis_i_num                -- １１日－訪問計画(一般)
        ,lt_visit_tab(12).tgt_vis_i_num                -- １２日－訪問計画(一般)
        ,lt_visit_tab(13).tgt_vis_i_num                -- １３日－訪問計画(一般)
        ,lt_visit_tab(14).tgt_vis_i_num                -- １４日－訪問計画(一般)
        ,lt_visit_tab(15).tgt_vis_i_num                -- １５日－訪問計画(一般)
        ,lt_visit_tab(16).tgt_vis_i_num                -- １６日－訪問計画(一般)
        ,lt_visit_tab(17).tgt_vis_i_num                -- １７日－訪問計画(一般)
        ,lt_visit_tab(18).tgt_vis_i_num                -- １８日－訪問計画(一般)
        ,lt_visit_tab(19).tgt_vis_i_num                -- １９日－訪問計画(一般)
        ,lt_visit_tab(20).tgt_vis_i_num                -- ２０日－訪問計画(一般)
        ,lt_visit_tab(21).tgt_vis_i_num                -- ２１日－訪問計画(一般)
        ,lt_visit_tab(22).tgt_vis_i_num                -- ２２日－訪問計画(一般)
        ,lt_visit_tab(23).tgt_vis_i_num                -- ２３日－訪問計画(一般)
        ,lt_visit_tab(24).tgt_vis_i_num                -- ２４日－訪問計画(一般)
        ,lt_visit_tab(25).tgt_vis_i_num                -- ２５日－訪問計画(一般)
        ,lt_visit_tab(26).tgt_vis_i_num                -- ２６日－訪問計画(一般)
        ,lt_visit_tab(27).tgt_vis_i_num                -- ２７日－訪問計画(一般)
        ,lt_visit_tab(28).tgt_vis_i_num                -- ２８日－訪問計画(一般)
        ,lt_visit_tab(29).tgt_vis_i_num                -- ２９日－訪問計画(一般)
        ,lt_visit_tab(30).tgt_vis_i_num                -- ３０日－訪問計画(一般)
        ,lt_visit_tab(31).tgt_vis_i_num                -- ３１日－訪問計画(一般)
        ,lt_visit_tab(1).tgt_vis_v_num                 -- １日－訪問計画(自販)
        ,lt_visit_tab(2).tgt_vis_v_num                 -- ２日－訪問計画(自販)
        ,lt_visit_tab(3).tgt_vis_v_num                 -- ３日－訪問計画(自販)
        ,lt_visit_tab(4).tgt_vis_v_num                 -- ４日－訪問計画(自販)
        ,lt_visit_tab(5).tgt_vis_v_num                 -- ５日－訪問計画(自販)
        ,lt_visit_tab(6).tgt_vis_v_num                 -- ６日－訪問計画(自販)
        ,lt_visit_tab(7).tgt_vis_v_num                 -- ７日－訪問計画(自販)
        ,lt_visit_tab(8).tgt_vis_v_num                 -- ８日－訪問計画(自販)
        ,lt_visit_tab(9).tgt_vis_v_num                 -- ９日－訪問計画(自販)
        ,lt_visit_tab(10).tgt_vis_v_num                -- １０日－訪問計画(自販)
        ,lt_visit_tab(11).tgt_vis_v_num                -- １１日－訪問計画(自販)
        ,lt_visit_tab(12).tgt_vis_v_num                -- １２日－訪問計画(自販)
        ,lt_visit_tab(13).tgt_vis_v_num                -- １３日－訪問計画(自販)
        ,lt_visit_tab(14).tgt_vis_v_num                -- １４日－訪問計画(自販)
        ,lt_visit_tab(15).tgt_vis_v_num                -- １５日－訪問計画(自販)
        ,lt_visit_tab(16).tgt_vis_v_num                -- １６日－訪問計画(自販)
        ,lt_visit_tab(17).tgt_vis_v_num                -- １７日－訪問計画(自販)
        ,lt_visit_tab(18).tgt_vis_v_num                -- １８日－訪問計画(自販)
        ,lt_visit_tab(19).tgt_vis_v_num                -- １９日－訪問計画(自販)
        ,lt_visit_tab(20).tgt_vis_v_num                -- ２０日－訪問計画(自販)
        ,lt_visit_tab(21).tgt_vis_v_num                -- ２１日－訪問計画(自販)
        ,lt_visit_tab(22).tgt_vis_v_num                -- ２２日－訪問計画(自販)
        ,lt_visit_tab(23).tgt_vis_v_num                -- ２３日－訪問計画(自販)
        ,lt_visit_tab(24).tgt_vis_v_num                -- ２４日－訪問計画(自販)
        ,lt_visit_tab(25).tgt_vis_v_num                -- ２５日－訪問計画(自販)
        ,lt_visit_tab(26).tgt_vis_v_num                -- ２６日－訪問計画(自販)
        ,lt_visit_tab(27).tgt_vis_v_num                -- ２７日－訪問計画(自販)
        ,lt_visit_tab(28).tgt_vis_v_num                -- ２８日－訪問計画(自販)
        ,lt_visit_tab(29).tgt_vis_v_num                -- ２９日－訪問計画(自販)
        ,lt_visit_tab(30).tgt_vis_v_num                -- ３０日－訪問計画(自販)
        ,lt_visit_tab(31).tgt_vis_v_num                -- ３１日－訪問計画(自販)
        ,lt_visit_tab(1).rslt_vis_i_num                -- １日－訪問実績(一般)
        ,lt_visit_tab(2).rslt_vis_i_num                -- ２日－訪問実績(一般)
        ,lt_visit_tab(3).rslt_vis_i_num                -- ３日－訪問実績(一般)
        ,lt_visit_tab(4).rslt_vis_i_num                -- ４日－訪問実績(一般)
        ,lt_visit_tab(5).rslt_vis_i_num                -- ５日－訪問実績(一般)
        ,lt_visit_tab(6).rslt_vis_i_num                -- ６日－訪問実績(一般)
        ,lt_visit_tab(7).rslt_vis_i_num                -- ７日－訪問実績(一般)
        ,lt_visit_tab(8).rslt_vis_i_num                -- ８日－訪問実績(一般)
        ,lt_visit_tab(9).rslt_vis_i_num                -- ９日－訪問実績(一般)
        ,lt_visit_tab(10).rslt_vis_i_num               -- １０日－訪問実績(一般)
        ,lt_visit_tab(11).rslt_vis_i_num               -- １１日－訪問実績(一般)
        ,lt_visit_tab(12).rslt_vis_i_num               -- １２日－訪問実績(一般)
        ,lt_visit_tab(13).rslt_vis_i_num               -- １３日－訪問実績(一般)
        ,lt_visit_tab(14).rslt_vis_i_num               -- １４日－訪問実績(一般)
        ,lt_visit_tab(15).rslt_vis_i_num               -- １５日－訪問実績(一般)
        ,lt_visit_tab(16).rslt_vis_i_num               -- １６日－訪問実績(一般)
        ,lt_visit_tab(17).rslt_vis_i_num               -- １７日－訪問実績(一般)
        ,lt_visit_tab(18).rslt_vis_i_num               -- １８日－訪問実績(一般)
        ,lt_visit_tab(19).rslt_vis_i_num               -- １９日－訪問実績(一般)
        ,lt_visit_tab(20).rslt_vis_i_num               -- ２０日－訪問実績(一般)
        ,lt_visit_tab(21).rslt_vis_i_num               -- ２１日－訪問実績(一般)
        ,lt_visit_tab(22).rslt_vis_i_num               -- ２２日－訪問実績(一般)
        ,lt_visit_tab(23).rslt_vis_i_num               -- ２３日－訪問実績(一般)
        ,lt_visit_tab(24).rslt_vis_i_num               -- ２４日－訪問実績(一般)
        ,lt_visit_tab(25).rslt_vis_i_num               -- ２５日－訪問実績(一般)
        ,lt_visit_tab(26).rslt_vis_i_num               -- ２６日－訪問実績(一般)
        ,lt_visit_tab(27).rslt_vis_i_num               -- ２７日－訪問実績(一般)
        ,lt_visit_tab(28).rslt_vis_i_num               -- ２８日－訪問実績(一般)
        ,lt_visit_tab(29).rslt_vis_i_num               -- ２９日－訪問実績(一般)
        ,lt_visit_tab(30).rslt_vis_i_num               -- ３０日－訪問実績(一般)
        ,lt_visit_tab(31).rslt_vis_i_num               -- ３１日－訪問実績(一般)
        ,lt_visit_tab(1).rslt_vis_v_num                -- １日－訪問実績(自販)
        ,lt_visit_tab(2).rslt_vis_v_num                -- ２日－訪問実績(自販)
        ,lt_visit_tab(3).rslt_vis_v_num                -- ３日－訪問実績(自販)
        ,lt_visit_tab(4).rslt_vis_v_num                -- ４日－訪問実績(自販)
        ,lt_visit_tab(5).rslt_vis_v_num                -- ５日－訪問実績(自販)
        ,lt_visit_tab(6).rslt_vis_v_num                -- ６日－訪問実績(自販)
        ,lt_visit_tab(7).rslt_vis_v_num                -- ７日－訪問実績(自販)
        ,lt_visit_tab(8).rslt_vis_v_num                -- ８日－訪問実績(自販)
        ,lt_visit_tab(9).rslt_vis_v_num                -- ９日－訪問実績(自販)
        ,lt_visit_tab(10).rslt_vis_v_num               -- １０日－訪問実績(自販)
        ,lt_visit_tab(11).rslt_vis_v_num               -- １１日－訪問実績(自販)
        ,lt_visit_tab(12).rslt_vis_v_num               -- １２日－訪問実績(自販)
        ,lt_visit_tab(13).rslt_vis_v_num               -- １３日－訪問実績(自販)
        ,lt_visit_tab(14).rslt_vis_v_num               -- １４日－訪問実績(自販)
        ,lt_visit_tab(15).rslt_vis_v_num               -- １５日－訪問実績(自販)
        ,lt_visit_tab(16).rslt_vis_v_num               -- １６日－訪問実績(自販)
        ,lt_visit_tab(17).rslt_vis_v_num               -- １７日－訪問実績(自販)
        ,lt_visit_tab(18).rslt_vis_v_num               -- １８日－訪問実績(自販)
        ,lt_visit_tab(19).rslt_vis_v_num               -- １９日－訪問実績(自販)
        ,lt_visit_tab(20).rslt_vis_v_num               -- ２０日－訪問実績(自販)
        ,lt_visit_tab(21).rslt_vis_v_num               -- ２１日－訪問実績(自販)
        ,lt_visit_tab(22).rslt_vis_v_num               -- ２２日－訪問実績(自販)
        ,lt_visit_tab(23).rslt_vis_v_num               -- ２３日－訪問実績(自販)
        ,lt_visit_tab(24).rslt_vis_v_num               -- ２４日－訪問実績(自販)
        ,lt_visit_tab(25).rslt_vis_v_num               -- ２５日－訪問実績(自販)
        ,lt_visit_tab(26).rslt_vis_v_num               -- ２６日－訪問実績(自販)
        ,lt_visit_tab(27).rslt_vis_v_num               -- ２７日－訪問実績(自販)
        ,lt_visit_tab(28).rslt_vis_v_num               -- ２８日－訪問実績(自販)
        ,lt_visit_tab(29).rslt_vis_v_num               -- ２９日－訪問実績(自販)
        ,lt_visit_tab(30).rslt_vis_v_num               -- ３０日－訪問実績(自販)
        ,lt_visit_tab(31).rslt_vis_v_num               -- ３１日－訪問実績(自販)
        ,lt_visit_tab(1).rslt_vis_m_num                -- １日－訪問実績(MC)
        ,lt_visit_tab(2).rslt_vis_m_num                -- ２日－訪問実績(MC)
        ,lt_visit_tab(3).rslt_vis_m_num                -- ３日－訪問実績(MC)
        ,lt_visit_tab(4).rslt_vis_m_num                -- ４日－訪問実績(MC)
        ,lt_visit_tab(5).rslt_vis_m_num                -- ５日－訪問実績(MC)
        ,lt_visit_tab(6).rslt_vis_m_num                -- ６日－訪問実績(MC)
        ,lt_visit_tab(7).rslt_vis_m_num                -- ７日－訪問実績(MC)
        ,lt_visit_tab(8).rslt_vis_m_num                -- ８日－訪問実績(MC)
        ,lt_visit_tab(9).rslt_vis_m_num                -- ９日－訪問実績(MC)
        ,lt_visit_tab(10).rslt_vis_m_num               -- １０日－訪問実績(MC)
        ,lt_visit_tab(11).rslt_vis_m_num               -- １１日－訪問実績(MC)
        ,lt_visit_tab(12).rslt_vis_m_num               -- １２日－訪問実績(MC)
        ,lt_visit_tab(13).rslt_vis_m_num               -- １３日－訪問実績(MC)
        ,lt_visit_tab(14).rslt_vis_m_num               -- １４日－訪問実績(MC)
        ,lt_visit_tab(15).rslt_vis_m_num               -- １５日－訪問実績(MC)
        ,lt_visit_tab(16).rslt_vis_m_num               -- １６日－訪問実績(MC)
        ,lt_visit_tab(17).rslt_vis_m_num               -- １７日－訪問実績(MC)
        ,lt_visit_tab(18).rslt_vis_m_num               -- １８日－訪問実績(MC)
        ,lt_visit_tab(19).rslt_vis_m_num               -- １９日－訪問実績(MC)
        ,lt_visit_tab(20).rslt_vis_m_num               -- ２０日－訪問実績(MC)
        ,lt_visit_tab(21).rslt_vis_m_num               -- ２１日－訪問実績(MC)
        ,lt_visit_tab(22).rslt_vis_m_num               -- ２２日－訪問実績(MC)
        ,lt_visit_tab(23).rslt_vis_m_num               -- ２３日－訪問実績(MC)
        ,lt_visit_tab(24).rslt_vis_m_num               -- ２４日－訪問実績(MC)
        ,lt_visit_tab(25).rslt_vis_m_num               -- ２５日－訪問実績(MC)
        ,lt_visit_tab(26).rslt_vis_m_num               -- ２６日－訪問実績(MC)
        ,lt_visit_tab(27).rslt_vis_m_num               -- ２７日－訪問実績(MC)
        ,lt_visit_tab(28).rslt_vis_m_num               -- ２８日－訪問実績(MC)
        ,lt_visit_tab(29).rslt_vis_m_num               -- ２９日－訪問実績(MC)
        ,lt_visit_tab(30).rslt_vis_m_num               -- ３０日－訪問実績(MC)
        ,lt_visit_tab(31).rslt_vis_m_num               -- ３１日－訪問実績(MC)
        ,lt_visit_tab(1).rslt_vis_e_num                -- １日－訪問実績(有効訪問)
        ,lt_visit_tab(2).rslt_vis_e_num                -- ２日－訪問実績(有効訪問)
        ,lt_visit_tab(3).rslt_vis_e_num                -- ３日－訪問実績(有効訪問)
        ,lt_visit_tab(4).rslt_vis_e_num                -- ４日－訪問実績(有効訪問)
        ,lt_visit_tab(5).rslt_vis_e_num                -- ５日－訪問実績(有効訪問)
        ,lt_visit_tab(6).rslt_vis_e_num                -- ６日－訪問実績(有効訪問)
        ,lt_visit_tab(7).rslt_vis_e_num                -- ７日－訪問実績(有効訪問)
        ,lt_visit_tab(8).rslt_vis_e_num                -- ８日－訪問実績(有効訪問)
        ,lt_visit_tab(9).rslt_vis_e_num                -- ９日－訪問実績(有効訪問)
        ,lt_visit_tab(10).rslt_vis_e_num               -- １０日－訪問実績(有効訪問)
        ,lt_visit_tab(11).rslt_vis_e_num               -- １１日－訪問実績(有効訪問)
        ,lt_visit_tab(12).rslt_vis_e_num               -- １２日－訪問実績(有効訪問)
        ,lt_visit_tab(13).rslt_vis_e_num               -- １３日－訪問実績(有効訪問)
        ,lt_visit_tab(14).rslt_vis_e_num               -- １４日－訪問実績(有効訪問)
        ,lt_visit_tab(15).rslt_vis_e_num               -- １５日－訪問実績(有効訪問)
        ,lt_visit_tab(16).rslt_vis_e_num               -- １６日－訪問実績(有効訪問)
        ,lt_visit_tab(17).rslt_vis_e_num               -- １７日－訪問実績(有効訪問)
        ,lt_visit_tab(18).rslt_vis_e_num               -- １８日－訪問実績(有効訪問)
        ,lt_visit_tab(19).rslt_vis_e_num               -- １９日－訪問実績(有効訪問)
        ,lt_visit_tab(20).rslt_vis_e_num               -- ２０日－訪問実績(有効訪問)
        ,lt_visit_tab(21).rslt_vis_e_num               -- ２１日－訪問実績(有効訪問)
        ,lt_visit_tab(22).rslt_vis_e_num               -- ２２日－訪問実績(有効訪問)
        ,lt_visit_tab(23).rslt_vis_e_num               -- ２３日－訪問実績(有効訪問)
        ,lt_visit_tab(24).rslt_vis_e_num               -- ２４日－訪問実績(有効訪問)
        ,lt_visit_tab(25).rslt_vis_e_num               -- ２５日－訪問実績(有効訪問)
        ,lt_visit_tab(26).rslt_vis_e_num               -- ２６日－訪問実績(有効訪問)
        ,lt_visit_tab(27).rslt_vis_e_num               -- ２７日－訪問実績(有効訪問)
        ,lt_visit_tab(28).rslt_vis_e_num               -- ２８日－訪問実績(有効訪問)
        ,lt_visit_tab(29).rslt_vis_e_num               -- ２９日－訪問実績(有効訪問)
        ,lt_visit_tab(30).rslt_vis_e_num               -- ３０日－訪問実績(有効訪問)
        ,lt_visit_tab(31).rslt_vis_e_num               -- ３１日－訪問実績(有効訪問)
        ,cn_created_by                                 -- 作成者
        ,cd_creation_date                              -- 作成日
        ,cn_last_updated_by                            -- 最終更新者
        ,cd_last_update_date                           -- 最終更新日
        ,cn_last_update_login                          -- 最終更新ログイン
        ,cn_request_id                                 -- 要求ID
        ,cn_program_application_id                     -- コンカレント・プログラム・アプリケーションID
        ,cn_program_id                                 -- コンカレント・プログラムID
        ,cd_program_update_date                        -- プログラム更新日
      );
      --
    END LOOP get_loop;
    --
    /* 2009.08.03 K.Satomura 0000911対応 END */
  END sum_visit_sales;
--
  /***********************************************************************************
   * Procedure Name   : debug
   * Description      : デバッグログ出力
   ***********************************************************************************/
  PROCEDURE debug(
    buff                IN         VARCHAR2     -- デバッグログ
  )
  IS
  BEGIN
    IF ( CB_DEBUG_LOG = TRUE ) THEN
      fnd_file.put_line(
        which  => FND_FILE.LOG
       ,buff   => buff || cv_lf || ''   -- 空行の挿入
      );
    END IF;
  END debug;
--
  /***********************************************************************************
   * Procedure Name   : do_error
   * Description      : 例外発生
   ***********************************************************************************/
  PROCEDURE do_error(
    proc_no               IN         VARCHAR2     -- 処理番号
  )
  IS
    ln_cnt                NUMBER  := 1;
  BEGIN
    IF ( CB_DO_ERROR_NO =  proc_no ) THEN
      debug(
        buff  => '例外テスト' || cv_lf ||
                 '処理番号＝' || proc_no ||
                 cv_lf || ''
      );
      ln_cnt  :=  ln_cnt / 0;
    END IF;
  END do_error;
--
  /***********************************************************************************
   * Procedure Name   : init_month_square_hon_tab
   * Description      : PL/SQL表（本体部）の項目の初期化
   ***********************************************************************************/
  PROCEDURE init_month_square_hon_tab(
    io_tab            IN OUT NOCOPY  g_get_month_square_ttype           -- 配列
  )
  IS
  BEGIN
      FOR j IN 1..8 LOOP
        io_tab(j).last_year_rslt_sales_amt := 0;
        io_tab(j).last_mon_rslt_sales_amt  := 0;
        io_tab(j).new_customer_num         := 0;
        io_tab(j).new_vendor_num           := 0;
        io_tab(j).new_customer_amt         := 0;
        io_tab(j).new_vendor_amt           := 0;
        io_tab(j).plan_sales_amt           := 0;
        io_tab(j).vis_a_num                := 0;
        io_tab(j).vis_b_num                := 0;
        io_tab(j).vis_c_num                := 0;
        io_tab(j).vis_d_num                := 0;
        io_tab(j).vis_e_num                := 0;
        io_tab(j).vis_f_num                := 0;
        io_tab(j).vis_g_num                := 0;
        io_tab(j).vis_h_num                := 0;
        io_tab(j).vis_i_num                := 0;
        io_tab(j).vis_j_num                := 0;
        io_tab(j).vis_k_num                := 0;
        io_tab(j).vis_l_num                := 0;
        io_tab(j).vis_m_num                := 0;
        io_tab(j).vis_n_num                := 0;
        io_tab(j).vis_o_num                := 0;
        io_tab(j).vis_p_num                := 0;
        io_tab(j).vis_q_num                := 0;
        io_tab(j).vis_r_num                := 0;
        io_tab(j).vis_s_num                := 0;
        io_tab(j).vis_t_num                := 0;
        io_tab(j).vis_u_num                := 0;
        io_tab(j).vis_v_num                := 0;
        io_tab(j).vis_w_num                := 0;
        io_tab(j).vis_x_num                := 0;
        io_tab(j).vis_y_num                := 0;
        io_tab(j).vis_z_num                := 0;
        FOR i IN 1..31 LOOP
          io_tab(j).l_get_one_day_tab(i).plan_vs_amt           := 0;
          io_tab(j).l_get_one_day_tab(i).rslt_vs_amt           := 0;
          io_tab(j).l_get_one_day_tab(i).rslt_other_sales_amt  := 0;
          io_tab(j).l_get_one_day_tab(i).effective_num         := 0;
        END LOOP;
      END LOOP;
  END init_month_square_hon_tab;
/* 20090519_Ogawa_T1_1033 END*/
--
  /***********************************************************************************
   * Procedure Name   : init_month_square_rec1
   * Description      : PL/SQL表（一ヶ月分）の項目の初期化
   ***********************************************************************************/
  PROCEDURE init_month_square_rec1(
    io_month_square_rec  IN  OUT NOCOPY     g_month_rtype1  -- 一ヶ月分データ
  )
  IS
  BEGIN
      FOR i IN 1..31 LOOP
        io_month_square_rec.l_one_day_tab(i).tgt_amt                 :=0;
        io_month_square_rec.l_one_day_tab(i).rslt_amt                :=0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_amt         :=0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_num             :=0;
        io_month_square_rec.l_one_day_tab(i).vis_num                 :=0;
        io_month_square_rec.l_one_day_tab(i).vis_sales_num           :=0;
        io_month_square_rec.l_one_day_tab(i).vis_new_num             :=0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_new_num          :=0;
        io_month_square_rec.l_one_day_tab(i).visit_sign              :=NULL;
        io_month_square_rec.l_one_day_tab(i).vis_a_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_b_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_c_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_d_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_e_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_f_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_g_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_h_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_i_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_j_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_k_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_l_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_m_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_n_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_o_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_p_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_q_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_r_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_s_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_t_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_u_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_v_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_w_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_x_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_y_num               :=0;
        io_month_square_rec.l_one_day_tab(i).vis_z_num               :=0;
      END LOOP;
  END init_month_square_rec1;
--
  /***********************************************************************************
   * Procedure Name   : init_month_square_rec2
   * Description      : PL/SQL表（一ヶ月分）の項目の初期化
   ***********************************************************************************/
  PROCEDURE init_month_square_rec2(
    io_month_square_rec  IN  OUT NOCOPY     g_month_rtype2  -- 一ヶ月分データ
  )
  IS
  BEGIN
      FOR i IN 1..31 LOOP
        io_month_square_rec.l_one_day_tab(i).tgt_amt                             := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_new_amt                         := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vd_new_amt                      := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vd_amt                          := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_other_new_amt                   := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_other_amt                       := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_amt                            := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_new_amt                        := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_new_amt                     := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_amt                         := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_new_amt                  := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_amt                      := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_amt                     := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_num                         := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_new_num                     := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_vd_new_num                  := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_vd_num                      := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_other_new_num               := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_other_num                   := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_mc_num                      := 0;
        io_month_square_rec.l_one_day_tab(i).vis_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_new_num                         := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_new_num                      := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_num                          := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_new_num                   := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_num                       := 0;
        io_month_square_rec.l_one_day_tab(i).vis_mc_num                          := 0;
        io_month_square_rec.l_one_day_tab(i).vis_sales_num                       := 0;
        io_month_square_rec.l_one_day_tab(i).vis_a_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_b_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_c_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_d_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_e_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_f_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_g_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_h_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_i_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_j_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_k_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_l_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_m_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_n_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_o_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_p_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_q_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_r_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_s_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_t_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_u_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_v_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_w_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_x_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_y_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_z_num                           := 0;
      END LOOP;
  END init_month_square_rec2;
--
  /***********************************************************************************
   * Procedure Name   : init_month_square_rec3
   * Description      : PL/SQL表（一ヶ月分）の項目の初期化
   ***********************************************************************************/
  PROCEDURE init_month_square_rec3(
    io_month_square_rec  IN  OUT NOCOPY     g_month_rtype3  -- 一ヶ月分データ
  )
  IS
  BEGIN
      FOR i IN 1..31 LOOP
        io_month_square_rec.l_one_day_tab(i).tgt_amt                               := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_new_amt                           := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vd_new_amt                        := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vd_amt                            := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_other_new_amt                     := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_other_amt                         := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_amt                              := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_new_amt                          := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_new_amt                       := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_amt                           := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_new_amt                    := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_amt                        := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_amt                       := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_vd_amt                    := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_other_amt                 := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_new_num                       := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_vd_new_num                    := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_vd_num                        := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_other_new_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_other_num                     := 0;
        io_month_square_rec.l_one_day_tab(i).tgt_vis_mc_num                        := 0;
        io_month_square_rec.l_one_day_tab(i).vis_num                               := 0;
        io_month_square_rec.l_one_day_tab(i).vis_new_num                           := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_new_num                        := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_num                            := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_new_num                     := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_num                         := 0;
        io_month_square_rec.l_one_day_tab(i).vis_mc_num                            := 0;
        io_month_square_rec.l_one_day_tab(i).vis_sales_num                         := 0;
        io_month_square_rec.l_one_day_tab(i).vis_a_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_b_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_c_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_d_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_e_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_f_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_g_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_h_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_i_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_j_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_k_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_l_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_m_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_n_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_o_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_p_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_q_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_r_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_s_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_t_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_u_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_v_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_w_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_x_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_y_num                             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_z_num                             := 0;
      END LOOP;
  END init_month_square_rec3;
--
  /***********************************************************************************
   * Procedure Name   : init_month_square_rec4
   * Description      : PL/SQL表（一ヶ月分）の項目の初期化
   ***********************************************************************************/
  PROCEDURE init_month_square_rec4(
    io_month_square_rec  IN  OUT NOCOPY     g_month_rtype4  -- 一ヶ月分データ
  )
  IS
  BEGIN
      FOR i IN 1..31 LOOP
        io_month_square_rec.l_one_day_tab(i).rslt_amt                  := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_new_amt              := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_new_amt           := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_amt               := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_new_amt        := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_amt            := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_amt           := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_vd_amt        := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_other_amt     := 0;
        io_month_square_rec.l_one_day_tab(i).vis_num                   := 0;
        io_month_square_rec.l_one_day_tab(i).vis_new_num               := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_new_num            := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_num                := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_new_num         := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_num             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_mc_num                := 0;
        io_month_square_rec.l_one_day_tab(i).vis_sales_num             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_a_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_b_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_c_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_d_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_e_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_f_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_g_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_h_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_i_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_j_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_k_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_l_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_m_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_n_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_o_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_p_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_q_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_r_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_s_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_t_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_u_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_v_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_w_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_x_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_y_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_z_num                 := 0;
      END LOOP;
  END init_month_square_rec4;
--
  /***********************************************************************************
   * Procedure Name   : init_month_square_rec5
   * Description      : PL/SQL表（一ヶ月分）の項目の初期化
   ***********************************************************************************/
  PROCEDURE init_month_square_rec5(
    io_month_square_rec  IN  OUT NOCOPY     g_month_rtype5  -- 一ヶ月分データ
  )
  IS
  BEGIN
      FOR i IN 1..31 LOOP
        io_month_square_rec.l_one_day_tab(i).rslt_amt                  := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_new_amt              := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_new_amt           := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_vd_amt               := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_new_amt        := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_other_amt            := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_amt           := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_vd_amt        := 0;
        io_month_square_rec.l_one_day_tab(i).rslt_center_other_amt     := 0;
        io_month_square_rec.l_one_day_tab(i).vis_num                   := 0;
        io_month_square_rec.l_one_day_tab(i).vis_new_num               := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_new_num            := 0;
        io_month_square_rec.l_one_day_tab(i).vis_vd_num                := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_new_num         := 0;
        io_month_square_rec.l_one_day_tab(i).vis_other_num             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_mc_num                := 0;
        io_month_square_rec.l_one_day_tab(i).vis_sales_num             := 0;
        io_month_square_rec.l_one_day_tab(i).vis_a_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_b_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_c_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_d_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_e_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_f_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_g_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_h_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_i_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_j_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_k_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_l_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_m_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_n_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_o_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_p_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_q_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_r_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_s_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_t_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_u_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_v_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_w_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_x_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_y_num                 := 0;
        io_month_square_rec.l_one_day_tab(i).vis_z_num                 := 0;
      END LOOP;
  END init_month_square_rec5;
--
  /***********************************************************************************
   * Procedure Name   : init
   * Description      : 初期処理(A-1)
   ***********************************************************************************/
  PROCEDURE init(
    iv_year_month       IN         VARCHAR2     -- 基準年月
   ,iv_report_type      IN         VARCHAR2     -- 帳票種別
   ,iv_base_code        IN         VARCHAR2     -- 拠点コード
   ,ov_errbuf           OUT NOCOPY VARCHAR2     -- エラー・メッセージ           --# 固定 #
   ,ov_retcode          OUT NOCOPY VARCHAR2     -- リターン・コード             --# 固定 #
   ,ov_errmsg           OUT NOCOPY VARCHAR2     -- ユーザー・エラー・メッセージ --# 固定 #
  )
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name         CONSTANT VARCHAR2(100) := 'init';              -- プログラム名
    cv_table            CONSTANT VARCHAR2(30)  := 'XXCSO_RESOURCE_RALATIONS_V'; -- リソース関連マスタビュー
--
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
  -- ローカル変数
    lv_employee_number     xxcso_resource_relations_v2.employee_number%TYPE;      -- 従業員番号格納
    lv_work_base_code      xxcso_resource_relations_v2.work_base_code_new%TYPE;   -- 勤務地拠点コード格納
    lv_group_number        xxcso_resource_relations_v2.group_number_new%TYPE;     -- グループ番号格納
    lv_position_code       xxcso_resource_relations_v2.position_code_new%TYPE;    -- 職位コード格納
    lv_job_type_code       xxcso_resource_relations_v2.job_type_code_new%TYPE;    -- 職種コード格納
    lv_group_leader_flag   xxcso_resource_relations_v2.group_leader_flag_new%TYPE;-- グループ長区分
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
--
    -- メッセージ出力
    -- 入力された基準年月ログに出力
    lv_errmsg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_app_name              --アプリケーション短縮名
                    ,iv_name         => cv_tkn_number_01         --メッセージコード
                    ,iv_token_name1  => cv_tkn_entry             --トークンコード1
                    ,iv_token_value1 => iv_year_month            --トークン値1
                   );
    fnd_file.put_line(
          which  => FND_FILE.LOG,
          buff   => ''      || cv_lf ||     -- 空行の挿入
                  lv_errmsg || cv_lf ||
                   ''                         -- 空行の挿入
        );
--
    -- ==============================================================================
    -- 帳票種別番号により、帳票ID、帳票種別名、フォーム様式ファイル名、クエリー様式ファイル名を取得
    -- ==============================================================================
    -- 帳票種別名を取得
    gv_report_meaning  := XXCSO_UTIL_COMMON_PKG.get_lookup_meaning(
                            iv_lookup_type           => cv_rep_lookup_type_code,  -- タイプ
                            iv_lookup_code           => iv_report_type,           -- コード
                            id_standard_date         => SYSDATE);                 -- 基準日
    IF ( gv_report_meaning IS NULL ) THEN
      lv_errmsg := xxccp_common_pkg.get_msg(
                       iv_application  => cv_app_name              --アプリケーション短縮名
                      ,iv_name         => cv_tkn_number_12         -- メッセージコード
                      ,iv_token_name1  => cv_tkn_task_name         -- トークンコード1
                      ,iv_token_value1 => iv_report_type           -- トークン値1
                      ,iv_token_name2  => cv_tkn_lookup_type_name  -- トークンコード2
                      ,iv_token_value2 => cv_rep_lookup_type_code  -- トークン値2
                   );
      RAISE global_api_expt;
    END IF;
    -- フォーム様式ファイル名を取得
    gv_svf_form_name   := XXCSO_UTIL_COMMON_PKG.get_lookup_attribute(
                            iv_lookup_type           => cv_rep_lookup_type_code,  -- タイプ
                            iv_lookup_code           => iv_report_type,           -- コード
                            in_dff_number            => cv_svf_form_def_no,       -- DFF番号
                            id_standard_date         => SYSDATE);                 -- 基準日
    IF ( gv_svf_form_name IS NULL ) THEN
      lv_errmsg := xxccp_common_pkg.get_msg(
                       iv_application  => cv_app_name              --アプリケーション短縮名
                      ,iv_name         => cv_tkn_number_12         -- メッセージコード
                      ,iv_token_name1  => cv_tkn_task_name         -- トークンコード1
                      ,iv_token_value1 => iv_report_type           -- トークン値1
                      ,iv_token_name2  => cv_tkn_lookup_type_name  -- トークンコード2
                      ,iv_token_value2 => cv_rep_lookup_type_code  -- トークン値2
                   );
      RAISE global_api_expt;
    END IF;
    -- クエリー様式ファイル名を取得
    gv_svf_query_name  := XXCSO_UTIL_COMMON_PKG.get_lookup_attribute(
                            iv_lookup_type           => cv_rep_lookup_type_code,  -- タイプ
                            iv_lookup_code           => iv_report_type,           -- コード
                            in_dff_number            => cv_svf_query_def_no,      -- DFF番号
                            id_standard_date         => SYSDATE);                 -- 基準日
    IF ( gv_svf_query_name IS NULL ) THEN
      lv_errmsg := xxccp_common_pkg.get_msg(
                       iv_application  => cv_app_name              --アプリケーション短縮名
                      ,iv_name         => cv_tkn_number_12         -- メッセージコード
                      ,iv_token_name1  => cv_tkn_task_name         -- トークンコード1
                      ,iv_token_value1 => iv_report_type           -- トークン値1
                      ,iv_token_name2  => cv_tkn_lookup_type_name  -- トークンコード2
                      ,iv_token_value2 => cv_rep_lookup_type_code  -- トークン値2
                   );
      RAISE global_api_expt;
    END IF;
--
    -- 帳票種別名をログに出力
    fnd_file.put_line(
          which  => FND_FILE.LOG,
          buff   => ''      || cv_lf ||                        -- 空行の挿入
                  gv_report_meaning || cv_lf ||
                   ''                                            -- 空行の挿入
        );
    -- 入力された拠点コードをログに出力
    lv_errmsg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_app_name              --アプリケーション短縮名
                    ,iv_name         => cv_tkn_number_03         --メッセージコード
                    ,iv_token_name1  => cv_tkn_entry             --トークンコード1
                    ,iv_token_value1 => iv_base_code             --トークン値1
                   );
    fnd_file.put_line(
          which  => FND_FILE.LOG,
          buff   => ''      || cv_lf ||     -- 空行の挿入
                  lv_errmsg || cv_lf ||
                   ''                         -- 空行の挿入
        );
    -- フォーム様式ファイル名
    lv_errmsg := 'フォーム様式ファイル名：' || gv_svf_form_name;
    fnd_file.put_line(
          which  => FND_FILE.LOG,
          buff   => ''      || cv_lf ||     -- 空行の挿入
                  lv_errmsg || cv_lf ||
                   ''                       -- 空行の挿入
    );
    -- クエリー様式ファイル名
    lv_errmsg := 'クエリー様式ファイル名：' || gv_svf_query_name;
    fnd_file.put_line(
          which  => FND_FILE.LOG,
          buff   => ''      || cv_lf ||     -- 空行の挿入
                  lv_errmsg || cv_lf ||
                   ''                       -- 空行の挿入
    );
    -- DEBUGメッセージ
    -- ユーザID
    debug(
          buff   => ''      || cv_lf ||     -- 空行の挿入
                  'ユーザID：'||cn_created_by
    );
    -- 関連データを抽出します。
    SELECT  xrrv.employee_number employee_number,    -- 従業員番号
            (CASE
               WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
                 THEN xrrv.work_base_code_new
               ELSE xrrv.work_base_code_old
             END
            ) work_base_code,                        -- 勤務地拠点コード
            (CASE
               WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
                 THEN xrrv.group_number_new
               ELSE xrrv.group_number_old
             END
            ) group_number                           -- グループ番号
    INTO    lv_employee_number,                      -- 従業員番号
            lv_work_base_code,                       -- 勤務地拠点コード
            lv_group_number                          -- グループ番号
    FROM    xxcso_resource_relations_v2 xrrv         -- リソース関連マスタ(最新)VIEW
    WHERE   xrrv.user_id = cn_created_by;            -- ログインユーザID
--
DO_ERROR('A-1');
--
    -- 取得されたデータをグローバル変数に設定
    gt_employee_number   := NVL(lv_employee_number,' ');                -- 従業員番号
    gt_work_base_code    := NVL(lv_work_base_code,' ');                 -- 勤務地拠点コード
    gt_group_number      := NVL(lv_group_number,' ');                   -- グループ番号
    -- 入力されたパラメータをグローバル変数に格納
    gv_year_month        := iv_year_month;                     -- 基準年月
    gd_year_month        := TO_DATE(gv_year_month,'YYYYMM');
    gv_report_type       := iv_report_type;                    -- 帳票種別
    gv_base_code         := iv_base_code;                      -- 拠点コード
--
    -- ログインユーザが営業員
    gv_is_salesman := xxcso_util_common_pkg.chk_responsibility(      -- ログインユーザが営業員の場合のみ
                        cn_created_by
                       ,fnd_global.resp_id
                       ,'1'
                      );
    -- ログインユーザがグループリーダ
    gv_is_groupleader := xxcso_util_common_pkg.chk_responsibility(      -- ログインユーザがグループリーダの場合のみ
                           cn_created_by
                          ,fnd_global.resp_id
                          ,'2'
                         );
--
    -- DEBUGメッセージ
    -- 取得したデータをログに出力
    debug(
       buff   => 'A-1 初期処理：取得されたデータ：'  || cv_lf ||
                  '従業員番号:'       || gt_employee_number   || cv_lf ||
                  '勤務地拠点コード:' || gt_work_base_code    || cv_lf ||
                  'グループ番号:'     || gt_group_number      || cv_lf ||
                  '基準年月:'         || gv_year_month        ||  cv_lf ||
                  '帳票種別:'         || gv_report_type       ||  cv_lf ||
                  '拠点コード:'       || gv_base_code         ||  cv_lf ||
                  '帳票種別名:'       || gv_report_meaning    ||  cv_lf ||
                  'フォーム様式ファイル名:' || gv_svf_form_name  ||  cv_lf ||
                  'クエリー様式ファイル名:' || gv_svf_query_name || cv_lf ||
                  'ログインID:'       || cn_created_by || cv_lf ||
                  'is営業員:'         || gv_is_salesman || cv_lf ||
                  'isグループリーダ:' || gv_is_groupleader
     );
--
/* 20090702_Ogawa_0000312 START*/
    SELECT   efdfce.attr_group_id
    INTO     gn_rsrc_attr_group_id
    FROM     fnd_application          fa
            ,ego_fnd_dsc_flx_ctx_ext  efdfce
    WHERE    fa.application_short_name             = 'AR'
      AND    efdfce.application_id                 = fa.application_id
      AND    efdfce.descriptive_flexfield_name     = 'HZ_ORG_PROFILES_GROUP'
      AND    efdfce.descriptive_flex_context_code  = 'RESOURCE'
    ;
--
    SELECT   efdfce.attr_group_id
    INTO     gn_rtn_attr_group_id
    FROM     fnd_application          fa
            ,ego_fnd_dsc_flx_ctx_ext  efdfce
    WHERE    fa.application_short_name             = 'AR'
      AND    efdfce.application_id                 = fa.application_id
      AND    efdfce.descriptive_flexfield_name     = 'HZ_ORG_PROFILES_GROUP'
      AND    efdfce.descriptive_flex_context_code  = 'ROUTE'
    ;
/* 20090702_Ogawa_0000312 END*/
--
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数OTHERS例外ハンドラ ***
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,4000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM||lv_errbuf;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
  END init;
--
  /**********************************************************************************
   * Procedure Name   : chek_param
   * Description      : パラメータチェック (A-2)
  ***********************************************************************************/
   PROCEDURE chek_param(
      ov_errbuf         OUT NOCOPY VARCHAR2     -- エラー・メッセージ            --# 固定 #
     ,ov_retcode        OUT NOCOPY VARCHAR2     -- リターン・コード              --# 固定 #
     ,ov_errmsg         OUT NOCOPY VARCHAR2     -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'chek_param';     -- プログラム名
  --
  --#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
  --###########################  固定部 END   ####################################
--
  -- ===============================
  -- ユーザー宣言部
  -- ===============================
  -- *** ローカル定数 ***
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 START */
    cv_manage_base_code CONSTANT VARCHAR2(100) := 'XXCSO1_MANAGE_BASE_CODE';
    cv_tkn_msg_base     CONSTANT VARCHAR2(100) := '拠点';
    cv_tkn_msg_errmsg   CONSTANT VARCHAR2(100) := '（非直轄範囲）';
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 END */
  -- *** ローカル変数 ***
    lv_boolean                    VARCHAR2(5);              -- 共通関数リターン値を格納
    ld_year_month_lastday         DATE;                     -- 基準年月月末日（オンライン日付考慮）
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 START */
    lv_manage_base_code fnd_profile_option_values.profile_option_value%TYPE;
    ln_work_count       NUMBER;
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 END */
  --
  BEGIN
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
    -- ====================
    -- 変数初期化処理
    -- ====================
    -- 職責IDを取得します。
    gn_resp_id         := fnd_global.resp_id;
    -- 基準年月の１日を取得してグローバル変数に格納
    gd_year_month_day  := TO_DATE(gv_year_month || '01','YYYYMMDD');
    -- 基準年月の末日を取得してグローバル変数に格納
    gd_year_month_lastday := LAST_DAY(gd_year_month_day);
    -- 入力された基準年月が、SYSDATEを含め過去であるかをチェックします。
    IF (gd_year_month_day > XXCSO_UTIL_COMMON_PKG.GET_ONLINE_SYSDATE()) THEN
      -- メッセージ出力
      lv_errmsg := xxccp_common_pkg.get_msg(
                       iv_application  => cv_app_name              --アプリケーション短縮名
                      ,iv_name         => cv_tkn_number_06         --メッセージコード
                      ,iv_token_name1  => cv_tkn_entry             --トークンコード1
                      ,iv_token_value1 => '基準年月'               --トークン値1
                     );
      fnd_file.put_line(
            which  => FND_FILE.LOG,
            buff   => ''      || cv_lf ||     -- 空行の挿入
                    lv_errmsg || cv_lf ||
                     ''                         -- 空行の挿入
          );
      RAISE global_api_expt;
    END IF;
    -- DEBUGメッセージ
    -- 基準年月の１日をログに出力
    debug(
       buff   => '基準年月の１日' || gd_year_month_day
     );
--
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 START */
    lv_manage_base_code := fnd_profile.value(cv_manage_base_code);
    --
    IF (lv_manage_base_code IS NULL) THEN
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 END */
      -- 入力された拠点コード、帳票種別に実行権限が、あるかをチェックします。
      xxcso_util_common_pkg.chk_exe_report_visite_sales(
         in_user_id     => fnd_global.user_id
        ,in_resp_id     => gn_resp_id
        ,iv_base_code   => gv_base_code
        ,iv_report_type => gv_report_type
        ,ov_ret_code    => lv_boolean
        ,ov_err_msg     => lv_errmsg
      );
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 START */
    ELSE
      -- プロファイルに値がある場合、入力された拠点コードが
      -- プロファイルの拠点コード配下に存在するかチェックをする。
      IF (lv_manage_base_code <> gv_base_code) THEN
        -- プロファイルの拠点コードと、入力された拠点コードが異なる場合
        SELECT COUNT(1)
        INTO   ln_work_count
        FROM   (
                 SELECT     abl.child_base_code child_base_code
                 FROM       xxcso_aff_base_level_v2 abl
                 START WITH abl.base_code = lv_manage_base_code
                 CONNECT BY PRIOR abl.child_base_code = abl.base_code
               ) aff
        WHERE  aff.child_base_code = gv_base_code
        ;
        --
        IF (ln_work_count <= 0) THEN
          lv_errmsg := xxccp_common_pkg.get_msg(
                          iv_application  => cv_app_name
                         ,iv_name         => cv_tkn_number_13
                         ,iv_token_name1  => cv_tkn_item
                         ,iv_token_value1 => cv_tkn_msg_base
                         ,iv_token_name2  => cv_tkn_errmsg
                         ,iv_token_value2 => cv_tkn_msg_errmsg
                       );
          lv_boolean := 'FALSE';
          --
        END IF;
        --
      END IF;
      --
    END IF;
    /* 2009.06.26 K.Satomura 統合テスト障害番号0000016対応 END */
--
DO_ERROR('A-2-2');
--
-- TODO テストのため一時に通過させます。
--    lv_boolean := cv_true;
--
    IF lv_boolean = cv_false THEN
      debug(
        buff   => ''      || cv_lf ||     -- 空行の挿入
                lv_errmsg
      );
      RAISE global_api_expt;
    END IF;
    -- 入力パラメータの基準年月より、稼動日数等を取得します。
    -- 基準年月の末日を取得してグローバル変数に格納
    SELECT
          (CASE
            WHEN XXCSO_UTIL_COMMON_PKG.GET_ONLINE_SYSDATE() < LAST_DAY(gd_year_month_day)
              THEN XXCSO_UTIL_COMMON_PKG.GET_ONLINE_SYSDATE()
          ELSE
          LAST_DAY(gd_year_month_day)
          END)
    INTO      ld_year_month_lastday             -- 基準年月の末日
    FROM      DUAL;
--
DO_ERROR('A-2-3');
--
    -- 基準年月の先月を取得してグローバル変数に格納
    gv_year_month_prev    := TO_CHAR(add_months(gd_year_month_day,-1),'YYYYMM');
    -- 基準年月の前年を取得してグローバル変数に格納
    gv_year_prev          := TO_CHAR(add_months(gd_year_month_day,-12),'YYYYMM');
    -- 稼動日数を取得してグローバル変数に格納
    gn_operation_days     := xxcso_util_common_pkg.get_working_days(
                              gd_year_month_day,TRUNC(ld_year_month_lastday));
    -- 稼動可能日数を取得してグローバル変数に格納
    gn_operation_all_days := xxcso_util_common_pkg.get_working_days(
                              gd_year_month_day,gd_year_month_lastday);
    -- DEBUGメッセージ
    -- 取得された日付けをログに出力
    debug(
       buff   => '基準年月の末日:' ||gd_year_month_lastday ||
                 '基準年月の先月:' ||gv_year_month_prev ||
                 '基準年月の前年:' ||gv_year_prev ||
                 '稼動日数:'||gn_operation_days ||
                 '稼動可能日数:'||gn_operation_all_days
     );
--
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数OTHERS例外ハンドラ ***
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,4000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM||lv_errbuf;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END chek_param;
--
  /**********************************************************************************
   * Procedure Name   : insert_wrk_table
   * Description      : ワークテーブルへの出力 (A-3-4,A-4-4,A-5-4,A-6-4,A-7-4)
  ***********************************************************************************/
  PROCEDURE insert_wrk_table(
     ir_m_tab            IN  g_get_month_square_ttype         -- 明細部レコード
    ,ir_hon_tab          IN  g_get_month_square_ttype         -- 本体部レコード
    ,in_m_cnt            IN         NUMBER                           -- 明細部行数
    ,in_report_output_no IN         NUMBER                           -- 帳票出力セット番号
    ,ov_errbuf           OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
  cv_prg_name             CONSTANT VARCHAR2(100)   := 'insert_wrk_table';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
  lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
  lv_retcode VARCHAR2(1);     -- リターン・コード
  lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
  -- ローカル定数
  -- ローカル変数
  lv_up_base_code            xxcso_rep_visit_sale_plan.up_base_code%TYPE;           -- 拠点コード（親）
  lv_up_hub_name             xxcso_rep_visit_sale_plan.up_hub_name%TYPE;            -- 拠点名称（親）
  lv_base_code               xxcso_rep_visit_sale_plan.base_code%TYPE;              -- 拠点コード
  lv_hub_name                xxcso_rep_visit_sale_plan.hub_name%TYPE;               -- 拠点名称
  lv_group_number            xxcso_rep_visit_sale_plan.group_number%TYPE;           -- 営業グループ番号
  lv_group_name              xxcso_rep_visit_sale_plan.group_name%TYPE;             -- 営業グループ名
  lv_employee_number         xxcso_rep_visit_sale_plan.employee_number%TYPE;        -- 営業員コード
  lv_employee_name           xxcso_rep_visit_sale_plan.employee_name%TYPE;          -- 営業員名
  lv_report_id               xxcso_rep_visit_sale_plan.report_id%TYPE;              -- 帳票ID
  lv_report_name             xxcso_rep_visit_sale_plan.report_name%TYPE;            -- 帳票タイトル
  ln_line_kind               xxcso_rep_visit_sale_plan.line_kind%TYPE;              -- 帳票出力位置
  ln_line_num                xxcso_rep_visit_sale_plan.line_num%TYPE;               -- 行番号
  ln_m_cnt                   NUMBER;
  BEGIN
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
    -- ローカル変数の初期化
    -- 帳票idによって帳票タイトルを判断します。
    -- DEBUGメッセージ
    -- ワークテーブルへの出力
    debug(
       buff   => 'ワークテーブルへの出力開始 :' || '明細部配列：' || TO_CHAR(in_m_cnt)
     );
    IF(gv_report_type = cv_report_1) THEN
      lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
      SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（営業員別）' || '≫';
      lv_report_id   := cv_pkg_name;
    ELSIF(gv_report_type = cv_report_2) THEN
      lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
      SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（営業員グループ別）' || '≫';
      lv_report_id   := cv_pkg_name;
    ELSIF(gv_report_type = cv_report_3) THEN
      lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
      SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（拠点/課別）' || '≫';
      lv_report_id   := cv_pkg_name;
    ELSIF(gv_report_type = cv_report_4) THEN
      lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
      /* 20090427_abe_売上計画出力対応 START*/
      SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（地区/部別）' || '≫';
      --SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（地区営業部/部別）' || '≫';
      /* 20090427_abe_売上計画出力対応 END*/
      lv_report_id   := cv_pkg_name;
    ELSIF(gv_report_type = cv_report_5) THEN
      lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
      /* 20090427_abe_売上計画出力対応 START*/
      SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（営業本部別）' || '≫';
      --SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（地域営業本部別）' || '≫';
      /* 20090427_abe_売上計画出力対応 END*/
      lv_report_id   := cv_pkg_name;
    END IF;
    -- DEBUGメッセージ
    -- 帳票タイトル
    debug(
       buff   => '帳票タイトル :' || lv_report_name
     );
    -- 訪問帳票ワークテーブルに出力
    -- 明細部
    FOR i IN 1..(in_m_cnt) LOOP
      BEGIN
        ln_line_kind              := cn_line_kind2;              -- 帳票出力位置
        ln_line_num               := i;                          -- 行番号
        INSERT INTO xxcso_rep_visit_sale_plan(
           report_output_no               -- 帳票出力セット番号
          ,line_kind                      -- 帳票出力位置
          ,line_num                       -- 行番号
          ,report_id                      -- 帳票ＩＤ
          ,report_name                    -- 帳票タイトル
          ,output_date                    -- 出力日時
          ,year_month                     -- 基準年月
          ,operation_days                 -- 稼動日数
          ,operation_all_days             -- 稼動可能日数
          ,up_base_code                   -- 拠点コード（親）
          ,up_hub_name                    -- 拠点名称（親）
          ,base_code                      -- 拠点コード
          ,hub_name                       -- 拠点名称
          ,group_number                   -- 営業グループ番号
          ,group_name                     -- 営業グループ名
          ,employee_number                -- 営業員コード
          ,employee_name                  -- 営業員名
          ,business_high_type             -- 業態（大分類）
          ,business_high_name             -- 業態（大分類）名
          ,gvm_type                       -- 一般／自販機／ＭＣ
          ,account_number                 -- 顧客コード
          ,customer_name                  -- 顧客名
          ,route_no                       -- ルートNo
          ,last_year_rslt_sales_amt       -- 前年実績
          ,last_mon_rslt_sales_amt        -- 先月実績
          ,new_customer_num               -- 新規顧客件数
          ,new_vendor_num                 -- 新規ＶＤ件数
          ,new_customer_amt               -- 新規顧客売上実績
          ,new_vendor_amt                 -- 新規ＶＤ売上実績
          ,plan_sales_amt                 -- 売上予算
          ,plan_vs_amt_1                  -- １日－売上／訪問計画
          ,rslt_vs_amt_1                  -- １日－売上／訪問実績
          ,rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
          ,effective_num_1                -- １日－有効軒数
          ,visit_sign_1                   -- １日－訪問記号
          ,plan_vs_amt_2                  -- ２日－売上／訪問計画
          ,rslt_vs_amt_2                  -- ２日－売上／訪問実績
          ,rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
          ,effective_num_2                -- ２日－有効軒数
          ,visit_sign_2                   -- ２日－訪問記号
          ,plan_vs_amt_3                  -- ３日－売上／訪問計画
          ,rslt_vs_amt_3                  -- ３日－売上／訪問実績
          ,rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
          ,effective_num_3                -- ３日－有効軒数
          ,visit_sign_3                   -- ３日－訪問記号
          ,plan_vs_amt_4                  -- ４日－売上／訪問計画
          ,rslt_vs_amt_4                  -- ４日－売上／訪問実績
          ,rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
          ,effective_num_4                -- ４日－有効軒数
          ,visit_sign_4                   -- ４日－訪問記号
          ,plan_vs_amt_5                  -- ５日－売上／訪問計画
          ,rslt_vs_amt_5                  -- ５日－売上／訪問実績
          ,rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
          ,effective_num_5                -- ５日－有効軒数
          ,visit_sign_5                   -- ５日－訪問記号
          ,plan_vs_amt_6                  -- ６日－売上／訪問計画
          ,rslt_vs_amt_6                  -- ６日－売上／訪問実績
          ,rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
          ,effective_num_6                -- ６日－有効軒数
          ,visit_sign_6                   -- ６日－訪問記号
          ,plan_vs_amt_7                  -- ７日－売上／訪問計画
          ,rslt_vs_amt_7                  -- ７日－売上／訪問実績
          ,rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
          ,effective_num_7                -- ７日－有効軒数
          ,visit_sign_7                   -- ７日－訪問記号
          ,plan_vs_amt_8                  -- ８日－売上／訪問計画
          ,rslt_vs_amt_8                  -- ８日－売上／訪問実績
          ,rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
          ,effective_num_8                -- ８日－有効軒数
          ,visit_sign_8                   -- ８日－訪問記号
          ,plan_vs_amt_9                  -- ９日－売上／訪問計画
          ,rslt_vs_amt_9                  -- ９日－売上／訪問実績
          ,rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
          ,effective_num_9                -- ９日－有効軒数
          ,visit_sign_9                   -- ９日－訪問記号
          ,plan_vs_amt_10                 -- １０日－売上／訪問計画
          ,rslt_vs_amt_10                 -- １０日－売上／訪問実績
          ,rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
          ,effective_num_10               -- １０日－有効軒数
          ,visit_sign_10                  -- １０日－訪問記号
          ,plan_vs_amt_11                 -- １１日－売上／訪問計画
          ,rslt_vs_amt_11                 -- １１日－売上／訪問実績
          ,rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
          ,effective_num_11               -- １１日－有効軒数
          ,visit_sign_11                  -- １１日－訪問記号
          ,plan_vs_amt_12                 -- １２日－売上／訪問計画
          ,rslt_vs_amt_12                 -- １２日－売上／訪問実績
          ,rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
          ,effective_num_12               -- １２日－有効軒数
          ,visit_sign_12                  -- １２日－訪問記号
          ,plan_vs_amt_13                 -- １３日－売上／訪問計画
          ,rslt_vs_amt_13                 -- １３日－売上／訪問実績
          ,rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
          ,effective_num_13               -- １３日－有効軒数
          ,visit_sign_13                  -- １３日－訪問記号
          ,plan_vs_amt_14                 -- １４日－売上／訪問計画
          ,rslt_vs_amt_14                 -- １４日－売上／訪問実績
          ,rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
          ,effective_num_14               -- １４日－有効軒数
          ,visit_sign_14                  -- １４日－訪問記号
          ,plan_vs_amt_15                 -- １５日－売上／訪問計画
          ,rslt_vs_amt_15                 -- １５日－売上／訪問実績
          ,rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
          ,effective_num_15               -- １５日－有効軒数
          ,visit_sign_15                  -- １５日－訪問記号
          ,plan_vs_amt_16                 -- １６日－売上／訪問計画
          ,rslt_vs_amt_16                 -- １６日－売上／訪問実績
          ,rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
          ,effective_num_16               -- １６日－有効軒数
          ,visit_sign_16                  -- １６日－訪問記号
          ,plan_vs_amt_17                 -- １７日－売上／訪問計画
          ,rslt_vs_amt_17                 -- １７日－売上／訪問実績
          ,rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
          ,effective_num_17               -- １７日－有効軒数
          ,visit_sign_17                  -- １７日－訪問記号
          ,plan_vs_amt_18                 -- １８日－売上／訪問計画
          ,rslt_vs_amt_18                 -- １８日－売上／訪問実績
          ,rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
          ,effective_num_18               -- １８日－有効軒数
          ,visit_sign_18                  -- １８日－訪問記号
          ,plan_vs_amt_19                 -- １９日－売上／訪問計画
          ,rslt_vs_amt_19                 -- １９日－売上／訪問実績
          ,rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
          ,effective_num_19               -- １９日－有効軒数
          ,visit_sign_19                  -- １９日－訪問記号
          ,plan_vs_amt_20                 -- ２０日－売上／訪問計画
          ,rslt_vs_amt_20                 -- ２０日－売上／訪問実績
          ,rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
          ,effective_num_20               -- ２０日－有効軒数
          ,visit_sign_20                  -- ２０日－訪問記号
          ,plan_vs_amt_21                 -- ２１日－売上／訪問計画
          ,rslt_vs_amt_21                 -- ２１日－売上／訪問実績
          ,rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
          ,effective_num_21               -- ２１日－有効軒数
          ,visit_sign_21                  -- ２１日－訪問記号
          ,plan_vs_amt_22                 -- ２２日－売上／訪問計画
          ,rslt_vs_amt_22                 -- ２２日－売上／訪問実績
          ,rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
          ,effective_num_22               -- ２２日－有効軒数
          ,visit_sign_22                  -- ２２日－訪問記号
          ,plan_vs_amt_23                 -- ２３日－売上／訪問計画
          ,rslt_vs_amt_23                 -- ２３日－売上／訪問実績
          ,rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
          ,effective_num_23               -- ２３日－有効軒数
          ,visit_sign_23                  -- ２３日－訪問記号
          ,plan_vs_amt_24                 -- ２４日－売上／訪問計画
          ,rslt_vs_amt_24                 -- ２４日－売上／訪問実績
          ,rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
          ,effective_num_24               -- ２４日－有効軒数
          ,visit_sign_24                  -- ２４日－訪問記号
          ,plan_vs_amt_25                 -- ２５日－売上／訪問計画
          ,rslt_vs_amt_25                 -- ２５日－売上／訪問実績
          ,rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
          ,effective_num_25               -- ２５日－有効軒数
          ,visit_sign_25                  -- ２５日－訪問記号
          ,plan_vs_amt_26                 -- ２６日－売上／訪問計画
          ,rslt_vs_amt_26                 -- ２６日－売上／訪問実績
          ,rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
          ,effective_num_26               -- ２６日－有効軒数
          ,visit_sign_26                  -- ２６日－訪問記号
          ,plan_vs_amt_27                 -- ２７日－売上／訪問計画
          ,rslt_vs_amt_27                 -- ２７日－売上／訪問実績
          ,rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
          ,effective_num_27               -- ２７日－有効軒数
          ,visit_sign_27                  -- ２７日－訪問記号
          ,plan_vs_amt_28                 -- ２８日－売上／訪問計画
          ,rslt_vs_amt_28                 -- ２８日－売上／訪問実績
          ,rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
          ,effective_num_28               -- ２８日－有効軒数
          ,visit_sign_28                  -- ２８日－訪問記号
          ,plan_vs_amt_29                 -- ２９日－売上／訪問計画
          ,rslt_vs_amt_29                 -- ２９日－売上／訪問実績
          ,rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
          ,effective_num_29               -- ２９日－有効軒数
          ,visit_sign_29                  -- ２９日－訪問記号
          ,plan_vs_amt_30                 -- ３０日－売上／訪問計画
          ,rslt_vs_amt_30                 -- ３０日－売上／訪問実績
          ,rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
          ,effective_num_30               -- ３０日－有効軒数
          ,visit_sign_30                  -- ３０日－訪問記号
          ,plan_vs_amt_31                 -- ３１日－売上／訪問計画
          ,rslt_vs_amt_31                 -- ３１日－売上／訪問実績
          ,rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
          ,effective_num_31               -- ３１日－有効軒数
          ,visit_sign_31                  -- ３１日－訪問記号
          ,vis_a_num                      -- 訪問Ａ件数
          ,vis_b_num                      -- 訪問Ｂ件数
          ,vis_c_num                      -- 訪問Ｃ件数
          ,vis_d_num                      -- 訪問Ｄ件数
          ,vis_e_num                      -- 訪問Ｅ件数
          ,vis_f_num                      -- 訪問Ｆ件数
          ,vis_g_num                      -- 訪問Ｇ件数
          ,vis_h_num                      -- 訪問Ｈ件数
          ,vis_i_num                      -- 訪問ⅰ件数
          ,vis_j_num                      -- 訪問Ｊ件数
          ,vis_k_num                      -- 訪問Ｋ件数
          ,vis_l_num                      -- 訪問Ｌ件数
          ,vis_m_num                      -- 訪問Ｍ件数
          ,vis_n_num                      -- 訪問Ｎ件数
          ,vis_o_num                      -- 訪問Ｏ件数
          ,vis_p_num                      -- 訪問Ｐ件数
          ,vis_q_num                      -- 訪問Ｑ件数
          ,vis_r_num                      -- 訪問Ｒ件数
          ,vis_s_num                      -- 訪問Ｓ件数
          ,vis_t_num                      -- 訪問Ｔ件数
          ,vis_u_num                      -- 訪問Ｕ件数
          ,vis_v_num                      -- 訪問Ｖ件数
          ,vis_w_num                      -- 訪問Ｗ件数
          ,vis_x_num                      -- 訪問Ｘ件数
          ,vis_y_num                      -- 訪問Ｙ件数
          ,vis_z_num                      -- 訪問Ｚ件数
          ,created_by                     -- 作成者
          ,creation_date                  -- 作成日
          ,last_updated_by                -- 最終更新者
          ,last_update_date               -- 最終更新日
          ,last_update_login              -- 最終更新ログイン
          ,request_id                     -- 要求ID
          ,program_application_id         -- コンカレント・プログラム・アプリケーションID
          ,program_id                     -- コンカレント・プログラムID
          ,program_update_date            -- プログラム更新日
          )
          VALUES(
           in_report_output_no                              -- 帳票出力セット番号
          ,ln_line_kind                                     -- 帳票出力位置
          ,ln_line_num                                      -- 行番号
          ,NULL                                             -- 帳票ＩＤ
          ,NULL                                             -- 帳票タイトル
          ,NULL                                             -- 出力日時
          ,NULL                                             -- 基準年月
          ,NULL                                             -- 稼動日数
          ,NULL                                             -- 稼動可能日数
          ,ir_m_tab(i).up_base_code                         -- 拠点コード（親）
          ,ir_m_tab(i).up_hub_name                          -- 拠点名称（親）
          ,ir_m_tab(i).base_code                            -- 拠点コード
          ,ir_m_tab(i).hub_name                             -- 拠点名称
          ,ir_m_tab(i).group_number                         -- 営業グループ番号
          ,ir_m_tab(i).group_name                           -- 営業グループ名
          ,ir_m_tab(i).employee_number                      -- 営業員コード
          ,ir_m_tab(i).employee_name                        -- 営業員名
          ,ir_m_tab(i).business_high_type                   -- 業態（大分類）
          ,ir_m_tab(i).business_high_name                   -- 業態（大分類）名
          ,ir_m_tab(i).gvm_type                             -- 一般／自販機／ＭＣ
          ,ir_m_tab(i).account_number                       -- 顧客コード
          ,ir_m_tab(i).customer_name                        -- 顧客名
          ,ir_m_tab(i).route_no                             -- ルートNo
          ,ir_m_tab(i).last_year_rslt_sales_amt             -- 前年実績
          ,ir_m_tab(i).last_mon_rslt_sales_amt              -- 先月実績
          ,ir_m_tab(i).new_customer_num                     -- 新規顧客件数
          ,ir_m_tab(i).new_vendor_num                       -- 新規ＶＤ件数
          ,ir_m_tab(i).new_customer_amt                     -- 新規顧客売上実績
          ,ir_m_tab(i).new_vendor_amt                       -- 新規ＶＤ売上実績
          ,ir_m_tab(i).plan_sales_amt                       -- 売上予算
          ,ir_m_tab(i).l_get_one_day_tab(1).plan_vs_amt             -- １日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(1).rslt_vs_amt             -- １日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(1).rslt_other_sales_amt    -- １日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(1).effective_num           -- １日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(1).visit_sign              -- １日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(2).plan_vs_amt             -- ２日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(2).rslt_vs_amt             -- ２日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(2).rslt_other_sales_amt    -- ２日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(2).effective_num           -- ２日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(2).visit_sign              -- ２日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(3).plan_vs_amt             -- ３日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(3).rslt_vs_amt             -- ３日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(3).rslt_other_sales_amt    -- ３日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(3).effective_num           -- ３日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(3).visit_sign              -- ３日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(4).plan_vs_amt             -- ４日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(4).rslt_vs_amt             -- ４日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(4).rslt_other_sales_amt    -- ４日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(4).effective_num           -- ４日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(4).visit_sign              -- ４日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(5).plan_vs_amt             -- ５日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(5).rslt_vs_amt             -- ５日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(5).rslt_other_sales_amt    -- ５日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(5).effective_num           -- ５日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(5).visit_sign              -- ５日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(6).plan_vs_amt             -- ６日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(6).rslt_vs_amt             -- ６日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(6).rslt_other_sales_amt    -- ６日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(6).effective_num           -- ６日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(6).visit_sign              -- ６日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(7).plan_vs_amt             -- ７日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(7).rslt_vs_amt             -- ７日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(7).rslt_other_sales_amt    -- ７日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(7).effective_num           -- ７日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(7).visit_sign              -- ７日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(8).plan_vs_amt             -- ８日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(8).rslt_vs_amt             -- ８日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(8).rslt_other_sales_amt    -- ８日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(8).effective_num           -- ８日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(8).visit_sign              -- ８日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(9).plan_vs_amt             -- ９日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(9).rslt_vs_amt             -- ９日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(9).rslt_other_sales_amt    -- ９日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(9).effective_num           -- ９日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(9).visit_sign              -- ９日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(10).plan_vs_amt            -- １０日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(10).rslt_vs_amt            -- １０日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(10).rslt_other_sales_amt   -- １０日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(10).effective_num          -- １０日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(10).visit_sign             -- １０日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(11).plan_vs_amt            -- １１日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(11).rslt_vs_amt            -- １１日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(11).rslt_other_sales_amt   -- １１日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(11).effective_num          -- １１日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(11).visit_sign             -- １１日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(12).plan_vs_amt            -- １２日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(12).rslt_vs_amt            -- １２日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(12).rslt_other_sales_amt   -- １２日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(12).effective_num          -- １２日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(12).visit_sign             -- １２日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(13).plan_vs_amt            -- １３日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(13).rslt_vs_amt            -- １３日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(13).rslt_other_sales_amt   -- １３日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(13).effective_num          -- １３日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(13).visit_sign             -- １３日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(14).plan_vs_amt            -- １４日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(14).rslt_vs_amt            -- １４日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(14).rslt_other_sales_amt   -- １４日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(14).effective_num          -- １４日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(14).visit_sign             -- １４日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(15).plan_vs_amt            -- １５日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(15).rslt_vs_amt            -- １５日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(15).rslt_other_sales_amt   -- １５日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(15).effective_num          -- １５日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(15).visit_sign             -- １５日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(16).plan_vs_amt            -- １６日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(16).rslt_vs_amt            -- １６日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(16).rslt_other_sales_amt   -- １６日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(16).effective_num          -- １６日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(16).visit_sign             -- １６日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(17).plan_vs_amt            -- １７日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(17).rslt_vs_amt            -- １７日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(17).rslt_other_sales_amt   -- １７日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(17).effective_num          -- １７日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(17).visit_sign             -- １７日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(18).plan_vs_amt            -- １８日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(18).rslt_vs_amt            -- １８日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(18).rslt_other_sales_amt   -- １８日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(18).effective_num          -- １８日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(18).visit_sign             -- １８日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(19).plan_vs_amt            -- １９日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(19).rslt_vs_amt            -- １９日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(19).rslt_other_sales_amt   -- １９日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(19).effective_num          -- １９日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(19).visit_sign             -- １９日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(20).plan_vs_amt            -- ２０日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(20).rslt_vs_amt            -- ２０日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(20).rslt_other_sales_amt   -- ２０日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(20).effective_num          -- ２０日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(20).visit_sign             -- ２０日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(21).plan_vs_amt            -- ２１日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(21).rslt_vs_amt            -- ２１日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(21).rslt_other_sales_amt   -- ２１日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(21).effective_num          -- ２１日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(21).visit_sign             -- ２１日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(22).plan_vs_amt            -- ２２日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(22).rslt_vs_amt            -- ２２日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(22).rslt_other_sales_amt   -- ２２日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(22).effective_num          -- ２２日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(22).visit_sign             -- ２２日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(23).plan_vs_amt            -- ２３日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(23).rslt_vs_amt            -- ２３日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(23).rslt_other_sales_amt   -- ２３日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(23).effective_num          -- ２３日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(23).visit_sign             -- ２３日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(24).plan_vs_amt            -- ２４日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(24).rslt_vs_amt            -- ２４日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(24).rslt_other_sales_amt   -- ２４日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(24).effective_num          -- ２４日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(24).visit_sign             -- ２４日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(25).plan_vs_amt            -- ２５日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(25).rslt_vs_amt            -- ２５日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(25).rslt_other_sales_amt   -- ２５日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(25).effective_num          -- ２５日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(25).visit_sign             -- ２５日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(26).plan_vs_amt            -- ２６日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(26).rslt_vs_amt            -- ２６日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(26).rslt_other_sales_amt   -- ２６日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(26).effective_num          -- ２６日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(26).visit_sign             -- ２６日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(27).plan_vs_amt            -- ２７日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(27).rslt_vs_amt            -- ２７日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(27).rslt_other_sales_amt   -- ２７日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(27).effective_num          -- ２７日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(27).visit_sign             -- ２７日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(28).plan_vs_amt            -- ２８日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(28).rslt_vs_amt            -- ２８日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(28).rslt_other_sales_amt   -- ２８日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(28).effective_num          -- ２８日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(28).visit_sign             -- ２８日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(29).plan_vs_amt            -- ２９日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(29).rslt_vs_amt            -- ２９日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(29).rslt_other_sales_amt   -- ２９日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(29).effective_num          -- ２９日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(29).visit_sign             -- ２９日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(30).plan_vs_amt            -- ３０日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(30).rslt_vs_amt            -- ３０日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(30).rslt_other_sales_amt   -- ３０日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(30).effective_num          -- ３０日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(30).visit_sign             -- ３０日－訪問記号
          ,ir_m_tab(i).l_get_one_day_tab(31).plan_vs_amt            -- ３１日－売上／訪問計画
          ,ir_m_tab(i).l_get_one_day_tab(31).rslt_vs_amt            -- ３１日－売上／訪問実績
          ,ir_m_tab(i).l_get_one_day_tab(31).rslt_other_sales_amt   -- ３１日－売上実績（他拠点納品分）
          ,ir_m_tab(i).l_get_one_day_tab(31).effective_num          -- ３１日－有効軒数
          ,ir_m_tab(i).l_get_one_day_tab(31).visit_sign             -- ３１日－訪問記号
          ,ir_m_tab(i).vis_a_num                                    -- 訪問Ａ件数
          ,ir_m_tab(i).vis_b_num                                    -- 訪問Ｂ件数
          ,ir_m_tab(i).vis_c_num                                    -- 訪問Ｃ件数
          ,ir_m_tab(i).vis_d_num                                    -- 訪問Ｄ件数
          ,ir_m_tab(i).vis_e_num                                    -- 訪問Ｅ件数
          ,ir_m_tab(i).vis_f_num                                    -- 訪問Ｆ件数
          ,ir_m_tab(i).vis_g_num                                    -- 訪問Ｇ件数
          ,ir_m_tab(i).vis_h_num                                    -- 訪問Ｈ件数
          ,ir_m_tab(i).vis_i_num                                    -- 訪問ⅰ件数
          ,ir_m_tab(i).vis_j_num                                    -- 訪問Ｊ件数
          ,ir_m_tab(i).vis_k_num                                    -- 訪問Ｋ件数
          ,ir_m_tab(i).vis_l_num                                    -- 訪問Ｌ件数
          ,ir_m_tab(i).vis_m_num                                    -- 訪問Ｍ件数
          ,ir_m_tab(i).vis_n_num                                    -- 訪問Ｎ件数
          ,ir_m_tab(i).vis_o_num                                    -- 訪問Ｏ件数
          ,ir_m_tab(i).vis_p_num                                    -- 訪問Ｐ件数
          ,ir_m_tab(i).vis_q_num                                    -- 訪問Ｑ件数
          ,ir_m_tab(i).vis_r_num                                    -- 訪問Ｒ件数
          ,ir_m_tab(i).vis_s_num                                    -- 訪問Ｓ件数
          ,ir_m_tab(i).vis_t_num                                    -- 訪問Ｔ件数
          ,ir_m_tab(i).vis_u_num                                    -- 訪問Ｕ件数
          ,ir_m_tab(i).vis_v_num                                    -- 訪問Ｖ件数
          ,ir_m_tab(i).vis_w_num                                    -- 訪問Ｗ件数
          ,ir_m_tab(i).vis_x_num                                    -- 訪問Ｘ件数
          ,ir_m_tab(i).vis_y_num                                    -- 訪問Ｙ件数
          ,ir_m_tab(i).vis_z_num                                    -- 訪問Ｚ件数
          ,cn_created_by                                            -- 作成者
          ,cd_creation_date                                         -- 作成日
          ,cn_last_updated_by                                       -- 最終更新者
          ,cd_last_update_date                                      -- 最終更新日
          ,cn_last_update_login                                     -- 最終更新ログイン
          ,cn_request_id                                            -- 要求ID
          ,cn_program_application_id                                -- コンカレント・プログラム・アプリケーションID
          ,cn_program_id                                            -- コンカレント・プログラムID
          ,cd_program_update_date                                   -- プログラム更新日
          );
--
DO_ERROR('A-X-4-1');
--
        gn_normal_cnt := gn_normal_cnt + 1;
      EXCEPTION
        WHEN OTHERS THEN
        -- DEBUGメッセージ
        -- 帳票タイトル
        fnd_file.put_line(
           which  => FND_FILE.LOG,
           buff   => '明細部配列出力に失敗しました。 :' || TO_CHAR(ln_line_num) || SQLERRM ||
                    ''                         -- 空行の挿入
        );
        RAISE global_api_others_expt;
      END;
    END LOOP;
    -- 帳票本体部
    FOR i IN 1..cn_idx_max LOOP
      IF( i < cn_idx_sales_sum )  THEN               -- 売り上げ中計部
        ln_line_kind              := cn_line_kind3;              -- 帳票出力位置
        ln_line_num               := i;                          -- 行番号
      ELSIF( i = cn_idx_sales_sum ) THEN            -- 売り上げ合計部
        ln_line_kind              := cn_line_kind4;              -- 帳票出力位置
        ln_line_num               := 1;                          -- 行番号
        lv_up_base_code           := ir_hon_tab(i).up_base_code;
        lv_up_hub_name            := ir_hon_tab(i).up_hub_name;
        lv_base_code              := ir_hon_tab(i).base_code;
        lv_hub_name               := ir_hon_tab(i).hub_name;
        lv_group_number           := ir_hon_tab(i).group_number;
        lv_group_name             := ir_hon_tab(i).group_name;
        lv_employee_number        := ir_hon_tab(i).employee_number;
        lv_employee_name          := ir_hon_tab(i).employee_name;
      ELSIF( i BETWEEN cn_idx_visit_ippn AND cn_idx_visit_mc )  THEN    -- 訪問中計部
        ln_line_kind              := cn_line_kind5;              -- 帳票出力位置
        ln_line_num               := i -3;                       -- 行番号
      ELSIF( i = cn_idx_visit_sum ) THEN            -- 訪問合計部
        ln_line_kind              := cn_line_kind6;              -- 帳票出力位置
        ln_line_num               := 1;                          -- 行番号
      ELSIF( i = cn_idx_visit_dsc ) THEN            -- 訪問内容合計部
        ln_line_kind              := cn_line_kind7;              -- 帳票出力位置
        ln_line_num               := 1;                          -- 行番号
      END IF;
      INSERT INTO xxcso_rep_visit_sale_plan(
         report_output_no                                 -- 帳票出力セット番号
        ,line_kind                                        -- 帳票出力位置
        ,line_num                                         -- 行番号
        ,report_id                                        -- 帳票ＩＤ
        ,report_name                                      -- 帳票タイトル
        ,output_date                                      -- 出力日時
        ,year_month                                       -- 基準年月
        ,operation_days                                   -- 稼動日数
        ,operation_all_days                               -- 稼動可能日数
        ,up_base_code                                     -- 拠点コード（親）
        ,up_hub_name                                      -- 拠点名称（親）
        ,base_code                                        -- 拠点コード
        ,hub_name                                         -- 拠点名称
        ,group_number                                     -- 営業グループ番号
        ,group_name                                       -- 営業グループ名
        ,employee_number                                  -- 営業員コード
        ,employee_name                                    -- 営業員名
        ,business_high_type                               -- 業態（大分類）
        ,business_high_name                               -- 業態（大分類）名
        ,gvm_type                                         -- 一般／自販機／ＭＣ
        ,account_number                                   -- 顧客コード
        ,customer_name                                    -- 顧客名
        ,route_no                                         -- ルートNo
        ,last_year_rslt_sales_amt                         -- 前年実績
        ,last_mon_rslt_sales_amt                          -- 先月実績
        ,new_customer_num                                 -- 新規顧客件数
        ,new_vendor_num                                   -- 新規ＶＤ件数
        ,new_customer_amt                                 -- 新規顧客売上実績
        ,new_vendor_amt                                   -- 新規ＶＤ売上実績
        ,plan_sales_amt                                   -- 売上予算
        ,plan_vs_amt_1                                    -- １日－売上／訪問計画
        ,rslt_vs_amt_1                                    -- １日－売上／訪問実績
        ,rslt_other_sales_amt_1                           -- １日－売上実績（他拠点納品分）
        ,effective_num_1                                  -- １日－有効軒数
        ,visit_sign_1                                     -- １日－訪問記号
        ,plan_vs_amt_2                                    -- ２日－売上／訪問計画
        ,rslt_vs_amt_2                                    -- ２日－売上／訪問実績
        ,rslt_other_sales_amt_2                           -- ２日－売上実績（他拠点納品分）
        ,effective_num_2                                  -- ２日－有効軒数
        ,visit_sign_2                                     -- ２日－訪問記号
        ,plan_vs_amt_3                                    -- ３日－売上／訪問計画
        ,rslt_vs_amt_3                                    -- ３日－売上／訪問実績
        ,rslt_other_sales_amt_3                           -- ３日－売上実績（他拠点納品分）
        ,effective_num_3                                  -- ３日－有効軒数
        ,visit_sign_3                                     -- ３日－訪問記号
        ,plan_vs_amt_4                                    -- ４日－売上／訪問計画
        ,rslt_vs_amt_4                                    -- ４日－売上／訪問実績
        ,rslt_other_sales_amt_4                           -- ４日－売上実績（他拠点納品分）
        ,effective_num_4                                  -- ４日－有効軒数
        ,visit_sign_4                                     -- ４日－訪問記号
        ,plan_vs_amt_5                                    -- ５日－売上／訪問計画
        ,rslt_vs_amt_5                                    -- ５日－売上／訪問実績
        ,rslt_other_sales_amt_5                           -- ５日－売上実績（他拠点納品分）
        ,effective_num_5                                  -- ５日－有効軒数
        ,visit_sign_5                                     -- ５日－訪問記号
        ,plan_vs_amt_6                                    -- ６日－売上／訪問計画
        ,rslt_vs_amt_6                                    -- ６日－売上／訪問実績
        ,rslt_other_sales_amt_6                           -- ６日－売上実績（他拠点納品分）
        ,effective_num_6                                  -- ６日－有効軒数
        ,visit_sign_6                                     -- ６日－訪問記号
        ,plan_vs_amt_7                                    -- ７日－売上／訪問計画
        ,rslt_vs_amt_7                                    -- ７日－売上／訪問実績
        ,rslt_other_sales_amt_7                           -- ７日－売上実績（他拠点納品分）
        ,effective_num_7                                  -- ７日－有効軒数
        ,visit_sign_7                                     -- ７日－訪問記号
        ,plan_vs_amt_8                                    -- ８日－売上／訪問計画
        ,rslt_vs_amt_8                                    -- ８日－売上／訪問実績
        ,rslt_other_sales_amt_8                           -- ８日－売上実績（他拠点納品分）
        ,effective_num_8                                  -- ８日－有効軒数
        ,visit_sign_8                                     -- ８日－訪問記号
        ,plan_vs_amt_9                                    -- ９日－売上／訪問計画
        ,rslt_vs_amt_9                                    -- ９日－売上／訪問実績
        ,rslt_other_sales_amt_9                           -- ９日－売上実績（他拠点納品分）
        ,effective_num_9                                  -- ９日－有効軒数
        ,visit_sign_9                                     -- ９日－訪問記号
        ,plan_vs_amt_10                                   -- １０日－売上／訪問計画
        ,rslt_vs_amt_10                                   -- １０日－売上／訪問実績
        ,rslt_other_sales_amt_10                          -- １０日－売上実績（他拠点納品分）
        ,effective_num_10                                 -- １０日－有効軒数
        ,visit_sign_10                                    -- １０日－訪問記号
        ,plan_vs_amt_11                                   -- １１日－売上／訪問計画
        ,rslt_vs_amt_11                                   -- １１日－売上／訪問実績
        ,rslt_other_sales_amt_11                          -- １１日－売上実績（他拠点納品分）
        ,effective_num_11                                 -- １１日－有効軒数
        ,visit_sign_11                                    -- １１日－訪問記号
        ,plan_vs_amt_12                                   -- １２日－売上／訪問計画
        ,rslt_vs_amt_12                                   -- １２日－売上／訪問実績
        ,rslt_other_sales_amt_12                          -- １２日－売上実績（他拠点納品分）
        ,effective_num_12                                 -- １２日－有効軒数
        ,visit_sign_12                                    -- １２日－訪問記号
        ,plan_vs_amt_13                                   -- １３日－売上／訪問計画
        ,rslt_vs_amt_13                                   -- １３日－売上／訪問実績
        ,rslt_other_sales_amt_13                          -- １３日－売上実績（他拠点納品分）
        ,effective_num_13                                 -- １３日－有効軒数
        ,visit_sign_13                                    -- １３日－訪問記号
        ,plan_vs_amt_14                                   -- １４日－売上／訪問計画
        ,rslt_vs_amt_14                                   -- １４日－売上／訪問実績
        ,rslt_other_sales_amt_14                          -- １４日－売上実績（他拠点納品分）
        ,effective_num_14                                 -- １４日－有効軒数
        ,visit_sign_14                                    -- １４日－訪問記号
        ,plan_vs_amt_15                                   -- １５日－売上／訪問計画
        ,rslt_vs_amt_15                                   -- １５日－売上／訪問実績
        ,rslt_other_sales_amt_15                          -- １５日－売上実績（他拠点納品分）
        ,effective_num_15                                 -- １５日－有効軒数
        ,visit_sign_15                                    -- １５日－訪問記号
        ,plan_vs_amt_16                                   -- １６日－売上／訪問計画
        ,rslt_vs_amt_16                                   -- １６日－売上／訪問実績
        ,rslt_other_sales_amt_16                          -- １６日－売上実績（他拠点納品分）
        ,effective_num_16                                 -- １６日－有効軒数
        ,visit_sign_16                                    -- １６日－訪問記号
        ,plan_vs_amt_17                                   -- １７日－売上／訪問計画
        ,rslt_vs_amt_17                                   -- １７日－売上／訪問実績
        ,rslt_other_sales_amt_17                          -- １７日－売上実績（他拠点納品分）
        ,effective_num_17                                 -- １７日－有効軒数
        ,visit_sign_17                                    -- １７日－訪問記号
        ,plan_vs_amt_18                                   -- １８日－売上／訪問計画
        ,rslt_vs_amt_18                                   -- １８日－売上／訪問実績
        ,rslt_other_sales_amt_18                          -- １８日－売上実績（他拠点納品分）
        ,effective_num_18                                 -- １８日－有効軒数
        ,visit_sign_18                                    -- １８日－訪問記号
        ,plan_vs_amt_19                                   -- １９日－売上／訪問計画
        ,rslt_vs_amt_19                                   -- １９日－売上／訪問実績
        ,rslt_other_sales_amt_19                          -- １９日－売上実績（他拠点納品分）
        ,effective_num_19                                 -- １９日－有効軒数
        ,visit_sign_19                                    -- １９日－訪問記号
        ,plan_vs_amt_20                                   -- ２０日－売上／訪問計画
        ,rslt_vs_amt_20                                   -- ２０日－売上／訪問実績
        ,rslt_other_sales_amt_20                          -- ２０日－売上実績（他拠点納品分）
        ,effective_num_20                                 -- ２０日－有効軒数
        ,visit_sign_20                                    -- ２０日－訪問記号
        ,plan_vs_amt_21                                   -- ２１日－売上／訪問計画
        ,rslt_vs_amt_21                                   -- ２１日－売上／訪問実績
        ,rslt_other_sales_amt_21                          -- ２１日－売上実績（他拠点納品分）
        ,effective_num_21                                 -- ２１日－有効軒数
        ,visit_sign_21                                    -- ２１日－訪問記号
        ,plan_vs_amt_22                                   -- ２２日－売上／訪問計画
        ,rslt_vs_amt_22                                   -- ２２日－売上／訪問実績
        ,rslt_other_sales_amt_22                          -- ２２日－売上実績（他拠点納品分）
        ,effective_num_22                                 -- ２２日－有効軒数
        ,visit_sign_22                                    -- ２２日－訪問記号
        ,plan_vs_amt_23                                   -- ２３日－売上／訪問計画
        ,rslt_vs_amt_23                                   -- ２３日－売上／訪問実績
        ,rslt_other_sales_amt_23                          -- ２３日－売上実績（他拠点納品分）
        ,effective_num_23                                 -- ２３日－有効軒数
        ,visit_sign_23                                    -- ２３日－訪問記号
        ,plan_vs_amt_24                                   -- ２４日－売上／訪問計画
        ,rslt_vs_amt_24                                   -- ２４日－売上／訪問実績
        ,rslt_other_sales_amt_24                          -- ２４日－売上実績（他拠点納品分）
        ,effective_num_24                                 -- ２４日－有効軒数
        ,visit_sign_24                                    -- ２４日－訪問記号
        ,plan_vs_amt_25                                   -- ２５日－売上／訪問計画
        ,rslt_vs_amt_25                                   -- ２５日－売上／訪問実績
        ,rslt_other_sales_amt_25                          -- ２５日－売上実績（他拠点納品分）
        ,effective_num_25                                 -- ２５日－有効軒数
        ,visit_sign_25                                    -- ２５日－訪問記号
        ,plan_vs_amt_26                                   -- ２６日－売上／訪問計画
        ,rslt_vs_amt_26                                   -- ２６日－売上／訪問実績
        ,rslt_other_sales_amt_26                          -- ２６日－売上実績（他拠点納品分）
        ,effective_num_26                                 -- ２６日－有効軒数
        ,visit_sign_26                                    -- ２６日－訪問記号
        ,plan_vs_amt_27                                   -- ２７日－売上／訪問計画
        ,rslt_vs_amt_27                                   -- ２７日－売上／訪問実績
        ,rslt_other_sales_amt_27                          -- ２７日－売上実績（他拠点納品分）
        ,effective_num_27                                 -- ２７日－有効軒数
        ,visit_sign_27                                    -- ２７日－訪問記号
        ,plan_vs_amt_28                                   -- ２８日－売上／訪問計画
        ,rslt_vs_amt_28                                   -- ２８日－売上／訪問実績
        ,rslt_other_sales_amt_28                          -- ２８日－売上実績（他拠点納品分）
        ,effective_num_28                                 -- ２８日－有効軒数
        ,visit_sign_28                                    -- ２８日－訪問記号
        ,plan_vs_amt_29                                   -- ２９日－売上／訪問計画
        ,rslt_vs_amt_29                                   -- ２９日－売上／訪問実績
        ,rslt_other_sales_amt_29                          -- ２９日－売上実績（他拠点納品分）
        ,effective_num_29                                 -- ２９日－有効軒数
        ,visit_sign_29                                    -- ２９日－訪問記号
        ,plan_vs_amt_30                                   -- ３０日－売上／訪問計画
        ,rslt_vs_amt_30                                   -- ３０日－売上／訪問実績
        ,rslt_other_sales_amt_30                          -- ３０日－売上実績（他拠点納品分）
        ,effective_num_30                                 -- ３０日－有効軒数
        ,visit_sign_30                                    -- ３０日－訪問記号
        ,plan_vs_amt_31                                   -- ３１日－売上／訪問計画
        ,rslt_vs_amt_31                                   -- ３１日－売上／訪問実績
        ,rslt_other_sales_amt_31                          -- ３１日－売上実績（他拠点納品分）
        ,effective_num_31                                 -- ３１日－有効軒数
        ,visit_sign_31                                    -- ３１日－訪問記号
        ,vis_a_num                                        -- 訪問Ａ件数
        ,vis_b_num                                        -- 訪問Ｂ件数
        ,vis_c_num                                        -- 訪問Ｃ件数
        ,vis_d_num                                        -- 訪問Ｄ件数
        ,vis_e_num                                        -- 訪問Ｅ件数
        ,vis_f_num                                        -- 訪問Ｆ件数
        ,vis_g_num                                        -- 訪問Ｇ件数
        ,vis_h_num                                        -- 訪問Ｈ件数
        ,vis_i_num                                        -- 訪問ⅰ件数
        ,vis_j_num                                        -- 訪問Ｊ件数
        ,vis_k_num                                        -- 訪問Ｋ件数
        ,vis_l_num                                        -- 訪問Ｌ件数
        ,vis_m_num                                        -- 訪問Ｍ件数
        ,vis_n_num                                        -- 訪問Ｎ件数
        ,vis_o_num                                        -- 訪問Ｏ件数
        ,vis_p_num                                        -- 訪問Ｐ件数
        ,vis_q_num                                        -- 訪問Ｑ件数
        ,vis_r_num                                        -- 訪問Ｒ件数
        ,vis_s_num                                        -- 訪問Ｓ件数
        ,vis_t_num                                        -- 訪問Ｔ件数
        ,vis_u_num                                        -- 訪問Ｕ件数
        ,vis_v_num                                        -- 訪問Ｖ件数
        ,vis_w_num                                        -- 訪問Ｗ件数
        ,vis_x_num                                        -- 訪問Ｘ件数
        ,vis_y_num                                        -- 訪問Ｙ件数
        ,vis_z_num                                        -- 訪問Ｚ件数
        ,created_by                                       -- 作成者
        ,creation_date                                    -- 作成日
        ,last_updated_by                                  -- 最終更新者
        ,last_update_date                                 -- 最終更新日
        ,last_update_login                                -- 最終更新ログイン
        ,request_id                                       -- 要求ID
        ,program_application_id                           -- コンカレント・プログラム・アプリケーションID
        ,program_id                                       -- コンカレント・プログラムID
        ,program_update_date                               -- プログラム更新日
      )
      VALUES(
        in_report_output_no                              -- 帳票出力セット番号
       ,ln_line_kind                                     -- 帳票出力位置
       ,ln_line_num                                      -- 行番号
       ,NULL                                             -- 帳票ＩＤ
       ,NULL                                             -- 帳票タイトル
       ,NULL                                             -- 出力日時
       ,NULL                                             -- 基準年月
       ,NULL                                             -- 稼動日数
       ,NULL                                             -- 稼動可能日数
       ,ir_hon_tab(i).up_base_code                       -- 拠点コード（親）
       ,ir_hon_tab(i).up_hub_name                        -- 拠点名称（親）
       ,ir_hon_tab(i).base_code                          -- 拠点コード
       ,ir_hon_tab(i).hub_name                           -- 拠点名称
       ,ir_hon_tab(i).group_number                       -- 営業グループ番号
       ,ir_hon_tab(i).group_name                         -- 営業グループ名
       ,ir_hon_tab(i).employee_number                    -- 営業員コード
       ,ir_hon_tab(i).employee_name                      -- 営業員名
       ,ir_hon_tab(i).business_high_type                 -- 業態（大分類）
       ,ir_hon_tab(i).business_high_name                 -- 業態（大分類）名
       ,ir_hon_tab(i).gvm_type                           -- 一般／自販機／ＭＣ
       ,ir_hon_tab(i).account_number                     -- 顧客コード
       ,ir_hon_tab(i).customer_name                      -- 顧客名
       ,ir_hon_tab(i).route_no                           -- ルートNo
       ,ir_hon_tab(i).last_year_rslt_sales_amt           -- 前年実績
       ,ir_hon_tab(i).last_mon_rslt_sales_amt            -- 先月実績
       ,ir_hon_tab(i).new_customer_num                   -- 新規顧客件数
       ,ir_hon_tab(i).new_vendor_num                     -- 新規ＶＤ件数
       ,ir_hon_tab(i).new_customer_amt                   -- 新規顧客売上実績
       ,ir_hon_tab(i).new_vendor_amt                     -- 新規ＶＤ売上実績
       ,ir_hon_tab(i).plan_sales_amt                     -- 売上予算
       ,ir_hon_tab(i).l_get_one_day_tab(1).plan_vs_amt             -- １日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(1).rslt_vs_amt             -- １日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(1).rslt_other_sales_amt    -- １日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(1).effective_num           -- １日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(1).visit_sign              -- １日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(2).plan_vs_amt             -- ２日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(2).rslt_vs_amt             -- ２日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(2).rslt_other_sales_amt    -- ２日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(2).effective_num           -- ２日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(2).visit_sign              -- ２日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(3).plan_vs_amt             -- ３日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(3).rslt_vs_amt             -- ３日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(3).rslt_other_sales_amt    -- ３日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(3).effective_num           -- ３日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(3).visit_sign              -- ３日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(4).plan_vs_amt             -- ４日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(4).rslt_vs_amt             -- ４日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(4).rslt_other_sales_amt    -- ４日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(4).effective_num           -- ４日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(4).visit_sign              -- ４日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(5).plan_vs_amt             -- ５日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(5).rslt_vs_amt             -- ５日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(5).rslt_other_sales_amt    -- ５日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(5).effective_num           -- ５日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(5).visit_sign              -- ５日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(6).plan_vs_amt             -- ６日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(6).rslt_vs_amt             -- ６日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(6).rslt_other_sales_amt    -- ６日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(6).effective_num           -- ６日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(6).visit_sign              -- ６日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(7).plan_vs_amt             -- ７日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(7).rslt_vs_amt             -- ７日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(7).rslt_other_sales_amt    -- ７日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(7).effective_num           -- ７日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(7).visit_sign              -- ７日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(8).plan_vs_amt             -- ８日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(8).rslt_vs_amt             -- ８日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(8).rslt_other_sales_amt    -- ８日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(8).effective_num           -- ８日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(8).visit_sign              -- ８日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(9).plan_vs_amt             -- ９日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(9).rslt_vs_amt             -- ９日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(9).rslt_other_sales_amt    -- ９日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(9).effective_num           -- ９日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(9).visit_sign              -- ９日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(10).plan_vs_amt            -- １０日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(10).rslt_vs_amt            -- １０日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(10).rslt_other_sales_amt   -- １０日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(10).effective_num          -- １０日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(10).visit_sign             -- １０日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(11).plan_vs_amt            -- １１日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(11).rslt_vs_amt            -- １１日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(11).rslt_other_sales_amt   -- １１日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(11).effective_num          -- １１日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(11).visit_sign             -- １１日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(12).plan_vs_amt            -- １２日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(12).rslt_vs_amt            -- １２日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(12).rslt_other_sales_amt   -- １２日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(12).effective_num          -- １２日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(12).visit_sign             -- １２日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(13).plan_vs_amt            -- １３日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(13).rslt_vs_amt            -- １３日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(13).rslt_other_sales_amt   -- １３日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(13).effective_num          -- １３日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(13).visit_sign             -- １３日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(14).plan_vs_amt            -- １４日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(14).rslt_vs_amt            -- １４日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(14).rslt_other_sales_amt   -- １４日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(14).effective_num          -- １４日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(14).visit_sign             -- １４日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(15).plan_vs_amt            -- １５日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(15).rslt_vs_amt            -- １５日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(15).rslt_other_sales_amt   -- １５日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(15).effective_num          -- １５日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(15).visit_sign             -- １５日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(16).plan_vs_amt            -- １６日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(16).rslt_vs_amt            -- １６日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(16).rslt_other_sales_amt   -- １６日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(16).effective_num          -- １６日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(16).visit_sign             -- １６日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(17).plan_vs_amt            -- １７日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(17).rslt_vs_amt            -- １７日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(17).rslt_other_sales_amt   -- １７日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(17).effective_num          -- １７日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(17).visit_sign             -- １７日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(18).plan_vs_amt            -- １８日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(18).rslt_vs_amt            -- １８日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(18).rslt_other_sales_amt   -- １８日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(18).effective_num          -- １８日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(18).visit_sign             -- １８日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(19).plan_vs_amt            -- １９日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(19).rslt_vs_amt            -- １９日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(19).rslt_other_sales_amt   -- １９日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(19).effective_num          -- １９日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(19).visit_sign             -- １９日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(20).plan_vs_amt            -- ２０日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(20).rslt_vs_amt            -- ２０日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(20).rslt_other_sales_amt   -- ２０日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(20).effective_num          -- ２０日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(20).visit_sign             -- ２０日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(21).plan_vs_amt            -- ２１日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(21).rslt_vs_amt            -- ２１日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(21).rslt_other_sales_amt   -- ２１日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(21).effective_num          -- ２１日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(21).visit_sign             -- ２１日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(22).plan_vs_amt            -- ２２日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(22).rslt_vs_amt            -- ２２日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(22).rslt_other_sales_amt   -- ２２日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(22).effective_num          -- ２２日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(22).visit_sign             -- ２２日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(23).plan_vs_amt            -- ２３日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(23).rslt_vs_amt            -- ２３日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(23).rslt_other_sales_amt   -- ２３日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(23).effective_num          -- ２３日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(23).visit_sign             -- ２３日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(24).plan_vs_amt            -- ２４日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(24).rslt_vs_amt            -- ２４日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(24).rslt_other_sales_amt   -- ２４日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(24).effective_num          -- ２４日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(24).visit_sign             -- ２４日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(25).plan_vs_amt            -- ２５日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(25).rslt_vs_amt            -- ２５日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(25).rslt_other_sales_amt   -- ２５日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(25).effective_num          -- ２５日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(25).visit_sign             -- ２５日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(26).plan_vs_amt            -- ２６日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(26).rslt_vs_amt            -- ２６日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(26).rslt_other_sales_amt   -- ２６日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(26).effective_num          -- ２６日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(26).visit_sign             -- ２６日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(27).plan_vs_amt            -- ２７日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(27).rslt_vs_amt            -- ２７日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(27).rslt_other_sales_amt   -- ２７日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(27).effective_num          -- ２７日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(27).visit_sign             -- ２７日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(28).plan_vs_amt            -- ２８日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(28).rslt_vs_amt            -- ２８日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(28).rslt_other_sales_amt   -- ２８日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(28).effective_num          -- ２８日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(28).visit_sign             -- ２８日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(29).plan_vs_amt            -- ２９日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(29).rslt_vs_amt            -- ２９日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(29).rslt_other_sales_amt   -- ２９日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(29).effective_num          -- ２９日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(29).visit_sign             -- ２９日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(30).plan_vs_amt            -- ３０日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(30).rslt_vs_amt            -- ３０日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(30).rslt_other_sales_amt   -- ３０日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(30).effective_num          -- ３０日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(30).visit_sign             -- ３０日－訪問記号
       ,ir_hon_tab(i).l_get_one_day_tab(31).plan_vs_amt            -- ３１日－売上／訪問計画
       ,ir_hon_tab(i).l_get_one_day_tab(31).rslt_vs_amt            -- ３１日－売上／訪問実績
       ,ir_hon_tab(i).l_get_one_day_tab(31).rslt_other_sales_amt   -- ３１日－売上実績（他拠点納品分）
       ,ir_hon_tab(i).l_get_one_day_tab(31).effective_num          -- ３１日－有効軒数
       ,ir_hon_tab(i).l_get_one_day_tab(31).visit_sign             -- ３１日－訪問記号
       ,ir_hon_tab(i).vis_a_num                                    -- 訪問Ａ件数
       ,ir_hon_tab(i).vis_b_num                                    -- 訪問Ｂ件数
       ,ir_hon_tab(i).vis_c_num                                    -- 訪問Ｃ件数
       ,ir_hon_tab(i).vis_d_num                                    -- 訪問Ｄ件数
       ,ir_hon_tab(i).vis_e_num                                    -- 訪問Ｅ件数
       ,ir_hon_tab(i).vis_f_num                                    -- 訪問Ｆ件数
       ,ir_hon_tab(i).vis_g_num                                    -- 訪問Ｇ件数
       ,ir_hon_tab(i).vis_h_num                                    -- 訪問Ｈ件数
       ,ir_hon_tab(i).vis_i_num                                    -- 訪問ⅰ件数
       ,ir_hon_tab(i).vis_j_num                                    -- 訪問Ｊ件数
       ,ir_hon_tab(i).vis_k_num                                    -- 訪問Ｋ件数
       ,ir_hon_tab(i).vis_l_num                                    -- 訪問Ｌ件数
       ,ir_hon_tab(i).vis_m_num                                    -- 訪問Ｍ件数
       ,ir_hon_tab(i).vis_n_num                                    -- 訪問Ｎ件数
       ,ir_hon_tab(i).vis_o_num                                    -- 訪問Ｏ件数
       ,ir_hon_tab(i).vis_p_num                                    -- 訪問Ｐ件数
       ,ir_hon_tab(i).vis_q_num                                    -- 訪問Ｑ件数
       ,ir_hon_tab(i).vis_r_num                                    -- 訪問Ｒ件数
       ,ir_hon_tab(i).vis_s_num                                    -- 訪問Ｓ件数
       ,ir_hon_tab(i).vis_t_num                                    -- 訪問Ｔ件数
       ,ir_hon_tab(i).vis_u_num                                    -- 訪問Ｕ件数
       ,ir_hon_tab(i).vis_v_num                                    -- 訪問Ｖ件数
       ,ir_hon_tab(i).vis_w_num                                    -- 訪問Ｗ件数
       ,ir_hon_tab(i).vis_x_num                                    -- 訪問Ｘ件数
       ,ir_hon_tab(i).vis_y_num                                    -- 訪問Ｙ件数
       ,ir_hon_tab(i).vis_z_num                                    -- 訪問Ｚ件数
       ,cn_created_by                                              -- 作成者
       ,cd_creation_date                                           -- 作成日
       ,cn_last_updated_by                                         -- 最終更新者
       ,cd_last_update_date                                        -- 最終更新日
       ,cn_last_update_login                                       -- 最終更新ログイン
       ,cn_request_id                                              -- 要求ID
       ,cn_program_application_id                                  -- コンカレント・プログラム・アプリケーションID
       ,cn_program_id                                              -- コンカレント・プログラムID
       ,cd_program_update_date                                     -- プログラム更新日
      );
--
DO_ERROR('A-X-4-2');
--
      gn_normal_cnt := gn_normal_cnt + 1;
    END LOOP;
    -- ヘッダー部
    INSERT INTO xxcso_rep_visit_sale_plan(
       report_output_no                                 -- 帳票出力セット番号
      ,line_kind                                        -- 帳票出力位置
      ,line_num                                         -- 行番号
      ,report_id                                        -- 帳票ＩＤ
      ,report_name                                      -- 帳票タイトル
      ,output_date                                      -- 出力日時
      ,year_month                                       -- 基準年月
      ,operation_days                                   -- 稼動日数
      ,operation_all_days                               -- 稼動可能日数
      ,up_base_code                                     -- 拠点コード（親）
      ,up_hub_name                                      -- 拠点名称（親）
      ,base_code                                        -- 拠点コード
      ,hub_name                                         -- 拠点名称
      ,group_number                                     -- 営業グループ番号
      ,group_name                                       -- 営業グループ名
      ,employee_number                                  -- 営業員コード
      ,employee_name                                    -- 営業員名
      ,business_high_type                               -- 業態（大分類）
      ,business_high_name                               -- 業態（大分類）名
      ,gvm_type                                         -- 一般／自販機／ＭＣ
      ,account_number                                   -- 顧客コード
      ,customer_name                                    -- 顧客名
      ,route_no                                         -- ルートNo
      ,last_year_rslt_sales_amt                         -- 前年実績
      ,last_mon_rslt_sales_amt                          -- 先月実績
      ,new_customer_num                                 -- 新規顧客件数
      ,new_vendor_num                                   -- 新規ＶＤ件数
      ,new_customer_amt                                 -- 新規顧客売上実績
      ,new_vendor_amt                                   -- 新規ＶＤ売上実績
      ,plan_sales_amt                                   -- 売上予算
      ,plan_vs_amt_1                                    -- １日－売上／訪問計画
      ,rslt_vs_amt_1                                    -- １日－売上／訪問実績
      ,rslt_other_sales_amt_1                           -- １日－売上実績（他拠点納品分）
      ,effective_num_1                                  -- １日－有効軒数
      ,visit_sign_1                                     -- １日－訪問記号
      ,plan_vs_amt_2                                    -- ２日－売上／訪問計画
      ,rslt_vs_amt_2                                    -- ２日－売上／訪問実績
      ,rslt_other_sales_amt_2                           -- ２日－売上実績（他拠点納品分）
      ,effective_num_2                                  -- ２日－有効軒数
      ,visit_sign_2                                     -- ２日－訪問記号
      ,plan_vs_amt_3                                    -- ３日－売上／訪問計画
      ,rslt_vs_amt_3                                    -- ３日－売上／訪問実績
      ,rslt_other_sales_amt_3                           -- ３日－売上実績（他拠点納品分）
      ,effective_num_3                                  -- ３日－有効軒数
      ,visit_sign_3                                     -- ３日－訪問記号
      ,plan_vs_amt_4                                    -- ４日－売上／訪問計画
      ,rslt_vs_amt_4                                    -- ４日－売上／訪問実績
      ,rslt_other_sales_amt_4                           -- ４日－売上実績（他拠点納品分）
      ,effective_num_4                                  -- ４日－有効軒数
      ,visit_sign_4                                     -- ４日－訪問記号
      ,plan_vs_amt_5                                    -- ５日－売上／訪問計画
      ,rslt_vs_amt_5                                    -- ５日－売上／訪問実績
      ,rslt_other_sales_amt_5                           -- ５日－売上実績（他拠点納品分）
      ,effective_num_5                                  -- ５日－有効軒数
      ,visit_sign_5                                     -- ５日－訪問記号
      ,plan_vs_amt_6                                    -- ６日－売上／訪問計画
      ,rslt_vs_amt_6                                    -- ６日－売上／訪問実績
      ,rslt_other_sales_amt_6                           -- ６日－売上実績（他拠点納品分）
      ,effective_num_6                                  -- ６日－有効軒数
      ,visit_sign_6                                     -- ６日－訪問記号
      ,plan_vs_amt_7                                    -- ７日－売上／訪問計画
      ,rslt_vs_amt_7                                    -- ７日－売上／訪問実績
      ,rslt_other_sales_amt_7                           -- ７日－売上実績（他拠点納品分）
      ,effective_num_7                                  -- ７日－有効軒数
      ,visit_sign_7                                     -- ７日－訪問記号
      ,plan_vs_amt_8                                    -- ８日－売上／訪問計画
      ,rslt_vs_amt_8                                    -- ８日－売上／訪問実績
      ,rslt_other_sales_amt_8                           -- ８日－売上実績（他拠点納品分）
      ,effective_num_8                                  -- ８日－有効軒数
      ,visit_sign_8                                     -- ８日－訪問記号
      ,plan_vs_amt_9                                    -- ９日－売上／訪問計画
      ,rslt_vs_amt_9                                    -- ９日－売上／訪問実績
      ,rslt_other_sales_amt_9                           -- ９日－売上実績（他拠点納品分）
      ,effective_num_9                                  -- ９日－有効軒数
      ,visit_sign_9                                     -- ９日－訪問記号
      ,plan_vs_amt_10                                   -- １０日－売上／訪問計画
      ,rslt_vs_amt_10                                   -- １０日－売上／訪問実績
      ,rslt_other_sales_amt_10                          -- １０日－売上実績（他拠点納品分）
      ,effective_num_10                                 -- １０日－有効軒数
      ,visit_sign_10                                    -- １０日－訪問記号
      ,plan_vs_amt_11                                   -- １１日－売上／訪問計画
      ,rslt_vs_amt_11                                   -- １１日－売上／訪問実績
      ,rslt_other_sales_amt_11                          -- １１日－売上実績（他拠点納品分）
      ,effective_num_11                                 -- １１日－有効軒数
      ,visit_sign_11                                    -- １１日－訪問記号
      ,plan_vs_amt_12                                   -- １２日－売上／訪問計画
      ,rslt_vs_amt_12                                   -- １２日－売上／訪問実績
      ,rslt_other_sales_amt_12                          -- １２日－売上実績（他拠点納品分）
      ,effective_num_12                                 -- １２日－有効軒数
      ,visit_sign_12                                    -- １２日－訪問記号
      ,plan_vs_amt_13                                   -- １３日－売上／訪問計画
      ,rslt_vs_amt_13                                   -- １３日－売上／訪問実績
      ,rslt_other_sales_amt_13                          -- １３日－売上実績（他拠点納品分）
      ,effective_num_13                                 -- １３日－有効軒数
      ,visit_sign_13                                    -- １３日－訪問記号
      ,plan_vs_amt_14                                   -- １４日－売上／訪問計画
      ,rslt_vs_amt_14                                   -- １４日－売上／訪問実績
      ,rslt_other_sales_amt_14                          -- １４日－売上実績（他拠点納品分）
      ,effective_num_14                                 -- １４日－有効軒数
      ,visit_sign_14                                    -- １４日－訪問記号
      ,plan_vs_amt_15                                   -- １５日－売上／訪問計画
      ,rslt_vs_amt_15                                   -- １５日－売上／訪問実績
      ,rslt_other_sales_amt_15                          -- １５日－売上実績（他拠点納品分）
      ,effective_num_15                                 -- １５日－有効軒数
      ,visit_sign_15                                    -- １５日－訪問記号
      ,plan_vs_amt_16                                   -- １６日－売上／訪問計画
      ,rslt_vs_amt_16                                   -- １６日－売上／訪問実績
      ,rslt_other_sales_amt_16                          -- １６日－売上実績（他拠点納品分）
      ,effective_num_16                                 -- １６日－有効軒数
      ,visit_sign_16                                    -- １６日－訪問記号
      ,plan_vs_amt_17                                   -- １７日－売上／訪問計画
      ,rslt_vs_amt_17                                   -- １７日－売上／訪問実績
      ,rslt_other_sales_amt_17                          -- １７日－売上実績（他拠点納品分）
      ,effective_num_17                                 -- １７日－有効軒数
      ,visit_sign_17                                    -- １７日－訪問記号
      ,plan_vs_amt_18                                   -- １８日－売上／訪問計画
      ,rslt_vs_amt_18                                   -- １８日－売上／訪問実績
      ,rslt_other_sales_amt_18                          -- １８日－売上実績（他拠点納品分）
      ,effective_num_18                                 -- １８日－有効軒数
      ,visit_sign_18                                    -- １８日－訪問記号
      ,plan_vs_amt_19                                   -- １９日－売上／訪問計画
      ,rslt_vs_amt_19                                   -- １９日－売上／訪問実績
      ,rslt_other_sales_amt_19                          -- １９日－売上実績（他拠点納品分）
      ,effective_num_19                                 -- １９日－有効軒数
      ,visit_sign_19                                    -- １９日－訪問記号
      ,plan_vs_amt_20                                   -- ２０日－売上／訪問計画
      ,rslt_vs_amt_20                                   -- ２０日－売上／訪問実績
      ,rslt_other_sales_amt_20                          -- ２０日－売上実績（他拠点納品分）
      ,effective_num_20                                 -- ２０日－有効軒数
      ,visit_sign_20                                    -- ２０日－訪問記号
      ,plan_vs_amt_21                                   -- ２１日－売上／訪問計画
      ,rslt_vs_amt_21                                   -- ２１日－売上／訪問実績
      ,rslt_other_sales_amt_21                          -- ２１日－売上実績（他拠点納品分）
      ,effective_num_21                                 -- ２１日－有効軒数
      ,visit_sign_21                                    -- ２１日－訪問記号
      ,plan_vs_amt_22                                   -- ２２日－売上／訪問計画
      ,rslt_vs_amt_22                                   -- ２２日－売上／訪問実績
      ,rslt_other_sales_amt_22                          -- ２２日－売上実績（他拠点納品分）
      ,effective_num_22                                 -- ２２日－有効軒数
      ,visit_sign_22                                    -- ２２日－訪問記号
      ,plan_vs_amt_23                                   -- ２３日－売上／訪問計画
      ,rslt_vs_amt_23                                   -- ２３日－売上／訪問実績
      ,rslt_other_sales_amt_23                          -- ２３日－売上実績（他拠点納品分）
      ,effective_num_23                                 -- ２３日－有効軒数
      ,visit_sign_23                                    -- ２３日－訪問記号
      ,plan_vs_amt_24                                   -- ２４日－売上／訪問計画
      ,rslt_vs_amt_24                                   -- ２４日－売上／訪問実績
      ,rslt_other_sales_amt_24                          -- ２４日－売上実績（他拠点納品分）
      ,effective_num_24                                 -- ２４日－有効軒数
      ,visit_sign_24                                    -- ２４日－訪問記号
      ,plan_vs_amt_25                                   -- ２５日－売上／訪問計画
      ,rslt_vs_amt_25                                   -- ２５日－売上／訪問実績
      ,rslt_other_sales_amt_25                          -- ２５日－売上実績（他拠点納品分）
      ,effective_num_25                                 -- ２５日－有効軒数
      ,visit_sign_25                                    -- ２５日－訪問記号
      ,plan_vs_amt_26                                   -- ２６日－売上／訪問計画
      ,rslt_vs_amt_26                                   -- ２６日－売上／訪問実績
      ,rslt_other_sales_amt_26                          -- ２６日－売上実績（他拠点納品分）
      ,effective_num_26                                 -- ２６日－有効軒数
      ,visit_sign_26                                    -- ２６日－訪問記号
      ,plan_vs_amt_27                                   -- ２７日－売上／訪問計画
      ,rslt_vs_amt_27                                   -- ２７日－売上／訪問実績
      ,rslt_other_sales_amt_27                          -- ２７日－売上実績（他拠点納品分）
      ,effective_num_27                                 -- ２７日－有効軒数
      ,visit_sign_27                                    -- ２７日－訪問記号
      ,plan_vs_amt_28                                   -- ２８日－売上／訪問計画
      ,rslt_vs_amt_28                                   -- ２８日－売上／訪問実績
      ,rslt_other_sales_amt_28                          -- ２８日－売上実績（他拠点納品分）
      ,effective_num_28                                 -- ２８日－有効軒数
      ,visit_sign_28                                    -- ２８日－訪問記号
      ,plan_vs_amt_29                                   -- ２９日－売上／訪問計画
      ,rslt_vs_amt_29                                   -- ２９日－売上／訪問実績
      ,rslt_other_sales_amt_29                          -- ２９日－売上実績（他拠点納品分）
      ,effective_num_29                                 -- ２９日－有効軒数
      ,visit_sign_29                                    -- ２９日－訪問記号
      ,plan_vs_amt_30                                   -- ３０日－売上／訪問計画
      ,rslt_vs_amt_30                                   -- ３０日－売上／訪問実績
      ,rslt_other_sales_amt_30                          -- ３０日－売上実績（他拠点納品分）
      ,effective_num_30                                 -- ３０日－有効軒数
      ,visit_sign_30                                    -- ３０日－訪問記号
      ,plan_vs_amt_31                                   -- ３１日－売上／訪問計画
      ,rslt_vs_amt_31                                   -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_31                          -- ３１日－売上実績（他拠点納品分）
      ,effective_num_31                                 -- ３１日－有効軒数
      ,visit_sign_31                                    -- ３１日－訪問記号
      ,vis_a_num                                        -- 訪問Ａ件数
      ,vis_b_num                                        -- 訪問Ｂ件数
      ,vis_c_num                                        -- 訪問Ｃ件数
      ,vis_d_num                                        -- 訪問Ｄ件数
      ,vis_e_num                                        -- 訪問Ｅ件数
      ,vis_f_num                                        -- 訪問Ｆ件数
      ,vis_g_num                                        -- 訪問Ｇ件数
      ,vis_h_num                                        -- 訪問Ｈ件数
      ,vis_i_num                                        -- 訪問ⅰ件数
      ,vis_j_num                                        -- 訪問Ｊ件数
      ,vis_k_num                                        -- 訪問Ｋ件数
      ,vis_l_num                                        -- 訪問Ｌ件数
      ,vis_m_num                                        -- 訪問Ｍ件数
      ,vis_n_num                                        -- 訪問Ｎ件数
      ,vis_o_num                                        -- 訪問Ｏ件数
      ,vis_p_num                                        -- 訪問Ｐ件数
      ,vis_q_num                                        -- 訪問Ｑ件数
      ,vis_r_num                                        -- 訪問Ｒ件数
      ,vis_s_num                                        -- 訪問Ｓ件数
      ,vis_t_num                                        -- 訪問Ｔ件数
      ,vis_u_num                                        -- 訪問Ｕ件数
      ,vis_v_num                                        -- 訪問Ｖ件数
      ,vis_w_num                                        -- 訪問Ｗ件数
      ,vis_x_num                                        -- 訪問Ｘ件数
      ,vis_y_num                                        -- 訪問Ｙ件数
      ,vis_z_num                                        -- 訪問Ｚ件数
      ,created_by                                       -- 作成者
      ,creation_date                                    -- 作成日
      ,last_updated_by                                  -- 最終更新者
      ,last_update_date                                 -- 最終更新日
      ,last_update_login                                -- 最終更新ログイン
      ,request_id                                       -- 要求ID
      ,program_application_id                           -- コンカレント・プログラム・アプリケーションID
      ,program_id                                       -- コンカレント・プログラムID
      ,program_update_date                               -- プログラム更新日
    )
    VALUES(
       in_report_output_no                              -- 帳票出力セット番号
      ,cn_line_kind1                                    -- 帳票出力位置
      ,1                                                -- 行番号
      ,lv_report_id                                     -- 帳票ＩＤ
      ,lv_report_name                                   -- 帳票タイトル
      ,SYSDATE                                          -- 出力日時
      ,gd_year_month                                    -- 基準年月
      ,gn_operation_days                                -- 稼動日数
      ,gn_operation_all_days                            -- 稼動可能日数
      ,lv_up_base_code                                  -- 拠点コード（親）
      ,lv_up_hub_name                                   -- 拠点名称（親）
      ,lv_base_code                                     -- 拠点コード
      ,lv_hub_name                                      -- 拠点名称
      ,lv_group_number                                  -- 営業グループ番号
      ,lv_group_name                                    -- 営業グループ名
      ,lv_employee_number                               -- 営業員コード
      ,lv_employee_name                                 -- 営業員名
      ,NULL                                             -- 業態（大分類）
      ,NULL                                             -- 業態（大分類）名
      ,NULL                                             -- 一般／自販機／ＭＣ
      ,NULL                                             -- 顧客コード
      ,NULL                                             -- 顧客名
      ,NULL                                             -- ルートNo
      ,NULL                                             -- 前年実績
      ,NULL                                             -- 先月実績
      ,NULL                                             -- 新規顧客件数
      ,NULL                                             -- 新規ＶＤ件数
      ,NULL                                             -- 新規顧客売上実績
      ,NULL                                             -- 新規ＶＤ売上実績
      ,NULL                                             -- 売上予算
      ,NULL                                             -- １日－売上／訪問計画
      ,NULL                                             -- １日－売上／訪問実績
      ,NULL                                             -- １日－売上実績（他拠点納品分）
      ,NULL                                             -- １日－有効軒数
      ,NULL                                             -- １日－訪問記号
      ,NULL                                             -- ２日－売上／訪問計画
      ,NULL                                             -- ２日－売上／訪問実績
      ,NULL                                             -- ２日－売上実績（他拠点納品分）
      ,NULL                                             -- ２日－有効軒数
      ,NULL                                             -- ２日－訪問記号
      ,NULL                                             -- ３日－売上／訪問計画
      ,NULL                                             -- ３日－売上／訪問実績
      ,NULL                                             -- ３日－売上実績（他拠点納品分）
      ,NULL                                             -- ３日－有効軒数
      ,NULL                                             -- ３日－訪問記号
      ,NULL                                             -- ４日－売上／訪問計画
      ,NULL                                             -- ４日－売上／訪問実績
      ,NULL                                             -- ４日－売上実績（他拠点納品分）
      ,NULL                                             -- ４日－有効軒数
      ,NULL                                             -- ４日－訪問記号
      ,NULL                                             -- ５日－売上／訪問計画
      ,NULL                                             -- ５日－売上／訪問実績
      ,NULL                                             -- ５日－売上実績（他拠点納品分）
      ,NULL                                             -- ５日－有効軒数
      ,NULL                                             -- ５日－訪問記号
      ,NULL                                             -- ６日－売上／訪問計画
      ,NULL                                             -- ６日－売上／訪問実績
      ,NULL                                             -- ６日－売上実績（他拠点納品分）
      ,NULL                                             -- ６日－有効軒数
      ,NULL                                             -- ６日－訪問記号
      ,NULL                                             -- ７日－売上／訪問計画
      ,NULL                                             -- ７日－売上／訪問実績
      ,NULL                                             -- ７日－売上実績（他拠点納品分）
      ,NULL                                             -- ７日－有効軒数
      ,NULL                                             -- ７日－訪問記号
      ,NULL                                             -- ８日－売上／訪問計画
      ,NULL                                             -- ８日－売上／訪問実績
      ,NULL                                             -- ８日－売上実績（他拠点納品分）
      ,NULL                                             -- ８日－有効軒数
      ,NULL                                             -- ８日－訪問記号
      ,NULL                                             -- ９日－売上／訪問計画
      ,NULL                                             -- ９日－売上／訪問実績
      ,NULL                                             -- ９日－売上実績（他拠点納品分）
      ,NULL                                             -- ９日－有効軒数
      ,NULL                                             -- ９日－訪問記号
      ,NULL                                             -- １０日－売上／訪問計画
      ,NULL                                             -- １０日－売上／訪問実績
      ,NULL                                             -- １０日－売上実績（他拠点納品分
      ,NULL                                             -- １０日－有効軒数
      ,NULL                                             -- １０日－訪問記号
      ,NULL                                             -- １１日－売上／訪問計画
      ,NULL                                             -- １１日－売上／訪問実績
      ,NULL                                             -- １１日－売上実績（他拠点納品分
      ,NULL                                             -- １１日－有効軒数
      ,NULL                                             -- １１日－訪問記号
      ,NULL                                             -- １２日－売上／訪問計画
      ,NULL                                             -- １２日－売上／訪問実績
      ,NULL                                             -- １２日－売上実績（他拠点納品分
      ,NULL                                             -- １２日－有効軒数
      ,NULL                                             -- １２日－訪問記号
      ,NULL                                             -- １３日－売上／訪問計画
      ,NULL                                             -- １３日－売上／訪問実績
      ,NULL                                             -- １３日－売上実績（他拠点納品分
      ,NULL                                             -- １３日－有効軒数
      ,NULL                                             -- １３日－訪問記号
      ,NULL                                             -- １４日－売上／訪問計画
      ,NULL                                             -- １４日－売上／訪問実績
      ,NULL                                             -- １４日－売上実績（他拠点納品分
      ,NULL                                             -- １４日－有効軒数
      ,NULL                                             -- １４日－訪問記号
      ,NULL                                             -- １５日－売上／訪問計画
      ,NULL                                             -- １５日－売上／訪問実績
      ,NULL                                             -- １５日－売上実績（他拠点納品分
      ,NULL                                             -- １５日－有効軒数
      ,NULL                                             -- １５日－訪問記号
      ,NULL                                             -- １６日－売上／訪問計画
      ,NULL                                             -- １６日－売上／訪問実績
      ,NULL                                             -- １６日－売上実績（他拠点納品分
      ,NULL                                             -- １６日－有効軒数
      ,NULL                                             -- １６日－訪問記号
      ,NULL                                             -- １７日－売上／訪問計画
      ,NULL                                             -- １７日－売上／訪問実績
      ,NULL                                             -- １７日－売上実績（他拠点納品分
      ,NULL                                             -- １７日－有効軒数
      ,NULL                                             -- １７日－訪問記号
      ,NULL                                             -- １８日－売上／訪問計画
      ,NULL                                             -- １８日－売上／訪問実績
      ,NULL                                             -- １８日－売上実績（他拠点納品分
      ,NULL                                             -- １８日－有効軒数
      ,NULL                                             -- １８日－訪問記号
      ,NULL                                             -- １９日－売上／訪問計画
      ,NULL                                             -- １９日－売上／訪問実績
      ,NULL                                             -- １９日－売上実績（他拠点納品分
      ,NULL                                             -- １９日－有効軒数
      ,NULL                                             -- １９日－訪問記号
      ,NULL                                             -- ２０日－売上／訪問計画
      ,NULL                                             -- ２０日－売上／訪問実績
      ,NULL                                             -- ２０日－売上実績（他拠点納品分
      ,NULL                                             -- ２０日－有効軒数
      ,NULL                                             -- ２０日－訪問記号
      ,NULL                                             -- ２１日－売上／訪問計画
      ,NULL                                             -- ２１日－売上／訪問実績
      ,NULL                                             -- ２１日－売上実績（他拠点納品分
      ,NULL                                             -- ２１日－有効軒数
      ,NULL                                             -- ２１日－訪問記号
      ,NULL                                             -- ２２日－売上／訪問計画
      ,NULL                                             -- ２２日－売上／訪問実績
      ,NULL                                             -- ２２日－売上実績（他拠点納品分
      ,NULL                                             -- ２２日－有効軒数
      ,NULL                                             -- ２２日－訪問記号
      ,NULL                                             -- ２３日－売上／訪問計画
      ,NULL                                             -- ２３日－売上／訪問実績
      ,NULL                                             -- ２３日－売上実績（他拠点納品分
      ,NULL                                             -- ２３日－有効軒数
      ,NULL                                             -- ２３日－訪問記号
      ,NULL                                             -- ２４日－売上／訪問計画
      ,NULL                                             -- ２４日－売上／訪問実績
      ,NULL                                             -- ２４日－売上実績（他拠点納品分
      ,NULL                                             -- ２４日－有効軒数
      ,NULL                                             -- ２４日－訪問記号
      ,NULL                                             -- ２５日－売上／訪問計画
      ,NULL                                             -- ２５日－売上／訪問実績
      ,NULL                                             -- ２５日－売上実績（他拠点納品分
      ,NULL                                             -- ２５日－有効軒数
      ,NULL                                             -- ２５日－訪問記号
      ,NULL                                             -- ２６日－売上／訪問計画
      ,NULL                                             -- ２６日－売上／訪問実績
      ,NULL                                             -- ２６日－売上実績（他拠点納品分
      ,NULL                                             -- ２６日－有効軒数
      ,NULL                                             -- ２６日－訪問記号
      ,NULL                                             -- ２７日－売上／訪問計画
      ,NULL                                             -- ２７日－売上／訪問実績
      ,NULL                                             -- ２７日－売上実績（他拠点納品分
      ,NULL                                             -- ２７日－有効軒数
      ,NULL                                             -- ２７日－訪問記号
      ,NULL                                             -- ２８日－売上／訪問計画
      ,NULL                                             -- ２８日－売上／訪問実績
      ,NULL                                             -- ２８日－売上実績（他拠点納品分
      ,NULL                                             -- ２８日－有効軒数
      ,NULL                                             -- ２８日－訪問記号
      ,NULL                                             -- ２９日－売上／訪問計画
      ,NULL                                             -- ２９日－売上／訪問実績
      ,NULL                                             -- ２９日－売上実績（他拠点納品分
      ,NULL                                             -- ２９日－有効軒数
      ,NULL                                             -- ２９日－訪問記号
      ,NULL                                             -- ３０日－売上／訪問計画
      ,NULL                                             -- ３０日－売上／訪問実績
      ,NULL                                             -- ３０日－売上実績（他拠点納品分
      ,NULL                                             -- ３０日－有効軒数
      ,NULL                                             -- ３０日－訪問記号
      ,NULL                                             -- ３１日－売上／訪問計画
      ,NULL                                             -- ３１日－売上／訪問実績
      ,NULL                                             -- ３１日－売上実績（他拠点納品分
      ,NULL                                             -- ３１日－有効軒数
      ,NULL                                             -- ３１日－訪問記号
      ,NULL                                             -- 訪問Ａ件数
      ,NULL                                             -- 訪問Ｂ件数
      ,NULL                                             -- 訪問Ｃ件数
      ,NULL                                             -- 訪問Ｄ件数
      ,NULL                                             -- 訪問Ｅ件数
      ,NULL                                             -- 訪問Ｆ件数
      ,NULL                                             -- 訪問Ｇ件数
      ,NULL                                             -- 訪問Ｈ件数
      ,NULL                                             -- 訪問ⅰ件数
      ,NULL                                             -- 訪問Ｊ件数
      ,NULL                                             -- 訪問Ｋ件数
      ,NULL                                             -- 訪問Ｌ件数
      ,NULL                                             -- 訪問Ｍ件数
      ,NULL                                             -- 訪問Ｎ件数
      ,NULL                                             -- 訪問Ｏ件数
      ,NULL                                             -- 訪問Ｐ件数
      ,NULL                                             -- 訪問Ｑ件数
      ,NULL                                             -- 訪問Ｒ件数
      ,NULL                                             -- 訪問Ｓ件数
      ,NULL                                             -- 訪問Ｔ件数
      ,NULL                                             -- 訪問Ｕ件数
      ,NULL                                             -- 訪問Ｖ件数
      ,NULL                                             -- 訪問Ｗ件数
      ,NULL                                             -- 訪問Ｘ件数
      ,NULL                                             -- 訪問Ｙ件数
      ,NULL                                             -- 訪問Ｚ件数
      ,cn_created_by                                    -- 作成者
      ,cd_creation_date                                 -- 作成日
      ,cn_last_updated_by                               -- 最終更新者
      ,cd_last_update_date                              -- 最終更新日
      ,cn_last_update_login                             -- 最終更新ログイン
      ,cn_request_id                                    -- 要求ID
      ,cn_program_application_id                        -- コンカレント・プログラム・アプリケーションID
      ,cn_program_id                                    -- コンカレント・プログラムID
      ,cd_program_update_date                           -- プログラム更新日
    );
--
DO_ERROR('A-X-4-3');
--
    gn_normal_cnt := gn_normal_cnt + 1;
        debug(
          buff   => ''      || cv_lf ||     -- 空行の挿入
                  'ワークテーブルへの出力完了'
        );
--
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数OTHERS例外ハンドラ ***
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,4000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM||lv_errbuf;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END insert_wrk_table;
--
  /**********************************************************************************
   * Procedure Name   : up_plsql_tab1
   * Description      : 帳票種別1-営業員別-PLSQL表の更新 (A-3-3)
  ***********************************************************************************/
  PROCEDURE up_plsql_tab1(
     i_month_square_rec  IN             g_month_rtype1                     -- 一ヶ月分データ
    ,in_m_cnt            IN             NUMBER                             -- 明細部のカウンタ
    ,io_m_tab            IN OUT NOCOPY  g_get_month_square_ttype           -- 明細部配列
    ,io_hon_tab          IN OUT NOCOPY  g_get_month_square_ttype           -- 本体部配列
    ,ov_errbuf           OUT NOCOPY     VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY     VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY     VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'up_plsql_tab1';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
    ln_m_cnt     NUMBER(5);                         -- 明細部カウンター
    lv_gvm_type  xxcso_rep_visit_sale_plan.gvm_type%TYPE;
    BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
      ln_m_cnt    := in_m_cnt;
      -- DEBUGメッセージ
      -- PL/SQL表の更新
      debug(
         buff   => '営業員別-PL/SQL表の更新処理:' || TO_CHAR(ln_m_cnt)
      );
      -- 売り上げ明細部
      BEGIN
        io_m_tab(ln_m_cnt).base_code       := i_month_square_rec.work_base_code;            -- 勤務地拠点コード
        io_m_tab(ln_m_cnt).hub_name        := i_month_square_rec.base_name;                 -- 勤務地拠点名
        io_m_tab(ln_m_cnt).employee_number := i_month_square_rec.employee_number;           -- 従業員番号
        io_m_tab(ln_m_cnt).employee_name   := i_month_square_rec.name;                      -- 従業員名
        io_m_tab(ln_m_cnt).account_number  := i_month_square_rec.account_number;            -- 顧客コード
        io_m_tab(ln_m_cnt).customer_name   := i_month_square_rec.party_name;                -- 顧客名
        io_m_tab(ln_m_cnt).route_no        := i_month_square_rec.route_number;              -- ルートNo
        io_m_tab(ln_m_cnt).last_year_rslt_sales_amt := i_month_square_rec.rslt_amty;        -- 前年実績
        io_m_tab(ln_m_cnt).last_mon_rslt_sales_amt  := i_month_square_rec.rslt_amtm;        -- 先月実績
        io_m_tab(ln_m_cnt).plan_sales_amt  := i_month_square_rec.tgt_sales_prsn_total_amt;  -- 月別売上予算
        io_m_tab(ln_m_cnt).gvm_type        := i_month_square_rec.gvm_type;                  -- 一般/自販機/ｍｃ
        io_m_tab(ln_m_cnt).business_high_type := i_month_square_rec.business_high_type;     -- 業態（大分類）
        io_m_tab(ln_m_cnt).business_high_name := i_month_square_rec.business_high_name;     -- 業態（大分類）名
        -- DEBUGメッセージ
        -- PL/SQL表の更新
        debug(
           buff   => '営業員別-PL/SQL表の更新処理' || '売り上げ明細部固定部完了'
        );
      EXCEPTION
        WHEN OTHERS THEN
          fnd_file.put_line(
             which  => FND_FILE.LOG,
             buff   => '営業員別-PL/SQL表の更新処理失敗:' || SQLERRM
          );
        RAISE global_api_others_expt;
      END;
      -- 売り上げ中計部
      IF(ln_m_cnt = 1) THEN
        -- DEBUGメッセージ
        -- PL/SQL表の更新
        debug(
           buff   => '営業員別-PL/SQL表の更新処理' || '本体部の固定部'
        );
        FOR i IN 1..cn_idx_max LOOP
          IF (i = cn_idx_sales_ippn) THEN
            io_hon_tab(i).gvm_type := cv_gvm_g;    -- 一般
          ELSIF(i = cn_idx_sales_vd) THEN
            io_hon_tab(i).gvm_type := cv_gvm_v;    -- 自販機
          ELSIF(i = cn_idx_sales_sum) THEN
            io_hon_tab(i).plan_sales_amt     := i_month_square_rec.tgt_sales_prsn_total_amt;-- 売上予算
          ELSIF(i = cn_idx_visit_ippn) THEN
            io_hon_tab(i).gvm_type           := cv_gvm_g;                          -- 一般
          ELSIF(i = cn_idx_visit_vd) THEN
            io_hon_tab(i).gvm_type           := cv_gvm_v;                          -- 自販機
          ELSIF(i = cn_idx_visit_mc) THEN
            io_hon_tab(i).gvm_type           := cv_gvm_m;                          --／ＭＣ
          END IF;
          io_hon_tab(i).base_code       := i_month_square_rec.work_base_code;   -- 業務地拠点コード
          io_hon_tab(i).hub_name        := i_month_square_rec.base_name;        -- 業務地拠点名
          io_hon_tab(i).employee_number := i_month_square_rec.employee_number;  -- 従業員番号
          io_hon_tab(i).employee_name   := i_month_square_rec.name;             -- 従業員名
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   =>  '業務地拠点コード:' || io_hon_tab(i).base_code ||
                          '業務地拠点名:' || io_hon_tab(i).hub_name ||
                            '従業員番号:' || io_hon_tab(i).employee_number ||
                              '従業員名:' || io_hon_tab(i).employee_name
          );
        END LOOP;
      END IF;
--
      -- 売上中計部(一般)
      IF(i_month_square_rec.gvm_type = cv_gvm_g) THEN      -- 一般
        io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt :=
          io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt +
          NVL(i_month_square_rec.rslt_amty, 0);    -- 前年実績
        io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt  :=
          io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt +
          NVL(i_month_square_rec.rslt_amtm, 0);    -- 先月実績
      END IF;
      -- 売上中計部(自販機)
      IF(i_month_square_rec.gvm_type = cv_gvm_v) THEN      -- 自販機
        io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt :=
          io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt +
          NVL(i_month_square_rec.rslt_amty, 0);       -- 前年実績
        io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt :=
          io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt +
          NVL(i_month_square_rec.rslt_amtm, 0);       -- 先月実績
      END IF;
      -- 売上合計部
      io_hon_tab(cn_idx_sales_sum).new_customer_num   :=
        io_hon_tab(cn_idx_sales_sum).new_customer_num +
        NVL(i_month_square_rec.cust_new_num, 0);    -- 顧客件数（新規）
      io_hon_tab(cn_idx_sales_sum).new_vendor_num     :=
        io_hon_tab(cn_idx_sales_sum).new_vendor_num +
        NVL(i_month_square_rec.cust_vd_new_num, 0); -- 新規ＶＤ件数
--
      -- 帳票明細部
      FOR i IN 1..31 LOOP
        BEGIN
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   => '営業員別-PL/SQL表の更新処理' || '1ヶ月分のデータ更新'
          );
          IF(i_month_square_rec.gvm_type = cv_gvm_g) THEN      -- 一般
            -- 売り上げ明細部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-売り上げ明細部(一般)の更新処理' ||
                          '売り上げ計画' || TO_CHAR(i_month_square_rec.l_one_day_tab(i).tgt_amt)
            );
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).plan_vs_amt
              := i_month_square_rec.l_one_day_tab(i).tgt_amt;                 -- 売り上げ計画
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
              := i_month_square_rec.l_one_day_tab(i).rslt_amt;                -- 売り上げ実績
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_other_sales_amt
              := i_month_square_rec.l_one_day_tab(i).rslt_center_amt;         -- 内他拠点＿売上実績
            IF(i_month_square_rec.l_one_day_tab(i).visit_sign IS NOT NULL)THEN
              io_m_tab(ln_m_cnt).l_get_one_day_tab(i).visit_sign
              := SUBSTR('*' || i_month_square_rec.l_one_day_tab(i).visit_sign, 1, 20);       -- 結合訪問記号
            END IF;
            -- 売り上げ中計部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-売り上げ中計部(一般)の更新処理'
            );
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).plan_vs_amt :=
              io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).plan_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).tgt_amt,0);             -- 売り上げ計画
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
              io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).rslt_amt,0);            -- 売り上げ実績
            -- 訪問中計部（一般）
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).plan_vs_amt :=
              io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).plan_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_num,0);         -- 訪問計画
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
              io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).vis_num,0);             -- 訪問実績
          ELSIF (i_month_square_rec.gvm_type = cv_gvm_v) THEN          -- 自販機
            -- 売り上げ明細部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-売り上げ明細部(自販機)の更新処理' ||
                          '売り上げ計画' || TO_CHAR(i_month_square_rec.l_one_day_tab(i).tgt_amt)
            );
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).plan_vs_amt
              := i_month_square_rec.l_one_day_tab(i).tgt_amt;                 -- 売り上げ計画
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
              := i_month_square_rec.l_one_day_tab(i).rslt_amt;                -- 売り上げ実績
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_other_sales_amt
              := i_month_square_rec.l_one_day_tab(i).rslt_center_amt;         -- 内他拠点＿売上実績
            IF(i_month_square_rec.l_one_day_tab(i).visit_sign IS NOT NULL)THEN
              io_m_tab(ln_m_cnt).l_get_one_day_tab(i).visit_sign
              := SUBSTR('*' || i_month_square_rec.l_one_day_tab(i).visit_sign, 1, 20);       -- 結合訪問記号
            END IF;
            -- 売り上げ中計部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-売り上げ中計部(自販機)の更新処理'
            );
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).plan_vs_amt :=
              io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).plan_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).tgt_amt,0);             -- 売り上げ計画
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt :=
              io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).rslt_amt,0);            -- 売り上げ実績
            -- 訪問中計部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-訪問中計部(自販機)の更新処理'
            );
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).plan_vs_amt :=
              io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).plan_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_num,0);         -- 訪問計画
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt :=
              io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).vis_num,0);             -- 訪問実績
          ELSIF (i_month_square_rec.gvm_type = cv_gvm_m) THEN                 -- MC
            -- 売り上げ明細部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-売り上げ明細部(MC)の更新処理' ||
                          '売り上げ計画' || TO_CHAR(i_month_square_rec.l_one_day_tab(i).tgt_amt)
            );
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).plan_vs_amt
              := i_month_square_rec.l_one_day_tab(i).tgt_vis_num;            -- 訪問計画
            io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
              := i_month_square_rec.l_one_day_tab(i).vis_num;                -- 訪問実績
            IF(i_month_square_rec.l_one_day_tab(i).vis_num > 0)THEN
              io_m_tab(ln_m_cnt).l_get_one_day_tab(i).visit_sign
              := '*';                                                        -- 結合訪問記号
            END IF;
            -- 訪問中計部
            -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '営業員別-PL/SQL表-訪問中計部(MC)の更新処理'
            );
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).plan_vs_amt :=
              io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).plan_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_num,0);         -- 訪問計画
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt :=
              io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt +
              NVL(i_month_square_rec.l_one_day_tab(i).vis_num,0);             -- 訪問実績
          END IF;
          -- 売り上げ合計部
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   => '営業員別-PL/SQL表-売り上げ合計部の更新処理'
          );
          -- 訪問合計部
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   => '営業員別-PL/SQL表-訪問合計部の更新処理'
          );
          io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num :=
            io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_sales_num,0);              -- 有効軒数
          -- 訪問内容合計部
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   => '営業員別-PL/SQL表-訪問内容合計部の更新処理'
          );
          -- A0Z訪問件数
          io_hon_tab(cn_idx_visit_dsc).vis_a_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_a_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_a_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_b_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_b_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_b_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_c_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_c_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_c_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_d_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_d_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_d_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_e_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_e_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_e_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_f_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_f_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_f_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_g_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_g_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_g_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_h_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_h_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_h_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_i_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_i_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_i_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_j_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_j_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_j_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_k_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_k_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_k_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_l_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_l_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_l_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_m_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_m_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_m_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_n_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_n_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_n_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_o_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_o_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_o_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_p_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_p_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_p_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_q_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_q_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_q_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_r_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_r_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_r_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_s_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_s_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_s_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_t_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_t_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_t_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_u_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_u_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_u_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_v_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_v_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_v_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_w_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_w_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_w_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_x_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_x_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_x_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_y_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_y_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_y_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_z_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_z_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_z_num,0);
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   => '営業員別-PL/SQL表の訪問内容合計部分更新処理完了' || 'LOOP件数:'|| TO_CHAR(i)
          );
        EXCEPTION
          WHEN OTHERS THEN
          fnd_file.put_line(
             which  => FND_FILE.LOG,
             buff   => '営業員別-PL/SQL表-本体部の更新処理でエラーになりました。' || SQLERRM ||
                      ''                         -- 空行の挿入
           );
          RAISE global_api_others_expt;
        END;
      END LOOP;
      -- DEBUGメッセージ
      -- PL/SQL表の更新
      debug(
         buff   => '営業員別-PL/SQL表の更新処理完了'
      );
    EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
            fnd_file.put_line(
               which  => FND_FILE.LOG,
               buff   => '営業員別-PL/SQL表-訪問内容合計部の更新処理でエラーになりました。' || SQLERRM ||
                        ''                         -- 空行の挿入
             );
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END up_plsql_tab1;
--
  /**********************************************************************************
   * Procedure Name   : get_ticket1
   * Description      : 帳票種別1-営業員別 (A-3-1,A-3-2)
  ***********************************************************************************/
  PROCEDURE get_ticket1(
    ov_errbuf         OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
   ,ov_retcode        OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
   ,ov_errmsg         OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'get_ticket1';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ローカル定数
    -- ローカル変数
/* 20090519_Ogawa_T1_0945 START*/
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--  lb_boolean            BOOLEAN;      -- 判断用
--  ln_m_cnt              NUMBER(9);    -- 明細部カウンター数格納
--  ln_cnt                NUMBER(9);    -- 抽出されたレコード件数
--  ln_date               NUMBER(2);    -- 日付のナンバー型
--  ln_report_output_no   NUMBER(9);    -- 帳票出力セット番号
--  lv_gvm_type           VARCHAR2(1);                                        -- 一般／自販機／ＭＣ
--  lv_bf_employee_number xxcso_resource_relations_v2.employee_number%TYPE;   -- 営業員番号格納
--  lv_bf_account_number  xxcso_cust_accounts_v.account_number%TYPE;          -- 顧客コード格納
--  -- *** ローカル・カーソル ***
--  CURSOR ticket_data_cur
--  IS
--    SELECT
--            (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.work_base_code_new
--              ELSE xrrv.work_base_code_old
--            END
--            ) work_base_code,                             -- 勤務地拠点コード
--            (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.work_base_name_new
--              ELSE xrrv.work_base_name_old
--            END
--            ) base_name,                                  -- 勤務地拠点名
--            xrrv.employee_number employee_number,         -- 従業員番号
--            xrrv.full_name name,                          -- 従業員名
--           (CASE
--              WHEN xcav.customer_status IN (cv_cust_status4,cv_cust_status5,cv_cust_status6)-- 顧客ステータス(顧客)
--                THEN cv_gvm_m                             -- MC
--              WHEN (XXCSO_ROUTE_COMMON_PKG.ISCUSTOMERVENDOR(xcav.business_low_type) = cv_true)
--                THEN cv_gvm_v                             -- 自販機
--              ELSE
--                     cv_gvm_g                             -- 一般
--            END
--            )                     gvm_type,               -- 一般／自販機／ＭＣ
--            xcav.business_low_type business_low_type,     -- 業態（小分類）
--            xcav.account_number   account_number,         -- 顧客コード
--            xcav.party_name       party_name,             -- 顧客名
--            xcrv.route_number     route_number,           -- ルートNo
--            xsvsr.sales_date      sales_date,             -- 販売年月日
--            xsvsr.tgt_amt         tgt_amt,                -- 売上計画
--            xsvsr.rslt_amt        rslt_amt,               -- 売上実績
--            xsvsr.rslt_center_amt rslt_center_amt,        -- 内他拠点＿売上実績
--            xsvsr.tgt_vis_num     tgt_vis_num,            -- 訪問計画
--            xsvsr.vis_num         vis_num,                -- 訪問実績
--            xsvsr.vis_sales_num   vis_sales_num,          -- 有効軒数
--            xsvsr.vis_new_num     vis_new_num,            -- 訪問実績（新規)
--            xsvsr.vis_vd_new_num  vis_vd_new_num,         -- 訪問実績（VD：新規）
--            xsvsr.vis_a_num       vis_a_num,              -- 訪問Ａ件数
--            xsvsr.vis_b_num       vis_b_num,              -- 訪問Ｂ件数
--            xsvsr.vis_c_num       vis_c_num,              -- 訪問Ｃ件数
--            xsvsr.vis_d_num       vis_d_num,              -- 訪問Ｄ件数
--            xsvsr.vis_e_num       vis_e_num,              -- 訪問Ｅ件数
--            xsvsr.vis_f_num       vis_f_num,              -- 訪問Ｆ件数
--            xsvsr.vis_g_num       vis_g_num,              -- 訪問Ｇ件数
--            xsvsr.vis_h_num       vis_h_num,              -- 訪問Ｈ件数
--            xsvsr.vis_i_num       vis_i_num,              -- 訪問ⅰ件数
--            xsvsr.vis_j_num       vis_j_num,              -- 訪問Ｊ件数
--            xsvsr.vis_k_num       vis_k_num,              -- 訪問Ｋ件数
--            xsvsr.vis_l_num       vis_l_num,              -- 訪問Ｌ件数
--            xsvsr.vis_m_num       vis_m_num,              -- 訪問Ｍ件数
--            xsvsr.vis_n_num       vis_n_num,              -- 訪問Ｎ件数
--            xsvsr.vis_o_num       vis_o_num,              -- 訪問Ｏ件数
--            xsvsr.vis_p_num       vis_p_num,              -- 訪問Ｐ件数
--            xsvsr.vis_q_num       vis_q_num,              -- 訪問Ｑ件数
--            xsvsr.vis_r_num       vis_r_num,              -- 訪問Ｒ件数
--            xsvsr.vis_s_num       vis_s_num,              -- 訪問Ｓ件数
--            xsvsr.vis_t_num       vis_t_num,              -- 訪問Ｔ件数
--            xsvsr.vis_u_num       vis_u_num,              -- 訪問Ｕ件数
--            xsvsr.vis_v_num       vis_v_num,              -- 訪問Ｖ件数
--            xsvsr.vis_w_num       vis_w_num,              -- 訪問Ｗ件数
--            xsvsr.vis_x_num       vis_x_num,              -- 訪問Ｘ件数
--            xsvsr.vis_y_num       vis_y_num,              -- 訪問Ｙ件数
--            xsvsr.vis_z_num       vis_z_num,              -- 訪問Ｚ件数
--            xsvsry.rslt_amt       rslt_amty,              -- 前年実績
--            xsvsrm.rslt_amt       rslt_amtm,              -- 先月実績
--            (CASE
--              WHEN (0 < xsvsr.vis_a_num) THEN 'A'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_b_num) THEN 'B'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_c_num) THEN 'C'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_d_num) THEN 'D'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_e_num) THEN 'E'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_f_num) THEN 'F'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_g_num) THEN 'G'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_h_num) THEN 'H'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_i_num) THEN 'I'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_j_num) THEN 'J'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_k_num) THEN 'K'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_l_num) THEN 'L'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_m_num) THEN 'M'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_n_num) THEN 'N'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_o_num) THEN 'O'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_p_num) THEN 'P'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_q_num) THEN 'Q'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_r_num) THEN 'R'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_s_num) THEN 'S'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_t_num) THEN 'T'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_u_num) THEN 'U'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_v_num) THEN 'V'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_w_num) THEN 'W'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_x_num) THEN 'X'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_y_num) THEN 'Y'
--            END
--            ) || (CASE
--              WHEN (0 < xsvsr.vis_z_num) THEN 'Z'
--            END
--            ) visit_sign,                                 -- 結合訪問記号
--            xsvsrn.cust_new_num         cust_new_num,     -- 顧客件数（新規）
--            xsvsrn.cust_vd_new_num      cust_vd_new_num,  -- 顧客件数（VD：新規）
--            xsvsre.tgt_sales_prsn_total_amt tgt_sales_prsn_total_amt --月別売上予算
--    FROM    xxcso_resource_relations_v2 xrrv              -- リソース関連マスタ(最新)VIEW
--           ,xxcso_resource_custs_v2     xrcv              -- 営業員担当顧客(最新)VIEW
--           ,xxcso_cust_accounts_v       xcav              -- 顧客マスタVIEW
--           ,xxcso_cust_routes_v2        xcrv              -- 顧客ルートNo(最新)VIEW
--           ,xxcso_sum_visit_sale_rep    xsvsr             -- 訪問売上計画管理表サマリテーブル
--           ,xxcso_sum_visit_sale_rep    xsvsry            -- 訪問売上計画管理表サマリ前年
--           ,xxcso_sum_visit_sale_rep    xsvsrm            -- 訪問売上計画管理表サマリ先月
--           ,xxcso_sum_visit_sale_rep    xsvsrn            -- 訪問売上計画管理表サマリ当月
--           ,xxcso_sum_visit_sale_rep    xsvsre            -- 訪問売上計画管理表サマリ営業員
--    WHERE   (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.work_base_code_new
--              ELSE xrrv.work_base_code_old
--            END
--            )  = gv_base_code
--      AND   ( gv_is_groupleader = cv_false
--              OR
--             ( gv_is_groupleader = cv_true
--                AND
--                ( CASE
--                    WHEN xrrv.issue_date <= gv_online_sysdate
--                      THEN xrrv.group_number_new
--                    ELSE xrrv.group_number_old
--                  END
--                ) = gt_group_number
--              )
--            )
--      AND   ( gv_is_salesman = cv_false
--              OR
--              ( gv_is_salesman = cv_true
--                AND
--                xrrv.employee_number = gt_employee_number
--              )
--            )
--      /* 20090427_abe_売上計画出力対応 START*/
--      AND   xrrv.employee_number = xrcv.employee_number(+)
--      AND   xrcv.account_number  = xcav.account_number(+)
--      AND   xcav.account_number  = xcrv.account_number(+)
--      AND  (
--            EXISTS (SELECT  COUNT(1)
--                      FROM  xxcso_cust_accounts_v  xcav1
--                     WHERE  xcav.account_number = xcav1.account_number(+)
--                   )
--           OR
--            ((
--      --AND   xrrv.employee_number = xrcv.employee_number
--      --AND   xrcv.account_number  = xcav.account_number
--      --AND   xcav.account_number  = xcrv.account_number(+)
--      --AND   ((
--      /* 20090427_abe_売上計画出力対応 END*/
--              ( xcav.customer_class_code IS NULL  -- 顧客区分
--              )
--              AND
--              ( xcav.customer_status IN ( cv_cust_status7, cv_cust_status4 )  -- 顧客ステータス
--              )
--             )
--         OR  (( xcav.customer_class_code = cv_cust_class_cd3 -- 顧客区分
--              )
--              AND
--              /* 20090427_abe_売上計画出力対応 START*/
--              --( xcav.customer_status IN ( cv_cust_status5
--              --                           ,cv_cust_status6
--              --                           ,cv_cust_status8
--              --                           ,cv_cust_status9
--              --                          )  -- 顧客ステータス
--              --)
--              ( xcav.customer_status IN ( cv_cust_status7, cv_cust_status4 )  -- 顧客ステータス
--              )
--              /* 20090427_abe_売上計画出力対応 END*/
--             )
--         OR  (( xcav.customer_class_code = cv_cust_class_cd4 -- 顧客区分
--              )
--              AND
--              ( xcav.customer_status IN ( cv_cust_status6
--                                         ,cv_cust_status8
--                                        )  -- 顧客ステータス
--              ))
--         OR  (( xcav.customer_class_code = cv_cust_class_cd5 -- 顧客区分
--              )
--              AND
--              ( xcav.customer_status = cv_cust_status3 -- 顧客ステータス
--              ))
--         OR  (( xcav.customer_class_code = cv_cust_class_cd6 -- 顧客区分
--              )
--              AND
--              ( xcav.customer_status = cv_cust_status3 -- 顧客ステータス
--              ))
--         OR  (( xcav.customer_class_code = cv_cust_class_cd7 -- 顧客区分
--              )
--              AND
--              (xcav.customer_status = cv_cust_status3 -- 顧客ステータス
--              )
--             )
--            )
--      /* 20090427_abe_売上計画出力対応 START*/
--           )
--      AND   xcav.account_number  = xsvsr.sum_org_code(+)
--      AND   xsvsr.sum_org_type(+)   = cv_sum_org_type1
--      AND   xsvsr.month_date_div(+) = cv_month_date_div2
--      AND   xsvsr.sales_date(+)
--              BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      --AND   xcav.account_number  = xsvsr.sum_org_code
--      --AND   xsvsr.sum_org_type   = cv_sum_org_type1
--      --AND   xsvsr.month_date_div = cv_month_date_div2
--      /* 20090427_abe_売上計画出力対応 END*/
--      AND   xsvsr.sum_org_type   = xsvsry.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsry.sum_org_code(+)
--      AND   xsvsry.month_date_div(+)= cv_month_date_div1
--      AND   xsvsry.sales_date(+) = gv_year_prev
--      AND   xsvsr.sum_org_type   = xsvsrm.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrm.sum_org_code(+)
--      AND   xsvsrm.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrm.sales_date(+) = gv_year_month_prev
--      AND   xsvsr.sum_org_type   = xsvsrn.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrn.sum_org_code(+)
--      AND   xsvsrn.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrn.sales_date(+) = gv_year_month
--      AND   xsvsre.sum_org_type(+) = cv_sum_org_type2
--      AND   xsvsre.sum_org_code(+) = xrrv.employee_number
--      AND   xsvsre.month_date_div(+)= cv_month_date_div1
--      AND   xsvsre.sales_date(+)= gv_year_month
--    ORDER BY  work_base_code     ASC,
--              employee_number    ASC,
--              account_number     ASC;
--  -- ローカルレコード
--  l_cur_rec                  ticket_data_cur%ROWTYPE;
--  l_month_square_rec         g_month_rtype1;
--  l_get_month_square_tab     g_get_month_square_ttype;
--  l_get_month_square_hon_tab g_get_month_square_ttype;
--
    lv_report_name             xxcso_rep_visit_sale_plan.report_name%TYPE;   -- 帳票タイトル
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_0945 END*/
/* 20090519_Ogawa_T1_1021 END*/
    -- 帳票変数格納用
    -- *** ローカル例外 ***
    error_get_data_expt        EXCEPTION;
    BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
      ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
/* 20090519_Ogawa_T1_0945 START*/
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--    -- ローカル変数初期化
--    lb_boolean                := TRUE;        -- 初期処理判断
--    ln_m_cnt                  := 1;           -- 明細部の行数
--    ln_report_output_no       := 1;           -- 配列行数
--    ln_cnt                    := 0;           -- LOOP件数(抽出件数)
--    -- PL/SQL表（本体部）の項目の初期化
--    init_month_square_hon_tab(l_get_month_square_hon_tab);
--    -- ローカルレコードの初期化
--    init_month_square_rec1(l_month_square_rec);
--    BEGIN
--      --カーソルオープン
--      OPEN ticket_data_cur;
--
--DO_ERROR('A-3-2-1');
--
--      <<get_data_loop>>
--      LOOP
--        l_cur_rec                           := NULL;          -- カーソルレコードの初期化
--
--        FETCH ticket_data_cur INTO l_cur_rec;                 -- カーソルのデータをレコードに格納
--
--        -- 対象件数がO件の場合
--        EXIT WHEN ticket_data_cur%NOTFOUND
--          OR  ticket_data_cur%ROWCOUNT = 0;
--
--DO_ERROR('A-3-2-2');
--
--        debug(
--          buff   =>l_cur_rec.work_base_code ||  ',' ||
--                   l_cur_rec.base_name ||  ',' ||
--                   l_cur_rec.employee_number ||  ',' ||
--                   l_cur_rec.gvm_type ||  ',' ||
--                   l_cur_rec.account_number ||  ',' ||
--                   l_cur_rec.party_name ||  ',' ||
--                   l_cur_rec.route_number ||  ',' ||
--                   l_cur_rec.business_low_type ||  ',' ||
--                   l_cur_rec.sales_date ||  ',' ||
--                   TO_CHAR(l_cur_rec.tgt_amt)          ||  ',' ||
--                   TO_CHAR(l_cur_rec.rslt_amt)         ||  ',' ||
--                   TO_CHAR(l_cur_rec.rslt_center_amt)  ||  ',' ||
--                   TO_CHAR(l_cur_rec.tgt_vis_num)      ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_num)          ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_sales_num)    ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_new_num)      ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_vd_new_num)   ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_a_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_b_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_c_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_d_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_e_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_f_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_g_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_h_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_i_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_j_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_k_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_l_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_m_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_n_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_o_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_p_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_q_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_r_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_s_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_t_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_u_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_v_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_w_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_x_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_y_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.vis_z_num)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.rslt_amty)        ||  ',' ||
--                   TO_CHAR(l_cur_rec.rslt_amtm)        ||  ',' ||
--                   l_cur_rec.visit_sign                ||  ',' ||
--                   TO_CHAR(l_cur_rec.cust_new_num)     ||  ',' ||
--                   TO_CHAR(l_cur_rec.cust_vd_new_num)  ||  ',' ||
--                   TO_CHAR(l_cur_rec.tgt_sales_prsn_total_amt) ||  ',' ||
--                   cv_lf
--        );
--        -- 前回レコードと営業員番号が同じで顧客コードが違う場合、明細部配列と本体部配列を更新。
--        IF (lb_boolean = FALSE) THEN
--          IF ((lv_bf_employee_number = l_cur_rec.employee_number) AND
--              (lv_bf_account_number <> l_cur_rec.account_number))
--            THEN
--            -- DEBUGメッセージ
--            debug(
--               buff   => '顧客コードが違います。 :' ||'前回： '|| lv_bf_account_number ||
--                          '今回：' || l_cur_rec.account_number ||
--                          '明細部配列' || TO_CHAR(ln_m_cnt)
--            );
--            -- =================================================
--            -- A-3-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab1(
--               i_month_square_rec   => l_month_square_rec          -- 1ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--            l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--            -- レコードの初期化
--            init_month_square_rec1(l_month_square_rec);
--            ln_m_cnt          := ln_m_cnt + 1;       -- 明細部配列を＋１する。
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          ELSIF (lv_bf_employee_number <> l_cur_rec.employee_number)
--            THEN
--              -- =================================================
--              -- A-3-3.PLSQL表の更新
--              -- =================================================
--              up_plsql_tab1(
--                 i_month_square_rec   => l_month_square_rec          -- 1ヶ月分データ
--                ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--                ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--                ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--                ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--                ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--                ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--              );
--              IF (lv_retcode = cv_status_error) THEN
--                RAISE global_process_expt;
--              END IF;
--              l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--              l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--              -- レコードの初期化
--              init_month_square_rec1(l_month_square_rec);
--              lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          END IF;
--        END IF;
--        -- 出力フラグがオンの状態で営業員番号が前回取得した営業員番号と違う場合ワークテーブルに出力します。
--        IF ((ln_cnt > 0) AND
--            (lv_bf_employee_number <> l_cur_rec.employee_number))
--          THEN
--            -- DEBUGメッセージ
--            debug(
--               buff   => '従業員が違います。 :' ||'前回： '|| lv_bf_employee_number ||
--                          '今回：' || l_cur_rec.employee_number
--            );
--            -- =================================================
--            -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--            -- =================================================
--            insert_wrk_table(
--               ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--              ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--              ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--              ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--              ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--              ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            -- レコードの初期化
--            l_get_month_square_tab.DELETE;
--            l_get_month_square_hon_tab.DELETE;
--            init_month_square_hon_tab(l_get_month_square_hon_tab);
--            ln_m_cnt            := 1;                       -- 明細部配列の行数の初期化
--            ln_report_output_no := ln_report_output_no + 1; -- 出力された帳票個数に＋１する
--            lb_boolean          := TRUE;                    -- 初期処理の状態に戻す
--        END IF;
--        -- 初期処理の場合
--        IF (lb_boolean) THEN
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '初期処理の場合' || '顧客コード:' || l_cur_rec.account_number ||
--                       '従業員番号:'     || l_cur_rec.employee_number ||
--                       '一般／自販機／ＭＣ:' || l_cur_rec.gvm_type
--          );
--          -- 前回従業員番号、顧客コードをローカル変数に格納
--          lv_bf_account_number       := l_cur_rec.account_number;          -- 顧客コード
--          lv_bf_employee_number      := l_cur_rec.employee_number;         -- 従業員番号
--          lv_gvm_type             := l_cur_rec.gvm_type;                -- 一般／自販機／ＭＣ
--          -- 取得されたデータをローカルレコードに格納
--          -- 顧客コード
--          l_month_square_rec.account_number     := l_cur_rec.account_number;
--          -- 顧客名
--          l_month_square_rec.party_name         := l_cur_rec.party_name;
--          -- 従業員番号
--          l_month_square_rec.employee_number    := l_cur_rec.employee_number;
--          -- 一般／自販機／ＭＣ
--          l_month_square_rec.gvm_type           := l_cur_rec.gvm_type;
--          -- 勤務地拠点コード
--          l_month_square_rec.work_base_code     := l_cur_rec.work_base_code;
--          -- 勤務地拠点名
--          l_month_square_rec.base_name          := l_cur_rec.base_name;
--          -- 従業員名
--          l_month_square_rec.name               := l_cur_rec.name;
--          -- ルートNo
--          l_month_square_rec.route_number       := l_cur_rec.route_number;
--          -- 前年実績
--          l_month_square_rec.rslt_amty          := l_cur_rec.rslt_amty;
--          -- 先月実績
--          l_month_square_rec.rslt_amtm          := l_cur_rec.rslt_amtm;
--          -- 月別売上予算
--          l_month_square_rec.tgt_sales_prsn_total_amt := l_cur_rec.tgt_sales_prsn_total_amt;
--          -- 新規顧客件数
--          l_month_square_rec.cust_new_num       := l_cur_rec.cust_new_num;
--          -- 新規VD件数
--          l_month_square_rec.cust_vd_new_num    := l_cur_rec.cust_vd_new_num;
--
--          /* 20090427_abe_売上計画出力対応 START*/
--          IF (l_cur_rec.account_number IS NOT NULL) THEN
--          /* 20090427_abe_売上計画出力対応 END*/
--            BEGIN
--              IF (l_cur_rec.business_low_type IS NOT NULL) THEN
--                --業態（小分類）から業態コードと業態名を取得
--                SELECT dai.lookup_code lookup_code                      -- 業態コード
--                ,      dai.meaning     meaning                          -- 業態名
--                INTO   l_month_square_rec.business_high_type
--                ,      l_month_square_rec.business_high_name
--                FROM   fnd_lookup_values_vl dai
--                ,      fnd_lookup_values_vl chu
--                ,      fnd_lookup_values_vl syo
--                WHERE  syo.lookup_type = cv_lookup_type_syo
--                AND    chu.lookup_type = cv_lookup_type_chu
--                AND    dai.lookup_type = cv_lookup_type_dai
--                AND    syo.lookup_code = l_cur_rec.business_low_type    --業態（小分類）
--                AND    chu.lookup_code = syo.attribute1
--                AND    dai.lookup_code = chu.attribute1
--                AND    syo.enabled_flag   = cv_flg_y
--                AND    chu.enabled_flag   = cv_flg_y
--                AND    dai.enabled_flag   = cv_flg_y
--                AND    NVL(dai.start_date_active, TRUNC(gd_online_sysdate)) <= TRUNC(gd_online_sysdate)
--                AND    NVL(dai.end_date_active,   TRUNC(gd_online_sysdate)) >= TRUNC(gd_online_sysdate)
--                AND    NVL(chu.start_date_active, TRUNC(gd_online_sysdate)) <= TRUNC(gd_online_sysdate)
--                AND    NVL(chu.end_date_active,   TRUNC(gd_online_sysdate)) >= TRUNC(gd_online_sysdate)
--                AND    NVL(syo.start_date_active, TRUNC(gd_online_sysdate)) <= TRUNC(gd_online_sysdate)
--                AND    NVL(syo.end_date_active,   TRUNC(gd_online_sysdate)) >= TRUNC(gd_online_sysdate);
--              ELSE
--                l_month_square_rec.business_high_type   := NULL;
--                l_month_square_rec.business_high_name   := cv_mc;
--              END IF;
--            EXCEPTION
--              WHEN OTHERS THEN
--                -- メッセージ出力
--                lv_errmsg := xxccp_common_pkg.get_msg(
--                                 iv_application  => cv_app_name              --アプリケーション短縮名
--                                ,iv_name         => cv_tkn_number_08         --メッセージコード
--                                ,iv_token_name1  => cv_tkn_table             --トークンコード1
--                                ,iv_token_value1 => '業態（小分類）：'||l_cur_rec.business_low_type||
--                                                    'から参照タイプ業態（大分類）'--トークン値1
--                                ,iv_token_name2  => cv_tkn_errmsg            --トークンコード２
--                                ,iv_token_value2 => SQLERRM                  --トークン値２
--                );
--                fnd_file.put_line(
--                      which  => FND_FILE.LOG,
--                      buff   => ''      || cv_lf ||     -- 空行の挿入
--                              lv_errmsg || cv_lf ||
--                               ''                         -- 空行の挿入
--                );
--                l_month_square_rec.business_high_type   := NULL;
--                l_month_square_rec.business_high_name   := cv_mc;
--            END;
--          /* 20090427_abe_売上計画出力対応 START*/
--          ELSE
--            l_month_square_rec.business_high_type   := NULL;
--            l_month_square_rec.business_high_name   := NULL;
--          END IF;
--          /* 20090427_abe_売上計画出力対応 END*/
--        END IF;
--        /* 20090427_abe_売上計画出力対応 START*/
--        IF (l_cur_rec.sales_date IS NOT NULL) THEN
--        /* 20090427_abe_売上計画出力対応 END*/
--          -- 日付を取得
--          ln_date := TO_NUMBER(SUBSTR(l_cur_rec.sales_date,7,2));
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '日付:' || l_cur_rec.sales_date || cv_lf ||
--                       '日付けのナンバー型:'     || TO_CHAR(ln_date)
--          );
--          -- 売上計画
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_amt          := l_cur_rec.tgt_amt;
--          -- 売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_amt         := l_cur_rec.rslt_amt;
--          -- 内他拠点＿売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_amt  := l_cur_rec.rslt_center_amt;
--          -- 訪問計画
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_num      := l_cur_rec.tgt_vis_num;
--          -- 訪問実績
--          l_month_square_rec.l_one_day_tab(ln_date).vis_num          := l_cur_rec.vis_num;
--          -- 有効軒数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_sales_num    := l_cur_rec.vis_sales_num;
--          -- 訪問実績（新規)
--          l_month_square_rec.l_one_day_tab(ln_date).vis_new_num      := l_cur_rec.vis_new_num;
--          -- 訪問実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_new_num   := l_cur_rec.vis_vd_new_num;
--          -- 結合訪問記号
--          l_month_square_rec.l_one_day_tab(ln_date).visit_sign       := SUBSTR(l_cur_rec.visit_sign, 1, 20);
--          -- 訪問A0Z件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_a_num := nvl(l_cur_rec.vis_a_num,0);  -- 訪問A件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_b_num := nvl(l_cur_rec.vis_b_num,0);  -- 訪問B件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_c_num := nvl(l_cur_rec.vis_c_num,0);  -- 訪問C件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_d_num := nvl(l_cur_rec.vis_d_num,0);  -- 訪問D件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_e_num := nvl(l_cur_rec.vis_e_num,0);  -- 訪問E件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_f_num := nvl(l_cur_rec.vis_f_num,0);  -- 訪問F件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_g_num := nvl(l_cur_rec.vis_g_num,0);  -- 訪問G件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_h_num := nvl(l_cur_rec.vis_h_num,0);  -- 訪問H件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_i_num := nvl(l_cur_rec.vis_i_num,0);  -- 訪問I件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_j_num := nvl(l_cur_rec.vis_j_num,0);  -- 訪問J件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_k_num := nvl(l_cur_rec.vis_k_num,0);  -- 訪問K件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_l_num := nvl(l_cur_rec.vis_l_num,0);  -- 訪問L件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_m_num := nvl(l_cur_rec.vis_m_num,0);  -- 訪問M件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_n_num := nvl(l_cur_rec.vis_n_num,0);  -- 訪問N件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_o_num := nvl(l_cur_rec.vis_o_num,0);  -- 訪問O件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_p_num := nvl(l_cur_rec.vis_p_num,0);  -- 訪問P件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_q_num := nvl(l_cur_rec.vis_q_num,0);  -- 訪問Q件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_r_num := nvl(l_cur_rec.vis_r_num,0);  -- 訪問R件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_s_num := nvl(l_cur_rec.vis_s_num,0);  -- 訪問S件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_t_num := nvl(l_cur_rec.vis_t_num,0);  -- 訪問T件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_u_num := nvl(l_cur_rec.vis_u_num,0);  -- 訪問U件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_v_num := nvl(l_cur_rec.vis_v_num,0);  -- 訪問V件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_w_num := nvl(l_cur_rec.vis_w_num,0);  -- 訪問W件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_x_num := nvl(l_cur_rec.vis_x_num,0);  -- 訪問X件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_y_num := nvl(l_cur_rec.vis_y_num,0);  -- 訪問Y件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_z_num := nvl(l_cur_rec.vis_z_num,0);  -- 訪問Z件数
--        /* 20090427_abe_売上計画出力対応 START*/
--        END IF;
--        /* 20090427_abe_売上計画出力対応 END*/
--        -- 最初のレコードの場合
--        IF(lb_boolean) THEN
--          lb_boolean              := FALSE;                  -- 初期処理のフラグをオフする。
--        END IF;
--        -- 抽出件数カウンタに１を足す。
--        ln_cnt         := ln_cnt + 1;
--        gn_target_cnt  := ln_cnt;
--        -- loop件数
--        debug(
--              buff   => 'loop件数' || TO_CHAR(ln_cnt)
--        );
--      END LOOP;
--      -- 最後のデータ登録
--      IF (ln_cnt > 0) THEN
--          debug(
--                buff   => '最後のデータの登録'
--          );
--        -- =================================================
--        -- A-3-3.PLSQL表の更新
--        -- =================================================
--        up_plsql_tab1(
--           i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--          ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--          ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--          ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--          ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--          ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--      END IF;
--    EXCEPTION
--      WHEN error_get_data_expt THEN
--        RAISE global_api_expt;
--      WHEN OTHERS THEN
--        -- メッセージ出力
--        lv_errmsg := xxccp_common_pkg.get_msg(
--                         iv_application  => cv_app_name              --アプリケーション短縮名
--                        ,iv_name         => cv_tkn_number_08         --メッセージコード
--                        ,iv_token_name1  => cv_tkn_table             --トークンコード1
--                        ,iv_token_value1 => cv_tab_samari            --トークン値1
--                        ,iv_token_name2  => cv_tkn_errmsg            --トークンコード２
--                        ,iv_token_value2 => SQLERRM                  --トークン値２
--        );
--        fnd_file.put_line(
--              which  => FND_FILE.LOG,
--              buff   => ''      || cv_lf ||     -- 空行の挿入
--                      lv_errmsg || cv_lf ||
--                       ''                         -- 空行の挿入
--        );
--        RAISE global_api_expt;
--    END;
--  -- カーソルクローズ
--  CLOSE ticket_data_cur;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 開始');
--
    sum_resources(
      iv_base_code => gv_base_code
    );
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    IF ( SQL%ROWCOUNT = 0 ) THEN
      RETURN;
    END IF;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 開始');
--
    sum_visit_sales;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
    SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（営業員別）' || '≫';
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■ヘッダ部
    -- 対象拠点内の全営業員を
    -- グループ番号（昇順）、グループ長区分（降順 Y⇒N）、
    -- グループ順位（昇順）、従業員番号（昇順）
    -- で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,report_id                                 -- 帳票ＩＤ
      ,report_name                               -- 帳票タイトル
      ,output_date                               -- 出力日時
      ,year_month                                -- 基準年月
      ,operation_days                            -- 稼動日数
      ,operation_all_days                        -- 稼動可能日数
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,ROWNUM                               -- 帳票出力セット番号
           ,cn_line_kind1                        -- 帳票出力位置
           ,1                                    -- 行番
           ,cv_pkg_name                          -- 帳票ＩＤ
           ,lv_report_name                       -- 帳票タイトル
           ,SYSDATE                              -- 出力日時
           ,gd_year_month                        -- 基準年月
           ,gn_operation_days                    -- 稼動日数
           ,gn_operation_all_days                -- 稼動可能日数
           ,inn_v.base_code                      -- 拠点コード
           ,(SELECT  xabv.base_name
             FROM    xxcso_aff_base_v2  xabv
             WHERE   xabv.base_code = inn_v.base_code
            )                                    -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
    FROM    (SELECT  xtrvr.base_code
                    ,xtrvr.employee_number
                    ,xtrvr.employee_name
                    ,xtrvr.group_number
                    ,xtrvr.group_leader_flag
                    ,xtrvr.group_grade
             FROM    xxcso_tmp_rep_vsp_rsrcs  xtrvr
             ORDER BY  TO_NUMBER(group_number)     ASC
                      ,NVL(group_leader_flag, 'N') DESC
                      ,TO_NUMBER(group_grade)      ASC
                      ,employee_number             ASC
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■明細部
    -- 営業員毎に担当する顧客情報とその売上／訪問計画（日別）、
    -- 売上／訪問実績（日別）、売上実績（他拠点納品分）（日別）、
    -- 訪問記号（日別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,business_high_type                        -- 業態（大分類）
      ,business_high_name                        -- 業態（大分類）名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,account_number                            -- 顧客コード
      ,customer_name                             -- 顧客名
      ,route_no                                  -- ルートNo
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
      ,visit_sign_1                              -- １日－訪問記号
      ,visit_sign_2                              -- ２日－訪問記号
      ,visit_sign_3                              -- ３日－訪問記号
      ,visit_sign_4                              -- ４日－訪問記号
      ,visit_sign_5                              -- ５日－訪問記号
      ,visit_sign_6                              -- ６日－訪問記号
      ,visit_sign_7                              -- ７日－訪問記号
      ,visit_sign_8                              -- ８日－訪問記号
      ,visit_sign_9                              -- ９日－訪問記号
      ,visit_sign_10                             -- １０日－訪問記号
      ,visit_sign_11                             -- １１日－訪問記号
      ,visit_sign_12                             -- １２日－訪問記号
      ,visit_sign_13                             -- １３日－訪問記号
      ,visit_sign_14                             -- １４日－訪問記号
      ,visit_sign_15                             -- １５日－訪問記号
      ,visit_sign_16                             -- １６日－訪問記号
      ,visit_sign_17                             -- １７日－訪問記号
      ,visit_sign_18                             -- １８日－訪問記号
      ,visit_sign_19                             -- １９日－訪問記号
      ,visit_sign_20                             -- ２０日－訪問記号
      ,visit_sign_21                             -- ２１日－訪問記号
      ,visit_sign_22                             -- ２２日－訪問記号
      ,visit_sign_23                             -- ２３日－訪問記号
      ,visit_sign_24                             -- ２４日－訪問記号
      ,visit_sign_25                             -- ２５日－訪問記号
      ,visit_sign_26                             -- ２６日－訪問記号
      ,visit_sign_27                             -- ２７日－訪問記号
      ,visit_sign_28                             -- ２８日－訪問記号
      ,visit_sign_29                             -- ２９日－訪問記号
      ,visit_sign_30                             -- ３０日－訪問記号
      ,visit_sign_31                             -- ３１日－訪問記号
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind2                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.business_high_type             -- 業態（大分類）
           ,inn_v.business_high_name             -- 業態（大分類）名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,inn_v.account_number                 -- 顧客コード
           ,inn_v.customer_name                  -- 顧客名
           ,inn_v.route_no                       -- ルートNo
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
           ,inn_v.visit_sign_1                  -- １日－訪問記号
           ,inn_v.visit_sign_2                  -- ２日－訪問記号
           ,inn_v.visit_sign_3                  -- ３日－訪問記号
           ,inn_v.visit_sign_4                  -- ４日－訪問記号
           ,inn_v.visit_sign_5                  -- ５日－訪問記号
           ,inn_v.visit_sign_6                  -- ６日－訪問記号
           ,inn_v.visit_sign_7                  -- ７日－訪問記号
           ,inn_v.visit_sign_8                  -- ８日－訪問記号
           ,inn_v.visit_sign_9                  -- ９日－訪問記号
           ,inn_v.visit_sign_10                 -- １０日－訪問記号
           ,inn_v.visit_sign_11                 -- １１日－訪問記号
           ,inn_v.visit_sign_12                 -- １２日－訪問記号
           ,inn_v.visit_sign_13                 -- １３日－訪問記号
           ,inn_v.visit_sign_14                 -- １４日－訪問記号
           ,inn_v.visit_sign_15                 -- １５日－訪問記号
           ,inn_v.visit_sign_16                 -- １６日－訪問記号
           ,inn_v.visit_sign_17                 -- １７日－訪問記号
           ,inn_v.visit_sign_18                 -- １８日－訪問記号
           ,inn_v.visit_sign_19                 -- １９日－訪問記号
           ,inn_v.visit_sign_20                 -- ２０日－訪問記号
           ,inn_v.visit_sign_21                 -- ２１日－訪問記号
           ,inn_v.visit_sign_22                 -- ２２日－訪問記号
           ,inn_v.visit_sign_23                 -- ２３日－訪問記号
           ,inn_v.visit_sign_24                 -- ２４日－訪問記号
           ,inn_v.visit_sign_25                 -- ２５日－訪問記号
           ,inn_v.visit_sign_26                 -- ２６日－訪問記号
           ,inn_v.visit_sign_27                 -- ２７日－訪問記号
           ,inn_v.visit_sign_28                 -- ２８日－訪問記号
           ,inn_v.visit_sign_29                 -- ２９日－訪問記号
           ,inn_v.visit_sign_30                 -- ３０日－訪問記号
           ,inn_v.visit_sign_31                 -- ３１日－訪問記号
    FROM    (SELECT  xrvsp.report_output_no
                    ,xrvsp.base_code
                    ,xrvsp.hub_name
                    ,xrvsp.employee_number
                    ,xrvsp.employee_name
                    ,xtrvp.business_high_type
                    ,xtrvp.business_high_name
                    ,xtrvp.gvm_type
                    ,xtrvp.account_number
                    ,xtrvp.customer_name
                    ,xtrvp.route_no
                    ,xtrvp.last_year_rslt_sales_amt
                    ,xtrvp.last_mon_rslt_sales_amt
                    ,xtrvp.plan_vs_amt_1
                    ,xtrvp.plan_vs_amt_2
                    ,xtrvp.plan_vs_amt_3
                    ,xtrvp.plan_vs_amt_4
                    ,xtrvp.plan_vs_amt_5
                    ,xtrvp.plan_vs_amt_6
                    ,xtrvp.plan_vs_amt_7
                    ,xtrvp.plan_vs_amt_8
                    ,xtrvp.plan_vs_amt_9
                    ,xtrvp.plan_vs_amt_10
                    ,xtrvp.plan_vs_amt_11
                    ,xtrvp.plan_vs_amt_12
                    ,xtrvp.plan_vs_amt_13
                    ,xtrvp.plan_vs_amt_14
                    ,xtrvp.plan_vs_amt_15
                    ,xtrvp.plan_vs_amt_16
                    ,xtrvp.plan_vs_amt_17
                    ,xtrvp.plan_vs_amt_18
                    ,xtrvp.plan_vs_amt_19
                    ,xtrvp.plan_vs_amt_20
                    ,xtrvp.plan_vs_amt_21
                    ,xtrvp.plan_vs_amt_22
                    ,xtrvp.plan_vs_amt_23
                    ,xtrvp.plan_vs_amt_24
                    ,xtrvp.plan_vs_amt_25
                    ,xtrvp.plan_vs_amt_26
                    ,xtrvp.plan_vs_amt_27
                    ,xtrvp.plan_vs_amt_28
                    ,xtrvp.plan_vs_amt_29
                    ,xtrvp.plan_vs_amt_30
                    ,xtrvp.plan_vs_amt_31
                    ,xtrvp.rslt_vs_amt_1
                    ,xtrvp.rslt_vs_amt_2
                    ,xtrvp.rslt_vs_amt_3
                    ,xtrvp.rslt_vs_amt_4
                    ,xtrvp.rslt_vs_amt_5
                    ,xtrvp.rslt_vs_amt_6
                    ,xtrvp.rslt_vs_amt_7
                    ,xtrvp.rslt_vs_amt_8
                    ,xtrvp.rslt_vs_amt_9
                    ,xtrvp.rslt_vs_amt_10
                    ,xtrvp.rslt_vs_amt_11
                    ,xtrvp.rslt_vs_amt_12
                    ,xtrvp.rslt_vs_amt_13
                    ,xtrvp.rslt_vs_amt_14
                    ,xtrvp.rslt_vs_amt_15
                    ,xtrvp.rslt_vs_amt_16
                    ,xtrvp.rslt_vs_amt_17
                    ,xtrvp.rslt_vs_amt_18
                    ,xtrvp.rslt_vs_amt_19
                    ,xtrvp.rslt_vs_amt_20
                    ,xtrvp.rslt_vs_amt_21
                    ,xtrvp.rslt_vs_amt_22
                    ,xtrvp.rslt_vs_amt_23
                    ,xtrvp.rslt_vs_amt_24
                    ,xtrvp.rslt_vs_amt_25
                    ,xtrvp.rslt_vs_amt_26
                    ,xtrvp.rslt_vs_amt_27
                    ,xtrvp.rslt_vs_amt_28
                    ,xtrvp.rslt_vs_amt_29
                    ,xtrvp.rslt_vs_amt_30
                    ,xtrvp.rslt_vs_amt_31
                    ,xtrvp.rslt_other_sales_amt_1
                    ,xtrvp.rslt_other_sales_amt_2
                    ,xtrvp.rslt_other_sales_amt_3
                    ,xtrvp.rslt_other_sales_amt_4
                    ,xtrvp.rslt_other_sales_amt_5
                    ,xtrvp.rslt_other_sales_amt_6
                    ,xtrvp.rslt_other_sales_amt_7
                    ,xtrvp.rslt_other_sales_amt_8
                    ,xtrvp.rslt_other_sales_amt_9
                    ,xtrvp.rslt_other_sales_amt_10
                    ,xtrvp.rslt_other_sales_amt_11
                    ,xtrvp.rslt_other_sales_amt_12
                    ,xtrvp.rslt_other_sales_amt_13
                    ,xtrvp.rslt_other_sales_amt_14
                    ,xtrvp.rslt_other_sales_amt_15
                    ,xtrvp.rslt_other_sales_amt_16
                    ,xtrvp.rslt_other_sales_amt_17
                    ,xtrvp.rslt_other_sales_amt_18
                    ,xtrvp.rslt_other_sales_amt_19
                    ,xtrvp.rslt_other_sales_amt_20
                    ,xtrvp.rslt_other_sales_amt_21
                    ,xtrvp.rslt_other_sales_amt_22
                    ,xtrvp.rslt_other_sales_amt_23
                    ,xtrvp.rslt_other_sales_amt_24
                    ,xtrvp.rslt_other_sales_amt_25
                    ,xtrvp.rslt_other_sales_amt_26
                    ,xtrvp.rslt_other_sales_amt_27
                    ,xtrvp.rslt_other_sales_amt_28
                    ,xtrvp.rslt_other_sales_amt_29
                    ,xtrvp.rslt_other_sales_amt_30
                    ,xtrvp.rslt_other_sales_amt_31
                    ,xtrvp.visit_sign_1
                    ,xtrvp.visit_sign_2
                    ,xtrvp.visit_sign_3
                    ,xtrvp.visit_sign_4
                    ,xtrvp.visit_sign_5
                    ,xtrvp.visit_sign_6
                    ,xtrvp.visit_sign_7
                    ,xtrvp.visit_sign_8
                    ,xtrvp.visit_sign_9
                    ,xtrvp.visit_sign_10
                    ,xtrvp.visit_sign_11
                    ,xtrvp.visit_sign_12
                    ,xtrvp.visit_sign_13
                    ,xtrvp.visit_sign_14
                    ,xtrvp.visit_sign_15
                    ,xtrvp.visit_sign_16
                    ,xtrvp.visit_sign_17
                    ,xtrvp.visit_sign_18
                    ,xtrvp.visit_sign_19
                    ,xtrvp.visit_sign_20
                    ,xtrvp.visit_sign_21
                    ,xtrvp.visit_sign_22
                    ,xtrvp.visit_sign_23
                    ,xtrvp.visit_sign_24
                    ,xtrvp.visit_sign_25
                    ,xtrvp.visit_sign_26
                    ,xtrvp.visit_sign_27
                    ,xtrvp.visit_sign_28
                    ,xtrvp.visit_sign_29
                    ,xtrvp.visit_sign_30
                    ,xtrvp.visit_sign_31
             FROM    xxcso_rep_visit_sale_plan   xrvsp
                    ,xxcso_tmp_rep_vs_plan       xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.employee_number(+)     = xrvsp.employee_number
             ORDER BY  report_output_no
                      ,route_no
                      ,DECODE(gvm_type, cv_gvm_m, '2', '1')
                      ,account_number
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部
    -- 明細部の日別合計を一般計、自販機計で集計する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,xrvsp.employee_number                 employee_number
                    ,xrvsp.employee_name                   employee_name
                    ,xtrvp.gvm_type                        gvm_type
                    ,SUM(xtrvp.last_year_rslt_sales_amt)   last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)    last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)              plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)              plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)              plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)              plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)              plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)              plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)              plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)              plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)              plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)             plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)             plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)             plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)             plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)             plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)             plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)             plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)             plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)             plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)             plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)             plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)             plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)             plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)             plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)             plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)             plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)             plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)             plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)             plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)             plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)             plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)             plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)              rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)              rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)              rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)              rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)              rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)              rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)              rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)              rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)              rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)             rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)             rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)             rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)             rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)             rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)             rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)             rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)             rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)             rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)             rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)             rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)             rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)             rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)             rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)             rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)             rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)             rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)             rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)             rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)             rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)             rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)             rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)     rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)     rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)     rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)     rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)     rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)     rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)     rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)     rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)     rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)    rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)    rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)    rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)    rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)    rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)    rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)    rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)    rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)    rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)    rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)    rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)    rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)    rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)    rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)    rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)    rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)    rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)    rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)    rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)    rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)    rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)    rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan      xrvsp
                    ,xxcso_tmp_rep_vs_plan          xtrvp
             WHERE   xrvsp.request_id         = cn_request_id
               AND   xrvsp.line_kind          = cn_line_kind1
               AND   xtrvp.employee_number(+) = xrvsp.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.employee_number
                      ,xrvsp.employee_name
                      ,xtrvp.gvm_type
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部(補足)
    -- 売上－中計部で一般計、自販機計で０件だった営業員の中計部を作成する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,(SELECT  MAX(xrvsp3.line_num)
             FROM    xxcso_rep_visit_sale_plan  xrvsp3
             WHERE   xrvsp3.request_id = cn_request_id
               AND   xrvsp3.line_kind  = cn_line_kind3
            ) + ROWNUM                           -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
    FROM    (
             -- 一般計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,xrvsp.employee_number                 employee_number
                    ,xrvsp.employee_name                   employee_name
                    ,cv_gvm_g                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id      = cn_request_id
                         AND   xrvsp3.line_kind       = cn_line_kind3
                         AND   xrvsp3.employee_number = xrvsp.employee_number
                         AND   xrvsp3.gvm_type        = cv_gvm_g
                     )
             UNION ALL
             -- 自販機計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,xrvsp.employee_number                 employee_number
                    ,xrvsp.employee_name                   employee_name
                    ,cv_gvm_v                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id      = cn_request_id
                         AND   xrvsp3.line_kind       = cn_line_kind3
                         AND   xrvsp3.employee_number = xrvsp.employee_number
                         AND   xrvsp3.gvm_type        = cv_gvm_v
                     )
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－計部
    -- 営業員毎に新規顧客軒数、新規ＶＤ軒数、売上予算を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,xrvsp.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind4                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,xrvsp.base_code                      -- 拠点コード
           ,xrvsp.hub_name                       -- 拠点名
           ,xrvsp.employee_number                -- 営業員コード
           ,xrvsp.employee_name                  -- 営業員名
           ,xtrvp.new_customer_num               -- 新規顧客軒数
           ,xtrvp.new_vendor_num                 -- 新規ＶＤ軒数
           ,(CASE
               WHEN (xdmp.sales_plan_rel_div = '1') THEN
                 xspmp.tgt_sales_prsn_total_amt
               ELSE
                 xspmp.bsc_sls_prsn_total_amt
             END
            )                                    -- 売上予算
    FROM    xxcso_rep_visit_sale_plan   xrvsp
           ,xxcso_dept_monthly_plans    xdmp
           ,xxcso_sls_prsn_mnthly_plns  xspmp
           ,(
             SELECT  xtrvp1.employee_number        employee_number
                    ,SUM(xtrvp1.new_customer_num)  new_customer_num
                    ,SUM(xtrvp1.new_vendor_num)    new_vendor_num
             FROM    xxcso_tmp_rep_vs_plan         xtrvp1
             GROUP BY xtrvp1.employee_number
            )                           xtrvp
    WHERE   xrvsp.request_id         = cn_request_id
      AND   xrvsp.line_kind          = cn_line_kind1
      AND   xtrvp.employee_number(+) = xrvsp.employee_number
      AND   xdmp.base_code(+)        = xrvsp.base_code
      AND   xdmp.year_month(+)       = gv_year_month
      AND   xspmp.base_code(+)       = xrvsp.base_code
      AND   xspmp.employee_number(+) = xrvsp.employee_number
      AND   xspmp.year_month(+)      = gv_year_month
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－中計部
    -- 営業員毎に訪問計画／訪問実績（日別）を
    -- 一般計、自販機計、ＭＣ計で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,plan_vs_amt_1                             -- １日－訪問計画
      ,plan_vs_amt_2                             -- ２日－訪問計画
      ,plan_vs_amt_3                             -- ３日－訪問計画
      ,plan_vs_amt_4                             -- ４日－訪問計画
      ,plan_vs_amt_5                             -- ５日－訪問計画
      ,plan_vs_amt_6                             -- ６日－訪問計画
      ,plan_vs_amt_7                             -- ７日－訪問計画
      ,plan_vs_amt_8                             -- ８日－訪問計画
      ,plan_vs_amt_9                             -- ９日－訪問計画
      ,plan_vs_amt_10                            -- １０日－訪問計画
      ,plan_vs_amt_11                            -- １１日－訪問計画
      ,plan_vs_amt_12                            -- １２日－訪問計画
      ,plan_vs_amt_13                            -- １３日－訪問計画
      ,plan_vs_amt_14                            -- １４日－訪問計画
      ,plan_vs_amt_15                            -- １５日－訪問計画
      ,plan_vs_amt_16                            -- １６日－訪問計画
      ,plan_vs_amt_17                            -- １７日－訪問計画
      ,plan_vs_amt_18                            -- １８日－訪問計画
      ,plan_vs_amt_19                            -- １９日－訪問計画
      ,plan_vs_amt_20                            -- ２０日－訪問計画
      ,plan_vs_amt_21                            -- ２１日－訪問計画
      ,plan_vs_amt_22                            -- ２２日－訪問計画
      ,plan_vs_amt_23                            -- ２３日－訪問計画
      ,plan_vs_amt_24                            -- ２４日－訪問計画
      ,plan_vs_amt_25                            -- ２５日－訪問計画
      ,plan_vs_amt_26                            -- ２６日－訪問計画
      ,plan_vs_amt_27                            -- ２７日－訪問計画
      ,plan_vs_amt_28                            -- ２８日－訪問計画
      ,plan_vs_amt_29                            -- ２９日－訪問計画
      ,plan_vs_amt_30                            -- ３０日－訪問計画
      ,plan_vs_amt_31                            -- ３１日－訪問計画
      ,rslt_vs_amt_1                             -- １日－訪問実績
      ,rslt_vs_amt_2                             -- ２日－訪問実績
      ,rslt_vs_amt_3                             -- ３日－訪問実績
      ,rslt_vs_amt_4                             -- ４日－訪問実績
      ,rslt_vs_amt_5                             -- ５日－訪問実績
      ,rslt_vs_amt_6                             -- ６日－訪問実績
      ,rslt_vs_amt_7                             -- ７日－訪問実績
      ,rslt_vs_amt_8                             -- ８日－訪問実績
      ,rslt_vs_amt_9                             -- ９日－訪問実績
      ,rslt_vs_amt_10                            -- １０日－訪問実績
      ,rslt_vs_amt_11                            -- １１日－訪問実績
      ,rslt_vs_amt_12                            -- １２日－訪問実績
      ,rslt_vs_amt_13                            -- １３日－訪問実績
      ,rslt_vs_amt_14                            -- １４日－訪問実績
      ,rslt_vs_amt_15                            -- １５日－訪問実績
      ,rslt_vs_amt_16                            -- １６日－訪問実績
      ,rslt_vs_amt_17                            -- １７日－訪問実績
      ,rslt_vs_amt_18                            -- １８日－訪問実績
      ,rslt_vs_amt_19                            -- １９日－訪問実績
      ,rslt_vs_amt_20                            -- ２０日－訪問実績
      ,rslt_vs_amt_21                            -- ２１日－訪問実績
      ,rslt_vs_amt_22                            -- ２２日－訪問実績
      ,rslt_vs_amt_23                            -- ２３日－訪問実績
      ,rslt_vs_amt_24                            -- ２４日－訪問実績
      ,rslt_vs_amt_25                            -- ２５日－訪問実績
      ,rslt_vs_amt_26                            -- ２６日－訪問実績
      ,rslt_vs_amt_27                            -- ２７日－訪問実績
      ,rslt_vs_amt_28                            -- ２８日－訪問実績
      ,rslt_vs_amt_29                            -- ２９日－訪問実績
      ,rslt_vs_amt_30                            -- ３０日－訪問実績
      ,rslt_vs_amt_31                            -- ３１日－訪問実績
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind5                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,plan_vs_amt_1                        -- １日－訪問計画
           ,plan_vs_amt_2                        -- ２日－訪問計画
           ,plan_vs_amt_3                        -- ３日－訪問計画
           ,plan_vs_amt_4                        -- ４日－訪問計画
           ,plan_vs_amt_5                        -- ５日－訪問計画
           ,plan_vs_amt_6                        -- ６日－訪問計画
           ,plan_vs_amt_7                        -- ７日－訪問計画
           ,plan_vs_amt_8                        -- ８日－訪問計画
           ,plan_vs_amt_9                        -- ９日－訪問計画
           ,plan_vs_amt_10                       -- １０日－訪問計画
           ,plan_vs_amt_11                       -- １１日－訪問計画
           ,plan_vs_amt_12                       -- １２日－訪問計画
           ,plan_vs_amt_13                       -- １３日－訪問計画
           ,plan_vs_amt_14                       -- １４日－訪問計画
           ,plan_vs_amt_15                       -- １５日－訪問計画
           ,plan_vs_amt_16                       -- １６日－訪問計画
           ,plan_vs_amt_17                       -- １７日－訪問計画
           ,plan_vs_amt_18                       -- １８日－訪問計画
           ,plan_vs_amt_19                       -- １９日－訪問計画
           ,plan_vs_amt_20                       -- ２０日－訪問計画
           ,plan_vs_amt_21                       -- ２１日－訪問計画
           ,plan_vs_amt_22                       -- ２２日－訪問計画
           ,plan_vs_amt_23                       -- ２３日－訪問計画
           ,plan_vs_amt_24                       -- ２４日－訪問計画
           ,plan_vs_amt_25                       -- ２５日－訪問計画
           ,plan_vs_amt_26                       -- ２６日－訪問計画
           ,plan_vs_amt_27                       -- ２７日－訪問計画
           ,plan_vs_amt_28                       -- ２８日－訪問計画
           ,plan_vs_amt_29                       -- ２９日－訪問計画
           ,plan_vs_amt_30                       -- ３０日－訪問計画
           ,plan_vs_amt_31                       -- ３１日－訪問計画
           ,rslt_vs_amt_1                        -- １日－訪問実績
           ,rslt_vs_amt_2                        -- ２日－訪問実績
           ,rslt_vs_amt_3                        -- ３日－訪問実績
           ,rslt_vs_amt_4                        -- ４日－訪問実績
           ,rslt_vs_amt_5                        -- ５日－訪問実績
           ,rslt_vs_amt_6                        -- ６日－訪問実績
           ,rslt_vs_amt_7                        -- ７日－訪問実績
           ,rslt_vs_amt_8                        -- ８日－訪問実績
           ,rslt_vs_amt_9                        -- ９日－訪問実績
           ,rslt_vs_amt_10                       -- １０日－訪問実績
           ,rslt_vs_amt_11                       -- １１日－訪問実績
           ,rslt_vs_amt_12                       -- １２日－訪問実績
           ,rslt_vs_amt_13                       -- １３日－訪問実績
           ,rslt_vs_amt_14                       -- １４日－訪問実績
           ,rslt_vs_amt_15                       -- １５日－訪問実績
           ,rslt_vs_amt_16                       -- １６日－訪問実績
           ,rslt_vs_amt_17                       -- １７日－訪問実績
           ,rslt_vs_amt_18                       -- １８日－訪問実績
           ,rslt_vs_amt_19                       -- １９日－訪問実績
           ,rslt_vs_amt_20                       -- ２０日－訪問実績
           ,rslt_vs_amt_21                       -- ２１日－訪問実績
           ,rslt_vs_amt_22                       -- ２２日－訪問実績
           ,rslt_vs_amt_23                       -- ２３日－訪問実績
           ,rslt_vs_amt_24                       -- ２４日－訪問実績
           ,rslt_vs_amt_25                       -- ２５日－訪問実績
           ,rslt_vs_amt_26                       -- ２６日－訪問実績
           ,rslt_vs_amt_27                       -- ２７日－訪問実績
           ,rslt_vs_amt_28                       -- ２８日－訪問実績
           ,rslt_vs_amt_29                       -- ２９日－訪問実績
           ,rslt_vs_amt_30                       -- ３０日－訪問実績
           ,rslt_vs_amt_31                       -- ３１日－訪問実績
    FROM    (
             -------------------------------------------
             --一般計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.base_code                        base_code
                    ,xrvsp.hub_name                         hub_name
                    ,xrvsp.employee_number                  employee_number
                    ,xrvsp.employee_name                    employee_name
                    ,cv_gvm_g                               gvm_type
                    ,SUM(xtrvp.tgt_vis_i_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_i_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_i_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_i_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_i_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_i_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_i_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_i_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_i_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_i_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_i_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_i_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_i_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_i_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_i_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_i_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_i_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_i_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_i_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_i_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_i_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_i_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_i_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_i_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_i_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_i_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_i_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_i_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_i_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_i_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_i_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_i_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_i_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_i_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_i_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_i_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_i_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_i_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_i_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_i_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_i_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_i_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_i_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_i_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_i_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_i_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_i_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_i_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_i_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_i_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_i_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_i_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_i_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_i_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_i_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_i_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_i_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_i_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_i_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_i_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_i_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_i_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                     ,xxcso_tmp_rep_vs_plan       xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.employee_number(+)     = xrvsp.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.employee_number
                      ,xrvsp.employee_name
             UNION ALL
             -------------------------------------------
             -- 自販機計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.employee_number        employee_number
                    ,xrvsp.employee_name          employee_name
                    ,cv_gvm_v                     gvm_type
                    ,SUM(xtrvp.tgt_vis_v_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_v_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_v_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_v_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_v_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_v_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_v_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_v_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_v_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_v_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_v_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_v_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_v_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_v_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_v_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_v_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_v_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_v_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_v_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_v_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_v_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_v_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_v_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_v_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_v_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_v_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_v_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_v_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_v_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_v_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_v_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_v_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_v_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_v_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_v_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_v_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_v_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_v_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_v_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_v_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_v_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_v_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_v_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_v_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_v_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_v_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_v_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_v_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_v_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_v_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_v_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_v_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_v_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_v_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_v_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_v_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_v_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_v_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_v_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_v_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_v_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_v_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                     ,xxcso_tmp_rep_vs_plan       xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.employee_number(+)     = xrvsp.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.employee_number
                      ,xrvsp.employee_name
             UNION ALL
             -------------------------------------------
             -- ＭＣ計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.employee_number        employee_number
                    ,xrvsp.employee_name          employee_name
                    ,cv_gvm_m                     gvm_type
                    ,0                            plan_vs_amt_1
                    ,0                            plan_vs_amt_2
                    ,0                            plan_vs_amt_3
                    ,0                            plan_vs_amt_4
                    ,0                            plan_vs_amt_5
                    ,0                            plan_vs_amt_6
                    ,0                            plan_vs_amt_7
                    ,0                            plan_vs_amt_8
                    ,0                            plan_vs_amt_9
                    ,0                            plan_vs_amt_10
                    ,0                            plan_vs_amt_11
                    ,0                            plan_vs_amt_12
                    ,0                            plan_vs_amt_13
                    ,0                            plan_vs_amt_14
                    ,0                            plan_vs_amt_15
                    ,0                            plan_vs_amt_16
                    ,0                            plan_vs_amt_17
                    ,0                            plan_vs_amt_18
                    ,0                            plan_vs_amt_19
                    ,0                            plan_vs_amt_20
                    ,0                            plan_vs_amt_21
                    ,0                            plan_vs_amt_22
                    ,0                            plan_vs_amt_23
                    ,0                            plan_vs_amt_24
                    ,0                            plan_vs_amt_25
                    ,0                            plan_vs_amt_26
                    ,0                            plan_vs_amt_27
                    ,0                            plan_vs_amt_28
                    ,0                            plan_vs_amt_29
                    ,0                            plan_vs_amt_30
                    ,0                            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_m_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_m_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_m_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_m_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_m_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_m_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_m_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_m_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_m_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_m_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_m_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_m_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_m_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_m_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_m_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_m_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_m_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_m_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_m_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_m_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_m_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_m_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_m_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_m_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_m_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_m_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_m_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_m_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_m_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_m_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_m_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                     ,xxcso_tmp_rep_vs_plan       xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.employee_number(+)     = xrvsp.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.employee_number
                      ,xrvsp.employee_name
             ORDER BY  report_output_no
                      ,gvm_type
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－有効訪問部
    -- 営業員毎に有効訪問（日別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,effective_num_1                           -- １日－有効軒数
      ,effective_num_2                           -- ２日－有効軒数
      ,effective_num_3                           -- ３日－有効軒数
      ,effective_num_4                           -- ４日－有効軒数
      ,effective_num_5                           -- ５日－有効軒数
      ,effective_num_6                           -- ６日－有効軒数
      ,effective_num_7                           -- ７日－有効軒数
      ,effective_num_8                           -- ８日－有効軒数
      ,effective_num_9                           -- ９日－有効軒数
      ,effective_num_10                          -- １０日－有効軒数
      ,effective_num_11                          -- １１日－有効軒数
      ,effective_num_12                          -- １２日－有効軒数
      ,effective_num_13                          -- １３日－有効軒数
      ,effective_num_14                          -- １４日－有効軒数
      ,effective_num_15                          -- １５日－有効軒数
      ,effective_num_16                          -- １６日－有効軒数
      ,effective_num_17                          -- １７日－有効軒数
      ,effective_num_18                          -- １８日－有効軒数
      ,effective_num_19                          -- １９日－有効軒数
      ,effective_num_20                          -- ２０日－有効軒数
      ,effective_num_21                          -- ２１日－有効軒数
      ,effective_num_22                          -- ２２日－有効軒数
      ,effective_num_23                          -- ２３日－有効軒数
      ,effective_num_24                          -- ２４日－有効軒数
      ,effective_num_25                          -- ２５日－有効軒数
      ,effective_num_26                          -- ２６日－有効軒数
      ,effective_num_27                          -- ２７日－有効軒数
      ,effective_num_28                          -- ２８日－有効軒数
      ,effective_num_29                          -- ２９日－有効軒数
      ,effective_num_30                          -- ３０日－有効軒数
      ,effective_num_31                          -- ３１日－有効軒数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind6                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.rslt_vis_e_num_1               -- １日－有効軒数
           ,inn_v.rslt_vis_e_num_2               -- ２日－有効軒数
           ,inn_v.rslt_vis_e_num_3               -- ３日－有効軒数
           ,inn_v.rslt_vis_e_num_4               -- ４日－有効軒数
           ,inn_v.rslt_vis_e_num_5               -- ５日－有効軒数
           ,inn_v.rslt_vis_e_num_6               -- ６日－有効軒数
           ,inn_v.rslt_vis_e_num_7               -- ７日－有効軒数
           ,inn_v.rslt_vis_e_num_8               -- ８日－有効軒数
           ,inn_v.rslt_vis_e_num_9               -- ９日－有効軒数
           ,inn_v.rslt_vis_e_num_10              -- １０日－有効軒数
           ,inn_v.rslt_vis_e_num_11              -- １１日－有効軒数
           ,inn_v.rslt_vis_e_num_12              -- １２日－有効軒数
           ,inn_v.rslt_vis_e_num_13              -- １３日－有効軒数
           ,inn_v.rslt_vis_e_num_14              -- １４日－有効軒数
           ,inn_v.rslt_vis_e_num_15              -- １５日－有効軒数
           ,inn_v.rslt_vis_e_num_16              -- １６日－有効軒数
           ,inn_v.rslt_vis_e_num_17              -- １７日－有効軒数
           ,inn_v.rslt_vis_e_num_18              -- １８日－有効軒数
           ,inn_v.rslt_vis_e_num_19              -- １９日－有効軒数
           ,inn_v.rslt_vis_e_num_20              -- ２０日－有効軒数
           ,inn_v.rslt_vis_e_num_21              -- ２１日－有効軒数
           ,inn_v.rslt_vis_e_num_22              -- ２２日－有効軒数
           ,inn_v.rslt_vis_e_num_23              -- ２３日－有効軒数
           ,inn_v.rslt_vis_e_num_24              -- ２４日－有効軒数
           ,inn_v.rslt_vis_e_num_25              -- ２５日－有効軒数
           ,inn_v.rslt_vis_e_num_26              -- ２６日－有効軒数
           ,inn_v.rslt_vis_e_num_27              -- ２７日－有効軒数
           ,inn_v.rslt_vis_e_num_28              -- ２８日－有効軒数
           ,inn_v.rslt_vis_e_num_29              -- ２９日－有効軒数
           ,inn_v.rslt_vis_e_num_30              -- ３０日－有効軒数
           ,inn_v.rslt_vis_e_num_31              -- ３１日－有効軒数
    FROM    (SELECT  xrvsp.report_output_no        report_output_no
                    ,xrvsp.base_code               base_code
                    ,xrvsp.hub_name                hub_name
                    ,xrvsp.employee_number         employee_number
                    ,xrvsp.employee_name           employee_name
                    ,SUM(xtrvp.rslt_vis_e_num_1)      rslt_vis_e_num_1
                    ,SUM(xtrvp.rslt_vis_e_num_2)      rslt_vis_e_num_2
                    ,SUM(xtrvp.rslt_vis_e_num_3)      rslt_vis_e_num_3
                    ,SUM(xtrvp.rslt_vis_e_num_4)      rslt_vis_e_num_4
                    ,SUM(xtrvp.rslt_vis_e_num_5)      rslt_vis_e_num_5
                    ,SUM(xtrvp.rslt_vis_e_num_6)      rslt_vis_e_num_6
                    ,SUM(xtrvp.rslt_vis_e_num_7)      rslt_vis_e_num_7
                    ,SUM(xtrvp.rslt_vis_e_num_8)      rslt_vis_e_num_8
                    ,SUM(xtrvp.rslt_vis_e_num_9)      rslt_vis_e_num_9
                    ,SUM(xtrvp.rslt_vis_e_num_10)     rslt_vis_e_num_10
                    ,SUM(xtrvp.rslt_vis_e_num_11)     rslt_vis_e_num_11
                    ,SUM(xtrvp.rslt_vis_e_num_12)     rslt_vis_e_num_12
                    ,SUM(xtrvp.rslt_vis_e_num_13)     rslt_vis_e_num_13
                    ,SUM(xtrvp.rslt_vis_e_num_14)     rslt_vis_e_num_14
                    ,SUM(xtrvp.rslt_vis_e_num_15)     rslt_vis_e_num_15
                    ,SUM(xtrvp.rslt_vis_e_num_16)     rslt_vis_e_num_16
                    ,SUM(xtrvp.rslt_vis_e_num_17)     rslt_vis_e_num_17
                    ,SUM(xtrvp.rslt_vis_e_num_18)     rslt_vis_e_num_18
                    ,SUM(xtrvp.rslt_vis_e_num_19)     rslt_vis_e_num_19
                    ,SUM(xtrvp.rslt_vis_e_num_20)     rslt_vis_e_num_20
                    ,SUM(xtrvp.rslt_vis_e_num_21)     rslt_vis_e_num_21
                    ,SUM(xtrvp.rslt_vis_e_num_22)     rslt_vis_e_num_22
                    ,SUM(xtrvp.rslt_vis_e_num_23)     rslt_vis_e_num_23
                    ,SUM(xtrvp.rslt_vis_e_num_24)     rslt_vis_e_num_24
                    ,SUM(xtrvp.rslt_vis_e_num_25)     rslt_vis_e_num_25
                    ,SUM(xtrvp.rslt_vis_e_num_26)     rslt_vis_e_num_26
                    ,SUM(xtrvp.rslt_vis_e_num_27)     rslt_vis_e_num_27
                    ,SUM(xtrvp.rslt_vis_e_num_28)     rslt_vis_e_num_28
                    ,SUM(xtrvp.rslt_vis_e_num_29)     rslt_vis_e_num_29
                    ,SUM(xtrvp.rslt_vis_e_num_30)     rslt_vis_e_num_30
                    ,SUM(xtrvp.rslt_vis_e_num_31)     rslt_vis_e_num_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.employee_number(+)     = xrvsp.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.employee_number
                      ,xrvsp.employee_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－明細部
    -- 営業員毎に訪問記号計（月別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,vis_a_num                                 -- 訪問Ａ件数
      ,vis_b_num                                 -- 訪問Ｂ件数
      ,vis_c_num                                 -- 訪問Ｃ件数
      ,vis_d_num                                 -- 訪問Ｄ件数
      ,vis_e_num                                 -- 訪問Ｅ件数
      ,vis_f_num                                 -- 訪問Ｆ件数
      ,vis_g_num                                 -- 訪問Ｇ件数
      ,vis_h_num                                 -- 訪問Ｈ件数
      ,vis_i_num                                 -- 訪問Ｉ件数
      ,vis_j_num                                 -- 訪問Ｊ件数
      ,vis_k_num                                 -- 訪問Ｋ件数
      ,vis_l_num                                 -- 訪問Ｌ件数
      ,vis_m_num                                 -- 訪問Ｍ件数
      ,vis_n_num                                 -- 訪問Ｎ件数
      ,vis_o_num                                 -- 訪問Ｏ件数
      ,vis_p_num                                 -- 訪問Ｐ件数
      ,vis_q_num                                 -- 訪問Ｑ件数
      ,vis_r_num                                 -- 訪問Ｒ件数
      ,vis_s_num                                 -- 訪問Ｓ件数
      ,vis_t_num                                 -- 訪問Ｔ件数
      ,vis_u_num                                 -- 訪問Ｕ件数
      ,vis_v_num                                 -- 訪問Ｖ件数
      ,vis_w_num                                 -- 訪問Ｗ件数
      ,vis_x_num                                 -- 訪問Ｘ件数
      ,vis_y_num                                 -- 訪問Ｙ件数
      ,vis_z_num                                 -- 訪問Ｚ件数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind7                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.vis_a_num                      -- 訪問Ａ件数
           ,inn_v.vis_b_num                      -- 訪問Ｂ件数
           ,inn_v.vis_c_num                      -- 訪問Ｃ件数
           ,inn_v.vis_d_num                      -- 訪問Ｄ件数
           ,inn_v.vis_e_num                      -- 訪問Ｅ件数
           ,inn_v.vis_f_num                      -- 訪問Ｆ件数
           ,inn_v.vis_g_num                      -- 訪問Ｇ件数
           ,inn_v.vis_h_num                      -- 訪問Ｈ件数
           ,inn_v.vis_i_num                      -- 訪問Ｉ件数
           ,inn_v.vis_j_num                      -- 訪問Ｊ件数
           ,inn_v.vis_k_num                      -- 訪問Ｋ件数
           ,inn_v.vis_l_num                      -- 訪問Ｌ件数
           ,inn_v.vis_m_num                      -- 訪問Ｍ件数
           ,inn_v.vis_n_num                      -- 訪問Ｎ件数
           ,inn_v.vis_o_num                      -- 訪問Ｏ件数
           ,inn_v.vis_p_num                      -- 訪問Ｐ件数
           ,inn_v.vis_q_num                      -- 訪問Ｑ件数
           ,inn_v.vis_r_num                      -- 訪問Ｒ件数
           ,inn_v.vis_s_num                      -- 訪問Ｓ件数
           ,inn_v.vis_t_num                      -- 訪問Ｔ件数
           ,inn_v.vis_u_num                      -- 訪問Ｕ件数
           ,inn_v.vis_v_num                      -- 訪問Ｖ件数
           ,inn_v.vis_w_num                      -- 訪問Ｗ件数
           ,inn_v.vis_x_num                      -- 訪問Ｘ件数
           ,inn_v.vis_y_num                      -- 訪問Ｙ件数
           ,inn_v.vis_z_num                      -- 訪問Ｚ件数
    FROM    (SELECT  xrvsp.report_output_no           report_output_no
                    ,xrvsp.base_code                  base_code
                    ,xrvsp.hub_name                   hub_name
                    ,xrvsp.employee_number            employee_number
                    ,xrvsp.employee_name              employee_name
                    ,SUM(xsvsr.vis_a_num)             vis_a_num
                    ,SUM(xsvsr.vis_b_num)             vis_b_num
                    ,SUM(xsvsr.vis_c_num)             vis_c_num
                    ,SUM(xsvsr.vis_d_num)             vis_d_num
                    ,SUM(xsvsr.vis_e_num)             vis_e_num
                    ,SUM(xsvsr.vis_f_num)             vis_f_num
                    ,SUM(xsvsr.vis_g_num)             vis_g_num
                    ,SUM(xsvsr.vis_h_num)             vis_h_num
                    ,SUM(xsvsr.vis_i_num)             vis_i_num
                    ,SUM(xsvsr.vis_j_num)             vis_j_num
                    ,SUM(xsvsr.vis_k_num)             vis_k_num
                    ,SUM(xsvsr.vis_l_num)             vis_l_num
                    ,SUM(xsvsr.vis_m_num)             vis_m_num
                    ,SUM(xsvsr.vis_n_num)             vis_n_num
                    ,SUM(xsvsr.vis_o_num)             vis_o_num
                    ,SUM(xsvsr.vis_p_num)             vis_p_num
                    ,SUM(xsvsr.vis_q_num)             vis_q_num
                    ,SUM(xsvsr.vis_r_num)             vis_r_num
                    ,SUM(xsvsr.vis_s_num)             vis_s_num
                    ,SUM(xsvsr.vis_t_num)             vis_t_num
                    ,SUM(xsvsr.vis_u_num)             vis_u_num
                    ,SUM(xsvsr.vis_v_num)             vis_v_num
                    ,SUM(xsvsr.vis_w_num)             vis_w_num
                    ,SUM(xsvsr.vis_x_num)             vis_x_num
                    ,SUM(xsvsr.vis_y_num)             vis_y_num
                    ,SUM(xsvsr.vis_z_num)             vis_z_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
                    ,xxcso_sum_visit_sale_rep     xsvsr
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.employee_number(+)     = xrvsp.employee_number
               AND   xsvsr.sum_org_type(+)        = cv_sum_org_type1
               AND   xsvsr.sum_org_code(+)        = xtrvp.account_number
               AND   xsvsr.group_base_code(+)     = xtrvp.base_code
               AND   xsvsr.month_date_div(+)      = cv_month_date_div1
               AND   xsvsr.sales_date(+)          = gv_year_month
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.employee_number
                      ,xrvsp.employee_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_0945 END*/
/* 20090519_Ogawa_T1_1021 END*/
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END get_ticket1;
--
  /**********************************************************************************
   * Procedure Name   : up_plsql_tab2
   * Description      : 帳票種別2-営業員グループ別-PLSQL表の更新 (A-4-3)
  ***********************************************************************************/
  PROCEDURE up_plsql_tab2(
     i_month_square_rec  IN         g_month_rtype2                     -- 一ヶ月分データ
    ,in_m_cnt            IN         NUMBER                             -- 明細部のカウンタ
    ,io_m_tab            IN  OUT    NOCOPY    g_get_month_square_ttype           -- 明細部配列
    ,io_hon_tab          IN  OUT    NOCOPY    g_get_month_square_ttype           -- 本体部配列
    ,ov_errbuf           OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'up_plsql_tab2';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
    -- ローカル変数
    lv_gvm_type           VARCHAR2(1);                                       -- 一般／自販機／ＭＣ
    ln_m_cnt              NUMBER(9);                                         -- INパラメータを格納
    BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
      ln_m_cnt                            := in_m_cnt;                       -- INパラメータを格納
      -- DEBUGメッセージ
      -- PL/SQL表の更新
      debug(
         buff   => '営業グループ別-PL/SQL表の更新処理:' || TO_CHAR(ln_m_cnt)
      );
--
      BEGIN
        -- 売り上げ明細部
        io_m_tab(ln_m_cnt).base_code        := i_month_square_rec.work_base_code; -- 業務地拠点コード
        io_m_tab(ln_m_cnt).hub_name         := i_month_square_rec.base_name;     -- 業務地拠点名
        io_m_tab(in_m_cnt).group_number     := i_month_square_rec.group_number;  -- 営業グループ番号
        io_m_tab(in_m_cnt).group_name       := i_month_square_rec.group_name;    -- 営業グループ名
        io_m_tab(ln_m_cnt).employee_number  := i_month_square_rec.employee_number;-- 従業員番号
        io_m_tab(ln_m_cnt).employee_name    := i_month_square_rec.name;          -- 従業員名
        io_m_tab(in_m_cnt).last_year_rslt_sales_amt := i_month_square_rec.rslt_amty;   -- 前年実績
        io_m_tab(in_m_cnt).last_mon_rslt_sales_amt  := i_month_square_rec.rslt_amtm;   -- 先月実績
        io_m_tab(in_m_cnt).new_customer_num := i_month_square_rec.cust_new_num;     -- 顧客件数（新規）
        io_m_tab(in_m_cnt).new_vendor_num   := i_month_square_rec.cust_vd_new_num;  -- 顧客件数（VD：新規）
        io_m_tab(in_m_cnt).plan_sales_amt   := i_month_square_rec.tgt_sales_prsn_total_amt;  -- 月別売上予算
        -- DEBUGメッセージ
        -- PL/SQL表の更新
        debug(
           buff   => '営業グループ別-PL/SQL表の更新処理' || '売り上げ明細部固定部完了'
        );
      EXCEPTION
        WHEN OTHERS THEN
          fnd_file.put_line(
           which  => FND_FILE.LOG,
           buff   => '営業グループ別-PL/SQL表の更新処理失敗:' || SQLERRM
         );
         RAISE global_api_others_expt;
      END;
      -- 本体部
      IF(ln_m_cnt = 1) THEN
        FOR i IN 1..cn_idx_max LOOP
          IF (i = cn_idx_sales_ippn) THEN   --売り上げ中計部(一般)
            io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
          ELSIF(i=cn_idx_sales_vd) THEN      --売り上げ中計部(自販機)
            io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
          ELSIF(i = cn_idx_sales_sum) THEN
            NULL;
          ELSIF(i=cn_idx_visit_ippn)THEN       --訪問中計部
            io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
          ELSIF(i=cn_idx_visit_vd)THEN       --訪問中計部
            io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
          ELSIF(i=cn_idx_visit_mc)THEN       --訪問中計部
            io_hon_tab(i).gvm_type                 := cv_gvm_m;                              -- MC
          END IF;
          io_hon_tab(i).base_code      :=i_month_square_rec.work_base_code;-- 業務地拠点コード
          io_hon_tab(i).hub_name       :=i_month_square_rec.base_name;    -- 業務地拠点名
          io_hon_tab(i).group_number   :=i_month_square_rec.group_number; -- 営業グループ番号
          io_hon_tab(i).group_name     :=i_month_square_rec.group_name;   -- 営業グループ名
        END LOOP;
      END IF;
--
      -- 売上中計部(一般)
      io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amty, 0);    -- 前年実績
      io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt  :=
        io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amtm, 0);    -- 先月実績
      io_hon_tab(cn_idx_sales_ippn).new_customer_num :=
        io_hon_tab(cn_idx_sales_ippn).new_customer_num +
        NVL(i_month_square_rec.cust_other_new_num, 0); -- 顧客件数（新規）（一般）
      -- 売上中計部(自販機)
      io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amty, 0);       -- 前年実績
      io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amtm, 0);       -- 先月実績
      io_hon_tab(cn_idx_sales_vd).new_customer_num :=
        io_hon_tab(cn_idx_sales_vd).new_customer_num +
        i_month_square_rec.cust_vd_new_num;            -- 顧客件数（新規）(自販機)
--
      FOR i IN 1..31 LOOP
        BEGIN
          -- DEBUGメッセージ
          -- PL/SQL表の更新
          debug(
             buff   => '営業グループ別-PL/SQL表の更新処理' || '1ヶ月分のデータ更新'
          );
          -- 売り上げ明細部
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).plan_vs_amt
            := i_month_square_rec.l_one_day_tab(i).tgt_amt;               -- 売り上げ計画
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_amt;              -- 売り上げ実績
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_other_sales_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_center_amt;       -- 内他拠点＿売上実績
          -- 売り上げ中計部(一般)
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_other_amt,0);     --売上計画,訪問計画
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_other_amt,0);    -- 売上実績,訪問実績
          -- 売り上げ中計部(自販機)
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vd_amt,0);        --売上計画,訪問計画
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_vd_amt,0);       -- 売上実績,訪問実績
          -- 売り上げ合計部
          -- 訪問中計部(一般)
          io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_other_num,0); --売上計画,訪問計画
          io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_other_num,0);         -- 売上実績,訪問実績
          -- 訪問中計部(自販機)
          io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_vd_num,0);        --売上計画,訪問計画
          io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_vd_num,0);            -- 売上実績,訪問実績
          -- 訪問中計部(MC)
          io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_mc_num,0);        --売上計画,訪問計画
          io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_mc_num,0);            -- 売上実績,訪問実績
          -- 訪問合計部
          io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num :=
            io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_sales_num,0);         -- 有効軒数
          -- 訪問内容合計部
          io_hon_tab(cn_idx_visit_dsc).vis_a_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_a_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_a_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_b_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_b_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_b_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_c_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_c_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_c_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_d_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_d_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_d_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_e_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_e_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_e_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_f_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_f_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_f_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_g_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_g_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_g_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_h_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_h_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_h_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_i_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_i_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_i_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_j_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_j_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_j_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_k_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_k_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_k_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_l_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_l_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_l_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_m_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_m_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_m_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_n_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_n_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_n_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_o_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_o_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_o_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_p_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_p_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_p_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_q_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_q_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_q_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_r_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_r_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_r_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_s_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_s_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_s_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_t_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_t_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_t_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_u_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_u_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_u_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_v_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_v_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_v_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_w_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_w_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_w_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_x_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_x_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_x_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_y_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_y_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_y_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_z_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_z_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_z_num,0);
        EXCEPTION
          WHEN OTHERS THEN
          fnd_file.put_line(
             which  => FND_FILE.LOG,
             buff   => '営業グループ別-PL/SQL表-本体部の更新処理でエラーになりました。' || SQLERRM ||
                      ''                         -- 空行の挿入
           );
        END;
      END LOOP;
    EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END up_plsql_tab2;
--
  /**********************************************************************************
   * Procedure Name   : get_ticket2
   * Description      : 帳票種別2-営業員グループ別 (A-4-1,A-4-2)
  ***********************************************************************************/
  PROCEDURE get_ticket2(
    ov_errbuf         OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
   ,ov_retcode        OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
   ,ov_errmsg         OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'get_ticket2';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ローカル定数
    -- ローカル変数
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1027 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--  lb_boolean            BOOLEAN;      -- 判断用
--  ln_m_cnt              NUMBER(9);    -- 明細部カウンター数格納
--  ln_cnt                NUMBER(9);    -- 抽出されたレコード件数
--  ln_date               NUMBER(2);    -- 日付のナンバー型
--  ln_report_output_no   NUMBER(9);    -- 帳票出力セット番号
--  lv_bf_group_number    xxcso_resource_relations_v2.group_number_new%TYPE;
--  lv_bf_employee_number xxcso_resource_relations_v2.employee_number%TYPE;
--  -- *** ローカル・カーソル ***
--  CURSOR ticket_data_cur
--  IS
--    SELECT
--            (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.work_base_code_new
--              ELSE xrrv.work_base_code_old
--            END
--            ) work_base_code,                         -- 勤務地拠点コード
--            (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.work_base_name_new
--              ELSE xrrv.work_base_name_old
--            END
--            ) base_name,                              -- 勤務地拠点名
--            (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.group_number_new
--              ELSE xrrv.group_number_old
--            END
--            ) group_number,                                     -- 営業グループ番号
--            /* 20090427_abe_売上計画出力対応 START*/
--           -- (xev.last_name || 'グループ') group_name,           -- 営業グループ名
--            (SELECT (xev.last_name || 'グループ')
--             FROM  xxcso_employees_v           xev
--             WHERE xev.employee_number = (SELECT MIN(xrrv2.employee_number)
--                                          FROM   xxcso_resource_relations_v2 xrrv2 -- リソース関連マスタ(最新)VIEW
--                                          WHERE  (CASE
--                                                    WHEN TO_DATE(xrrv2.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                                                      THEN xrrv2.work_base_code_new
--                                                    ELSE xrrv2.work_base_code_old
--                                                  END
--                                                 )  =
--                                                 (CASE
--                                                    WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                                                      THEN xrrv.work_base_code_new
--                                                    ELSE xrrv.work_base_code_old
--                                                  END
--                                                 )
--                                          AND    (CASE
--                                                     WHEN xrrv2.issue_date <= gv_online_sysdate
--                                                       THEN NVL(xrrv2.group_number_new,' ')
--                                                     ELSE NVL(xrrv2.group_number_old,' ')
--                                                   END
--                                                 ) = (CASE
--                                                        WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                                                          THEN NVL(xrrv.group_number_new,' ')
--                                                        ELSE NVL(xrrv.group_number_old,' ')
--                                                      END
--                                                     )
--                                          AND    (CASE
--                                                    WHEN xrrv2.issue_date <= gv_online_sysdate
--                                                      THEN xrrv2.group_leader_flag_new
--                                                    ELSE xrrv2.group_leader_flag_old
--                                                  END
--                                                 ) = cv_flg_y
--                                         )
--              ) group_name ,  -- 営業グループ名
--            --(xrrv.last_name || 'グループ') group_name,          -- 営業グループ名
--            /* 20090427_abe_売上計画出力対応 END*/
--            xrrv.employee_number           employee_number,     -- 従業員番号
--            xrrv.full_name              name,                   -- 従業員名
--            xsvsr.sales_date            sales_date,             -- 販売年月日
--            xsvsr.tgt_amt               tgt_amt,                -- 売上計画
--            xsvsr.tgt_new_amt           tgt_new_amt,            -- 売上計画（新規）
--            xsvsr.tgt_vd_new_amt        tgt_vd_new_amt,         -- 売上計画（VD：新規）
--            xsvsr.tgt_vd_amt            tgt_vd_amt,             -- 売上計画（VD）
--            xsvsr.tgt_other_new_amt     tgt_other_new_amt,      -- 売上計画（VD以外：新規）
--            xsvsr.tgt_other_amt         tgt_other_amt,          -- 売上計画（VD以外）
--            xsvsr.rslt_amt              rslt_amt,               -- 売上実績
--            xsvsr.rslt_new_amt          rslt_new_amt,           -- 売上実績（新規）
--            xsvsr.rslt_vd_new_amt       rslt_vd_new_amt,        -- 売上実績（VD：新規）
--            xsvsr.rslt_vd_amt           rslt_vd_amt,            -- 売上実績（VD）
--            xsvsr.rslt_other_new_amt    rslt_other_new_amt,     -- 売上実績（VD以外：新規）
--            xsvsr.rslt_other_amt        rslt_other_amt,         -- 売上実績（VD以外）
--            xsvsr.rslt_center_amt       rslt_center_amt,        -- 内他拠点＿売上実績
--            xsvsr.tgt_vis_num           tgt_vis_num,            -- 訪問計画
--            xsvsr.tgt_vis_new_num       tgt_vis_new_num,        -- 訪問計画（新規）
--            xsvsr.tgt_vis_vd_new_num    tgt_vis_vd_new_num,     -- 訪問計画（VD：新規）
--            xsvsr.tgt_vis_vd_num        tgt_vis_vd_num,         -- 訪問計画（VD）
--            xsvsr.tgt_vis_other_new_num tgt_vis_other_new_num,  -- 訪問計画（VD以外：新規）
--            xsvsr.tgt_vis_other_num     tgt_vis_other_num,      -- 訪問計画（VD以外）
--            xsvsr.tgt_vis_mc_num        tgt_vis_mc_num,         -- 訪問計画（MC）
--            xsvsr.vis_num               vis_num,                -- 訪問実績
--            xsvsr.vis_new_num           vis_new_num,            -- 訪問実績（新規）
--            xsvsr.vis_vd_new_num        vis_vd_new_num,         -- 訪問実績（VD：新規）
--            xsvsr.vis_vd_num            vis_vd_num,             -- 訪問実績（VD）
--            xsvsr.vis_other_new_num     vis_other_new_num,      -- 訪問実績（VD以外：新規）
--            xsvsr.vis_other_num         vis_other_num,          -- 訪問実績（VD以外）
--            xsvsr.vis_mc_num            vis_mc_num,             -- 訪問実績（MC）
--            xsvsr.vis_sales_num         vis_sales_num,          -- 有効軒数
--            xsvsr.vis_a_num             vis_a_num,              -- 訪問Ａ件数
--            xsvsr.vis_b_num             vis_b_num,              -- 訪問Ｂ件数
--            xsvsr.vis_c_num             vis_c_num,              -- 訪問Ｃ件数
--            xsvsr.vis_d_num             vis_d_num,              -- 訪問Ｄ件数
--            xsvsr.vis_e_num             vis_e_num,              -- 訪問Ｅ件数
--            xsvsr.vis_f_num             vis_f_num,              -- 訪問Ｆ件数
--            xsvsr.vis_g_num             vis_g_num,              -- 訪問Ｇ件数
--            xsvsr.vis_h_num             vis_h_num,              -- 訪問Ｈ件数
--            xsvsr.vis_i_num             vis_i_num,              -- 訪問ⅰ件数
--            xsvsr.vis_j_num             vis_j_num,              -- 訪問Ｊ件数
--            xsvsr.vis_k_num             vis_k_num,              -- 訪問Ｋ件数
--            xsvsr.vis_l_num             vis_l_num,              -- 訪問Ｌ件数
--            xsvsr.vis_m_num             vis_m_num,              -- 訪問Ｍ件数
--            xsvsr.vis_n_num             vis_n_num,              -- 訪問Ｎ件数
--            xsvsr.vis_o_num             vis_o_num,              -- 訪問Ｏ件数
--            xsvsr.vis_p_num             vis_p_num,              -- 訪問Ｐ件数
--            xsvsr.vis_q_num             vis_q_num,              -- 訪問Ｑ件数
--            xsvsr.vis_r_num             vis_r_num,              -- 訪問Ｒ件数
--            xsvsr.vis_s_num             vis_s_num,              -- 訪問Ｓ件数
--            xsvsr.vis_t_num             vis_t_num,              -- 訪問Ｔ件数
--            xsvsr.vis_u_num             vis_u_num,              -- 訪問Ｕ件数
--            xsvsr.vis_v_num             vis_v_num,              -- 訪問Ｖ件数
--            xsvsr.vis_w_num             vis_w_num,              -- 訪問Ｗ件数
--            xsvsr.vis_x_num             vis_x_num,              -- 訪問Ｘ件数
--            xsvsr.vis_y_num             vis_y_num,              -- 訪問Ｙ件数
--            xsvsr.vis_z_num             vis_z_num,              -- 訪問Ｚ件数
--            xsvsry.rslt_amt             rslt_amty,              -- 前年実績
--            xsvsry.rslt_vd_amt          rslt_vd_amty,           -- 前年実績（VD）
--            xsvsry.rslt_other_amt       rslt_other_amty,        -- 前年実績（VD以外）
--            xsvsrm.rslt_amt             rslt_amtm,              -- 先月実績
--            xsvsrm.rslt_vd_amt          rslt_vd_amtm,           -- 先月実績（VD）
--            xsvsrm.rslt_other_amt       rslt_other_amtm,        -- 先月実績（VD以外）
--            xsvsrn.cust_new_num         cust_new_num,           -- 顧客件数（新規）
--            xsvsrn.cust_vd_new_num      cust_vd_new_num,        -- 顧客件数（VD：新規）
--            xsvsrn.cust_other_new_num   cust_other_new_num,     -- 顧客件数（VD以外：新規）
--            xsvsrn.tgt_sales_prsn_total_amt  tgt_sales_prsn_total_amt  -- 月別売上予算
--    FROM    xxcso_resource_relations_v2 xrrv                    -- リソース関連マスタ(最新)VIEW
--           ,xxcso_sum_visit_sale_rep    xsvsr                   -- 訪問売上計画管理表サマリテーブル
--           ,xxcso_sum_visit_sale_rep    xsvsry                  -- 訪問売上計画管理表サマリ前年
--           ,xxcso_sum_visit_sale_rep    xsvsrm                  -- 訪問売上計画管理表サマリ先月
--           ,xxcso_sum_visit_sale_rep    xsvsrn                  -- 訪問売上計画管理表サマリ当月
--    WHERE  (CASE
--              WHEN TO_DATE(xrrv.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                THEN xrrv.work_base_code_new
--              ELSE xrrv.work_base_code_old
--            END
--            )  = gv_base_code
--      AND   (
--              ( gv_is_groupleader = cv_true
--                AND
--                ( CASE
--                    /* 20090427_abe_売上計画出力対応 START*/
--                    WHEN xrrv.issue_date IS NULL
--                      THEN NVL(xrrv.group_number_new,' ')
--                    WHEN xrrv.issue_date <= gv_online_sysdate
--                      THEN NVL(xrrv.group_number_new,' ')
--                    ELSE  NVL(xrrv.group_number_old,' ')
--                    --WHEN xrrv.issue_date IS NULL
--                    --  THEN xrrv.group_number_new
--                    --WHEN xrrv.issue_date <= gv_online_sysdate
--                    --  THEN xrrv.group_number_new
--                    --ELSE  xrrv.group_number_old
--                    /* 20090427_abe_売上計画出力対応 END*/
--                  END
--                ) = gt_group_number
--              )
--              OR
--              ( gv_is_groupleader = cv_false
--                AND
--                1 = 1
--              )
--            )
--      /* 20090427_abe_売上計画出力対応 START*/
--      AND   xrrv.employee_number = xsvsr.sum_org_code(+)
--      AND   xsvsr.sum_org_type(+)   = cv_sum_org_type2
--      AND   xsvsr.month_date_div(+) = cv_month_date_div2
--      AND   xsvsr.sales_date(+)
--              BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      --AND   xrrv.employee_number = xsvsr.sum_org_code
--      --AND   xsvsr.sum_org_type   = cv_sum_org_type2
--      --AND   xsvsr.month_date_div = cv_month_date_div2
--      --AND   xsvsr.sales_date
--      --        BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      /* 20090427_abe_売上計画出力対応 END*/
--      AND   xsvsr.sum_org_type   = xsvsry.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsry.sum_org_code(+)
--      AND   xsvsry.month_date_div(+)= cv_month_date_div1
--      AND   xsvsry.sales_date(+) = gv_year_prev
--      AND   xsvsr.sum_org_type   = xsvsrm.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrm.sum_org_code(+)
--      AND   xsvsrm.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrm.sales_date(+) = gv_year_month_prev
--      AND   xsvsr.sum_org_type   = xsvsrn.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrn.sum_org_code(+)
--      AND   xsvsrn.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrn.sales_date(+) = gv_year_month
--    ORDER BY  work_base_code     ASC,
--              group_number       ASC,
--              employee_number    ASC;
--  -- ローカルレコード
--  l_cur_rec               ticket_data_cur%ROWTYPE;
--  -- 帳票変数格納用
--  l_month_square_rec         g_month_rtype2;
--  l_get_month_square_tab     g_get_month_square_ttype;
--  l_get_month_square_hon_tab g_get_month_square_ttype;
--
    lv_report_name             xxcso_rep_visit_sale_plan.report_name%TYPE;   -- 帳票タイトル
--
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1027 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1027 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--    -- ローカル変数初期化
--    lb_boolean                := TRUE;        -- 初期処理判断
--    ln_m_cnt                  := 1;           -- 明細部の行数
--    ln_report_output_no       := 1;           -- 配列行数
--    ln_cnt                    := 0;           -- LOOP件数
--    -- PL/SQL表（本体部）の初期化
--    init_month_square_hon_tab(l_get_month_square_hon_tab);
--    -- ローカルレコードの初期化
--    init_month_square_rec2(l_month_square_rec);
--    BEGIN
--      --カーソルオープン
--      OPEN ticket_data_cur;
--
--DO_ERROR('A-4-2-1');
--      debug(
--        buff   => 'ticket_data_curカーソルオープン'
--      );
--
--      <<get_data_loop>>
--      LOOP
--        l_cur_rec                           := NULL;          -- カーソルレコードの初期化
--
--        FETCH ticket_data_cur INTO l_cur_rec;                 -- カーソルのデータをレコードに格納
--
--DO_ERROR('A-4-2-2');
--        debug(
--          buff   => '　カーソルFETCH'
--        );
--
--        debug(
--          buff   => l_cur_rec.work_base_code                    ||','||
--                    l_cur_rec.base_name                         ||','||
--                    l_cur_rec.group_number                      ||','||
--                    l_cur_rec.group_name                        ||','||
--                    l_cur_rec.employee_number                   ||','||
--                    l_cur_rec.name                              ||','||
--                    l_cur_rec.sales_date                        ||','||
--                    TO_CHAR(l_cur_rec.tgt_amt)                  ||','||
--                    TO_CHAR(l_cur_rec.tgt_new_amt)              ||','||
--                    TO_CHAR(l_cur_rec.tgt_vd_new_amt)           ||','||
--                    TO_CHAR(l_cur_rec.tgt_vd_amt)               ||','||
--                    TO_CHAR(l_cur_rec.tgt_other_new_amt)        ||','||
--                    TO_CHAR(l_cur_rec.tgt_other_amt)            ||','||
--                    TO_CHAR(l_cur_rec.rslt_amt)                 ||','||
--                    TO_CHAR(l_cur_rec.rslt_new_amt)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_new_amt)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amt)              ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_new_amt)       ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amt)           ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_amt)          ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_num)              ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_new_num)          ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_vd_new_num)       ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_vd_num)           ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_other_new_num)    ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_other_num)        ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_mc_num)           ||','||
--                    TO_CHAR(l_cur_rec.vis_num)                  ||','||
--                    TO_CHAR(l_cur_rec.vis_new_num)              ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_new_num)           ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_other_new_num)        ||','||
--                    TO_CHAR(l_cur_rec.vis_other_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_mc_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_sales_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_a_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_b_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_c_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_d_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_e_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_f_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_g_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_h_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_i_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_j_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_k_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_l_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_m_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_n_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_o_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_p_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_q_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_r_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_s_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_t_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_u_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_v_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_w_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_x_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_y_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_z_num)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_amty)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amty)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amty)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_amtm)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amtm)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amtm)          ||','||
--                    TO_CHAR(l_cur_rec.cust_new_num)             ||','||
--                    TO_CHAR(l_cur_rec.cust_other_new_num)       ||','||
--                    TO_CHAR(l_cur_rec.tgt_sales_prsn_total_amt) ||','||
--                   cv_lf
--        );
--
--        fnd_file.put_line(
--              which  => FND_FILE.LOG,
--              buff   => 'gv_is_groupleader:'      || gv_is_groupleader
--        );
--
--
--        -- 対象件数がO件の場合
--        EXIT WHEN ticket_data_cur%NOTFOUND
--          OR  ticket_data_cur%ROWCOUNT = 0;
--
--        -- 前回レコードと営業グループが同じで営業員番号が違う場合、明細部配列と本体部配列を更新。
--        IF(lb_boolean=FALSE) THEN
--          IF((lv_bf_group_number = l_cur_rec.group_number  OR (lv_bf_group_number IS NULL AND  l_cur_rec.group_number IS NULL))AND(lv_bf_employee_number <> l_cur_rec.employee_number))
--            THEN
--            -- DEBUGメッセージ
--            debug(
--               buff   => '従業員番号が違います。 :' ||'前回： '|| lv_bf_employee_number ||
--                          '今回：' || l_cur_rec.employee_number ||
--                          '明細部配列' || TO_CHAR(ln_m_cnt)
--            );
--            -- =================================================
--            -- A-4-3.PLSQL表の更新
--            -- =================================================
--              up_plsql_tab2(
--                 i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--                ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--                ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--                ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--                ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--                ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--                ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--              );
--              IF (lv_retcode = cv_status_error) THEN
--                RAISE global_process_expt;
--              END IF;
--              l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--              l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--              init_month_square_rec2(l_month_square_rec);
--              ln_m_cnt          := ln_m_cnt + 1;       -- 明細部配列を＋１する。
--              lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          ELSIF(lv_bf_group_number <> l_cur_rec.group_number) OR (lv_bf_group_number IS NOT NULL AND l_cur_rec.group_number IS NULL) THEN
--            -- =================================================
--            -- A-4-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab2(
--               i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--            l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--            init_month_square_rec2(l_month_square_rec);
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          END IF;
--        END IF;
--        -- 営業グループ番号が前回取得した営業グループ番号と違う場合ワークテーブルに出力します。
--        IF ((ln_cnt > 0) AND
--            ((lv_bf_group_number <> l_cur_rec.group_number) OR (lv_bf_group_number IS NOT NULL AND l_cur_rec.group_number IS NULL ))) THEN
--          debug(
--             buff   => '営業員グループ番号が違います。 :' ||'前回： '|| lv_bf_group_number || ''||
--                        '今回：' || l_cur_rec.group_number
--          );
--          -- =================================================
--          -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--          -- =================================================
--          insert_wrk_table(
--             ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--            ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--            ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--            ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--            ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--            ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--            ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--          );
--          IF (lv_retcode = cv_status_error) THEN
--            RAISE global_process_expt;
--          END IF;
--          -- レコードの初期化
--          l_get_month_square_tab.DELETE;
--          l_get_month_square_hon_tab.DELETE;
--          init_month_square_hon_tab(l_get_month_square_hon_tab);
--          ln_m_cnt            := 1;                       -- 明細部配列の行数の初期化
--          ln_report_output_no := ln_report_output_no + 1; -- 出力された帳票個数に＋１する
--          lb_boolean          := TRUE;                    -- 初期処理の状態に戻す
--        END IF;
--        -- 初期処理の場合
--        IF(lb_boolean) THEN
--          -- 営業員番号と営業員グループ番号をローカル変数に格納
--          lv_bf_group_number         := l_cur_rec.group_number;          -- 営業グループ番号
--          lv_bf_employee_number      := l_cur_rec.employee_number;       -- 従業員番号
--          -- ローカルレコードに格納
--          -- 勤務地拠点コード
--          l_month_square_rec.work_base_code     := l_cur_rec.work_base_code;
--          -- 勤務地拠点名
--          l_month_square_rec.base_name          := l_cur_rec.base_name;
--          -- 営業グループ番号
--          l_month_square_rec.group_number       := l_cur_rec.group_number;
--          -- 営業グループ名
--          l_month_square_rec.group_name         := l_cur_rec.group_name;
--          -- 従業員番号
--          l_month_square_rec.employee_number    := l_cur_rec.employee_number;
--          -- 従業員名
--          l_month_square_rec.name               := l_cur_rec.name;
--          -- 新規顧客件数
--          l_month_square_rec.cust_new_num    := l_cur_rec.cust_new_num;
--          -- 新規VD件数
--          l_month_square_rec.cust_vd_new_num    := l_cur_rec.cust_vd_new_num;
--          -- 新規VD以外件数
--          l_month_square_rec.cust_other_new_num := l_cur_rec.cust_other_new_num;
--          -- 前年実績
--          l_month_square_rec.rslt_amty          := l_cur_rec.rslt_amty;
--          -- 前年実績（VD）
--          l_month_square_rec.rslt_vd_amty       := l_cur_rec.rslt_vd_amty;
--          -- 前年実績（VD以外）
--          l_month_square_rec.rslt_other_amty    := l_cur_rec.rslt_other_amty;
--          -- 先月実績
--          l_month_square_rec.rslt_amtm          := l_cur_rec.rslt_amtm;
--          -- 先月実績（VD）
--          l_month_square_rec.rslt_vd_amtm       := l_cur_rec.rslt_vd_amtm;
--          -- 先月実績（VD以外）
--          l_month_square_rec.rslt_other_amtm    := l_cur_rec.rslt_other_amtm;
--          -- 月別売上予算
--          l_month_square_rec.tgt_sales_prsn_total_amt := l_cur_rec.tgt_sales_prsn_total_amt;
--          lb_boolean := FALSE;                  -- 初期処理のフラグをオフする。
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '初期処理フラグ:' || 'FALSE'
--          );
--        END IF;
--        -- 日付を取得
--        /* 20090427_abe_売上計画出力対応 START*/
--        IF (l_cur_rec.sales_date IS NOT NULL) THEN
--        /* 20090427_abe_売上計画出力対応 END*/
--          ln_date := TO_NUMBER(SUBSTR(l_cur_rec.sales_date,7,2));
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '日付:' || l_cur_rec.sales_date || cv_lf ||
--                       '日付けのナンバー型:'     || TO_CHAR(ln_date)
--          );
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_amt
--            := l_cur_rec.tgt_amt;              -- 売上計画
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_new_amt
--            := l_cur_rec.tgt_new_amt;          -- 売上計画（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vd_new_amt
--            := l_cur_rec.tgt_vd_new_amt;       -- 売上計画（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vd_amt
--            := l_cur_rec.tgt_vd_amt;           -- 売上計画（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_other_new_amt
--            := l_cur_rec.tgt_other_new_amt;    -- 売上計画（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_other_amt
--            := l_cur_rec.tgt_other_amt;        -- 売上計画（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_amt
--            := l_cur_rec.rslt_amt;             -- 売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_new_amt
--            := l_cur_rec.rslt_new_amt;         -- 売上実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_new_amt
--            := l_cur_rec.rslt_vd_new_amt;      -- 売上実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_amt
--            := l_cur_rec.rslt_vd_amt;          -- 売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_new_amt
--            := l_cur_rec.rslt_other_new_amt;   -- 売上実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_amt
--            := l_cur_rec.rslt_other_amt;       -- 売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_amt
--            := l_cur_rec.rslt_center_amt;      -- 内他拠点＿売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_num
--            := l_cur_rec.tgt_vis_num;          -- 訪問計画
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_new_num
--            := l_cur_rec.tgt_vis_new_num;      -- 訪問計画（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_vd_new_num
--            := l_cur_rec.tgt_vis_vd_new_num;   -- 訪問計画（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_vd_num
--            := l_cur_rec.tgt_vis_vd_num;       -- 訪問計画（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_other_new_num
--            := l_cur_rec.tgt_vis_other_new_num;-- 訪問計画（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_other_num
--            := l_cur_rec.tgt_vis_other_num;    -- 訪問計画（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_mc_num
--            := l_cur_rec.tgt_vis_mc_num;        -- 訪問計画（MC）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_num
--            := l_cur_rec.vis_num;               -- 訪問実績
--          l_month_square_rec.l_one_day_tab(ln_date).vis_new_num
--            := l_cur_rec.vis_new_num;           -- 訪問実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_new_num
--            := l_cur_rec.vis_vd_new_num;        -- 訪問実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_num
--            := l_cur_rec.vis_vd_num;            -- 訪問実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_new_num
--            := l_cur_rec.vis_other_new_num;     -- 訪問実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_num
--            := l_cur_rec.vis_other_num;         -- 訪問実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_mc_num
--            := l_cur_rec.vis_mc_num;            -- 訪問実績（MC）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_sales_num
--            := l_cur_rec.vis_sales_num;         -- 有効軒数
--          -- A0Z訪問件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_a_num := nvl(l_cur_rec.vis_a_num,0);  -- 訪問A件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_b_num := nvl(l_cur_rec.vis_b_num,0);  -- 訪問B件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_c_num := nvl(l_cur_rec.vis_c_num,0);  -- 訪問C件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_d_num := nvl(l_cur_rec.vis_d_num,0);  -- 訪問D件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_e_num := nvl(l_cur_rec.vis_e_num,0);  -- 訪問E件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_f_num := nvl(l_cur_rec.vis_f_num,0);  -- 訪問F件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_g_num := nvl(l_cur_rec.vis_g_num,0);  -- 訪問G件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_h_num := nvl(l_cur_rec.vis_h_num,0);  -- 訪問H件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_i_num := nvl(l_cur_rec.vis_i_num,0);  -- 訪問I件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_j_num := nvl(l_cur_rec.vis_j_num,0);  -- 訪問J件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_k_num := nvl(l_cur_rec.vis_k_num,0);  -- 訪問K件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_l_num := nvl(l_cur_rec.vis_l_num,0);  -- 訪問L件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_m_num := nvl(l_cur_rec.vis_m_num,0);  -- 訪問M件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_n_num := nvl(l_cur_rec.vis_n_num,0);  -- 訪問N件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_o_num := nvl(l_cur_rec.vis_o_num,0);  -- 訪問O件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_p_num := nvl(l_cur_rec.vis_p_num,0);  -- 訪問P件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_q_num := nvl(l_cur_rec.vis_q_num,0);  -- 訪問Q件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_r_num := nvl(l_cur_rec.vis_r_num,0);  -- 訪問R件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_s_num := nvl(l_cur_rec.vis_s_num,0);  -- 訪問S件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_t_num := nvl(l_cur_rec.vis_t_num,0);  -- 訪問T件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_u_num := nvl(l_cur_rec.vis_u_num,0);  -- 訪問U件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_v_num := nvl(l_cur_rec.vis_v_num,0);  -- 訪問V件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_w_num := nvl(l_cur_rec.vis_w_num,0);  -- 訪問W件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_x_num := nvl(l_cur_rec.vis_x_num,0);  -- 訪問X件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_y_num := nvl(l_cur_rec.vis_y_num,0);  -- 訪問Y件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_z_num := nvl(l_cur_rec.vis_z_num,0);  -- 訪問Z件数
--        /* 20090427_abe_売上計画出力対応 START*/
--        END IF;
--        /* 20090427_abe_売上計画出力対応 END*/
--        -- 最初のレコードの場合
--        IF(lb_boolean) THEN
--          lb_boolean              := FALSE;                  -- 初期処理のフラグをオフする。
--        END IF;
--        -- 抽出件数カウンタに１を足す。
--        ln_cnt := ln_cnt + 1;
--        gn_target_cnt  := ln_cnt;
--        -- loop件数
--        debug(
--              buff   => 'loop件数' || TO_CHAR(ln_cnt)
--        );
--      END LOOP;
--      -- 最後のデータ登録
--      IF (ln_cnt > 0) THEN
--          debug(
--                buff   => '最後のデータの登録'
--          );
--      -- =================================================
--      -- A-4-3.PLSQL表の更新
--      -- =================================================
--      up_plsql_tab2(
--        i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--       ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--       ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--       ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--       ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--       ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--       ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--      );
--      IF (lv_retcode = cv_status_error) THEN
--        RAISE global_process_expt;
--      END IF;
--      -- =================================================
--      -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--      -- =================================================
--      insert_wrk_table(
--         ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--        ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--        ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--        ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--        ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--        ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--        ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--      END IF;
--      IF (lv_retcode = cv_status_error) THEN
--        RAISE global_process_expt;
--      END IF;
--    EXCEPTION
--      WHEN OTHERS THEN
--        -- メッセージ出力
--        lv_errmsg := xxccp_common_pkg.get_msg(
--                         iv_application  => cv_app_name              --アプリケーション短縮名
--                        ,iv_name         => cv_tkn_number_08         --メッセージコード
--                        ,iv_token_name1  => cv_tkn_table             --トークンコード1
--                        ,iv_token_value1 => cv_tab_samari            --トークン値1
--                        ,iv_token_name2  => cv_tkn_errmsg            --トークンコード２
--                        ,iv_token_value2 => SQLERRM                  --トークン値２
--        );
--        fnd_file.put_line(
--              which  => FND_FILE.LOG,
--              buff   => ''      || cv_lf ||     -- 空行の挿入
--                      lv_errmsg || cv_lf ||
--                       ''                         -- 空行の挿入
--        );
--        RAISE global_api_expt;
--    END;
--  -- カーソルクローズ
--  CLOSE ticket_data_cur;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 開始');
--
    sum_resources(
      iv_base_code => gv_base_code
    );
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    IF ( SQL%ROWCOUNT = 0 ) THEN
      RETURN;
    END IF;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 開始');
--
    sum_visit_sales;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
    SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（営業員グループ別）' || '≫';
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■ヘッダ部
    -- 対象拠点内の全グループを
    -- グループ番号（昇順）で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,report_id                                 -- 帳票ＩＤ
      ,report_name                               -- 帳票タイトル
      ,output_date                               -- 出力日時
      ,year_month                                -- 基準年月
      ,operation_days                            -- 稼動日数
      ,operation_all_days                        -- 稼動可能日数
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,ROWNUM                               -- 帳票出力セット番号
           ,cn_line_kind1                        -- 帳票出力位置
           ,1                                    -- 行番
           ,cv_pkg_name                          -- 帳票ＩＤ
           ,lv_report_name                       -- 帳票タイトル
           ,SYSDATE                              -- 出力日時
           ,gd_year_month                        -- 基準年月
           ,gn_operation_days                    -- 稼動日数
           ,gn_operation_all_days                -- 稼動可能日数
           ,inn_v.base_code                      -- 拠点コード
           ,(SELECT  xabv.base_name
             FROM    xxcso_aff_base_v2  xabv
             WHERE   xabv.base_code = inn_v.base_code
            )                                    -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,XXCSO019A05C.get_group_name(
               inn_v.base_code
              ,inn_v.group_number
              ,gd_online_sysdate
            )                                    -- 営業グループ名
    FROM    (
             SELECT  DISTINCT
                     xtrvr.base_code
                    ,xtrvr.group_number
             FROM    xxcso_tmp_rep_vsp_rsrcs   xtrvr
             ORDER BY  TO_NUMBER(group_number)     ASC
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■明細部
    -- グループ毎に所属する営業員をすべて抽出し、
    -- 担当する顧客の売上／訪問計画（日別）、売上／訪問実績（日別）、
    -- 売上実績（他拠点納品分）（日別）、新規顧客軒数、
    -- 新規ＶＤ軒数の合計、売上予算を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,employee_number                           -- 営業員コード
      ,employee_name                             -- 営業員名
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind2                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.employee_number                -- 営業員コード
           ,inn_v.employee_name                  -- 営業員名
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,(CASE
               WHEN (xdmp.sales_plan_rel_div = '1') THEN
                 xspmp.tgt_sales_prsn_total_amt
               ELSE
                 xspmp.bsc_sls_prsn_total_amt
             END
            )                                    -- 売上予算
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.base_code                         base_code
                    ,xrvsp.hub_name                          hub_name
                    ,xrvsp.group_number                      group_number
                    ,xrvsp.group_name                        group_name
                    ,xtrvr.employee_number                   employee_number
                    ,xtrvr.employee_name                     employee_name
                    ,xtrvr.group_leader_flag                 group_leader_flag
                    ,xtrvr.group_grade                       group_grade
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id         = cn_request_id
               AND   xrvsp.line_kind          = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
                      ,xtrvr.employee_number
                      ,xtrvr.employee_name
                      ,xtrvr.group_leader_flag
                      ,xtrvr.group_grade
             ORDER BY  report_output_no             ASC
                      ,NVL(group_leader_flag, 'N')  DESC
                      ,TO_NUMBER(group_grade)       ASC
                      ,employee_number              ASC
            )                             inn_v
           ,xxcso_dept_monthly_plans      xdmp
           ,xxcso_sls_prsn_mnthly_plns    xspmp
    WHERE   xdmp.base_code(+)        = inn_v.base_code
     AND    xdmp.year_month(+)       = gv_year_month
     AND    xspmp.base_code(+)       = inn_v.base_code
     AND    xspmp.employee_number(+) = inn_v.employee_number
     AND    xspmp.year_month(+)      = gv_year_month
     AND    xspmp.employee_number(+) = inn_v.employee_number
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部
    -- グループ毎に所属する営業員の担当する顧客の
    -- 日別合計を一般計、自販機計で集計する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.base_code                         base_code
                    ,xrvsp.hub_name                          hub_name
                    ,xrvsp.group_number                      group_number
                    ,xrvsp.group_name                        group_name
                    ,xtrvp.gvm_type                          gvm_type
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
                      ,xtrvp.gvm_type
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部(補足)
    -- 売上－中計部で一般計、自販機計で０件だったグループの中計部を作成する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,(SELECT  MAX(xrvsp3.line_num)
             FROM    xxcso_rep_visit_sale_plan  xrvsp3
             WHERE   xrvsp3.request_id = cn_request_id
               AND   xrvsp3.line_kind  = cn_line_kind3
            ) + ROWNUM                           -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
    FROM    (
             -- 一般計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,xrvsp.group_number                    group_number
                    ,xrvsp.group_name                      group_name
                    ,cv_gvm_g                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   NVL(xrvsp3.group_number, ' ') = NVL(xrvsp.group_number, ' ')
                         AND   xrvsp3.gvm_type               = cv_gvm_g
                     )
             UNION ALL
             -- 自販機計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,xrvsp.group_number                    group_number
                    ,xrvsp.group_name                      group_name
                    ,cv_gvm_v                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   NVL(xrvsp3.group_number, ' ') = NVL(xrvsp.group_number, ' ')
                         AND   xrvsp3.gvm_type               = cv_gvm_v
                     )
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－計部
    -- グループ毎に新規顧客軒数、新規ＶＤ軒数、売上予算を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind4                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.plan_sales_amt                 -- 売上予算
    FROM    (SELECT  xrvsp.report_output_no        report_output_no
                    ,xrvsp.base_code               base_code
                    ,xrvsp.hub_name                hub_name
                    ,xrvsp.group_number            group_number
                    ,xrvsp.group_name              group_name
                    ,SUM(xtrvp.new_customer_num)   new_customer_num
                    ,SUM(xtrvp.new_vendor_num)     new_vendor_num
                    ,SUM(
                       (CASE
                          WHEN (xdmp.sales_plan_rel_div = '1') THEN
                            xspmp.tgt_sales_prsn_total_amt
                          ELSE
                            xspmp.bsc_sls_prsn_total_amt
                        END
                       )
                     )                             plan_sales_amt
             FROM    xxcso_rep_visit_sale_plan   xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs     xtrvr
                    ,xxcso_dept_monthly_plans    xdmp
                    ,xxcso_sls_prsn_mnthly_plns  xspmp
                    ,(
                      SELECT  xtrvp1.employee_number        employee_number
                             ,SUM(xtrvp1.new_customer_num)  new_customer_num
                             ,SUM(xtrvp1.new_vendor_num)    new_vendor_num
                      FROM    xxcso_tmp_rep_vs_plan         xtrvp1
                      GROUP BY xtrvp1.employee_number
                     )                           xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
               AND   xdmp.base_code(+)            = xtrvr.base_code
               AND   xdmp.year_month(+)           = gv_year_month
               AND   xspmp.base_code(+)           = xtrvr.base_code
               AND   xspmp.employee_number(+)     = xtrvr.employee_number
               AND   xspmp.year_month(+)          = gv_year_month
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－中計部
    -- グループ毎に所属する営業員の訪問計画／訪問実績（日別）を
    -- 一般計、自販機計、ＭＣ計で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,plan_vs_amt_1                             -- １日－訪問計画
      ,plan_vs_amt_2                             -- ２日－訪問計画
      ,plan_vs_amt_3                             -- ３日－訪問計画
      ,plan_vs_amt_4                             -- ４日－訪問計画
      ,plan_vs_amt_5                             -- ５日－訪問計画
      ,plan_vs_amt_6                             -- ６日－訪問計画
      ,plan_vs_amt_7                             -- ７日－訪問計画
      ,plan_vs_amt_8                             -- ８日－訪問計画
      ,plan_vs_amt_9                             -- ９日－訪問計画
      ,plan_vs_amt_10                            -- １０日－訪問計画
      ,plan_vs_amt_11                            -- １１日－訪問計画
      ,plan_vs_amt_12                            -- １２日－訪問計画
      ,plan_vs_amt_13                            -- １３日－訪問計画
      ,plan_vs_amt_14                            -- １４日－訪問計画
      ,plan_vs_amt_15                            -- １５日－訪問計画
      ,plan_vs_amt_16                            -- １６日－訪問計画
      ,plan_vs_amt_17                            -- １７日－訪問計画
      ,plan_vs_amt_18                            -- １８日－訪問計画
      ,plan_vs_amt_19                            -- １９日－訪問計画
      ,plan_vs_amt_20                            -- ２０日－訪問計画
      ,plan_vs_amt_21                            -- ２１日－訪問計画
      ,plan_vs_amt_22                            -- ２２日－訪問計画
      ,plan_vs_amt_23                            -- ２３日－訪問計画
      ,plan_vs_amt_24                            -- ２４日－訪問計画
      ,plan_vs_amt_25                            -- ２５日－訪問計画
      ,plan_vs_amt_26                            -- ２６日－訪問計画
      ,plan_vs_amt_27                            -- ２７日－訪問計画
      ,plan_vs_amt_28                            -- ２８日－訪問計画
      ,plan_vs_amt_29                            -- ２９日－訪問計画
      ,plan_vs_amt_30                            -- ３０日－訪問計画
      ,plan_vs_amt_31                            -- ３１日－訪問計画
      ,rslt_vs_amt_1                             -- １日－訪問実績
      ,rslt_vs_amt_2                             -- ２日－訪問実績
      ,rslt_vs_amt_3                             -- ３日－訪問実績
      ,rslt_vs_amt_4                             -- ４日－訪問実績
      ,rslt_vs_amt_5                             -- ５日－訪問実績
      ,rslt_vs_amt_6                             -- ６日－訪問実績
      ,rslt_vs_amt_7                             -- ７日－訪問実績
      ,rslt_vs_amt_8                             -- ８日－訪問実績
      ,rslt_vs_amt_9                             -- ９日－訪問実績
      ,rslt_vs_amt_10                            -- １０日－訪問実績
      ,rslt_vs_amt_11                            -- １１日－訪問実績
      ,rslt_vs_amt_12                            -- １２日－訪問実績
      ,rslt_vs_amt_13                            -- １３日－訪問実績
      ,rslt_vs_amt_14                            -- １４日－訪問実績
      ,rslt_vs_amt_15                            -- １５日－訪問実績
      ,rslt_vs_amt_16                            -- １６日－訪問実績
      ,rslt_vs_amt_17                            -- １７日－訪問実績
      ,rslt_vs_amt_18                            -- １８日－訪問実績
      ,rslt_vs_amt_19                            -- １９日－訪問実績
      ,rslt_vs_amt_20                            -- ２０日－訪問実績
      ,rslt_vs_amt_21                            -- ２１日－訪問実績
      ,rslt_vs_amt_22                            -- ２２日－訪問実績
      ,rslt_vs_amt_23                            -- ２３日－訪問実績
      ,rslt_vs_amt_24                            -- ２４日－訪問実績
      ,rslt_vs_amt_25                            -- ２５日－訪問実績
      ,rslt_vs_amt_26                            -- ２６日－訪問実績
      ,rslt_vs_amt_27                            -- ２７日－訪問実績
      ,rslt_vs_amt_28                            -- ２８日－訪問実績
      ,rslt_vs_amt_29                            -- ２９日－訪問実績
      ,rslt_vs_amt_30                            -- ３０日－訪問実績
      ,rslt_vs_amt_31                            -- ３１日－訪問実績
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind5                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,plan_vs_amt_1                        -- １日－訪問計画
           ,plan_vs_amt_2                        -- ２日－訪問計画
           ,plan_vs_amt_3                        -- ３日－訪問計画
           ,plan_vs_amt_4                        -- ４日－訪問計画
           ,plan_vs_amt_5                        -- ５日－訪問計画
           ,plan_vs_amt_6                        -- ６日－訪問計画
           ,plan_vs_amt_7                        -- ７日－訪問計画
           ,plan_vs_amt_8                        -- ８日－訪問計画
           ,plan_vs_amt_9                        -- ９日－訪問計画
           ,plan_vs_amt_10                       -- １０日－訪問計画
           ,plan_vs_amt_11                       -- １１日－訪問計画
           ,plan_vs_amt_12                       -- １２日－訪問計画
           ,plan_vs_amt_13                       -- １３日－訪問計画
           ,plan_vs_amt_14                       -- １４日－訪問計画
           ,plan_vs_amt_15                       -- １５日－訪問計画
           ,plan_vs_amt_16                       -- １６日－訪問計画
           ,plan_vs_amt_17                       -- １７日－訪問計画
           ,plan_vs_amt_18                       -- １８日－訪問計画
           ,plan_vs_amt_19                       -- １９日－訪問計画
           ,plan_vs_amt_20                       -- ２０日－訪問計画
           ,plan_vs_amt_21                       -- ２１日－訪問計画
           ,plan_vs_amt_22                       -- ２２日－訪問計画
           ,plan_vs_amt_23                       -- ２３日－訪問計画
           ,plan_vs_amt_24                       -- ２４日－訪問計画
           ,plan_vs_amt_25                       -- ２５日－訪問計画
           ,plan_vs_amt_26                       -- ２６日－訪問計画
           ,plan_vs_amt_27                       -- ２７日－訪問計画
           ,plan_vs_amt_28                       -- ２８日－訪問計画
           ,plan_vs_amt_29                       -- ２９日－訪問計画
           ,plan_vs_amt_30                       -- ３０日－訪問計画
           ,plan_vs_amt_31                       -- ３１日－訪問計画
           ,rslt_vs_amt_1                        -- １日－訪問実績
           ,rslt_vs_amt_2                        -- ２日－訪問実績
           ,rslt_vs_amt_3                        -- ３日－訪問実績
           ,rslt_vs_amt_4                        -- ４日－訪問実績
           ,rslt_vs_amt_5                        -- ５日－訪問実績
           ,rslt_vs_amt_6                        -- ６日－訪問実績
           ,rslt_vs_amt_7                        -- ７日－訪問実績
           ,rslt_vs_amt_8                        -- ８日－訪問実績
           ,rslt_vs_amt_9                        -- ９日－訪問実績
           ,rslt_vs_amt_10                       -- １０日－訪問実績
           ,rslt_vs_amt_11                       -- １１日－訪問実績
           ,rslt_vs_amt_12                       -- １２日－訪問実績
           ,rslt_vs_amt_13                       -- １３日－訪問実績
           ,rslt_vs_amt_14                       -- １４日－訪問実績
           ,rslt_vs_amt_15                       -- １５日－訪問実績
           ,rslt_vs_amt_16                       -- １６日－訪問実績
           ,rslt_vs_amt_17                       -- １７日－訪問実績
           ,rslt_vs_amt_18                       -- １８日－訪問実績
           ,rslt_vs_amt_19                       -- １９日－訪問実績
           ,rslt_vs_amt_20                       -- ２０日－訪問実績
           ,rslt_vs_amt_21                       -- ２１日－訪問実績
           ,rslt_vs_amt_22                       -- ２２日－訪問実績
           ,rslt_vs_amt_23                       -- ２３日－訪問実績
           ,rslt_vs_amt_24                       -- ２４日－訪問実績
           ,rslt_vs_amt_25                       -- ２５日－訪問実績
           ,rslt_vs_amt_26                       -- ２６日－訪問実績
           ,rslt_vs_amt_27                       -- ２７日－訪問実績
           ,rslt_vs_amt_28                       -- ２８日－訪問実績
           ,rslt_vs_amt_29                       -- ２９日－訪問実績
           ,rslt_vs_amt_30                       -- ３０日－訪問実績
           ,rslt_vs_amt_31                       -- ３１日－訪問実績
    FROM    (
             -------------------------------------------
             --一般計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.group_number           group_number
                    ,xrvsp.group_name             group_name
                    ,cv_gvm_g                     gvm_type
                    ,SUM(xtrvp.tgt_vis_i_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_i_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_i_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_i_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_i_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_i_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_i_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_i_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_i_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_i_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_i_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_i_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_i_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_i_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_i_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_i_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_i_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_i_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_i_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_i_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_i_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_i_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_i_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_i_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_i_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_i_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_i_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_i_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_i_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_i_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_i_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_i_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_i_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_i_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_i_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_i_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_i_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_i_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_i_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_i_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_i_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_i_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_i_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_i_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_i_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_i_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_i_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_i_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_i_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_i_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_i_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_i_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_i_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_i_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_i_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_i_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_i_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_i_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_i_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_i_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_i_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_i_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
             UNION ALL
             -------------------------------------------
             -- 自販機計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.group_number           group_number
                    ,xrvsp.group_name             group_name
                    ,cv_gvm_v                     gvm_type
                    ,SUM(xtrvp.tgt_vis_v_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_v_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_v_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_v_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_v_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_v_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_v_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_v_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_v_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_v_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_v_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_v_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_v_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_v_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_v_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_v_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_v_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_v_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_v_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_v_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_v_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_v_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_v_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_v_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_v_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_v_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_v_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_v_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_v_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_v_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_v_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_v_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_v_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_v_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_v_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_v_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_v_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_v_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_v_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_v_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_v_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_v_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_v_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_v_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_v_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_v_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_v_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_v_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_v_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_v_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_v_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_v_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_v_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_v_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_v_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_v_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_v_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_v_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_v_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_v_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_v_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_v_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
             UNION ALL
             -------------------------------------------
             -- ＭＣ計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.group_number           group_number
                    ,xrvsp.group_name             group_name
                    ,cv_gvm_m                     gvm_type
                    ,0                            plan_vs_amt_1
                    ,0                            plan_vs_amt_2
                    ,0                            plan_vs_amt_3
                    ,0                            plan_vs_amt_4
                    ,0                            plan_vs_amt_5
                    ,0                            plan_vs_amt_6
                    ,0                            plan_vs_amt_7
                    ,0                            plan_vs_amt_8
                    ,0                            plan_vs_amt_9
                    ,0                            plan_vs_amt_10
                    ,0                            plan_vs_amt_11
                    ,0                            plan_vs_amt_12
                    ,0                            plan_vs_amt_13
                    ,0                            plan_vs_amt_14
                    ,0                            plan_vs_amt_15
                    ,0                            plan_vs_amt_16
                    ,0                            plan_vs_amt_17
                    ,0                            plan_vs_amt_18
                    ,0                            plan_vs_amt_19
                    ,0                            plan_vs_amt_20
                    ,0                            plan_vs_amt_21
                    ,0                            plan_vs_amt_22
                    ,0                            plan_vs_amt_23
                    ,0                            plan_vs_amt_24
                    ,0                            plan_vs_amt_25
                    ,0                            plan_vs_amt_26
                    ,0                            plan_vs_amt_27
                    ,0                            plan_vs_amt_28
                    ,0                            plan_vs_amt_29
                    ,0                            plan_vs_amt_30
                    ,0                            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_m_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_m_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_m_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_m_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_m_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_m_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_m_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_m_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_m_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_m_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_m_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_m_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_m_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_m_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_m_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_m_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_m_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_m_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_m_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_m_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_m_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_m_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_m_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_m_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_m_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_m_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_m_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_m_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_m_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_m_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_m_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－有効訪問部
    -- グループ毎に所属する営業員の有効訪問（日別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,effective_num_1                           -- １日－有効軒数
      ,effective_num_2                           -- ２日－有効軒数
      ,effective_num_3                           -- ３日－有効軒数
      ,effective_num_4                           -- ４日－有効軒数
      ,effective_num_5                           -- ５日－有効軒数
      ,effective_num_6                           -- ６日－有効軒数
      ,effective_num_7                           -- ７日－有効軒数
      ,effective_num_8                           -- ８日－有効軒数
      ,effective_num_9                           -- ９日－有効軒数
      ,effective_num_10                          -- １０日－有効軒数
      ,effective_num_11                          -- １１日－有効軒数
      ,effective_num_12                          -- １２日－有効軒数
      ,effective_num_13                          -- １３日－有効軒数
      ,effective_num_14                          -- １４日－有効軒数
      ,effective_num_15                          -- １５日－有効軒数
      ,effective_num_16                          -- １６日－有効軒数
      ,effective_num_17                          -- １７日－有効軒数
      ,effective_num_18                          -- １８日－有効軒数
      ,effective_num_19                          -- １９日－有効軒数
      ,effective_num_20                          -- ２０日－有効軒数
      ,effective_num_21                          -- ２１日－有効軒数
      ,effective_num_22                          -- ２２日－有効軒数
      ,effective_num_23                          -- ２３日－有効軒数
      ,effective_num_24                          -- ２４日－有効軒数
      ,effective_num_25                          -- ２５日－有効軒数
      ,effective_num_26                          -- ２６日－有効軒数
      ,effective_num_27                          -- ２７日－有効軒数
      ,effective_num_28                          -- ２８日－有効軒数
      ,effective_num_29                          -- ２９日－有効軒数
      ,effective_num_30                          -- ３０日－有効軒数
      ,effective_num_31                          -- ３１日－有効軒数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind6                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.effective_num_1                -- １日－有効軒数
           ,inn_v.effective_num_2                -- ２日－有効軒数
           ,inn_v.effective_num_3                -- ３日－有効軒数
           ,inn_v.effective_num_4                -- ４日－有効軒数
           ,inn_v.effective_num_5                -- ５日－有効軒数
           ,inn_v.effective_num_6                -- ６日－有効軒数
           ,inn_v.effective_num_7                -- ７日－有効軒数
           ,inn_v.effective_num_8                -- ８日－有効軒数
           ,inn_v.effective_num_9                -- ９日－有効軒数
           ,inn_v.effective_num_10               -- １０日－有効軒数
           ,inn_v.effective_num_11               -- １１日－有効軒数
           ,inn_v.effective_num_12               -- １２日－有効軒数
           ,inn_v.effective_num_13               -- １３日－有効軒数
           ,inn_v.effective_num_14               -- １４日－有効軒数
           ,inn_v.effective_num_15               -- １５日－有効軒数
           ,inn_v.effective_num_16               -- １６日－有効軒数
           ,inn_v.effective_num_17               -- １７日－有効軒数
           ,inn_v.effective_num_18               -- １８日－有効軒数
           ,inn_v.effective_num_19               -- １９日－有効軒数
           ,inn_v.effective_num_20               -- ２０日－有効軒数
           ,inn_v.effective_num_21               -- ２１日－有効軒数
           ,inn_v.effective_num_22               -- ２２日－有効軒数
           ,inn_v.effective_num_23               -- ２３日－有効軒数
           ,inn_v.effective_num_24               -- ２４日－有効軒数
           ,inn_v.effective_num_25               -- ２５日－有効軒数
           ,inn_v.effective_num_26               -- ２６日－有効軒数
           ,inn_v.effective_num_27               -- ２７日－有効軒数
           ,inn_v.effective_num_28               -- ２８日－有効軒数
           ,inn_v.effective_num_29               -- ２９日－有効軒数
           ,inn_v.effective_num_30               -- ３０日－有効軒数
           ,inn_v.effective_num_31               -- ３１日－有効軒数
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.group_number           group_number
                    ,xrvsp.group_name             group_name
                    ,SUM(xtrvp.rslt_vis_e_num_1)            effective_num_1
                    ,SUM(xtrvp.rslt_vis_e_num_2)            effective_num_2
                    ,SUM(xtrvp.rslt_vis_e_num_3)            effective_num_3
                    ,SUM(xtrvp.rslt_vis_e_num_4)            effective_num_4
                    ,SUM(xtrvp.rslt_vis_e_num_5)            effective_num_5
                    ,SUM(xtrvp.rslt_vis_e_num_6)            effective_num_6
                    ,SUM(xtrvp.rslt_vis_e_num_7)            effective_num_7
                    ,SUM(xtrvp.rslt_vis_e_num_8)            effective_num_8
                    ,SUM(xtrvp.rslt_vis_e_num_9)            effective_num_9
                    ,SUM(xtrvp.rslt_vis_e_num_10)           effective_num_10
                    ,SUM(xtrvp.rslt_vis_e_num_11)           effective_num_11
                    ,SUM(xtrvp.rslt_vis_e_num_12)           effective_num_12
                    ,SUM(xtrvp.rslt_vis_e_num_13)           effective_num_13
                    ,SUM(xtrvp.rslt_vis_e_num_14)           effective_num_14
                    ,SUM(xtrvp.rslt_vis_e_num_15)           effective_num_15
                    ,SUM(xtrvp.rslt_vis_e_num_16)           effective_num_16
                    ,SUM(xtrvp.rslt_vis_e_num_17)           effective_num_17
                    ,SUM(xtrvp.rslt_vis_e_num_18)           effective_num_18
                    ,SUM(xtrvp.rslt_vis_e_num_19)           effective_num_19
                    ,SUM(xtrvp.rslt_vis_e_num_20)           effective_num_20
                    ,SUM(xtrvp.rslt_vis_e_num_21)           effective_num_21
                    ,SUM(xtrvp.rslt_vis_e_num_22)           effective_num_22
                    ,SUM(xtrvp.rslt_vis_e_num_23)           effective_num_23
                    ,SUM(xtrvp.rslt_vis_e_num_24)           effective_num_24
                    ,SUM(xtrvp.rslt_vis_e_num_25)           effective_num_25
                    ,SUM(xtrvp.rslt_vis_e_num_26)           effective_num_26
                    ,SUM(xtrvp.rslt_vis_e_num_27)           effective_num_27
                    ,SUM(xtrvp.rslt_vis_e_num_28)           effective_num_28
                    ,SUM(xtrvp.rslt_vis_e_num_29)           effective_num_29
                    ,SUM(xtrvp.rslt_vis_e_num_30)           effective_num_30
                    ,SUM(xtrvp.rslt_vis_e_num_31)           effective_num_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－明細部
    -- グループ毎に訪問記号計（月別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,vis_a_num                                 -- 訪問Ａ件数
      ,vis_b_num                                 -- 訪問Ｂ件数
      ,vis_c_num                                 -- 訪問Ｃ件数
      ,vis_d_num                                 -- 訪問Ｄ件数
      ,vis_e_num                                 -- 訪問Ｅ件数
      ,vis_f_num                                 -- 訪問Ｆ件数
      ,vis_g_num                                 -- 訪問Ｇ件数
      ,vis_h_num                                 -- 訪問Ｈ件数
      ,vis_i_num                                 -- 訪問Ｉ件数
      ,vis_j_num                                 -- 訪問Ｊ件数
      ,vis_k_num                                 -- 訪問Ｋ件数
      ,vis_l_num                                 -- 訪問Ｌ件数
      ,vis_m_num                                 -- 訪問Ｍ件数
      ,vis_n_num                                 -- 訪問Ｎ件数
      ,vis_o_num                                 -- 訪問Ｏ件数
      ,vis_p_num                                 -- 訪問Ｐ件数
      ,vis_q_num                                 -- 訪問Ｑ件数
      ,vis_r_num                                 -- 訪問Ｒ件数
      ,vis_s_num                                 -- 訪問Ｓ件数
      ,vis_t_num                                 -- 訪問Ｔ件数
      ,vis_u_num                                 -- 訪問Ｕ件数
      ,vis_v_num                                 -- 訪問Ｖ件数
      ,vis_w_num                                 -- 訪問Ｗ件数
      ,vis_x_num                                 -- 訪問Ｘ件数
      ,vis_y_num                                 -- 訪問Ｙ件数
      ,vis_z_num                                 -- 訪問Ｚ件数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind7                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,inn_v.group_name                     -- 営業グループ名
           ,inn_v.vis_a_num                      -- 訪問Ａ件数
           ,inn_v.vis_b_num                      -- 訪問Ｂ件数
           ,inn_v.vis_c_num                      -- 訪問Ｃ件数
           ,inn_v.vis_d_num                      -- 訪問Ｄ件数
           ,inn_v.vis_e_num                      -- 訪問Ｅ件数
           ,inn_v.vis_f_num                      -- 訪問Ｆ件数
           ,inn_v.vis_g_num                      -- 訪問Ｇ件数
           ,inn_v.vis_h_num                      -- 訪問Ｈ件数
           ,inn_v.vis_i_num                      -- 訪問Ｉ件数
           ,inn_v.vis_j_num                      -- 訪問Ｊ件数
           ,inn_v.vis_k_num                      -- 訪問Ｋ件数
           ,inn_v.vis_l_num                      -- 訪問Ｌ件数
           ,inn_v.vis_m_num                      -- 訪問Ｍ件数
           ,inn_v.vis_n_num                      -- 訪問Ｎ件数
           ,inn_v.vis_o_num                      -- 訪問Ｏ件数
           ,inn_v.vis_p_num                      -- 訪問Ｐ件数
           ,inn_v.vis_q_num                      -- 訪問Ｑ件数
           ,inn_v.vis_r_num                      -- 訪問Ｒ件数
           ,inn_v.vis_s_num                      -- 訪問Ｓ件数
           ,inn_v.vis_t_num                      -- 訪問Ｔ件数
           ,inn_v.vis_u_num                      -- 訪問Ｕ件数
           ,inn_v.vis_v_num                      -- 訪問Ｖ件数
           ,inn_v.vis_w_num                      -- 訪問Ｗ件数
           ,inn_v.vis_x_num                      -- 訪問Ｘ件数
           ,inn_v.vis_y_num                      -- 訪問Ｙ件数
           ,inn_v.vis_z_num                      -- 訪問Ｚ件数
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,xrvsp.group_number           group_number
                    ,xrvsp.group_name             group_name
                    ,SUM(xsvsr.vis_a_num)         vis_a_num
                    ,SUM(xsvsr.vis_b_num)         vis_b_num
                    ,SUM(xsvsr.vis_c_num)         vis_c_num
                    ,SUM(xsvsr.vis_d_num)         vis_d_num
                    ,SUM(xsvsr.vis_e_num)         vis_e_num
                    ,SUM(xsvsr.vis_f_num)         vis_f_num
                    ,SUM(xsvsr.vis_g_num)         vis_g_num
                    ,SUM(xsvsr.vis_h_num)         vis_h_num
                    ,SUM(xsvsr.vis_i_num)         vis_i_num
                    ,SUM(xsvsr.vis_j_num)         vis_j_num
                    ,SUM(xsvsr.vis_k_num)         vis_k_num
                    ,SUM(xsvsr.vis_l_num)         vis_l_num
                    ,SUM(xsvsr.vis_m_num)         vis_m_num
                    ,SUM(xsvsr.vis_n_num)         vis_n_num
                    ,SUM(xsvsr.vis_o_num)         vis_o_num
                    ,SUM(xsvsr.vis_p_num)         vis_p_num
                    ,SUM(xsvsr.vis_q_num)         vis_q_num
                    ,SUM(xsvsr.vis_r_num)         vis_r_num
                    ,SUM(xsvsr.vis_s_num)         vis_s_num
                    ,SUM(xsvsr.vis_t_num)         vis_t_num
                    ,SUM(xsvsr.vis_u_num)         vis_u_num
                    ,SUM(xsvsr.vis_v_num)         vis_v_num
                    ,SUM(xsvsr.vis_w_num)         vis_w_num
                    ,SUM(xsvsr.vis_x_num)         vis_x_num
                    ,SUM(xsvsr.vis_y_num)         vis_y_num
                    ,SUM(xsvsr.vis_z_num)         vis_z_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs      xtrvr
                    ,xxcso_tmp_rep_vs_plan        xtrvp
                    ,xxcso_sum_visit_sale_rep     xsvsr
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NVL(xtrvr.group_number, ' ') = NVL(xrvsp.group_number, ' ')
               AND   xtrvp.employee_number(+)     = xtrvr.employee_number
               AND   xsvsr.sum_org_type(+)        = cv_sum_org_type1
               AND   xsvsr.sum_org_code(+)        = xtrvp.account_number
               AND   xsvsr.group_base_code(+)     = xtrvp.base_code
               AND   xsvsr.month_date_div(+)      = cv_month_date_div1
               AND   xsvsr.sales_date(+)          = gv_year_month
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.group_number
                      ,xrvsp.group_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1027 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END get_ticket2;
--
  /**********************************************************************************
   * Procedure Name   : up_plsql_tab3
   * Description      : 帳票種別3-拠点/課別-PLSQL表の更新 (A-5-3)
  ***********************************************************************************/
  PROCEDURE up_plsql_tab3(
     i_month_square_rec  IN         g_month_rtype3                     -- 1ヶ月分データ
    ,in_m_cnt            IN         NUMBER                             -- 明細部のカウンタ
    ,io_m_tab            IN OUT NOCOPY    g_get_month_square_ttype           -- 明細部配列
    ,io_hon_tab          IN OUT NOCOPY    g_get_month_square_ttype           -- 本体部配列
    ,ov_errbuf           OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'up_plsql_tab3';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
    -- ローカル変数
    lv_gvm_type           VARCHAR2(1);                                       -- 一般／自販機／ＭＣ
    ln_m_cnt              NUMBER(9);                                         -- INパラメータを格納
    BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
      ln_m_cnt                            := in_m_cnt;                       -- INパラメータを格納
      -- DEBUGメッセージ
      -- PL/SQL表の更新
      debug(
         buff   => '拠点/課別-PL/SQL表の更新処理:' || TO_CHAR(ln_m_cnt)
      );
      BEGIN
        -- 売り上げ明細部
        io_m_tab(ln_m_cnt).base_code        := i_month_square_rec.work_base_code;    -- 業務地拠点コード
        io_m_tab(ln_m_cnt).hub_name         := i_month_square_rec.base_name;         -- 業務地拠点名
        io_m_tab(in_m_cnt).group_number     := i_month_square_rec.group_number;      -- 営業グループ番号
        io_m_tab(in_m_cnt).group_name       := i_month_square_rec.group_name;        -- 営業グループ名
        io_m_tab(in_m_cnt).last_year_rslt_sales_amt := i_month_square_rec.rslt_amty; -- 前年実績
        io_m_tab(in_m_cnt).last_mon_rslt_sales_amt  := i_month_square_rec.rslt_amtm; -- 先月実績
        io_m_tab(in_m_cnt).new_customer_num := i_month_square_rec.cust_new_num;      -- 顧客件数
        io_m_tab(in_m_cnt).new_vendor_num   := i_month_square_rec.cust_vd_new_num;   -- 顧客件数（VD 新規）
        io_m_tab(in_m_cnt).plan_sales_amt   := i_month_square_rec.tgt_sales_prsn_total_amt;  -- 月別売上予算
        -- DEBUGメッセージ
        -- PL/SQL表の更新6u
        debug(
           buff   => '拠点/課別-PL/SQL表の更新処理' || '売り上げ明細部固定部完了'
        );
      EXCEPTION
        WHEN OTHERS THEN
          fnd_file.put_line(
           which  => FND_FILE.LOG,
           buff   => '拠点/課別-PL/SQL表の更新処理失敗:' || SQLERRM
         );
         RAISE global_api_others_expt;
      END;
      -- 本体部
      IF(ln_m_cnt = 1) THEN
        FOR i IN 1..cn_idx_max LOOP
          IF(i = cn_idx_sales_ippn) THEN         --売り上げ中計部(一般)
            io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
          ELSIF(i = cn_idx_sales_vd) THEN      --売り上げ中計部(自販機)
            io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
          ELSIF(i = cn_idx_sales_sum) THEN      -- 売り上げ合計部
            NULL;
          ELSIF(i=cn_idx_visit_ippn)THEN       --訪問中計部
            io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
          ELSIF(i=cn_idx_visit_vd)THEN       --訪問中計部
            io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
          ELSIF(i=cn_idx_visit_mc)THEN       --訪問中計部
            io_hon_tab(i).gvm_type                 := cv_gvm_m;                              -- MC
          END IF;
          io_hon_tab(i).base_code        := i_month_square_rec.work_base_code;  -- 業務地拠点コード
          io_hon_tab(i).hub_name         := i_month_square_rec.base_name;       -- 業務地拠点名
        END LOOP;
      END IF;
--
      -- 売上中計部(一般)
      io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amty, 0);    -- 前年実績
      io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt  :=
        io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amtm, 0);    -- 先月実績
      io_hon_tab(cn_idx_sales_ippn).new_customer_num :=
        io_hon_tab(cn_idx_sales_ippn).new_customer_num +
        NVL(i_month_square_rec.cust_other_new_num, 0); -- 顧客件数（新規）（一般）
      -- 売上中計部(自販機)
      io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amty, 0);       -- 前年実績
      io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amtm, 0);       -- 先月実績
      io_hon_tab(cn_idx_sales_vd).new_customer_num :=
        io_hon_tab(cn_idx_sales_vd).new_customer_num +
        i_month_square_rec.cust_vd_new_num;            -- 顧客件数（新規）(自販機)
--
      FOR i IN 1..31 LOOP
        BEGIN
          -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '拠点/課別-PL/SQL表の更新処理' || '1ヶ月分のデータ更新'
            );
          -- 売り上げ明細部
          io_m_tab(in_m_cnt).l_get_one_day_tab(i).plan_vs_amt
            := i_month_square_rec.l_one_day_tab(i).tgt_amt;                   -- 売り上げ計画
          io_m_tab(in_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_amt;                  -- 売り上げ実績
          io_m_tab(in_m_cnt).l_get_one_day_tab(i).rslt_other_sales_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_center_amt;           -- 内他拠点＿売上実績
          -- 売り上げ中計部(一般)
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_other_amt,0);         --売上計画,訪問計画
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_other_amt,0);        -- 売上実績,訪問実績
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_other_sales_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_other_sales_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_center_other_amt,0); -- 内他拠点＿売上実績
          -- 売り上げ中計部(自販機)
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vd_amt,0);            --売上計画,訪問計画
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_vd_amt,0);           -- 売上実績,訪問実績
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_other_sales_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_other_sales_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_center_vd_amt,0);    -- 内他拠点＿売上実績
          -- 売り上げ合計部
          -- 訪問中計部(一般)
          io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_other_num,0);     --売上計画,訪問計画
          io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_other_num,0);         -- 売上実績,訪問実績
          -- 訪問中計部(自販機)
          io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_vd_num,0);        --売上計画,訪問計画
          io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_vd_num,0);            -- 売上実績,訪問実績
          -- 訪問中計部(MC)
          io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).plan_vs_amt :=
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).plan_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).tgt_vis_mc_num,0);        --売上計画,訪問計画
          io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_mc_num,0);            -- 売上実績,訪問実績
          -- 訪問合計部
          io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num :=
            io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_sales_num,0);         -- 有効軒数
          -- 訪問内容合計部
          io_hon_tab(cn_idx_visit_dsc).vis_a_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_a_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_a_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_b_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_b_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_b_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_c_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_c_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_c_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_d_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_d_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_d_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_e_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_e_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_e_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_f_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_f_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_f_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_g_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_g_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_g_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_h_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_h_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_h_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_i_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_i_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_i_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_j_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_j_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_j_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_k_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_k_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_k_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_l_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_l_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_l_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_m_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_m_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_m_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_n_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_n_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_n_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_o_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_o_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_o_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_p_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_p_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_p_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_q_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_q_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_q_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_r_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_r_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_r_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_s_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_s_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_s_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_t_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_t_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_t_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_u_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_u_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_u_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_v_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_v_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_v_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_w_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_w_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_w_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_x_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_x_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_x_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_y_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_y_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_y_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_z_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_z_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_z_num,0);
        EXCEPTION
          WHEN OTHERS THEN
          fnd_file.put_line(
             which  => FND_FILE.LOG,
             buff   => '拠点/課別-PL/SQL表-本体部の更新処理でエラーになりました。' || SQLERRM ||
                      ''                         -- 空行の挿入
           );
        END;
      END LOOP;
    EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END up_plsql_tab3;
--
  /**********************************************************************************
   * Procedure Name   : get_ticket3
   * Description      : 帳票種別3-拠点/課別 (A-5-1,A-5-2)
  ***********************************************************************************/
  PROCEDURE get_ticket3(
     ov_errbuf         OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode        OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg         OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'get_ticket3';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ローカル定数
    -- ローカル変数
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1028 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--  lb_boolean            BOOLEAN;      -- 判断用
--  ln_m_cnt              NUMBER(9);    -- 明細部カウンター数格納
--  ln_cnt                NUMBER(9);    -- 抽出されたレコード件数
--  ln_date               NUMBER(2);    -- 日付のナンバー型
--  ln_report_output_no   NUMBER(9);    -- 帳票出力セット番号
--  lv_bf_group_number    xxcso_resource_relations_v2.group_number_new%TYPE;
--  lv_bf_work_base_code  xxcso_resource_relations_v2.work_base_code_new%TYPE;
--  -- *** ローカル・カーソル ***
--  CURSOR ticket_data_cur
--  IS
--    SELECT
--            gnv.gnv_work_base_code      work_base_code,         -- 勤務地拠点コード
--            xabv.base_name              base_name,              -- 勤務地拠点名
--            gnv.gnv_group_number        group_number,           -- 営業グループ番号
--            /* 20090427_abe_売上計画出力対応 START*/
--            --(SELECT
--            --   (last_name || 'グループ')
--            -- FROM
--            --   xxcso_resource_relations_v2
--            -- WHERE
--            --      (CASE
--            --         WHEN TO_DATE(issue_date,'YYYYMMDD') <= gd_online_sysdate
--            --           THEN work_base_code_new
--            --         ELSE work_base_code_old
--            --      END
--            --      ) = gnv.gnv_work_base_code
--            -- AND  (CASE
--            --         WHEN TO_DATE(issue_date,'YYYYMMDD') <= gd_online_sysdate
--            --           THEN group_number_new
--            --         ELSE group_number_old
--            --      END
--            --      ) = gnv.gnv_group_number
--            -- AND  (CASE
--            --         WHEN TO_DATE(issue_date,'YYYYMMDD') <= gd_online_sysdate
--            --           THEN group_leader_flag_new
--            --         ELSE group_leader_flag_old
--            --      END
--            --     ) = cv_flg_y
--            -- AND  ROWNUM = 1
--            --)     group_name,                                   -- グループ名
--            (SELECT  (xev.last_name  || 'グループ')
--             FROM    xxcso_employees_v           xev                     -- 従業員マスタ（最新）ビュー
--             WHERE   xev.employee_number =   (SELECT MIN(xrrv2.employee_number)
--                                              FROM   xxcso_resource_relations_v2 xrrv2 -- リソース関連マスタ(最新)VIEW
--                                              WHERE  (CASE
--                                                        WHEN TO_DATE(xrrv2.issue_date,'YYYYMMDD') <= gd_online_sysdate
--                                                          THEN xrrv2.work_base_code_new
--                                                        ELSE xrrv2.work_base_code_old
--                                                      END
--                                                     )  = gnv.gnv_work_base_code
--                                              AND    (CASE
--                                                         WHEN xrrv2.issue_date <= gv_online_sysdate
--                                                           THEN xrrv2.group_number_new
--                                                         ELSE xrrv2.group_number_old
--                                                       END
--                                                     ) = gnv.gnv_group_number
--                                              AND    (CASE
--                                                        WHEN xrrv2.issue_date <= gv_online_sysdate
--                                                          THEN xrrv2.group_leader_flag_new
--                                                        ELSE xrrv2.group_leader_flag_old
--                                                      END
--                                                     ) = cv_flg_y
--                                             )
--            )      group_name,    -- グループ名
--            /* 20090427_abe_売上計画出力対応 END*/
--            xsvsr.sales_date            sales_date,             -- 販売年月日
--            xsvsr.tgt_amt               tgt_amt,                -- 売上計画
--            xsvsr.tgt_new_amt           tgt_new_amt,            -- 売上計画（新規）
--            xsvsr.tgt_vd_new_amt        tgt_vd_new_amt,         -- 売上計画（VD：新規）
--            xsvsr.tgt_vd_amt            tgt_vd_amt,             -- 売上計画（VD）
--            xsvsr.tgt_other_new_amt     tgt_other_new_amt,      -- 売上計画（VD以外：新規）
--            xsvsr.tgt_other_amt         tgt_other_amt,          -- 売上計画（VD以外）
--            xsvsr.rslt_amt              rslt_amt,               -- 売上実績
--            xsvsr.rslt_new_amt          rslt_new_amt,           -- 売上実績（新規）
--            xsvsr.rslt_vd_new_amt       rslt_vd_new_amt,        -- 売上実績（VD：新規）
--            xsvsr.rslt_vd_amt           rslt_vd_amt,            -- 売上実績（VD）
--            xsvsr.rslt_other_new_amt    rslt_other_new_amt,     -- 売上実績（VD以外：新規）
--            xsvsr.rslt_other_amt        rslt_other_amt,         -- 売上実績（VD以外）
--            xsvsr.rslt_center_amt       rslt_center_amt,        -- 内他拠点＿売上実績
--            xsvsr.rslt_center_vd_amt    rslt_center_vd_amt,     -- 内他拠点＿売上実績（VD）
--            xsvsr.rslt_center_other_amt rslt_center_other_amt,  -- 内他拠点＿売上実績（VD以外）
--            xsvsr.tgt_vis_num           tgt_vis_num,            -- 訪問計画
--            xsvsr.tgt_vis_new_num       tgt_vis_new_num,        -- 訪問計画（新規）
--            xsvsr.tgt_vis_vd_new_num    tgt_vis_vd_new_num,     -- 訪問計画（VD：新規）
--            xsvsr.tgt_vis_vd_num        tgt_vis_vd_num,         -- 訪問計画（VD）
--            xsvsr.tgt_vis_other_new_num tgt_vis_other_new_num,  -- 訪問計画（VD以外：新規）
--            xsvsr.tgt_vis_other_num     tgt_vis_other_num,      -- 訪問計画（VD以外）
--            xsvsr.tgt_vis_mc_num        tgt_vis_mc_num,         -- 訪問計画（MC）
--            xsvsr.vis_num               vis_num,                -- 訪問実績
--            xsvsr.vis_new_num           vis_new_num,            -- 訪問実績（新規）
--            xsvsr.vis_vd_new_num        vis_vd_new_num,         -- 訪問実績（VD：新規）
--            xsvsr.vis_vd_num            vis_vd_num,             -- 訪問実績（VD）
--            xsvsr.vis_other_new_num     vis_other_new_num,      -- 訪問実績（VD以外：新規）
--            xsvsr.vis_other_num         vis_other_num,          -- 訪問実績（VD以外）
--            xsvsr.vis_mc_num            vis_mc_num,             -- 訪問実績（MC）
--            xsvsr.vis_sales_num         vis_sales_num,          -- 有効軒数
--            xsvsr.vis_a_num             vis_a_num,              -- 訪問Ａ件数
--            xsvsr.vis_b_num             vis_b_num,              -- 訪問Ｂ件数
--            xsvsr.vis_c_num             vis_c_num,              -- 訪問Ｃ件数
--            xsvsr.vis_d_num             vis_d_num,              -- 訪問Ｄ件数
--            xsvsr.vis_e_num             vis_e_num,              -- 訪問Ｅ件数
--            xsvsr.vis_f_num             vis_f_num,              -- 訪問Ｆ件数
--            xsvsr.vis_g_num             vis_g_num,              -- 訪問Ｇ件数
--            xsvsr.vis_h_num             vis_h_num,              -- 訪問Ｈ件数
--            xsvsr.vis_i_num             vis_i_num,              -- 訪問ⅰ件数
--            xsvsr.vis_j_num             vis_j_num,              -- 訪問Ｊ件数
--            xsvsr.vis_k_num             vis_k_num,              -- 訪問Ｋ件数
--            xsvsr.vis_l_num             vis_l_num,              -- 訪問Ｌ件数
--            xsvsr.vis_m_num             vis_m_num,              -- 訪問Ｍ件数
--            xsvsr.vis_n_num             vis_n_num,              -- 訪問Ｎ件数
--            xsvsr.vis_o_num             vis_o_num,              -- 訪問Ｏ件数
--            xsvsr.vis_p_num             vis_p_num,              -- 訪問Ｐ件数
--            xsvsr.vis_q_num             vis_q_num,              -- 訪問Ｑ件数
--            xsvsr.vis_r_num             vis_r_num,              -- 訪問Ｒ件数
--            xsvsr.vis_s_num             vis_s_num,              -- 訪問Ｓ件数
--            xsvsr.vis_t_num             vis_t_num,              -- 訪問Ｔ件数
--            xsvsr.vis_u_num             vis_u_num,              -- 訪問Ｕ件数
--            xsvsr.vis_v_num             vis_v_num,              -- 訪問Ｖ件数
--            xsvsr.vis_w_num             vis_w_num,              -- 訪問Ｗ件数
--            xsvsr.vis_x_num             vis_x_num,              -- 訪問Ｘ件数
--            xsvsr.vis_y_num             vis_y_num,              -- 訪問Ｙ件数
--            xsvsr.vis_z_num             vis_z_num,              -- 訪問Ｚ件数
--            xsvsry.rslt_amt             rslt_amty,              -- 前年実績
--            xsvsry.rslt_vd_amt          rslt_vd_amty,           -- 前年実績（VD）
--            xsvsry.rslt_other_amt       rslt_other_amty,        -- 前年実績（VD以外）
--            xsvsrm.rslt_amt             rslt_amtm,              -- 先月実績
--            xsvsrm.rslt_vd_amt          rslt_vd_amtm,           -- 先月実績（VD）
--            xsvsrm.rslt_other_amt       rslt_other_amtm,        -- 先月実績（VD以外）
--            xsvsrn.cust_new_num         cust_new_num,           -- 顧客件数（新規）
--            xsvsrn.cust_vd_new_num      cust_vd_new_num,        -- 顧客件数（VD：新規）
--            xsvsrn.cust_other_new_num   cust_other_new_num,     -- 顧客件数（VD以外：新規）
--            xsvsrn.tgt_sales_prsn_total_amt  tgt_sales_prsn_total_amt  -- 月別売上予算
--    FROM    xxcso_sum_visit_sale_rep    xsvsr                   -- 訪問売上計画管理表サマリテーブル
--           ,xxcso_sum_visit_sale_rep    xsvsry                  -- 訪問売上計画管理表サマリ前年
--           ,xxcso_sum_visit_sale_rep    xsvsrm                  -- 訪問売上計画管理表サマリ先月
--           ,xxcso_sum_visit_sale_rep    xsvsrn                  -- 訪問売上計画管理表サマリ当月
--           ,(SELECT  distinct
--                     (CASE
--                        WHEN TO_DATE(issue_date,'YYYYMMDD') <= gd_online_sysdate
--                          THEN work_base_code_new
--                        ELSE work_base_code_old
--                      END
--       	               )  gnv_work_base_code
--                    ,(CASE
--                        WHEN TO_DATE(issue_date,'YYYYMMDD') <= gd_online_sysdate
--                          THEN group_number_new
--                        ELSE group_number_old
--                      END
--                      )  gnv_group_number
--             FROM    xxcso_resource_relations_v2
--             WHERE   (CASE
--                        WHEN TO_DATE(issue_date,'YYYYMMDD') <= gd_online_sysdate
--                          THEN work_base_code_new
--                        ELSE work_base_code_old
--                      END
--                      )  = gv_base_code)       gnv               -- グループ番号ビュー
--           ,xxcso_aff_base_v2                  xabv              -- AFF部門マスタ（最新）ビュー
--    /* 20090427_abe_売上計画出力対応 START*/
--    WHERE   xsvsr.group_base_code(+) = gv_base_code
--      AND   xsvsr.sum_org_code(+)    = gnv.gnv_group_number
--      AND   xabv.base_code(+)        = gnv.gnv_work_base_code
--      AND   xsvsr.sum_org_type(+) =cv_sum_org_type3
--      AND   xsvsr.month_date_div(+) = cv_month_date_div2
--      AND   xsvsr.sales_date(+)
--              BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--    --WHERE   xsvsr.group_base_code = gv_base_code
--      --AND   xsvsr.sum_org_code    = gnv.gnv_group_number
--      --AND   xabv.base_code        = gnv.gnv_work_base_code
--      --AND   xsvsr.sum_org_type =cv_sum_org_type3
--      --AND   xsvsr.month_date_div = cv_month_date_div2
--      --AND   xsvsr.sales_date
--      --        BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--    /* 20090427_abe_売上計画出力対応 END*/
--      AND   xsvsr.sum_org_type   = xsvsry.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsry.sum_org_code(+)
--      AND   xsvsry.month_date_div(+)= cv_month_date_div1
--      AND   xsvsry.sales_date(+) = gv_year_prev
--      AND   xsvsr.sum_org_type   = xsvsrm.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrm.sum_org_code(+)
--      AND   xsvsrm.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrm.sales_date(+) = gv_year_month_prev
--      AND   xsvsr.sum_org_type   = xsvsrn.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrn.sum_org_code(+)
--      AND   xsvsrn.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrn.sales_date(+) = gv_year_month
--    ORDER BY  work_base_code     ASC,
--              group_number       ASC;
--  -- ローカルレコード
--  -- 帳票変数格納用
--  l_cur_rec                  ticket_data_cur%ROWTYPE;
--  l_month_square_rec         g_month_rtype3;
--  l_get_month_square_tab     g_get_month_square_ttype;
--  l_get_month_square_hon_tab g_get_month_square_ttype;
--
    lv_report_name             xxcso_rep_visit_sale_plan.report_name%TYPE;   -- 帳票タイトル
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1028 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1028 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--    -- ローカル変数初期化
--    lb_boolean                := TRUE;        -- 初期処理判断
--    ln_m_cnt                  := 1;           -- 明細部の行数
--    ln_report_output_no       := 1;           -- 配列行数
--    ln_cnt                    := 0;           -- LOOP件数
--    -- PL/SQL表（本体部）の初期化
--    init_month_square_hon_tab(l_get_month_square_hon_tab);
--    -- ローカルレコードの初期化
--    init_month_square_rec3(l_month_square_rec);
--    BEGIN
--      --カーソルオープン
--      OPEN ticket_data_cur;
--
--DO_ERROR('A-5-2-1');
--
--      <<get_data_loop>>
--      LOOP
--        l_cur_rec                           := NULL;          -- カーソルレコードの初期化
--
--        FETCH ticket_data_cur INTO l_cur_rec;                 -- カーソルのデータをレコードに格納
--
--        -- 対象件数がO件の場合
--        EXIT WHEN ticket_data_cur%NOTFOUND
--          OR  ticket_data_cur%ROWCOUNT = 0;
--
--DO_ERROR('A-5-2-2');
--
--        debug(
--          buff   => l_cur_rec.work_base_code                    ||','||
--                    l_cur_rec.base_name                         ||','||
--                    l_cur_rec.group_number                      ||','||
--                    l_cur_rec.group_name                        ||','||
--                    l_cur_rec.sales_date                        ||','||
--                    TO_CHAR(l_cur_rec.tgt_amt)                  ||','||
--                    TO_CHAR(l_cur_rec.tgt_new_amt)              ||','||
--                    TO_CHAR(l_cur_rec.tgt_vd_new_amt)           ||','||
--                    TO_CHAR(l_cur_rec.tgt_vd_amt)               ||','||
--                    TO_CHAR(l_cur_rec.tgt_other_new_amt)        ||','||
--                    TO_CHAR(l_cur_rec.tgt_other_amt)            ||','||
--                    TO_CHAR(l_cur_rec.rslt_amt)                 ||','||
--                    TO_CHAR(l_cur_rec.rslt_new_amt)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_new_amt)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amt)              ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_new_amt)       ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amt)           ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_amt)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_vd_amt)       ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_other_amt)    ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_num)              ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_new_num)          ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_vd_new_num)       ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_vd_num)           ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_other_new_num)    ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_other_num)        ||','||
--                    TO_CHAR(l_cur_rec.tgt_vis_mc_num)           ||','||
--                    TO_CHAR(l_cur_rec.vis_num)                  ||','||
--                    TO_CHAR(l_cur_rec.vis_new_num)              ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_new_num)           ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_other_new_num)        ||','||
--                    TO_CHAR(l_cur_rec.vis_other_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_mc_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_sales_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_a_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_b_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_c_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_d_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_e_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_f_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_g_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_h_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_i_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_j_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_k_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_l_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_m_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_n_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_o_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_p_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_q_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_r_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_s_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_t_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_u_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_v_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_w_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_x_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_y_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_z_num)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_amty)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amty)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amty)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_amtm)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amtm)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amtm)          ||','||
--                    TO_CHAR(l_cur_rec.cust_new_num)             ||','||
--                    TO_CHAR(l_cur_rec.cust_vd_new_num)          ||','||
--                    TO_CHAR(l_cur_rec.cust_other_new_num)       ||','||
--                    TO_CHAR(l_cur_rec.tgt_sales_prsn_total_amt) ||','||
--                   cv_lf
--        );
--
--        -- 前回レコードと拠点コードが同じでグループ番号が違う場合、明細部配列と本体部配列を更新。
--        IF(lb_boolean=FALSE) THEN
--          /* 20090427_abe_売上計画出力対応 START*/
--          --IF((lv_bf_work_base_code = l_cur_rec.work_base_code)AND(lv_bf_group_number <> l_cur_rec.group_number))
--          IF((lv_bf_work_base_code = l_cur_rec.work_base_code)AND((lv_bf_group_number <> l_cur_rec.group_number) OR l_cur_rec.group_number IS NULL))
--          /* 20090427_abe_売上計画出力対応 END*/
--            THEN
--            -- DEBUGメッセージ
--            debug(
--               buff   => '営業グループ番号が違います。 :' ||'前回： '|| lv_bf_group_number ||
--                          '今回：' || l_cur_rec.group_number ||
--                          '明細部配列' || TO_CHAR(ln_m_cnt)
--            );
--            -- =================================================
--            -- A-5-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab3(
--               i_month_square_rec   => l_month_square_rec          -- 1ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;
--            l_month_square_rec      := NULL;
--            init_month_square_rec3(l_month_square_rec);
--            ln_m_cnt          := ln_m_cnt + 1;       -- 明細部配列を＋１する。
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          ELSIF(lv_bf_work_base_code <> l_cur_rec.work_base_code)THEN
--            -- =================================================
--            -- A-5-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab3(
--               i_month_square_rec   => l_month_square_rec          -- 1ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--            l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--            init_month_square_rec3(l_month_square_rec);
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          END IF;
--        END IF;
--        -- 出力フラグがオンの状態で拠点コードが前回取得した営業員番号と違う場合ワークテーブルに出力します。
--        IF ((ln_cnt > 0) AND
--            (lv_bf_work_base_code <> l_cur_rec.work_base_code)) THEN
--          debug(
--             buff   => '拠点コードが違います。 :' ||'前回： '|| lv_bf_work_base_code || ''||
--                        '今回：' || l_cur_rec.work_base_code
--          );
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--         );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- レコードの初期化
--        l_get_month_square_tab.DELETE;
--        l_get_month_square_hon_tab.DELETE;
--        init_month_square_hon_tab(l_get_month_square_hon_tab);
--        ln_report_output_no := ln_report_output_no + 1; -- 出力された帳票個数に＋１する
--        lb_boolean          := TRUE;                    -- 初期処理の状態に戻す
--        ln_m_cnt            := 1;                       -- 明細部配列の行数の初期化
--        END IF;
--        -- 初期処理の場合
--        IF(lb_boolean) THEN
--          -- 営業グループ番号と従業員番号をローカル変数に格納
--          lv_bf_group_number         := l_cur_rec.group_number;          -- 営業グループ番号
--          lv_bf_work_base_code       := l_cur_rec.work_base_code;        -- 拠点コード
--          -- ローカルレコードに格納
--          -- 勤務地拠点コード
--          l_month_square_rec.work_base_code     := l_cur_rec.work_base_code;
--          -- 勤務地拠点名
--          l_month_square_rec.base_name          := l_cur_rec.base_name;
--          -- 営業グループ番号
--          l_month_square_rec.group_number       := l_cur_rec.group_number;
--          -- 営業グループ名
--          l_month_square_rec.group_name         := l_cur_rec.group_name;
--          -- 新規顧客件数
--          l_month_square_rec.cust_new_num       := l_cur_rec.cust_new_num;
--          -- 新規VD件数
--          l_month_square_rec.cust_vd_new_num    := l_cur_rec.cust_vd_new_num;
--          -- 新規VD以外件数
--          l_month_square_rec.cust_other_new_num := l_cur_rec.cust_other_new_num;
--          -- 前年実績
--          l_month_square_rec.rslt_amty          := l_cur_rec.rslt_amty;
--          -- 前年実績（VD）
--          l_month_square_rec.rslt_vd_amty       := l_cur_rec.rslt_vd_amty;
--          -- 前年実績（VD以外）
--          l_month_square_rec.rslt_other_amty    := l_cur_rec.rslt_other_amty;
--          -- 先月実績
--          l_month_square_rec.rslt_amtm          := l_cur_rec.rslt_amtm;
--          -- 先月実績（VD）
--          l_month_square_rec.rslt_vd_amtm       := l_cur_rec.rslt_vd_amtm;
--          -- 先月実績（VD以外）
--          l_month_square_rec.rslt_other_amtm    := l_cur_rec.rslt_other_amtm;
--          -- 月別売上予算
--          l_month_square_rec.tgt_sales_prsn_total_amt := l_cur_rec.tgt_sales_prsn_total_amt;
--          lb_boolean := FALSE;
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '初期処理フラグ:' || 'FALSE'
--          );
--        END IF;
--        /* 20090427_abe_売上計画出力対応 START*/
--        IF (l_cur_rec.sales_date IS NOT NULL) THEN
--          -- 日付を取得
--          ln_date := TO_NUMBER(SUBSTR(l_cur_rec.sales_date,7,2));
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '日付:' || l_cur_rec.sales_date || cv_lf ||
--                       '日付けのナンバー型:'     || TO_CHAR(ln_date)
--          );
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_amt
--            := l_cur_rec.tgt_amt;               -- 売上計画
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_new_amt
--            := l_cur_rec.tgt_new_amt;           -- 売上計画（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vd_new_amt
--            := l_cur_rec.tgt_vd_new_amt;        -- 売上計画（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vd_amt
--            := l_cur_rec.tgt_vd_amt;            -- 売上計画（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_other_new_amt
--            := l_cur_rec.tgt_other_new_amt;     -- 売上計画（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_other_amt
--            := l_cur_rec.tgt_other_amt;         -- 売上計画（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_amt
--            := l_cur_rec.rslt_amt;               -- 売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_new_amt
--            := l_cur_rec.rslt_new_amt;          -- 売上実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_new_amt
--            := l_cur_rec.rslt_vd_new_amt;       -- 売上実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_amt
--            := l_cur_rec.rslt_vd_amt;           -- 売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_new_amt
--            := l_cur_rec.rslt_other_new_amt;    -- 売上実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_amt
--            := l_cur_rec.rslt_other_amt;        -- 売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_amt
--            := l_cur_rec.rslt_center_amt;       -- 内他拠点＿売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_vd_amt
--            := l_cur_rec.rslt_center_vd_amt;    -- 内他拠点＿売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_other_amt
--            := l_cur_rec.rslt_center_other_amt; -- 内他拠点＿売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_num
--            := l_cur_rec.tgt_vis_num;           -- 訪問計画
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_new_num
--            := l_cur_rec.tgt_vis_new_num;       -- 訪問計画（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_vd_new_num
--            := l_cur_rec.tgt_vis_vd_new_num;    -- 訪問計画（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_vd_num
--            := l_cur_rec.tgt_vis_vd_num;        -- 訪問計画（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_other_new_num
--            := l_cur_rec.tgt_vis_other_new_num;-- 訪問計画（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_other_num
--            := l_cur_rec.tgt_vis_other_num;     -- 訪問計画（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).tgt_vis_mc_num
--            := l_cur_rec.tgt_vis_mc_num;        -- 訪問計画（MC）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_num
--            := l_cur_rec.vis_num;               -- 訪問実績
--          l_month_square_rec.l_one_day_tab(ln_date).vis_new_num
--            := l_cur_rec.vis_new_num;           -- 訪問実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_new_num
--            := l_cur_rec.vis_vd_new_num;        -- 訪問実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_num
--            := l_cur_rec.vis_vd_num;            -- 訪問実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_new_num
--            := l_cur_rec.vis_other_new_num;     -- 訪問実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_num
--            := l_cur_rec.vis_other_num;         -- 訪問実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_mc_num
--            := l_cur_rec.vis_mc_num;            -- 訪問実績（MC）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_sales_num
--            := l_cur_rec.vis_sales_num;         -- 有効軒数
--          -- A0Z訪問件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_a_num := nvl(l_cur_rec.vis_a_num,0);  -- 訪問A件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_b_num := nvl(l_cur_rec.vis_b_num,0);  -- 訪問B件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_c_num := nvl(l_cur_rec.vis_c_num,0);  -- 訪問C件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_d_num := nvl(l_cur_rec.vis_d_num,0);  -- 訪問D件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_e_num := nvl(l_cur_rec.vis_e_num,0);  -- 訪問E件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_f_num := nvl(l_cur_rec.vis_f_num,0);  -- 訪問F件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_g_num := nvl(l_cur_rec.vis_g_num,0);  -- 訪問G件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_h_num := nvl(l_cur_rec.vis_h_num,0);  -- 訪問H件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_i_num := nvl(l_cur_rec.vis_i_num,0);  -- 訪問I件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_j_num := nvl(l_cur_rec.vis_j_num,0);  -- 訪問J件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_k_num := nvl(l_cur_rec.vis_k_num,0);  -- 訪問K件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_l_num := nvl(l_cur_rec.vis_l_num,0);  -- 訪問L件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_m_num := nvl(l_cur_rec.vis_m_num,0);  -- 訪問M件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_n_num := nvl(l_cur_rec.vis_n_num,0);  -- 訪問N件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_o_num := nvl(l_cur_rec.vis_o_num,0);  -- 訪問O件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_p_num := nvl(l_cur_rec.vis_p_num,0);  -- 訪問P件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_q_num := nvl(l_cur_rec.vis_q_num,0);  -- 訪問Q件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_r_num := nvl(l_cur_rec.vis_r_num,0);  -- 訪問R件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_s_num := nvl(l_cur_rec.vis_s_num,0);  -- 訪問S件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_t_num := nvl(l_cur_rec.vis_t_num,0);  -- 訪問T件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_u_num := nvl(l_cur_rec.vis_u_num,0);  -- 訪問U件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_v_num := nvl(l_cur_rec.vis_v_num,0);  -- 訪問V件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_w_num := nvl(l_cur_rec.vis_w_num,0);  -- 訪問W件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_x_num := nvl(l_cur_rec.vis_x_num,0);  -- 訪問X件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_y_num := nvl(l_cur_rec.vis_y_num,0);  -- 訪問Y件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_z_num := nvl(l_cur_rec.vis_z_num,0);  -- 訪問Z件数
--        END IF;
--        /* 20090427_abe_売上計画出力対応 END*/
--        -- 最初のレコードの場合
--        IF(lb_boolean) THEN
--          lb_boolean              := FALSE;                  -- 初期処理のフラグをオフする。
--        END IF;
--        -- 抽出件数カウンタに１を足す。
--        ln_cnt         := ln_cnt + 1;
--        gn_target_cnt  := ln_cnt;
--        -- loop件数
--        debug(
--              buff   => 'loop件数' || TO_CHAR(ln_cnt)
--        );
--      END LOOP;
--      -- 最後のデータ登録
--      IF (ln_cnt > 0) THEN
--        debug(
--                buff   => '最後のデータの登録'
--        );
--        -- =================================================
--        -- A-5-3.PLSQL表の更新
--        -- =================================================
--        up_plsql_tab3(
--           i_month_square_rec   => l_month_square_rec          -- 1ヶ月分データ
--          ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--          ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--          ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--          ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--          ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--         );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--      END IF;
--    EXCEPTION
--      WHEN OTHERS THEN
--        -- メッセージ出力
--        lv_errmsg := xxccp_common_pkg.get_msg(
--                         iv_application  => cv_app_name              --アプリケーション短縮名
--                        ,iv_name         => cv_tkn_number_08         --メッセージコード
--                        ,iv_token_name1  => cv_tkn_table             --トークンコード1
--                        ,iv_token_value1 => cv_tab_samari            --トークン値1
--                        ,iv_token_name2  => cv_tkn_errmsg            --トークンコード２
--                        ,iv_token_value2 => SQLERRM                  --トークン値２
--        );
--        fnd_file.put_line(
--              which  => FND_FILE.LOG,
--              buff   => ''      || cv_lf ||     -- 空行の挿入
--                      lv_errmsg || cv_lf ||
--                       ''                         -- 空行の挿入
--        );
--      RAISE global_api_expt;
--    END;
--  -- カーソルクローズ
--  CLOSE ticket_data_cur;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 開始');
--
    sum_resources(
      iv_base_code => gv_base_code
    );
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 開始');
--
    sum_visit_sales;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
    SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（拠点/課別）' || '≫';
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■ヘッダ部
    -- 対象拠点内を拠点を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,report_id                                 -- 帳票ＩＤ
      ,report_name                               -- 帳票タイトル
      ,output_date                               -- 出力日時
      ,year_month                                -- 基準年月
      ,operation_days                            -- 稼動日数
      ,operation_all_days                        -- 稼動可能日数
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,ROWNUM                               -- 帳票出力セット番号
           ,cn_line_kind1                        -- 帳票出力位置
           ,1                                    -- 行番
           ,cv_pkg_name                          -- 帳票ＩＤ
           ,lv_report_name                       -- 帳票タイトル
           ,SYSDATE                              -- 出力日時
           ,gd_year_month                        -- 基準年月
           ,gn_operation_days                    -- 稼動日数
           ,gn_operation_all_days                -- 稼動可能日数
           ,xabv.base_code                       -- 拠点コード
           ,xabv.base_name                       -- 拠点名
    FROM    xxcso_aff_base_v2   xabv
    WHERE   xabv.base_code = gv_base_code
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■明細部
    -- 対象拠点内の営業グループをすべて抽出し、グループ内の営業員が
    -- 担当する顧客の売上／訪問計画（日別）、売上／訪問実績（日別）、
    -- 売上実績（他拠点納品分）（日別）、新規顧客軒数、
    -- 新規ＶＤ軒数、売上予算の合計を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,group_number                              -- 営業グループ番号
      ,group_name                                -- 営業グループ名
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind2                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.group_number                   -- 営業グループ番号
           ,XXCSO019A05C.get_group_name(
              inn_v.base_code
             ,inn_v.group_number
             ,gd_online_sysdate
            )                                    -- 営業グループ名
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.plan_sales_amt                 -- 売上予算
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.base_code                         base_code
                    ,xrvsp.hub_name                          hub_name
                    ,xtrvr.group_number                      group_number
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(
                       (CASE
                          WHEN (xdmp.sales_plan_rel_div = '1') THEN
                            xspmp.tgt_sales_prsn_total_amt
                          ELSE
                            xspmp.bsc_sls_prsn_total_amt
                        END
                       )
                     )                                       plan_sales_amt
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan               xrvsp
                    ,xxcso_tmp_rep_vsp_rsrcs                 xtrvr
                    ,xxcso_dept_monthly_plans                xdmp
                    ,xxcso_sls_prsn_mnthly_plns              xspmp
                    ,(SELECT  xtrvp1.employee_number                   employee_number
                             ,SUM(xtrvp1.new_customer_num)             new_customer_num
                             ,SUM(xtrvp1.new_vendor_num)               new_vendor_num
                             ,SUM(xtrvp1.plan_sales_amt)               plan_sales_amt
                             ,SUM(xtrvp1.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                             ,SUM(xtrvp1.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                             ,SUM(xtrvp1.plan_vs_amt_1)                plan_vs_amt_1
                             ,SUM(xtrvp1.plan_vs_amt_2)                plan_vs_amt_2
                             ,SUM(xtrvp1.plan_vs_amt_3)                plan_vs_amt_3
                             ,SUM(xtrvp1.plan_vs_amt_4)                plan_vs_amt_4
                             ,SUM(xtrvp1.plan_vs_amt_5)                plan_vs_amt_5
                             ,SUM(xtrvp1.plan_vs_amt_6)                plan_vs_amt_6
                             ,SUM(xtrvp1.plan_vs_amt_7)                plan_vs_amt_7
                             ,SUM(xtrvp1.plan_vs_amt_8)                plan_vs_amt_8
                             ,SUM(xtrvp1.plan_vs_amt_9)                plan_vs_amt_9
                             ,SUM(xtrvp1.plan_vs_amt_10)               plan_vs_amt_10
                             ,SUM(xtrvp1.plan_vs_amt_11)               plan_vs_amt_11
                             ,SUM(xtrvp1.plan_vs_amt_12)               plan_vs_amt_12
                             ,SUM(xtrvp1.plan_vs_amt_13)               plan_vs_amt_13
                             ,SUM(xtrvp1.plan_vs_amt_14)               plan_vs_amt_14
                             ,SUM(xtrvp1.plan_vs_amt_15)               plan_vs_amt_15
                             ,SUM(xtrvp1.plan_vs_amt_16)               plan_vs_amt_16
                             ,SUM(xtrvp1.plan_vs_amt_17)               plan_vs_amt_17
                             ,SUM(xtrvp1.plan_vs_amt_18)               plan_vs_amt_18
                             ,SUM(xtrvp1.plan_vs_amt_19)               plan_vs_amt_19
                             ,SUM(xtrvp1.plan_vs_amt_20)               plan_vs_amt_20
                             ,SUM(xtrvp1.plan_vs_amt_21)               plan_vs_amt_21
                             ,SUM(xtrvp1.plan_vs_amt_22)               plan_vs_amt_22
                             ,SUM(xtrvp1.plan_vs_amt_23)               plan_vs_amt_23
                             ,SUM(xtrvp1.plan_vs_amt_24)               plan_vs_amt_24
                             ,SUM(xtrvp1.plan_vs_amt_25)               plan_vs_amt_25
                             ,SUM(xtrvp1.plan_vs_amt_26)               plan_vs_amt_26
                             ,SUM(xtrvp1.plan_vs_amt_27)               plan_vs_amt_27
                             ,SUM(xtrvp1.plan_vs_amt_28)               plan_vs_amt_28
                             ,SUM(xtrvp1.plan_vs_amt_29)               plan_vs_amt_29
                             ,SUM(xtrvp1.plan_vs_amt_30)               plan_vs_amt_30
                             ,SUM(xtrvp1.plan_vs_amt_31)               plan_vs_amt_31
                             ,SUM(xtrvp1.rslt_vs_amt_1)                rslt_vs_amt_1
                             ,SUM(xtrvp1.rslt_vs_amt_2)                rslt_vs_amt_2
                             ,SUM(xtrvp1.rslt_vs_amt_3)                rslt_vs_amt_3
                             ,SUM(xtrvp1.rslt_vs_amt_4)                rslt_vs_amt_4
                             ,SUM(xtrvp1.rslt_vs_amt_5)                rslt_vs_amt_5
                             ,SUM(xtrvp1.rslt_vs_amt_6)                rslt_vs_amt_6
                             ,SUM(xtrvp1.rslt_vs_amt_7)                rslt_vs_amt_7
                             ,SUM(xtrvp1.rslt_vs_amt_8)                rslt_vs_amt_8
                             ,SUM(xtrvp1.rslt_vs_amt_9)                rslt_vs_amt_9
                             ,SUM(xtrvp1.rslt_vs_amt_10)               rslt_vs_amt_10
                             ,SUM(xtrvp1.rslt_vs_amt_11)               rslt_vs_amt_11
                             ,SUM(xtrvp1.rslt_vs_amt_12)               rslt_vs_amt_12
                             ,SUM(xtrvp1.rslt_vs_amt_13)               rslt_vs_amt_13
                             ,SUM(xtrvp1.rslt_vs_amt_14)               rslt_vs_amt_14
                             ,SUM(xtrvp1.rslt_vs_amt_15)               rslt_vs_amt_15
                             ,SUM(xtrvp1.rslt_vs_amt_16)               rslt_vs_amt_16
                             ,SUM(xtrvp1.rslt_vs_amt_17)               rslt_vs_amt_17
                             ,SUM(xtrvp1.rslt_vs_amt_18)               rslt_vs_amt_18
                             ,SUM(xtrvp1.rslt_vs_amt_19)               rslt_vs_amt_19
                             ,SUM(xtrvp1.rslt_vs_amt_20)               rslt_vs_amt_20
                             ,SUM(xtrvp1.rslt_vs_amt_21)               rslt_vs_amt_21
                             ,SUM(xtrvp1.rslt_vs_amt_22)               rslt_vs_amt_22
                             ,SUM(xtrvp1.rslt_vs_amt_23)               rslt_vs_amt_23
                             ,SUM(xtrvp1.rslt_vs_amt_24)               rslt_vs_amt_24
                             ,SUM(xtrvp1.rslt_vs_amt_25)               rslt_vs_amt_25
                             ,SUM(xtrvp1.rslt_vs_amt_26)               rslt_vs_amt_26
                             ,SUM(xtrvp1.rslt_vs_amt_27)               rslt_vs_amt_27
                             ,SUM(xtrvp1.rslt_vs_amt_28)               rslt_vs_amt_28
                             ,SUM(xtrvp1.rslt_vs_amt_29)               rslt_vs_amt_29
                             ,SUM(xtrvp1.rslt_vs_amt_30)               rslt_vs_amt_30
                             ,SUM(xtrvp1.rslt_vs_amt_31)               rslt_vs_amt_31
                             ,SUM(xtrvp1.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                             ,SUM(xtrvp1.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                             ,SUM(xtrvp1.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                             ,SUM(xtrvp1.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                             ,SUM(xtrvp1.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                             ,SUM(xtrvp1.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                             ,SUM(xtrvp1.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                             ,SUM(xtrvp1.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                             ,SUM(xtrvp1.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                             ,SUM(xtrvp1.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                             ,SUM(xtrvp1.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                             ,SUM(xtrvp1.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                             ,SUM(xtrvp1.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                             ,SUM(xtrvp1.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                             ,SUM(xtrvp1.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                             ,SUM(xtrvp1.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                             ,SUM(xtrvp1.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                             ,SUM(xtrvp1.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                             ,SUM(xtrvp1.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                             ,SUM(xtrvp1.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                             ,SUM(xtrvp1.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                             ,SUM(xtrvp1.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                             ,SUM(xtrvp1.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                             ,SUM(xtrvp1.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                             ,SUM(xtrvp1.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                             ,SUM(xtrvp1.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                             ,SUM(xtrvp1.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                             ,SUM(xtrvp1.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                             ,SUM(xtrvp1.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                             ,SUM(xtrvp1.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                             ,SUM(xtrvp1.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
                      FROM    xxcso_tmp_rep_vs_plan  xtrvp1
                      GROUP BY xtrvp1.employee_number
                     )                                      xtrvp
             WHERE    xrvsp.request_id         = cn_request_id
               AND    xrvsp.line_kind          = cn_line_kind1
               AND    xtrvr.base_code(+)       = xrvsp.base_code
               AND    xdmp.base_code(+)        = xtrvr.base_code
               AND    xdmp.year_month(+)       = gv_year_month
               AND    xspmp.base_code(+)       = xtrvr.base_code
               AND    xspmp.employee_number(+) = xtrvr.employee_number
               AND    xspmp.year_month(+)      = gv_year_month
               AND    xtrvp.employee_number(+) = xtrvr.employee_number
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xtrvr.group_number
             ORDER BY  report_output_no
                      ,TO_NUMBER(group_number)
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部
    -- 対象拠点に所属する営業員の担当する顧客の
    -- 日別合計を一般計、自販機計で集計する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.base_code                         base_code
                    ,xrvsp.hub_name                          hub_name
                    ,xrvsp.gvm_type                          gvm_type
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan               xrvsp
                    ,xxcso_tmp_rep_vs_plan                   xtrvp
             WHERE   xrvsp.request_id         = cn_request_id
               AND   xrvsp.line_kind          = cn_line_kind1
               AND   xtrvp.base_code(+)       = xrvsp.base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
                      ,xrvsp.gvm_type
             ORDER BY  report_output_no
                      ,xrvsp.gvm_type
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部(補足)
    -- 売上－中計部で一般計、自販機計で０件だったグループの中計部を作成する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,gvm_type                                  -- 一般／自販機／ＭＣ
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,(SELECT  MAX(xrvsp3.line_num)
             FROM    xxcso_rep_visit_sale_plan  xrvsp3
             WHERE   xrvsp3.request_id = cn_request_id
               AND   xrvsp3.line_kind  = cn_line_kind3
            ) + ROWNUM                           -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
    FROM    (
             -- 一般計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,cv_gvm_g                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   xrvsp3.gvm_type               = cv_gvm_g
                     )
             UNION ALL
             -- 自販機計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.base_code                       base_code
                    ,xrvsp.hub_name                        hub_name
                    ,cv_gvm_v                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   xrvsp3.gvm_type               = cv_gvm_v
                     )
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－計部
    -- 対象拠点の新規顧客軒数、新規ＶＤ軒数、売上予算を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind4                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,(SELECT  (CASE
                        WHEN (xdmp.sales_plan_rel_div = '1') THEN
                          xdmp.target_sales_total_amt
                        ELSE
                          xdmp.basic_sales_total_amt
                      END
                     )
             FROM    xxcso_dept_monthly_plans  xdmp
             WHERE   xdmp.base_code   = gv_base_code
               AND   xdmp.year_month  = gv_year_month
            )                                    -- 売上予算
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,SUM(xrvsp.new_customer_num)  new_customer_num
                    ,SUM(xrvsp.new_vendor_num)    new_vendor_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.base_code(+)           = xrvsp.base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－中計部
    -- 対象拠点に所属する営業員の訪問計画／訪問実績（日別）を
    -- 一般計、自販機計、ＭＣ計で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,plan_vs_amt_1                             -- １日－訪問計画
      ,plan_vs_amt_2                             -- ２日－訪問計画
      ,plan_vs_amt_3                             -- ３日－訪問計画
      ,plan_vs_amt_4                             -- ４日－訪問計画
      ,plan_vs_amt_5                             -- ５日－訪問計画
      ,plan_vs_amt_6                             -- ６日－訪問計画
      ,plan_vs_amt_7                             -- ７日－訪問計画
      ,plan_vs_amt_8                             -- ８日－訪問計画
      ,plan_vs_amt_9                             -- ９日－訪問計画
      ,plan_vs_amt_10                            -- １０日－訪問計画
      ,plan_vs_amt_11                            -- １１日－訪問計画
      ,plan_vs_amt_12                            -- １２日－訪問計画
      ,plan_vs_amt_13                            -- １３日－訪問計画
      ,plan_vs_amt_14                            -- １４日－訪問計画
      ,plan_vs_amt_15                            -- １５日－訪問計画
      ,plan_vs_amt_16                            -- １６日－訪問計画
      ,plan_vs_amt_17                            -- １７日－訪問計画
      ,plan_vs_amt_18                            -- １８日－訪問計画
      ,plan_vs_amt_19                            -- １９日－訪問計画
      ,plan_vs_amt_20                            -- ２０日－訪問計画
      ,plan_vs_amt_21                            -- ２１日－訪問計画
      ,plan_vs_amt_22                            -- ２２日－訪問計画
      ,plan_vs_amt_23                            -- ２３日－訪問計画
      ,plan_vs_amt_24                            -- ２４日－訪問計画
      ,plan_vs_amt_25                            -- ２５日－訪問計画
      ,plan_vs_amt_26                            -- ２６日－訪問計画
      ,plan_vs_amt_27                            -- ２７日－訪問計画
      ,plan_vs_amt_28                            -- ２８日－訪問計画
      ,plan_vs_amt_29                            -- ２９日－訪問計画
      ,plan_vs_amt_30                            -- ３０日－訪問計画
      ,plan_vs_amt_31                            -- ３１日－訪問計画
      ,rslt_vs_amt_1                             -- １日－訪問実績
      ,rslt_vs_amt_2                             -- ２日－訪問実績
      ,rslt_vs_amt_3                             -- ３日－訪問実績
      ,rslt_vs_amt_4                             -- ４日－訪問実績
      ,rslt_vs_amt_5                             -- ５日－訪問実績
      ,rslt_vs_amt_6                             -- ６日－訪問実績
      ,rslt_vs_amt_7                             -- ７日－訪問実績
      ,rslt_vs_amt_8                             -- ８日－訪問実績
      ,rslt_vs_amt_9                             -- ９日－訪問実績
      ,rslt_vs_amt_10                            -- １０日－訪問実績
      ,rslt_vs_amt_11                            -- １１日－訪問実績
      ,rslt_vs_amt_12                            -- １２日－訪問実績
      ,rslt_vs_amt_13                            -- １３日－訪問実績
      ,rslt_vs_amt_14                            -- １４日－訪問実績
      ,rslt_vs_amt_15                            -- １５日－訪問実績
      ,rslt_vs_amt_16                            -- １６日－訪問実績
      ,rslt_vs_amt_17                            -- １７日－訪問実績
      ,rslt_vs_amt_18                            -- １８日－訪問実績
      ,rslt_vs_amt_19                            -- １９日－訪問実績
      ,rslt_vs_amt_20                            -- ２０日－訪問実績
      ,rslt_vs_amt_21                            -- ２１日－訪問実績
      ,rslt_vs_amt_22                            -- ２２日－訪問実績
      ,rslt_vs_amt_23                            -- ２３日－訪問実績
      ,rslt_vs_amt_24                            -- ２４日－訪問実績
      ,rslt_vs_amt_25                            -- ２５日－訪問実績
      ,rslt_vs_amt_26                            -- ２６日－訪問実績
      ,rslt_vs_amt_27                            -- ２７日－訪問実績
      ,rslt_vs_amt_28                            -- ２８日－訪問実績
      ,rslt_vs_amt_29                            -- ２９日－訪問実績
      ,rslt_vs_amt_30                            -- ３０日－訪問実績
      ,rslt_vs_amt_31                            -- ３１日－訪問実績
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind5                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,plan_vs_amt_1                        -- １日－訪問計画
           ,plan_vs_amt_2                        -- ２日－訪問計画
           ,plan_vs_amt_3                        -- ３日－訪問計画
           ,plan_vs_amt_4                        -- ４日－訪問計画
           ,plan_vs_amt_5                        -- ５日－訪問計画
           ,plan_vs_amt_6                        -- ６日－訪問計画
           ,plan_vs_amt_7                        -- ７日－訪問計画
           ,plan_vs_amt_8                        -- ８日－訪問計画
           ,plan_vs_amt_9                        -- ９日－訪問計画
           ,plan_vs_amt_10                       -- １０日－訪問計画
           ,plan_vs_amt_11                       -- １１日－訪問計画
           ,plan_vs_amt_12                       -- １２日－訪問計画
           ,plan_vs_amt_13                       -- １３日－訪問計画
           ,plan_vs_amt_14                       -- １４日－訪問計画
           ,plan_vs_amt_15                       -- １５日－訪問計画
           ,plan_vs_amt_16                       -- １６日－訪問計画
           ,plan_vs_amt_17                       -- １７日－訪問計画
           ,plan_vs_amt_18                       -- １８日－訪問計画
           ,plan_vs_amt_19                       -- １９日－訪問計画
           ,plan_vs_amt_20                       -- ２０日－訪問計画
           ,plan_vs_amt_21                       -- ２１日－訪問計画
           ,plan_vs_amt_22                       -- ２２日－訪問計画
           ,plan_vs_amt_23                       -- ２３日－訪問計画
           ,plan_vs_amt_24                       -- ２４日－訪問計画
           ,plan_vs_amt_25                       -- ２５日－訪問計画
           ,plan_vs_amt_26                       -- ２６日－訪問計画
           ,plan_vs_amt_27                       -- ２７日－訪問計画
           ,plan_vs_amt_28                       -- ２８日－訪問計画
           ,plan_vs_amt_29                       -- ２９日－訪問計画
           ,plan_vs_amt_30                       -- ３０日－訪問計画
           ,plan_vs_amt_31                       -- ３１日－訪問計画
           ,rslt_vs_amt_1                        -- １日－訪問実績
           ,rslt_vs_amt_2                        -- ２日－訪問実績
           ,rslt_vs_amt_3                        -- ３日－訪問実績
           ,rslt_vs_amt_4                        -- ４日－訪問実績
           ,rslt_vs_amt_5                        -- ５日－訪問実績
           ,rslt_vs_amt_6                        -- ６日－訪問実績
           ,rslt_vs_amt_7                        -- ７日－訪問実績
           ,rslt_vs_amt_8                        -- ８日－訪問実績
           ,rslt_vs_amt_9                        -- ９日－訪問実績
           ,rslt_vs_amt_10                       -- １０日－訪問実績
           ,rslt_vs_amt_11                       -- １１日－訪問実績
           ,rslt_vs_amt_12                       -- １２日－訪問実績
           ,rslt_vs_amt_13                       -- １３日－訪問実績
           ,rslt_vs_amt_14                       -- １４日－訪問実績
           ,rslt_vs_amt_15                       -- １５日－訪問実績
           ,rslt_vs_amt_16                       -- １６日－訪問実績
           ,rslt_vs_amt_17                       -- １７日－訪問実績
           ,rslt_vs_amt_18                       -- １８日－訪問実績
           ,rslt_vs_amt_19                       -- １９日－訪問実績
           ,rslt_vs_amt_20                       -- ２０日－訪問実績
           ,rslt_vs_amt_21                       -- ２１日－訪問実績
           ,rslt_vs_amt_22                       -- ２２日－訪問実績
           ,rslt_vs_amt_23                       -- ２３日－訪問実績
           ,rslt_vs_amt_24                       -- ２４日－訪問実績
           ,rslt_vs_amt_25                       -- ２５日－訪問実績
           ,rslt_vs_amt_26                       -- ２６日－訪問実績
           ,rslt_vs_amt_27                       -- ２７日－訪問実績
           ,rslt_vs_amt_28                       -- ２８日－訪問実績
           ,rslt_vs_amt_29                       -- ２９日－訪問実績
           ,rslt_vs_amt_30                       -- ３０日－訪問実績
           ,rslt_vs_amt_31                       -- ３１日－訪問実績
    FROM    (
             -------------------------------------------
             --一般計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.base_code                        base_code
                    ,xrvsp.hub_name                         hub_name
                    ,cv_gvm_g                               gvm_type
                    ,SUM(xtrvp.tgt_vis_i_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_i_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_i_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_i_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_i_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_i_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_i_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_i_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_i_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_i_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_i_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_i_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_i_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_i_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_i_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_i_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_i_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_i_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_i_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_i_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_i_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_i_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_i_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_i_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_i_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_i_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_i_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_i_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_i_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_i_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_i_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_i_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_i_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_i_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_i_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_i_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_i_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_i_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_i_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_i_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_i_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_i_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_i_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_i_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_i_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_i_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_i_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_i_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_i_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_i_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_i_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_i_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_i_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_i_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_i_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_i_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_i_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_i_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_i_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_i_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_i_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_i_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.base_code(+)           = xrvsp.base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
             UNION ALL
             -------------------------------------------
             -- 自販機計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.base_code                        base_code
                    ,xrvsp.hub_name                         hub_name
                    ,cv_gvm_v                               gvm_type
                    ,SUM(xtrvp.tgt_vis_v_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_v_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_v_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_v_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_v_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_v_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_v_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_v_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_v_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_v_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_v_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_v_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_v_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_v_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_v_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_v_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_v_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_v_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_v_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_v_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_v_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_v_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_v_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_v_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_v_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_v_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_v_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_v_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_v_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_v_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_v_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_v_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_v_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_v_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_v_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_v_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_v_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_v_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_v_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_v_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_v_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_v_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_v_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_v_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_v_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_v_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_v_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_v_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_v_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_v_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_v_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_v_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_v_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_v_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_v_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_v_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_v_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_v_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_v_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_v_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_v_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_v_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.base_code(+)           = xrvsp.base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
             UNION ALL
             -------------------------------------------
             -- ＭＣ計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,cv_gvm_m                     gvm_type
                    ,0                            plan_vs_amt_1
                    ,0                            plan_vs_amt_2
                    ,0                            plan_vs_amt_3
                    ,0                            plan_vs_amt_4
                    ,0                            plan_vs_amt_5
                    ,0                            plan_vs_amt_6
                    ,0                            plan_vs_amt_7
                    ,0                            plan_vs_amt_8
                    ,0                            plan_vs_amt_9
                    ,0                            plan_vs_amt_10
                    ,0                            plan_vs_amt_11
                    ,0                            plan_vs_amt_12
                    ,0                            plan_vs_amt_13
                    ,0                            plan_vs_amt_14
                    ,0                            plan_vs_amt_15
                    ,0                            plan_vs_amt_16
                    ,0                            plan_vs_amt_17
                    ,0                            plan_vs_amt_18
                    ,0                            plan_vs_amt_19
                    ,0                            plan_vs_amt_20
                    ,0                            plan_vs_amt_21
                    ,0                            plan_vs_amt_22
                    ,0                            plan_vs_amt_23
                    ,0                            plan_vs_amt_24
                    ,0                            plan_vs_amt_25
                    ,0                            plan_vs_amt_26
                    ,0                            plan_vs_amt_27
                    ,0                            plan_vs_amt_28
                    ,0                            plan_vs_amt_29
                    ,0                            plan_vs_amt_30
                    ,0                            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_m_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_m_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_m_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_m_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_m_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_m_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_m_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_m_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_m_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_m_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_m_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_m_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_m_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_m_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_m_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_m_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_m_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_m_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_m_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_m_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_m_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_m_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_m_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_m_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_m_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_m_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_m_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_m_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_m_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_m_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_m_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.base_code(+)           = xrvsp.base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－有効訪問部
    -- 対象拠点に所属する営業員の有効訪問（日別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,effective_num_1                           -- １日－有効軒数
      ,effective_num_2                           -- ２日－有効軒数
      ,effective_num_3                           -- ３日－有効軒数
      ,effective_num_4                           -- ４日－有効軒数
      ,effective_num_5                           -- ５日－有効軒数
      ,effective_num_6                           -- ６日－有効軒数
      ,effective_num_7                           -- ７日－有効軒数
      ,effective_num_8                           -- ８日－有効軒数
      ,effective_num_9                           -- ９日－有効軒数
      ,effective_num_10                          -- １０日－有効軒数
      ,effective_num_11                          -- １１日－有効軒数
      ,effective_num_12                          -- １２日－有効軒数
      ,effective_num_13                          -- １３日－有効軒数
      ,effective_num_14                          -- １４日－有効軒数
      ,effective_num_15                          -- １５日－有効軒数
      ,effective_num_16                          -- １６日－有効軒数
      ,effective_num_17                          -- １７日－有効軒数
      ,effective_num_18                          -- １８日－有効軒数
      ,effective_num_19                          -- １９日－有効軒数
      ,effective_num_20                          -- ２０日－有効軒数
      ,effective_num_21                          -- ２１日－有効軒数
      ,effective_num_22                          -- ２２日－有効軒数
      ,effective_num_23                          -- ２３日－有効軒数
      ,effective_num_24                          -- ２４日－有効軒数
      ,effective_num_25                          -- ２５日－有効軒数
      ,effective_num_26                          -- ２６日－有効軒数
      ,effective_num_27                          -- ２７日－有効軒数
      ,effective_num_28                          -- ２８日－有効軒数
      ,effective_num_29                          -- ２９日－有効軒数
      ,effective_num_30                          -- ３０日－有効軒数
      ,effective_num_31                          -- ３１日－有効軒数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind6                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.effective_num_1                -- １日－有効軒数
           ,inn_v.effective_num_2                -- ２日－有効軒数
           ,inn_v.effective_num_3                -- ３日－有効軒数
           ,inn_v.effective_num_4                -- ４日－有効軒数
           ,inn_v.effective_num_5                -- ５日－有効軒数
           ,inn_v.effective_num_6                -- ６日－有効軒数
           ,inn_v.effective_num_7                -- ７日－有効軒数
           ,inn_v.effective_num_8                -- ８日－有効軒数
           ,inn_v.effective_num_9                -- ９日－有効軒数
           ,inn_v.effective_num_10               -- １０日－有効軒数
           ,inn_v.effective_num_11               -- １１日－有効軒数
           ,inn_v.effective_num_12               -- １２日－有効軒数
           ,inn_v.effective_num_13               -- １３日－有効軒数
           ,inn_v.effective_num_14               -- １４日－有効軒数
           ,inn_v.effective_num_15               -- １５日－有効軒数
           ,inn_v.effective_num_16               -- １６日－有効軒数
           ,inn_v.effective_num_17               -- １７日－有効軒数
           ,inn_v.effective_num_18               -- １８日－有効軒数
           ,inn_v.effective_num_19               -- １９日－有効軒数
           ,inn_v.effective_num_20               -- ２０日－有効軒数
           ,inn_v.effective_num_21               -- ２１日－有効軒数
           ,inn_v.effective_num_22               -- ２２日－有効軒数
           ,inn_v.effective_num_23               -- ２３日－有効軒数
           ,inn_v.effective_num_24               -- ２４日－有効軒数
           ,inn_v.effective_num_25               -- ２５日－有効軒数
           ,inn_v.effective_num_26               -- ２６日－有効軒数
           ,inn_v.effective_num_27               -- ２７日－有効軒数
           ,inn_v.effective_num_28               -- ２８日－有効軒数
           ,inn_v.effective_num_29               -- ２９日－有効軒数
           ,inn_v.effective_num_30               -- ３０日－有効軒数
           ,inn_v.effective_num_31               -- ３１日－有効軒数
    FROM    (
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.base_code                        base_code
                    ,xrvsp.hub_name                         hub_name
                    ,SUM(xtrvp.rslt_vis_e_num_1)            effective_num_1
                    ,SUM(xtrvp.rslt_vis_e_num_2)            effective_num_2
                    ,SUM(xtrvp.rslt_vis_e_num_3)            effective_num_3
                    ,SUM(xtrvp.rslt_vis_e_num_4)            effective_num_4
                    ,SUM(xtrvp.rslt_vis_e_num_5)            effective_num_5
                    ,SUM(xtrvp.rslt_vis_e_num_6)            effective_num_6
                    ,SUM(xtrvp.rslt_vis_e_num_7)            effective_num_7
                    ,SUM(xtrvp.rslt_vis_e_num_8)            effective_num_8
                    ,SUM(xtrvp.rslt_vis_e_num_9)            effective_num_9
                    ,SUM(xtrvp.rslt_vis_e_num_10)           effective_num_10
                    ,SUM(xtrvp.rslt_vis_e_num_11)           effective_num_11
                    ,SUM(xtrvp.rslt_vis_e_num_12)           effective_num_12
                    ,SUM(xtrvp.rslt_vis_e_num_13)           effective_num_13
                    ,SUM(xtrvp.rslt_vis_e_num_14)           effective_num_14
                    ,SUM(xtrvp.rslt_vis_e_num_15)           effective_num_15
                    ,SUM(xtrvp.rslt_vis_e_num_16)           effective_num_16
                    ,SUM(xtrvp.rslt_vis_e_num_17)           effective_num_17
                    ,SUM(xtrvp.rslt_vis_e_num_18)           effective_num_18
                    ,SUM(xtrvp.rslt_vis_e_num_19)           effective_num_19
                    ,SUM(xtrvp.rslt_vis_e_num_20)           effective_num_20
                    ,SUM(xtrvp.rslt_vis_e_num_21)           effective_num_21
                    ,SUM(xtrvp.rslt_vis_e_num_22)           effective_num_22
                    ,SUM(xtrvp.rslt_vis_e_num_23)           effective_num_23
                    ,SUM(xtrvp.rslt_vis_e_num_24)           effective_num_24
                    ,SUM(xtrvp.rslt_vis_e_num_25)           effective_num_25
                    ,SUM(xtrvp.rslt_vis_e_num_26)           effective_num_26
                    ,SUM(xtrvp.rslt_vis_e_num_27)           effective_num_27
                    ,SUM(xtrvp.rslt_vis_e_num_28)           effective_num_28
                    ,SUM(xtrvp.rslt_vis_e_num_29)           effective_num_29
                    ,SUM(xtrvp.rslt_vis_e_num_30)           effective_num_30
                    ,SUM(xtrvp.rslt_vis_e_num_31)           effective_num_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.base_code(+)           = xrvsp.base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－明細部
    -- 対象拠点の訪問記号計（月別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,vis_a_num                                 -- 訪問Ａ件数
      ,vis_b_num                                 -- 訪問Ｂ件数
      ,vis_c_num                                 -- 訪問Ｃ件数
      ,vis_d_num                                 -- 訪問Ｄ件数
      ,vis_e_num                                 -- 訪問Ｅ件数
      ,vis_f_num                                 -- 訪問Ｆ件数
      ,vis_g_num                                 -- 訪問Ｇ件数
      ,vis_h_num                                 -- 訪問Ｈ件数
      ,vis_i_num                                 -- 訪問Ｉ件数
      ,vis_j_num                                 -- 訪問Ｊ件数
      ,vis_k_num                                 -- 訪問Ｋ件数
      ,vis_l_num                                 -- 訪問Ｌ件数
      ,vis_m_num                                 -- 訪問Ｍ件数
      ,vis_n_num                                 -- 訪問Ｎ件数
      ,vis_o_num                                 -- 訪問Ｏ件数
      ,vis_p_num                                 -- 訪問Ｐ件数
      ,vis_q_num                                 -- 訪問Ｑ件数
      ,vis_r_num                                 -- 訪問Ｒ件数
      ,vis_s_num                                 -- 訪問Ｓ件数
      ,vis_t_num                                 -- 訪問Ｔ件数
      ,vis_u_num                                 -- 訪問Ｕ件数
      ,vis_v_num                                 -- 訪問Ｖ件数
      ,vis_w_num                                 -- 訪問Ｗ件数
      ,vis_x_num                                 -- 訪問Ｘ件数
      ,vis_y_num                                 -- 訪問Ｙ件数
      ,vis_z_num                                 -- 訪問Ｚ件数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind7                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.base_code                      -- 拠点コード
           ,inn_v.hub_name                       -- 拠点名
           ,inn_v.vis_a_num                      -- 訪問Ａ件数
           ,inn_v.vis_b_num                      -- 訪問Ｂ件数
           ,inn_v.vis_c_num                      -- 訪問Ｃ件数
           ,inn_v.vis_d_num                      -- 訪問Ｄ件数
           ,inn_v.vis_e_num                      -- 訪問Ｅ件数
           ,inn_v.vis_f_num                      -- 訪問Ｆ件数
           ,inn_v.vis_g_num                      -- 訪問Ｇ件数
           ,inn_v.vis_h_num                      -- 訪問Ｈ件数
           ,inn_v.vis_i_num                      -- 訪問Ｉ件数
           ,inn_v.vis_j_num                      -- 訪問Ｊ件数
           ,inn_v.vis_k_num                      -- 訪問Ｋ件数
           ,inn_v.vis_l_num                      -- 訪問Ｌ件数
           ,inn_v.vis_m_num                      -- 訪問Ｍ件数
           ,inn_v.vis_n_num                      -- 訪問Ｎ件数
           ,inn_v.vis_o_num                      -- 訪問Ｏ件数
           ,inn_v.vis_p_num                      -- 訪問Ｐ件数
           ,inn_v.vis_q_num                      -- 訪問Ｑ件数
           ,inn_v.vis_r_num                      -- 訪問Ｒ件数
           ,inn_v.vis_s_num                      -- 訪問Ｓ件数
           ,inn_v.vis_t_num                      -- 訪問Ｔ件数
           ,inn_v.vis_u_num                      -- 訪問Ｕ件数
           ,inn_v.vis_v_num                      -- 訪問Ｖ件数
           ,inn_v.vis_w_num                      -- 訪問Ｗ件数
           ,inn_v.vis_x_num                      -- 訪問Ｘ件数
           ,inn_v.vis_y_num                      -- 訪問Ｙ件数
           ,inn_v.vis_z_num                      -- 訪問Ｚ件数
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.base_code              base_code
                    ,xrvsp.hub_name               hub_name
                    ,SUM(xsvsr.vis_a_num)         vis_a_num
                    ,SUM(xsvsr.vis_b_num)         vis_b_num
                    ,SUM(xsvsr.vis_c_num)         vis_c_num
                    ,SUM(xsvsr.vis_d_num)         vis_d_num
                    ,SUM(xsvsr.vis_e_num)         vis_e_num
                    ,SUM(xsvsr.vis_f_num)         vis_f_num
                    ,SUM(xsvsr.vis_g_num)         vis_g_num
                    ,SUM(xsvsr.vis_h_num)         vis_h_num
                    ,SUM(xsvsr.vis_i_num)         vis_i_num
                    ,SUM(xsvsr.vis_j_num)         vis_j_num
                    ,SUM(xsvsr.vis_k_num)         vis_k_num
                    ,SUM(xsvsr.vis_l_num)         vis_l_num
                    ,SUM(xsvsr.vis_m_num)         vis_m_num
                    ,SUM(xsvsr.vis_n_num)         vis_n_num
                    ,SUM(xsvsr.vis_o_num)         vis_o_num
                    ,SUM(xsvsr.vis_p_num)         vis_p_num
                    ,SUM(xsvsr.vis_q_num)         vis_q_num
                    ,SUM(xsvsr.vis_r_num)         vis_r_num
                    ,SUM(xsvsr.vis_s_num)         vis_s_num
                    ,SUM(xsvsr.vis_t_num)         vis_t_num
                    ,SUM(xsvsr.vis_u_num)         vis_u_num
                    ,SUM(xsvsr.vis_v_num)         vis_v_num
                    ,SUM(xsvsr.vis_w_num)         vis_w_num
                    ,SUM(xsvsr.vis_x_num)         vis_x_num
                    ,SUM(xsvsr.vis_y_num)         vis_y_num
                    ,SUM(xsvsr.vis_z_num)         vis_z_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
                    ,xxcso_sum_visit_sale_rep     xsvsr
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xtrvp.base_code(+)           = xrvsp.base_code
               AND   xsvsr.sum_org_type(+)        = cv_sum_org_type1
               AND   xsvsr.sum_org_code(+)        = xtrvp.account_number
               AND   xsvsr.group_base_code(+)     = xtrvp.base_code
               AND   xsvsr.month_date_div(+)      = cv_month_date_div1
               AND   xsvsr.sales_date(+)          = gv_year_month
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.base_code
                      ,xrvsp.hub_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1028 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END get_ticket3;
--
  /**********************************************************************************
   * Procedure Name   : up_plsql_tab4
   * Description      : 帳票種別4-地区営業部/部別-PLSQL表の更新 (A-6-3)
  ***********************************************************************************/
  PROCEDURE up_plsql_tab4(
     i_month_square_rec  IN                g_month_rtype4                     -- 一ヶ月分データ
    ,in_m_cnt            IN                NUMBER                             -- 明細部のカウンタ
    ,io_m_tab            IN  OUT NOCOPY    g_get_month_square_ttype           -- 明細部配列
    ,io_hon_tab          IN  OUT NOCOPY    g_get_month_square_ttype           -- 本体部配列
    ,ov_errbuf           OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'up_plsql_tab4';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
    -- ローカル変数
    lv_gvm_type           VARCHAR2(1);                                       -- 一般／自販機／ＭＣ
    ln_m_cnt              NUMBER(9);                                         -- INパラメータを格納
    BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
      ln_m_cnt                            := in_m_cnt;                       -- INパラメータを格納
      -- DEBUGメッセージ
      -- PL/SQL表の更新
      debug(
         buff   => '地区営業部/部別-PL/SQL表の更新処理:' || TO_CHAR(ln_m_cnt)
      );
      BEGIN
        -- 売り上げ明細部
        io_m_tab(ln_m_cnt).up_base_code     := i_month_square_rec.base_code_par;       -- 拠点コード（親)
        io_m_tab(ln_m_cnt).up_hub_name      := i_month_square_rec.base_name_par;       -- 拠点名称（親）
        io_m_tab(ln_m_cnt).base_code        := i_month_square_rec.base_code_chi;       -- 業務地拠点コード
        io_m_tab(ln_m_cnt).hub_name         := i_month_square_rec.base_name_chi;       -- 業務地拠点名
        io_m_tab(ln_m_cnt).last_year_rslt_sales_amt :=i_month_square_rec.rslt_amty; -- 前年実績
        io_m_tab(ln_m_cnt).last_mon_rslt_sales_amt  :=i_month_square_rec.rslt_amtm; -- 先月実績
        io_m_tab(ln_m_cnt).new_customer_num :=i_month_square_rec.cust_new_num;      -- 顧客件数
        io_m_tab(ln_m_cnt).new_vendor_num   :=i_month_square_rec.cust_vd_new_num;   -- 顧客件数（VD 新規）
        io_m_tab(ln_m_cnt).plan_sales_amt  := i_month_square_rec.tgt_sales_prsn_total_amt;  -- 月別売上予算
        -- DEBUGメッセージ
        -- PL/SQL表の更新
        debug(
           buff   => '地区営業部/部別-PL/SQL表の更新処理' || '売り上げ明細部固定部完了'
        );
      EXCEPTION
        WHEN OTHERS THEN
          fnd_file.put_line(
           which  => FND_FILE.LOG,
           buff   => '地区営業部/部別-PL/SQL表の更新処理失敗:' || SQLERRM
         );
         RAISE global_api_others_expt;
      END;
      -- 本体部
      FOR i IN 1..cn_idx_max LOOP
        IF(i = cn_idx_sales_ippn) THEN         --売り上げ中計部(一般)
          io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
        ELSIF(i = cn_idx_sales_vd) THEN      --売り上げ中計部(自販機)
          io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
        ELSIF(i = cn_idx_sales_sum) THEN      -- 売り上げ合計部
          NULL;
        ELSIF(i=cn_idx_visit_ippn)THEN       --訪問中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
        ELSIF(i=cn_idx_visit_vd)THEN       --訪問中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
        ELSIF(i=cn_idx_visit_mc)THEN       --訪問中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_m;                              -- MC
        END IF;
        io_hon_tab(i).up_base_code     := i_month_square_rec.base_code_par;  -- 拠点コード（親)
        io_hon_tab(i).up_hub_name      := i_month_square_rec.base_name_par;  -- 拠点名称（親）
      END LOOP;
--
      -- 売上中計部(一般)
      io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amty, 0);    -- 前年実績
      io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt  :=
        io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amtm, 0);    -- 先月実績
      io_hon_tab(cn_idx_sales_ippn).new_customer_num :=
        io_hon_tab(cn_idx_sales_ippn).new_customer_num +
        NVL(i_month_square_rec.cust_other_new_num, 0); -- 顧客件数（新規）（一般）
      -- 売上中計部(自販機)
      io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amty, 0);       -- 前年実績
      io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amtm, 0);       -- 先月実績
      io_hon_tab(cn_idx_sales_vd).new_customer_num :=
        io_hon_tab(cn_idx_sales_vd).new_customer_num +
        NVL(i_month_square_rec.cust_vd_new_num, 0);     -- 顧客件数（新規）(自販機)
--
      FOR i IN 1..31 LOOP
        BEGIN
          -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '地区営業部/部別-PL/SQL表の更新処理' || '1ヶ月分のデータ更新'
            );
          --売り上げ明細部
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_amt;                  -- 売り上げ実績
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_other_sales_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_center_amt;           -- 内他拠点＿売上実績
          -- 売り上げ中計部(一般)
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_other_amt,0);        -- 売上実績,訪問実績
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_other_sales_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_other_sales_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_center_other_amt,0); -- 内他拠点＿売上実績
          -- 売り上げ中計部(自販機)
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_vd_amt,0);           -- 売上実績,訪問実績
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_other_sales_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_other_sales_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_center_vd_amt,0);    -- 内他拠点＿売上実績
          -- 売り上げ合計部
          -- 訪問中計部(一般)
          io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_other_num,0);         -- 売上実績,訪問実績
          -- 訪問中計部(自販機)
          io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_vd_num,0);            -- 売上実績,訪問実績
          -- 訪問中計部(MC)
          io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_mc_num,0);            -- 売上実績,訪問実績
          -- 訪問合計部
          io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num :=
            io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_sales_num,0);         -- 有効軒数
          -- 訪問内容合計部
          io_hon_tab(cn_idx_visit_dsc).vis_a_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_a_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_a_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_b_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_b_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_b_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_c_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_c_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_c_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_d_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_d_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_d_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_e_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_e_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_e_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_f_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_f_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_f_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_g_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_g_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_g_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_h_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_h_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_h_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_i_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_i_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_i_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_j_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_j_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_j_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_k_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_k_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_k_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_l_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_l_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_l_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_m_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_m_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_m_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_n_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_n_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_n_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_o_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_o_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_o_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_p_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_p_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_p_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_q_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_q_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_q_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_r_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_r_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_r_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_s_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_s_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_s_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_t_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_t_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_t_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_u_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_u_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_u_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_v_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_v_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_v_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_w_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_w_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_w_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_x_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_x_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_x_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_y_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_y_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_y_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_z_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_z_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_z_num,0);
        EXCEPTION
          WHEN OTHERS THEN
            fnd_file.put_line(
               which  => FND_FILE.LOG,
               buff   => '地区営業部/部別-PL/SQL表-本体部の更新処理でエラーになりました。' || SQLERRM ||
                        ''                         -- 空行の挿入
             );
            RAISE global_api_others_expt;
        END;
      END LOOP;
    EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END up_plsql_tab4;
--
  /**********************************************************************************
   * Procedure Name   : get_ticket4
   * Description      : 帳票種別4-地区営業部/部別 (A-6-1,A-6-2)
  ***********************************************************************************/
  PROCEDURE get_ticket4(
     ov_errbuf         OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode        OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg         OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'get_ticket4';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ローカル定数
    -- ローカル変数
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1029 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--  lb_boolean            BOOLEAN;      -- 判断用
--  ln_m_cnt              NUMBER(9);    -- 明細部カウンター数格納
--  ln_cnt                NUMBER(9);    -- 抽出されたレコード件数
--  ln_date               NUMBER(2);    -- 日付のナンバー型
--  ln_report_output_no   NUMBER(9);    -- 帳票出力セット番号
--  lv_bf_base_code_par   xxcso_aff_base_level_v.base_code%TYPE;
--  lv_bf_base_code_chi   xxcso_aff_base_level_v.child_base_code%TYPE;
--  -- *** ローカル・カーソル ***
--  CURSOR ticket_data_cur
--  IS
--    SELECT
--            xablv.base_code             base_code_par,          -- 勤務地拠点コード(親)(拠点コード)
--            xabvpar.base_name           base_name_par,          -- 勤務地拠点名(親)
--            xablv.child_base_code       base_code_chi,          -- 勤務地拠点コード
--            xabvchi.base_name           base_name_chi,          -- 勤務地拠点名
--            xsvsr.sales_date            sales_date,             -- 販売年月日
--            xsvsr.rslt_amt              rslt_amt,               -- 売上実績
--            xsvsr.rslt_new_amt          rslt_new_amt,           -- 売上実績（新規）
--            xsvsr.rslt_vd_new_amt       rslt_vd_new_amt,        -- 売上実績（VD：新規）
--            xsvsr.rslt_vd_amt           rslt_vd_amt,            -- 売上実績（VD）
--            xsvsr.rslt_other_new_amt    rslt_other_new_amt,     -- 売上実績（VD以外：新規）
--            xsvsr.rslt_other_amt        rslt_other_amt,         -- 売上実績（VD以外）
--            xsvsr.rslt_center_amt       rslt_center_amt,        -- 内他拠点＿売上実績
--            xsvsr.rslt_center_vd_amt    rslt_center_vd_amt,     -- 内他拠点＿売上実績（VD）
--            xsvsr.rslt_center_other_amt rslt_center_other_amt,  -- 内他拠点＿売上実績（VD以外）
--            xsvsr.vis_num               vis_num,                -- 訪問実績
--            xsvsr.vis_new_num           vis_new_num,            -- 訪問実績（新規）
--            xsvsr.vis_vd_new_num        vis_vd_new_num,         -- 訪問実績（VD：新規）
--            xsvsr.vis_vd_num            vis_vd_num,             -- 訪問実績（VD）
--            xsvsr.vis_other_new_num     vis_other_new_num,      -- 訪問実績（VD以外：新規）
--            xsvsr.vis_other_num         vis_other_num,          -- 訪問実績（VD以外）
--            xsvsr.vis_mc_num            vis_mc_num,             -- 訪問実績（MC）
--            xsvsr.vis_sales_num         vis_sales_num,          -- 有効軒数
--            xsvsr.vis_a_num             vis_a_num,              -- 訪問Ａ件数
--            xsvsr.vis_b_num             vis_b_num,              -- 訪問Ｂ件数
--            xsvsr.vis_c_num             vis_c_num,              -- 訪問Ｃ件数
--            xsvsr.vis_d_num             vis_d_num,              -- 訪問Ｄ件数
--            xsvsr.vis_e_num             vis_e_num,              -- 訪問Ｅ件数
--            xsvsr.vis_f_num             vis_f_num,              -- 訪問Ｆ件数
--            xsvsr.vis_g_num             vis_g_num,              -- 訪問Ｇ件数
--            xsvsr.vis_h_num             vis_h_num,              -- 訪問Ｈ件数
--            xsvsr.vis_i_num             vis_i_num,              -- 訪問ⅰ件数
--            xsvsr.vis_j_num             vis_j_num,              -- 訪問Ｊ件数
--            xsvsr.vis_k_num             vis_k_num,              -- 訪問Ｋ件数
--            xsvsr.vis_l_num             vis_l_num,              -- 訪問Ｌ件数
--            xsvsr.vis_m_num             vis_m_num,              -- 訪問Ｍ件数
--            xsvsr.vis_n_num             vis_n_num,              -- 訪問Ｎ件数
--            xsvsr.vis_o_num             vis_o_num,              -- 訪問Ｏ件数
--            xsvsr.vis_p_num             vis_p_num,              -- 訪問Ｐ件数
--            xsvsr.vis_q_num             vis_q_num,              -- 訪問Ｑ件数
--            xsvsr.vis_r_num             vis_r_num,              -- 訪問Ｒ件数
--            xsvsr.vis_s_num             vis_s_num,              -- 訪問Ｓ件数
--            xsvsr.vis_t_num             vis_t_num,              -- 訪問Ｔ件数
--            xsvsr.vis_u_num             vis_u_num,              -- 訪問Ｕ件数
--            xsvsr.vis_v_num             vis_v_num,              -- 訪問Ｖ件数
--            xsvsr.vis_w_num             vis_w_num,              -- 訪問Ｗ件数
--            xsvsr.vis_x_num             vis_x_num,              -- 訪問Ｘ件数
--            xsvsr.vis_y_num             vis_y_num,              -- 訪問Ｙ件数
--            xsvsr.vis_z_num             vis_z_num,              -- 訪問Ｚ件数
--            xsvsry.rslt_amt             rslt_amty,              -- 前年実績
--            xsvsry.rslt_vd_amt          rslt_vd_amty,           -- 前年実績（VD）
--            xsvsry.rslt_other_amt       rslt_other_amty,        -- 前年実績（VD以外）
--            xsvsrm.rslt_amt             rslt_amtm,              -- 先月実績
--            xsvsrm.rslt_vd_amt          rslt_vd_amtm,           -- 先月実績（VD）
--            xsvsrm.rslt_other_amt       rslt_other_amtm,        -- 先月実績（VD以外）
--            xsvsrn.cust_new_num         cust_new_num,           -- 顧客件数（新規）
--            xsvsrn.cust_vd_new_num      cust_vd_new_num,        -- 顧客件数（VD：新規）
--            xsvsrn.cust_other_new_num   cust_other_new_num,     -- 顧客件数（VD以外：新規）
--            xsvsrn.tgt_sales_prsn_total_amt  tgt_sales_prsn_total_amt  -- 月別売上予算
--    FROM    xxcso_aff_base_level_v      xablv         -- AFF部門階層マスタビュー
--           ,xxcso_aff_base_v2           xabvpar       -- AFF部門マスタ（最新）ビュー(親)
--           ,xxcso_aff_base_v2           xabvchi       -- AFF部門マスタ（最新）ビュー(子)
--           ,xxcso_sum_visit_sale_rep    xsvsr         -- 訪問売上計画管理表サマリテーブル
--           ,xxcso_sum_visit_sale_rep    xsvsry        -- 訪問売上計画管理表サマリ前年
--           ,xxcso_sum_visit_sale_rep    xsvsrm        -- 訪問売上計画管理表サマリ先月
--           ,xxcso_sum_visit_sale_rep    xsvsrn        -- 訪問売上計画管理表サマリ当月
--    WHERE   xablv.base_code = gv_base_code
--      /* 20090427_abe_売上計画出力対応 START*/
--      AND   xablv.child_base_code = xsvsr.sum_org_code(+)
--      AND   xablv.base_code = xabvpar.base_code(+)
--      AND   xablv.child_base_code = xabvchi.base_code(+)
--      AND   xsvsr.sum_org_type(+) = cv_sum_org_type4
--      AND   xsvsr.month_date_div(+) = cv_month_date_div2
--      AND   xsvsr.sales_date(+)
--              BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      --AND   xablv.child_base_code = xsvsr.sum_org_code
--      --AND   xablv.base_code = xabvpar.base_code
--      --AND   xablv.child_base_code = xabvchi.base_code
--      --AND   xsvsr.sum_org_type = cv_sum_org_type4
--      --AND   xsvsr.month_date_div = cv_month_date_div2
--      --AND   xsvsr.sales_date
--      --        BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      /* 20090427_abe_売上計画出力対応 END*/
--      AND   xsvsr.sum_org_type   = xsvsry.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsry.sum_org_code(+)
--      AND   xsvsry.month_date_div(+)= cv_month_date_div1
--      AND   xsvsry.sales_date(+) = gv_year_prev
--      AND   xsvsr.sum_org_type   = xsvsrm.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrm.sum_org_code(+)
--      AND   xsvsrm.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrm.sales_date(+) = gv_year_month_prev
--      AND   xsvsr.sum_org_type   = xsvsrn.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrn.sum_org_code(+)
--      AND   xsvsrn.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrn.sales_date(+) = gv_year_month
--    /* 20090427_abe_売上計画出力対応 START*/
--    ORDER BY  xabvchi.row_order   ASC;
--    --ORDER BY  base_code_chi     ASC;
--    /* 20090427_abe_売上計画出力対応 END*/
--  -- ローカルレコード
--  l_cur_rec                  ticket_data_cur%ROWTYPE;
--  l_month_square_rec         g_month_rtype4;
--  l_get_month_square_tab     g_get_month_square_ttype;
--  l_get_month_square_hon_tab g_get_month_square_ttype;
--
    -- 配下部門取得カーソル
    CURSOR get_base_data_cur
    IS
      SELECT  xablv.child_base_code    child_base_code
      FROM    xxcso_aff_base_level_v2  xablv
      START WITH
              xablv.base_code       = gv_base_code
      CONNECT BY PRIOR
              xablv.child_base_code = xablv.base_code
      UNION ALL
      SELECT  xabv.base_code           child_base_code
      FROM    xxcso_aff_base_v2        xabv
      WHERE   xabv.base_code        = gv_base_code
      AND     NOT EXISTS(
                SELECT  1
                FROM    xxcso_aff_base_level_v2  xablv1
                WHERE   xablv1.base_code = xabv.base_code
              )
      ;
--
    ln_sum_emp_num             NUMBER;
    lv_report_name             xxcso_rep_visit_sale_plan.report_name%TYPE;   -- 帳票タイトル
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1029 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1029 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--    -- ローカル変数初期化
--    lb_boolean                := TRUE;        -- 初期処理判断
--    ln_m_cnt                  := 1;           -- 明細部の行数
--    ln_report_output_no       := 1;           -- 配列行数
--    ln_cnt                    := 0;           -- LOOP件数
--    -- PL/SQL表（本体部）の初期化
--    init_month_square_hon_tab(l_get_month_square_hon_tab);
--    -- ローカルレコードの初期化
--    init_month_square_rec4(l_month_square_rec);
--    BEGIN
--      --カーソルオープン
--      OPEN ticket_data_cur;
--
--DO_ERROR('A-6-2-1');
--
--      <<get_data_loop>>
--      LOOP
--        l_cur_rec                           := NULL;          -- カーソルレコードの初期化
--
--        FETCH ticket_data_cur INTO l_cur_rec;                 -- カーソルのデータをレコードに格納
--
--        -- 対象件数がO件の場合
--        EXIT WHEN ticket_data_cur%NOTFOUND
--          OR  ticket_data_cur%ROWCOUNT = 0;
--
--DO_ERROR('A-6-2-2');
--
--        debug(
--          buff   => l_cur_rec.base_code_par                     ||','||
--                    l_cur_rec.base_name_par                     ||','||
--                    l_cur_rec.base_code_chi                     ||','||
--                    l_cur_rec.base_name_chi                     ||','||
--                    l_cur_rec.sales_date                        ||','||
--                    TO_CHAR(l_cur_rec.rslt_amt)                 ||','||
--                    TO_CHAR(l_cur_rec.rslt_new_amt)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_new_amt)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amt)              ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_new_amt)       ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amt)           ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_amt)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_vd_amt)       ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_other_amt)    ||','||
--                    TO_CHAR(l_cur_rec.vis_num)                  ||','||
--                    TO_CHAR(l_cur_rec.vis_new_num)              ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_new_num)           ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_other_new_num)        ||','||
--                    TO_CHAR(l_cur_rec.vis_other_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_mc_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_sales_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_a_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_b_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_c_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_d_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_e_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_f_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_g_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_h_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_i_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_j_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_k_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_l_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_m_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_n_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_o_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_p_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_q_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_r_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_s_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_t_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_u_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_v_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_w_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_x_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_y_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_z_num)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_amty)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amty)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amty)          ||','||
--                    TO_CHAR(l_cur_rec.rslt_amtm)                ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amtm)             ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amtm)          ||','||
--                    TO_CHAR(l_cur_rec.cust_new_num)             ||','||
--                    TO_CHAR(l_cur_rec.cust_vd_new_num)          ||','||
--                    TO_CHAR(l_cur_rec.cust_other_new_num)       ||','||
--                    TO_CHAR(l_cur_rec.tgt_sales_prsn_total_amt) ||','||
--                   cv_lf
--        );
--        -- 前回レコードと拠点コードが同じで業務地コードが違う場合、明細部配列と本体部配列を更新。
--        IF(lb_boolean=FALSE) THEN
--          IF((lv_bf_base_code_par = l_cur_rec.base_code_par)AND(lv_bf_base_code_chi <> l_cur_rec.base_code_chi))
--            THEN
--            -- DEBUGメッセージ
--            debug(
--               buff   => '業務地コードが違います。 :' ||'前回： '|| lv_bf_base_code_chi ||
--                          '今回：' || l_cur_rec.base_code_chi ||
--                          '明細部配列' || TO_CHAR(ln_m_cnt)
--            );
--            -- =================================================
--            -- A-6-2,A-6-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab4(
--               i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--            l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--            init_month_square_rec4(l_month_square_rec);
--            ln_m_cnt          := ln_m_cnt + 1;       -- 明細部配列を＋１する。
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          ELSIF(lv_bf_base_code_par <> l_cur_rec.base_code_par) THEN
--            -- =================================================
--            -- A-6-2,A-6-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab4(
--               i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;  -- ローカルレコードのデータを消す。
--            l_month_square_rec      := NULL;          -- ローカルレコードのデータを消す。
--            init_month_square_rec4(l_month_square_rec);
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          END IF;
--        END IF;
--        -- 拠点コードが前回取得した拠点コードと違う場合ワークテーブルに出力します。
--        IF ((ln_cnt > 0) AND
--            (lv_bf_base_code_par <> l_cur_rec.base_code_par)) THEN
--          debug(
--             buff   => '拠点コードが違います。 :' ||'前回： '|| lv_bf_base_code_par || ''||
--                        '今回：' || l_cur_rec.base_code_par
--          );
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- レコードの初期化
--        l_get_month_square_tab.DELETE;
--        l_get_month_square_hon_tab.DELETE;
--        init_month_square_hon_tab(l_get_month_square_hon_tab);
--        -- カウンタ数に１を足す
--        ln_report_output_no := ln_report_output_no + 1; -- 出力された帳票個数に＋１する
--        lb_boolean          := TRUE;                    -- 初期処理の状態に戻す
--        ln_m_cnt            := 1;                       -- 明細部配列の行数の初期化
--        END IF;
--        -- 初期処理の場合
--        IF(lb_boolean) THEN
--          -- 業務地コードをローカル変数に格納
--          lv_bf_base_code_par         := l_cur_rec.base_code_par;        -- 勤務地拠点コード(親)(拠点コード)
--          lv_bf_base_code_chi         := l_cur_rec.base_code_chi;        -- 勤務地拠点コード
--          -- ローカルレコードに格納
--          -- 勤務地拠点コード(親)(拠点コード)
--          l_month_square_rec.base_code_par     := l_cur_rec.base_code_par;
--          -- 勤務地拠点名(親)(拠点コード)
--          l_month_square_rec.base_name_par     := l_cur_rec.base_name_par;
--          -- 勤務地拠点コード
--          l_month_square_rec.base_code_chi     := l_cur_rec.base_code_chi;
--          -- 勤務地拠点名
--          l_month_square_rec.base_name_chi     := l_cur_rec.base_name_chi;
--          -- 新規顧客件数
--          l_month_square_rec.cust_new_num      := l_cur_rec.cust_new_num;
--          -- 新規VD件数
--          l_month_square_rec.cust_vd_new_num   := l_cur_rec.cust_vd_new_num;
--          -- 新規VD以外件数
--          l_month_square_rec.cust_other_new_num := l_cur_rec.cust_other_new_num;
--          -- 前年実績
--          l_month_square_rec.rslt_amty         := l_cur_rec.rslt_amty;
--          -- 前年実績（VD）
--          l_month_square_rec.rslt_vd_amty      := l_cur_rec.rslt_vd_amty;
--          -- 前年実績（VD以外））
--          l_month_square_rec.rslt_other_amty   := l_cur_rec.rslt_other_amty;
--          -- 先月実績
--          l_month_square_rec.rslt_amtm         := l_cur_rec.rslt_amtm;
--          -- 先月実績（VD）
--          l_month_square_rec.rslt_vd_amtm      := l_cur_rec.rslt_vd_amtm;
--          -- 先月実績（VD以外
--          l_month_square_rec.rslt_other_amtm   := l_cur_rec.rslt_other_amtm;
--          -- 月別売上予算
--          l_month_square_rec.tgt_sales_prsn_total_amt := l_cur_rec.tgt_sales_prsn_total_amt;
--          lb_boolean := FALSE;                  -- 初期処理のフラグをオフする。
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '初期処理フラグ:' || 'FALSE'
--          );
--        END IF;
--        /* 20090427_abe_売上計画出力対応 START*/
--        IF (l_cur_rec.sales_date IS NOT NULL) THEN
--          -- 日付を取得
--          ln_date := TO_NUMBER(SUBSTR(l_cur_rec.sales_date,7,2));
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '日付:' || l_cur_rec.sales_date || cv_lf ||
--                       '日付けのナンバー型:'     || TO_CHAR(ln_date)
--          );
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_amt
--            := l_cur_rec.rslt_amt;              -- 売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_new_amt
--            := l_cur_rec.rslt_new_amt;          -- 売上実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_new_amt
--            := l_cur_rec.rslt_vd_new_amt;       -- 売上実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_amt
--            := l_cur_rec.rslt_vd_amt;           -- 売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_new_amt
--            := l_cur_rec.rslt_other_new_amt;    -- 売上実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_amt
--            := l_cur_rec.rslt_other_amt;        -- 売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_amt
--            := l_cur_rec.rslt_center_amt;       -- 内他拠点＿売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_vd_amt
--            := l_cur_rec.rslt_center_vd_amt;    -- 内他拠点＿売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_other_amt
--            := l_cur_rec.rslt_center_other_amt; -- 内他拠点＿売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_num
--            := l_cur_rec.vis_num;               -- 訪問実績
--          l_month_square_rec.l_one_day_tab(ln_date).vis_new_num
--            := l_cur_rec.vis_new_num;           -- 訪問実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_new_num
--            := l_cur_rec.vis_vd_new_num;        -- 訪問実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_num
--            := l_cur_rec.vis_vd_num;            -- 訪問実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_new_num
--            := l_cur_rec.vis_other_new_num;     -- 訪問実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_num
--            := l_cur_rec.vis_other_num;         -- 訪問実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_mc_num
--            := l_cur_rec.vis_mc_num;            -- 訪問実績（MC
--          l_month_square_rec.l_one_day_tab(ln_date).vis_sales_num
--            := l_cur_rec.vis_sales_num;         -- 有効軒数
--          -- A0Z訪問件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_a_num := nvl(l_cur_rec.vis_a_num,0);  -- 訪問A件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_b_num := nvl(l_cur_rec.vis_b_num,0);  -- 訪問B件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_c_num := nvl(l_cur_rec.vis_c_num,0);  -- 訪問C件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_d_num := nvl(l_cur_rec.vis_d_num,0);  -- 訪問D件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_e_num := nvl(l_cur_rec.vis_e_num,0);  -- 訪問E件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_f_num := nvl(l_cur_rec.vis_f_num,0);  -- 訪問F件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_g_num := nvl(l_cur_rec.vis_g_num,0);  -- 訪問G件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_h_num := nvl(l_cur_rec.vis_h_num,0);  -- 訪問H件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_i_num := nvl(l_cur_rec.vis_i_num,0);  -- 訪問I件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_j_num := nvl(l_cur_rec.vis_j_num,0);  -- 訪問J件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_k_num := nvl(l_cur_rec.vis_k_num,0);  -- 訪問K件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_l_num := nvl(l_cur_rec.vis_l_num,0);  -- 訪問L件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_m_num := nvl(l_cur_rec.vis_m_num,0);  -- 訪問M件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_n_num := nvl(l_cur_rec.vis_n_num,0);  -- 訪問N件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_o_num := nvl(l_cur_rec.vis_o_num,0);  -- 訪問O件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_p_num := nvl(l_cur_rec.vis_p_num,0);  -- 訪問P件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_q_num := nvl(l_cur_rec.vis_q_num,0);  -- 訪問Q件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_r_num := nvl(l_cur_rec.vis_r_num,0);  -- 訪問R件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_s_num := nvl(l_cur_rec.vis_s_num,0);  -- 訪問S件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_t_num := nvl(l_cur_rec.vis_t_num,0);  -- 訪問T件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_u_num := nvl(l_cur_rec.vis_u_num,0);  -- 訪問U件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_v_num := nvl(l_cur_rec.vis_v_num,0);  -- 訪問V件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_w_num := nvl(l_cur_rec.vis_w_num,0);  -- 訪問W件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_x_num := nvl(l_cur_rec.vis_x_num,0);  -- 訪問X件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_y_num := nvl(l_cur_rec.vis_y_num,0);  -- 訪問Y件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_z_num := nvl(l_cur_rec.vis_z_num,0);  -- 訪問Z件数
--        END IF;
--        /* 20090427_abe_売上計画出力対応 END*/
--        -- 最初のレコードの場合
--        IF(lb_boolean) THEN
--          lb_boolean              := FALSE;                  -- 初期処理のフラグをオフする。
--        END IF;
--        -- 抽出件数カウンタに１を足す。
--        ln_cnt := ln_cnt + 1;
--        gn_target_cnt  := ln_cnt;
--        -- loop件数
--        debug(
--              buff   => 'loop件数' || TO_CHAR(ln_cnt)
--        );
--      END LOOP;
--      -- 最後のデータ登録
--      IF (ln_cnt > 0) THEN
--        debug(
--              buff   => '最後のデータの登録'
--        );
--        -- =================================================
--        -- A-6-2,A-6-3.PLSQL表の更新
--        -- =================================================
--        up_plsql_tab4(
--           i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--          ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--          ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--          ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--          ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--          ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--      END IF;
--    EXCEPTION
--      WHEN OTHERS THEN
--        -- メッセージ出力
--        lv_errmsg := xxccp_common_pkg.get_msg(
--                         iv_application  => cv_app_name              --アプリケーション短縮名
--                        ,iv_name         => cv_tkn_number_08         --メッセージコード
--                        ,iv_token_name1  => cv_tkn_table             --トークンコード1
--                        ,iv_token_value1 => cv_tab_samari            --トークン値1
--                        ,iv_token_name2  => cv_tkn_errmsg            --トークンコード２
--                        ,iv_token_value2 => SQLERRM                  --トークン値２
--        );
--        fnd_file.put_line(
--              which  => FND_FILE.LOG,
--              buff   => ''      || cv_lf ||     -- 空行の挿入
--                      lv_errmsg || cv_lf ||
--                       ''                         -- 空行の挿入
--        );
--        RAISE global_api_expt;
--    END;
--  -- カーソルクローズ
--  CLOSE ticket_data_cur;
--
    ln_sum_emp_num := 0;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 開始');
--
    FOR l_cur_rec IN get_base_data_cur
    LOOP
--
      sum_resources(
        iv_base_code => l_cur_rec.child_base_code
      );
--
      ln_sum_emp_num := ln_sum_emp_num + SQL%ROWCOUNT;
--
    END LOOP;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 終了（件数：' || ln_sum_emp_num || '）');
--
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 開始');
--
    sum_visit_sales;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
    SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（地区/部別）' || '≫';
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■ヘッダ部
    -- 対象部門を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,report_id                                 -- 帳票ＩＤ
      ,report_name                               -- 帳票タイトル
      ,output_date                               -- 出力日時
      ,year_month                                -- 基準年月
      ,operation_days                            -- 稼動日数
      ,operation_all_days                        -- 稼動可能日数
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,ROWNUM                               -- 帳票出力セット番号
           ,cn_line_kind1                        -- 帳票出力位置
           ,1                                    -- 行番
           ,cv_pkg_name                          -- 帳票ＩＤ
           ,lv_report_name                       -- 帳票タイトル
           ,SYSDATE                              -- 出力日時
           ,gd_year_month                        -- 基準年月
           ,gn_operation_days                    -- 稼動日数
           ,gn_operation_all_days                -- 稼動可能日数
           ,xabv.base_code                       -- 拠点コード（親）
           ,xabv.base_name                       -- 拠点名称（親）
    FROM    xxcso_aff_base_v2  xabv
    WHERE   xabv.base_code  = gv_base_code
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■明細部
    -- 対象部門内の全拠点をすべて抽出し、拠点内の営業員が
    -- 担当する顧客の売上／訪問計画（日別）、売上／訪問実績（日別）、
    -- 売上実績（他拠点納品分）（日別）、新規顧客軒数、
    -- 新規ＶＤ軒数、売上予算の合計を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,base_code                                 -- 拠点コード
      ,hub_name                                  -- 拠点名称
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind2                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.base_code                      -- 拠点コード
           ,(SELECT  xabv.base_name
             FROM    xxcso_aff_base_v2 xabv
             WHERE   xabv.base_code = inn_v.base_code
            )                                    -- 拠点名
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.plan_sales_amt                 -- 売上予算
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.up_base_code                      up_base_code
                    ,xrvsp.up_hub_name                       up_hub_name
                    ,xabv.under_base_code                    base_code
                    ,xabv.row_order                          row_order
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(
                       (CASE
                          WHEN (xdmp.sales_plan_rel_div = '1') THEN
                            xdmp.target_sales_total_amt
                          ELSE
                            xdmp.basic_sales_total_amt
                        END
                       )
                     )                                       plan_sales_amt
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan               xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                             ,xabv.row_order            row_order
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                            ,NULL                       row_order
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                                       xabv
                    ,xxcso_dept_monthly_plans                xdmp
                    ,(SELECT  xtrvp1.base_code                         base_code
                             ,SUM(xtrvp1.new_customer_num)             new_customer_num
                             ,SUM(xtrvp1.new_vendor_num)               new_vendor_num
                             ,SUM(xtrvp1.plan_sales_amt)               plan_sales_amt
                             ,SUM(xtrvp1.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                             ,SUM(xtrvp1.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                             ,SUM(xtrvp1.plan_vs_amt_1)                plan_vs_amt_1
                             ,SUM(xtrvp1.plan_vs_amt_2)                plan_vs_amt_2
                             ,SUM(xtrvp1.plan_vs_amt_3)                plan_vs_amt_3
                             ,SUM(xtrvp1.plan_vs_amt_4)                plan_vs_amt_4
                             ,SUM(xtrvp1.plan_vs_amt_5)                plan_vs_amt_5
                             ,SUM(xtrvp1.plan_vs_amt_6)                plan_vs_amt_6
                             ,SUM(xtrvp1.plan_vs_amt_7)                plan_vs_amt_7
                             ,SUM(xtrvp1.plan_vs_amt_8)                plan_vs_amt_8
                             ,SUM(xtrvp1.plan_vs_amt_9)                plan_vs_amt_9
                             ,SUM(xtrvp1.plan_vs_amt_10)               plan_vs_amt_10
                             ,SUM(xtrvp1.plan_vs_amt_11)               plan_vs_amt_11
                             ,SUM(xtrvp1.plan_vs_amt_12)               plan_vs_amt_12
                             ,SUM(xtrvp1.plan_vs_amt_13)               plan_vs_amt_13
                             ,SUM(xtrvp1.plan_vs_amt_14)               plan_vs_amt_14
                             ,SUM(xtrvp1.plan_vs_amt_15)               plan_vs_amt_15
                             ,SUM(xtrvp1.plan_vs_amt_16)               plan_vs_amt_16
                             ,SUM(xtrvp1.plan_vs_amt_17)               plan_vs_amt_17
                             ,SUM(xtrvp1.plan_vs_amt_18)               plan_vs_amt_18
                             ,SUM(xtrvp1.plan_vs_amt_19)               plan_vs_amt_19
                             ,SUM(xtrvp1.plan_vs_amt_20)               plan_vs_amt_20
                             ,SUM(xtrvp1.plan_vs_amt_21)               plan_vs_amt_21
                             ,SUM(xtrvp1.plan_vs_amt_22)               plan_vs_amt_22
                             ,SUM(xtrvp1.plan_vs_amt_23)               plan_vs_amt_23
                             ,SUM(xtrvp1.plan_vs_amt_24)               plan_vs_amt_24
                             ,SUM(xtrvp1.plan_vs_amt_25)               plan_vs_amt_25
                             ,SUM(xtrvp1.plan_vs_amt_26)               plan_vs_amt_26
                             ,SUM(xtrvp1.plan_vs_amt_27)               plan_vs_amt_27
                             ,SUM(xtrvp1.plan_vs_amt_28)               plan_vs_amt_28
                             ,SUM(xtrvp1.plan_vs_amt_29)               plan_vs_amt_29
                             ,SUM(xtrvp1.plan_vs_amt_30)               plan_vs_amt_30
                             ,SUM(xtrvp1.plan_vs_amt_31)               plan_vs_amt_31
                             ,SUM(xtrvp1.rslt_vs_amt_1)                rslt_vs_amt_1
                             ,SUM(xtrvp1.rslt_vs_amt_2)                rslt_vs_amt_2
                             ,SUM(xtrvp1.rslt_vs_amt_3)                rslt_vs_amt_3
                             ,SUM(xtrvp1.rslt_vs_amt_4)                rslt_vs_amt_4
                             ,SUM(xtrvp1.rslt_vs_amt_5)                rslt_vs_amt_5
                             ,SUM(xtrvp1.rslt_vs_amt_6)                rslt_vs_amt_6
                             ,SUM(xtrvp1.rslt_vs_amt_7)                rslt_vs_amt_7
                             ,SUM(xtrvp1.rslt_vs_amt_8)                rslt_vs_amt_8
                             ,SUM(xtrvp1.rslt_vs_amt_9)                rslt_vs_amt_9
                             ,SUM(xtrvp1.rslt_vs_amt_10)               rslt_vs_amt_10
                             ,SUM(xtrvp1.rslt_vs_amt_11)               rslt_vs_amt_11
                             ,SUM(xtrvp1.rslt_vs_amt_12)               rslt_vs_amt_12
                             ,SUM(xtrvp1.rslt_vs_amt_13)               rslt_vs_amt_13
                             ,SUM(xtrvp1.rslt_vs_amt_14)               rslt_vs_amt_14
                             ,SUM(xtrvp1.rslt_vs_amt_15)               rslt_vs_amt_15
                             ,SUM(xtrvp1.rslt_vs_amt_16)               rslt_vs_amt_16
                             ,SUM(xtrvp1.rslt_vs_amt_17)               rslt_vs_amt_17
                             ,SUM(xtrvp1.rslt_vs_amt_18)               rslt_vs_amt_18
                             ,SUM(xtrvp1.rslt_vs_amt_19)               rslt_vs_amt_19
                             ,SUM(xtrvp1.rslt_vs_amt_20)               rslt_vs_amt_20
                             ,SUM(xtrvp1.rslt_vs_amt_21)               rslt_vs_amt_21
                             ,SUM(xtrvp1.rslt_vs_amt_22)               rslt_vs_amt_22
                             ,SUM(xtrvp1.rslt_vs_amt_23)               rslt_vs_amt_23
                             ,SUM(xtrvp1.rslt_vs_amt_24)               rslt_vs_amt_24
                             ,SUM(xtrvp1.rslt_vs_amt_25)               rslt_vs_amt_25
                             ,SUM(xtrvp1.rslt_vs_amt_26)               rslt_vs_amt_26
                             ,SUM(xtrvp1.rslt_vs_amt_27)               rslt_vs_amt_27
                             ,SUM(xtrvp1.rslt_vs_amt_28)               rslt_vs_amt_28
                             ,SUM(xtrvp1.rslt_vs_amt_29)               rslt_vs_amt_29
                             ,SUM(xtrvp1.rslt_vs_amt_30)               rslt_vs_amt_30
                             ,SUM(xtrvp1.rslt_vs_amt_31)               rslt_vs_amt_31
                             ,SUM(xtrvp1.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                             ,SUM(xtrvp1.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                             ,SUM(xtrvp1.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                             ,SUM(xtrvp1.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                             ,SUM(xtrvp1.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                             ,SUM(xtrvp1.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                             ,SUM(xtrvp1.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                             ,SUM(xtrvp1.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                             ,SUM(xtrvp1.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                             ,SUM(xtrvp1.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                             ,SUM(xtrvp1.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                             ,SUM(xtrvp1.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                             ,SUM(xtrvp1.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                             ,SUM(xtrvp1.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                             ,SUM(xtrvp1.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                             ,SUM(xtrvp1.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                             ,SUM(xtrvp1.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                             ,SUM(xtrvp1.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                             ,SUM(xtrvp1.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                             ,SUM(xtrvp1.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                             ,SUM(xtrvp1.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                             ,SUM(xtrvp1.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                             ,SUM(xtrvp1.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                             ,SUM(xtrvp1.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                             ,SUM(xtrvp1.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                             ,SUM(xtrvp1.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                             ,SUM(xtrvp1.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                             ,SUM(xtrvp1.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                             ,SUM(xtrvp1.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                             ,SUM(xtrvp1.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                             ,SUM(xtrvp1.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
                      FROM    xxcso_tmp_rep_vs_plan  xtrvp1
                      GROUP BY xtrvp1.base_code
                     )                                      xtrvp
             WHERE    xrvsp.request_id         = cn_request_id
               AND    xrvsp.line_kind          = cn_line_kind1
               AND    xabv.base_code(+)        = xrvsp.up_base_code
               AND    xdmp.base_code(+)        = xabv.under_base_code
               AND    xdmp.year_month(+)       = gv_year_month
               AND    xtrvp.base_code(+)       = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
                      ,xabv.under_base_code
                      ,xabv.row_order
             ORDER BY  report_output_no
                      ,row_order
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部
    -- 対象拠点に所属する営業員の担当する顧客の
    -- 日別合計を一般計、自販機計で集計する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.up_base_code                      up_base_code
                    ,xrvsp.up_hub_name                       up_hub_name
                    ,xrvsp.gvm_type                          gvm_type
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan               xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                                       xabv
                    ,xxcso_tmp_rep_vs_plan                   xtrvp
             WHERE   xrvsp.request_id         = cn_request_id
               AND   xrvsp.line_kind          = cn_line_kind1
               AND   xabv.base_code(+)        = xrvsp.up_base_code
               AND   xtrvp.base_code(+)       = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
                      ,xrvsp.gvm_type
             ORDER BY  report_output_no
                      ,xrvsp.gvm_type
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部(補足)
    -- 売上－中計部で一般計、自販機計で０件だったグループの中計部を作成する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,gvm_type                                  -- 一般／自販機／ＭＣ
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,(SELECT  MAX(xrvsp3.line_num)
             FROM    xxcso_rep_visit_sale_plan  xrvsp3
             WHERE   xrvsp3.request_id = cn_request_id
               AND   xrvsp3.line_kind  = cn_line_kind3
            ) + ROWNUM                           -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
    FROM    (
             -- 一般計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.up_base_code                    up_base_code
                    ,xrvsp.up_hub_name                     up_hub_name
                    ,cv_gvm_g                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   xrvsp3.gvm_type               = cv_gvm_g
                     )
             UNION ALL
             -- 自販機計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.up_base_code                    up_base_code
                    ,xrvsp.up_hub_name                     up_hub_name
                    ,cv_gvm_v                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   xrvsp3.gvm_type               = cv_gvm_v
                     )
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－計部
    -- 対象拠点の新規顧客軒数、新規ＶＤ軒数、売上予算を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind4                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.plan_sales_amt                 -- 売上予算
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.up_base_code           up_base_code
                    ,xrvsp.up_hub_name            up_hub_name
                    ,SUM(
                       (CASE
                          WHEN (xdmp.sales_plan_rel_div = '1') THEN
                            xdmp.target_sales_total_amt
                          ELSE
                            xdmp.basic_sales_total_amt
                        END
                       )
                     )                            plan_sales_amt
                    ,SUM(xrvsp.new_customer_num)  new_customer_num
                    ,SUM(xrvsp.new_vendor_num)    new_vendor_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_dept_monthly_plans     xdmp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xdmp.base_code(+)            = xabv.under_base_code
               AND   xdmp.year_month(+)           = gv_year_month
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－中計部
    -- 対象拠点に所属する営業員の訪問計画／訪問実績（日別）を
    -- 一般計、自販機計、ＭＣ計で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,plan_vs_amt_1                             -- １日－訪問計画
      ,plan_vs_amt_2                             -- ２日－訪問計画
      ,plan_vs_amt_3                             -- ３日－訪問計画
      ,plan_vs_amt_4                             -- ４日－訪問計画
      ,plan_vs_amt_5                             -- ５日－訪問計画
      ,plan_vs_amt_6                             -- ６日－訪問計画
      ,plan_vs_amt_7                             -- ７日－訪問計画
      ,plan_vs_amt_8                             -- ８日－訪問計画
      ,plan_vs_amt_9                             -- ９日－訪問計画
      ,plan_vs_amt_10                            -- １０日－訪問計画
      ,plan_vs_amt_11                            -- １１日－訪問計画
      ,plan_vs_amt_12                            -- １２日－訪問計画
      ,plan_vs_amt_13                            -- １３日－訪問計画
      ,plan_vs_amt_14                            -- １４日－訪問計画
      ,plan_vs_amt_15                            -- １５日－訪問計画
      ,plan_vs_amt_16                            -- １６日－訪問計画
      ,plan_vs_amt_17                            -- １７日－訪問計画
      ,plan_vs_amt_18                            -- １８日－訪問計画
      ,plan_vs_amt_19                            -- １９日－訪問計画
      ,plan_vs_amt_20                            -- ２０日－訪問計画
      ,plan_vs_amt_21                            -- ２１日－訪問計画
      ,plan_vs_amt_22                            -- ２２日－訪問計画
      ,plan_vs_amt_23                            -- ２３日－訪問計画
      ,plan_vs_amt_24                            -- ２４日－訪問計画
      ,plan_vs_amt_25                            -- ２５日－訪問計画
      ,plan_vs_amt_26                            -- ２６日－訪問計画
      ,plan_vs_amt_27                            -- ２７日－訪問計画
      ,plan_vs_amt_28                            -- ２８日－訪問計画
      ,plan_vs_amt_29                            -- ２９日－訪問計画
      ,plan_vs_amt_30                            -- ３０日－訪問計画
      ,plan_vs_amt_31                            -- ３１日－訪問計画
      ,rslt_vs_amt_1                             -- １日－訪問実績
      ,rslt_vs_amt_2                             -- ２日－訪問実績
      ,rslt_vs_amt_3                             -- ３日－訪問実績
      ,rslt_vs_amt_4                             -- ４日－訪問実績
      ,rslt_vs_amt_5                             -- ５日－訪問実績
      ,rslt_vs_amt_6                             -- ６日－訪問実績
      ,rslt_vs_amt_7                             -- ７日－訪問実績
      ,rslt_vs_amt_8                             -- ８日－訪問実績
      ,rslt_vs_amt_9                             -- ９日－訪問実績
      ,rslt_vs_amt_10                            -- １０日－訪問実績
      ,rslt_vs_amt_11                            -- １１日－訪問実績
      ,rslt_vs_amt_12                            -- １２日－訪問実績
      ,rslt_vs_amt_13                            -- １３日－訪問実績
      ,rslt_vs_amt_14                            -- １４日－訪問実績
      ,rslt_vs_amt_15                            -- １５日－訪問実績
      ,rslt_vs_amt_16                            -- １６日－訪問実績
      ,rslt_vs_amt_17                            -- １７日－訪問実績
      ,rslt_vs_amt_18                            -- １８日－訪問実績
      ,rslt_vs_amt_19                            -- １９日－訪問実績
      ,rslt_vs_amt_20                            -- ２０日－訪問実績
      ,rslt_vs_amt_21                            -- ２１日－訪問実績
      ,rslt_vs_amt_22                            -- ２２日－訪問実績
      ,rslt_vs_amt_23                            -- ２３日－訪問実績
      ,rslt_vs_amt_24                            -- ２４日－訪問実績
      ,rslt_vs_amt_25                            -- ２５日－訪問実績
      ,rslt_vs_amt_26                            -- ２６日－訪問実績
      ,rslt_vs_amt_27                            -- ２７日－訪問実績
      ,rslt_vs_amt_28                            -- ２８日－訪問実績
      ,rslt_vs_amt_29                            -- ２９日－訪問実績
      ,rslt_vs_amt_30                            -- ３０日－訪問実績
      ,rslt_vs_amt_31                            -- ３１日－訪問実績
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind5                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,plan_vs_amt_1                        -- １日－訪問計画
           ,plan_vs_amt_2                        -- ２日－訪問計画
           ,plan_vs_amt_3                        -- ３日－訪問計画
           ,plan_vs_amt_4                        -- ４日－訪問計画
           ,plan_vs_amt_5                        -- ５日－訪問計画
           ,plan_vs_amt_6                        -- ６日－訪問計画
           ,plan_vs_amt_7                        -- ７日－訪問計画
           ,plan_vs_amt_8                        -- ８日－訪問計画
           ,plan_vs_amt_9                        -- ９日－訪問計画
           ,plan_vs_amt_10                       -- １０日－訪問計画
           ,plan_vs_amt_11                       -- １１日－訪問計画
           ,plan_vs_amt_12                       -- １２日－訪問計画
           ,plan_vs_amt_13                       -- １３日－訪問計画
           ,plan_vs_amt_14                       -- １４日－訪問計画
           ,plan_vs_amt_15                       -- １５日－訪問計画
           ,plan_vs_amt_16                       -- １６日－訪問計画
           ,plan_vs_amt_17                       -- １７日－訪問計画
           ,plan_vs_amt_18                       -- １８日－訪問計画
           ,plan_vs_amt_19                       -- １９日－訪問計画
           ,plan_vs_amt_20                       -- ２０日－訪問計画
           ,plan_vs_amt_21                       -- ２１日－訪問計画
           ,plan_vs_amt_22                       -- ２２日－訪問計画
           ,plan_vs_amt_23                       -- ２３日－訪問計画
           ,plan_vs_amt_24                       -- ２４日－訪問計画
           ,plan_vs_amt_25                       -- ２５日－訪問計画
           ,plan_vs_amt_26                       -- ２６日－訪問計画
           ,plan_vs_amt_27                       -- ２７日－訪問計画
           ,plan_vs_amt_28                       -- ２８日－訪問計画
           ,plan_vs_amt_29                       -- ２９日－訪問計画
           ,plan_vs_amt_30                       -- ３０日－訪問計画
           ,plan_vs_amt_31                       -- ３１日－訪問計画
           ,rslt_vs_amt_1                        -- １日－訪問実績
           ,rslt_vs_amt_2                        -- ２日－訪問実績
           ,rslt_vs_amt_3                        -- ３日－訪問実績
           ,rslt_vs_amt_4                        -- ４日－訪問実績
           ,rslt_vs_amt_5                        -- ５日－訪問実績
           ,rslt_vs_amt_6                        -- ６日－訪問実績
           ,rslt_vs_amt_7                        -- ７日－訪問実績
           ,rslt_vs_amt_8                        -- ８日－訪問実績
           ,rslt_vs_amt_9                        -- ９日－訪問実績
           ,rslt_vs_amt_10                       -- １０日－訪問実績
           ,rslt_vs_amt_11                       -- １１日－訪問実績
           ,rslt_vs_amt_12                       -- １２日－訪問実績
           ,rslt_vs_amt_13                       -- １３日－訪問実績
           ,rslt_vs_amt_14                       -- １４日－訪問実績
           ,rslt_vs_amt_15                       -- １５日－訪問実績
           ,rslt_vs_amt_16                       -- １６日－訪問実績
           ,rslt_vs_amt_17                       -- １７日－訪問実績
           ,rslt_vs_amt_18                       -- １８日－訪問実績
           ,rslt_vs_amt_19                       -- １９日－訪問実績
           ,rslt_vs_amt_20                       -- ２０日－訪問実績
           ,rslt_vs_amt_21                       -- ２１日－訪問実績
           ,rslt_vs_amt_22                       -- ２２日－訪問実績
           ,rslt_vs_amt_23                       -- ２３日－訪問実績
           ,rslt_vs_amt_24                       -- ２４日－訪問実績
           ,rslt_vs_amt_25                       -- ２５日－訪問実績
           ,rslt_vs_amt_26                       -- ２６日－訪問実績
           ,rslt_vs_amt_27                       -- ２７日－訪問実績
           ,rslt_vs_amt_28                       -- ２８日－訪問実績
           ,rslt_vs_amt_29                       -- ２９日－訪問実績
           ,rslt_vs_amt_30                       -- ３０日－訪問実績
           ,rslt_vs_amt_31                       -- ３１日－訪問実績
    FROM    (
             -------------------------------------------
             --一般計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.up_base_code                     up_base_code
                    ,xrvsp.up_hub_name                      up_hub_name
                    ,cv_gvm_g                               gvm_type
                    ,SUM(xtrvp.tgt_vis_i_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_i_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_i_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_i_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_i_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_i_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_i_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_i_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_i_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_i_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_i_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_i_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_i_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_i_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_i_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_i_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_i_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_i_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_i_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_i_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_i_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_i_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_i_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_i_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_i_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_i_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_i_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_i_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_i_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_i_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_i_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_i_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_i_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_i_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_i_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_i_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_i_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_i_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_i_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_i_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_i_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_i_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_i_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_i_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_i_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_i_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_i_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_i_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_i_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_i_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_i_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_i_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_i_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_i_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_i_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_i_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_i_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_i_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_i_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_i_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_i_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_i_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             UNION ALL
             -------------------------------------------
             -- 自販機計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.up_base_code                     up_base_code
                    ,xrvsp.up_hub_name                      up_hub_name
                    ,cv_gvm_v                               gvm_type
                    ,SUM(xtrvp.tgt_vis_v_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_v_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_v_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_v_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_v_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_v_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_v_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_v_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_v_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_v_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_v_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_v_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_v_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_v_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_v_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_v_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_v_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_v_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_v_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_v_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_v_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_v_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_v_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_v_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_v_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_v_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_v_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_v_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_v_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_v_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_v_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_v_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_v_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_v_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_v_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_v_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_v_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_v_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_v_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_v_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_v_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_v_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_v_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_v_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_v_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_v_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_v_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_v_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_v_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_v_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_v_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_v_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_v_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_v_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_v_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_v_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_v_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_v_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_v_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_v_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_v_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_v_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             UNION ALL
             -------------------------------------------
             -- ＭＣ計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.up_base_code           up_base_code
                    ,xrvsp.up_hub_name            up_hub_name
                    ,cv_gvm_m                     gvm_type
                    ,0                            plan_vs_amt_1
                    ,0                            plan_vs_amt_2
                    ,0                            plan_vs_amt_3
                    ,0                            plan_vs_amt_4
                    ,0                            plan_vs_amt_5
                    ,0                            plan_vs_amt_6
                    ,0                            plan_vs_amt_7
                    ,0                            plan_vs_amt_8
                    ,0                            plan_vs_amt_9
                    ,0                            plan_vs_amt_10
                    ,0                            plan_vs_amt_11
                    ,0                            plan_vs_amt_12
                    ,0                            plan_vs_amt_13
                    ,0                            plan_vs_amt_14
                    ,0                            plan_vs_amt_15
                    ,0                            plan_vs_amt_16
                    ,0                            plan_vs_amt_17
                    ,0                            plan_vs_amt_18
                    ,0                            plan_vs_amt_19
                    ,0                            plan_vs_amt_20
                    ,0                            plan_vs_amt_21
                    ,0                            plan_vs_amt_22
                    ,0                            plan_vs_amt_23
                    ,0                            plan_vs_amt_24
                    ,0                            plan_vs_amt_25
                    ,0                            plan_vs_amt_26
                    ,0                            plan_vs_amt_27
                    ,0                            plan_vs_amt_28
                    ,0                            plan_vs_amt_29
                    ,0                            plan_vs_amt_30
                    ,0                            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_m_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_m_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_m_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_m_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_m_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_m_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_m_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_m_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_m_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_m_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_m_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_m_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_m_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_m_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_m_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_m_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_m_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_m_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_m_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_m_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_m_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_m_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_m_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_m_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_m_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_m_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_m_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_m_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_m_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_m_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_m_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－有効訪問部
    -- 対象拠点に所属する営業員の有効訪問（日別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,effective_num_1                           -- １日－有効軒数
      ,effective_num_2                           -- ２日－有効軒数
      ,effective_num_3                           -- ３日－有効軒数
      ,effective_num_4                           -- ４日－有効軒数
      ,effective_num_5                           -- ５日－有効軒数
      ,effective_num_6                           -- ６日－有効軒数
      ,effective_num_7                           -- ７日－有効軒数
      ,effective_num_8                           -- ８日－有効軒数
      ,effective_num_9                           -- ９日－有効軒数
      ,effective_num_10                          -- １０日－有効軒数
      ,effective_num_11                          -- １１日－有効軒数
      ,effective_num_12                          -- １２日－有効軒数
      ,effective_num_13                          -- １３日－有効軒数
      ,effective_num_14                          -- １４日－有効軒数
      ,effective_num_15                          -- １５日－有効軒数
      ,effective_num_16                          -- １６日－有効軒数
      ,effective_num_17                          -- １７日－有効軒数
      ,effective_num_18                          -- １８日－有効軒数
      ,effective_num_19                          -- １９日－有効軒数
      ,effective_num_20                          -- ２０日－有効軒数
      ,effective_num_21                          -- ２１日－有効軒数
      ,effective_num_22                          -- ２２日－有効軒数
      ,effective_num_23                          -- ２３日－有効軒数
      ,effective_num_24                          -- ２４日－有効軒数
      ,effective_num_25                          -- ２５日－有効軒数
      ,effective_num_26                          -- ２６日－有効軒数
      ,effective_num_27                          -- ２７日－有効軒数
      ,effective_num_28                          -- ２８日－有効軒数
      ,effective_num_29                          -- ２９日－有効軒数
      ,effective_num_30                          -- ３０日－有効軒数
      ,effective_num_31                          -- ３１日－有効軒数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind6                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.effective_num_1                -- １日－有効軒数
           ,inn_v.effective_num_2                -- ２日－有効軒数
           ,inn_v.effective_num_3                -- ３日－有効軒数
           ,inn_v.effective_num_4                -- ４日－有効軒数
           ,inn_v.effective_num_5                -- ５日－有効軒数
           ,inn_v.effective_num_6                -- ６日－有効軒数
           ,inn_v.effective_num_7                -- ７日－有効軒数
           ,inn_v.effective_num_8                -- ８日－有効軒数
           ,inn_v.effective_num_9                -- ９日－有効軒数
           ,inn_v.effective_num_10               -- １０日－有効軒数
           ,inn_v.effective_num_11               -- １１日－有効軒数
           ,inn_v.effective_num_12               -- １２日－有効軒数
           ,inn_v.effective_num_13               -- １３日－有効軒数
           ,inn_v.effective_num_14               -- １４日－有効軒数
           ,inn_v.effective_num_15               -- １５日－有効軒数
           ,inn_v.effective_num_16               -- １６日－有効軒数
           ,inn_v.effective_num_17               -- １７日－有効軒数
           ,inn_v.effective_num_18               -- １８日－有効軒数
           ,inn_v.effective_num_19               -- １９日－有効軒数
           ,inn_v.effective_num_20               -- ２０日－有効軒数
           ,inn_v.effective_num_21               -- ２１日－有効軒数
           ,inn_v.effective_num_22               -- ２２日－有効軒数
           ,inn_v.effective_num_23               -- ２３日－有効軒数
           ,inn_v.effective_num_24               -- ２４日－有効軒数
           ,inn_v.effective_num_25               -- ２５日－有効軒数
           ,inn_v.effective_num_26               -- ２６日－有効軒数
           ,inn_v.effective_num_27               -- ２７日－有効軒数
           ,inn_v.effective_num_28               -- ２８日－有効軒数
           ,inn_v.effective_num_29               -- ２９日－有効軒数
           ,inn_v.effective_num_30               -- ３０日－有効軒数
           ,inn_v.effective_num_31               -- ３１日－有効軒数
    FROM    (
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.up_base_code                     up_base_code
                    ,xrvsp.up_hub_name                      up_hub_name
                    ,SUM(xtrvp.rslt_vis_e_num_1)            effective_num_1
                    ,SUM(xtrvp.rslt_vis_e_num_2)            effective_num_2
                    ,SUM(xtrvp.rslt_vis_e_num_3)            effective_num_3
                    ,SUM(xtrvp.rslt_vis_e_num_4)            effective_num_4
                    ,SUM(xtrvp.rslt_vis_e_num_5)            effective_num_5
                    ,SUM(xtrvp.rslt_vis_e_num_6)            effective_num_6
                    ,SUM(xtrvp.rslt_vis_e_num_7)            effective_num_7
                    ,SUM(xtrvp.rslt_vis_e_num_8)            effective_num_8
                    ,SUM(xtrvp.rslt_vis_e_num_9)            effective_num_9
                    ,SUM(xtrvp.rslt_vis_e_num_10)           effective_num_10
                    ,SUM(xtrvp.rslt_vis_e_num_11)           effective_num_11
                    ,SUM(xtrvp.rslt_vis_e_num_12)           effective_num_12
                    ,SUM(xtrvp.rslt_vis_e_num_13)           effective_num_13
                    ,SUM(xtrvp.rslt_vis_e_num_14)           effective_num_14
                    ,SUM(xtrvp.rslt_vis_e_num_15)           effective_num_15
                    ,SUM(xtrvp.rslt_vis_e_num_16)           effective_num_16
                    ,SUM(xtrvp.rslt_vis_e_num_17)           effective_num_17
                    ,SUM(xtrvp.rslt_vis_e_num_18)           effective_num_18
                    ,SUM(xtrvp.rslt_vis_e_num_19)           effective_num_19
                    ,SUM(xtrvp.rslt_vis_e_num_20)           effective_num_20
                    ,SUM(xtrvp.rslt_vis_e_num_21)           effective_num_21
                    ,SUM(xtrvp.rslt_vis_e_num_22)           effective_num_22
                    ,SUM(xtrvp.rslt_vis_e_num_23)           effective_num_23
                    ,SUM(xtrvp.rslt_vis_e_num_24)           effective_num_24
                    ,SUM(xtrvp.rslt_vis_e_num_25)           effective_num_25
                    ,SUM(xtrvp.rslt_vis_e_num_26)           effective_num_26
                    ,SUM(xtrvp.rslt_vis_e_num_27)           effective_num_27
                    ,SUM(xtrvp.rslt_vis_e_num_28)           effective_num_28
                    ,SUM(xtrvp.rslt_vis_e_num_29)           effective_num_29
                    ,SUM(xtrvp.rslt_vis_e_num_30)           effective_num_30
                    ,SUM(xtrvp.rslt_vis_e_num_31)           effective_num_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－明細部
    -- 対象拠点の訪問記号計（月別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,vis_a_num                                 -- 訪問Ａ件数
      ,vis_b_num                                 -- 訪問Ｂ件数
      ,vis_c_num                                 -- 訪問Ｃ件数
      ,vis_d_num                                 -- 訪問Ｄ件数
      ,vis_e_num                                 -- 訪問Ｅ件数
      ,vis_f_num                                 -- 訪問Ｆ件数
      ,vis_g_num                                 -- 訪問Ｇ件数
      ,vis_h_num                                 -- 訪問Ｈ件数
      ,vis_i_num                                 -- 訪問Ｉ件数
      ,vis_j_num                                 -- 訪問Ｊ件数
      ,vis_k_num                                 -- 訪問Ｋ件数
      ,vis_l_num                                 -- 訪問Ｌ件数
      ,vis_m_num                                 -- 訪問Ｍ件数
      ,vis_n_num                                 -- 訪問Ｎ件数
      ,vis_o_num                                 -- 訪問Ｏ件数
      ,vis_p_num                                 -- 訪問Ｐ件数
      ,vis_q_num                                 -- 訪問Ｑ件数
      ,vis_r_num                                 -- 訪問Ｒ件数
      ,vis_s_num                                 -- 訪問Ｓ件数
      ,vis_t_num                                 -- 訪問Ｔ件数
      ,vis_u_num                                 -- 訪問Ｕ件数
      ,vis_v_num                                 -- 訪問Ｖ件数
      ,vis_w_num                                 -- 訪問Ｗ件数
      ,vis_x_num                                 -- 訪問Ｘ件数
      ,vis_y_num                                 -- 訪問Ｙ件数
      ,vis_z_num                                 -- 訪問Ｚ件数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind7                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.vis_a_num                      -- 訪問Ａ件数
           ,inn_v.vis_b_num                      -- 訪問Ｂ件数
           ,inn_v.vis_c_num                      -- 訪問Ｃ件数
           ,inn_v.vis_d_num                      -- 訪問Ｄ件数
           ,inn_v.vis_e_num                      -- 訪問Ｅ件数
           ,inn_v.vis_f_num                      -- 訪問Ｆ件数
           ,inn_v.vis_g_num                      -- 訪問Ｇ件数
           ,inn_v.vis_h_num                      -- 訪問Ｈ件数
           ,inn_v.vis_i_num                      -- 訪問Ｉ件数
           ,inn_v.vis_j_num                      -- 訪問Ｊ件数
           ,inn_v.vis_k_num                      -- 訪問Ｋ件数
           ,inn_v.vis_l_num                      -- 訪問Ｌ件数
           ,inn_v.vis_m_num                      -- 訪問Ｍ件数
           ,inn_v.vis_n_num                      -- 訪問Ｎ件数
           ,inn_v.vis_o_num                      -- 訪問Ｏ件数
           ,inn_v.vis_p_num                      -- 訪問Ｐ件数
           ,inn_v.vis_q_num                      -- 訪問Ｑ件数
           ,inn_v.vis_r_num                      -- 訪問Ｒ件数
           ,inn_v.vis_s_num                      -- 訪問Ｓ件数
           ,inn_v.vis_t_num                      -- 訪問Ｔ件数
           ,inn_v.vis_u_num                      -- 訪問Ｕ件数
           ,inn_v.vis_v_num                      -- 訪問Ｖ件数
           ,inn_v.vis_w_num                      -- 訪問Ｗ件数
           ,inn_v.vis_x_num                      -- 訪問Ｘ件数
           ,inn_v.vis_y_num                      -- 訪問Ｙ件数
           ,inn_v.vis_z_num                      -- 訪問Ｚ件数
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.up_base_code           up_base_code
                    ,xrvsp.up_hub_name            up_hub_name
                    ,SUM(xsvsr.vis_a_num)         vis_a_num
                    ,SUM(xsvsr.vis_b_num)         vis_b_num
                    ,SUM(xsvsr.vis_c_num)         vis_c_num
                    ,SUM(xsvsr.vis_d_num)         vis_d_num
                    ,SUM(xsvsr.vis_e_num)         vis_e_num
                    ,SUM(xsvsr.vis_f_num)         vis_f_num
                    ,SUM(xsvsr.vis_g_num)         vis_g_num
                    ,SUM(xsvsr.vis_h_num)         vis_h_num
                    ,SUM(xsvsr.vis_i_num)         vis_i_num
                    ,SUM(xsvsr.vis_j_num)         vis_j_num
                    ,SUM(xsvsr.vis_k_num)         vis_k_num
                    ,SUM(xsvsr.vis_l_num)         vis_l_num
                    ,SUM(xsvsr.vis_m_num)         vis_m_num
                    ,SUM(xsvsr.vis_n_num)         vis_n_num
                    ,SUM(xsvsr.vis_o_num)         vis_o_num
                    ,SUM(xsvsr.vis_p_num)         vis_p_num
                    ,SUM(xsvsr.vis_q_num)         vis_q_num
                    ,SUM(xsvsr.vis_r_num)         vis_r_num
                    ,SUM(xsvsr.vis_s_num)         vis_s_num
                    ,SUM(xsvsr.vis_t_num)         vis_t_num
                    ,SUM(xsvsr.vis_u_num)         vis_u_num
                    ,SUM(xsvsr.vis_v_num)         vis_v_num
                    ,SUM(xsvsr.vis_w_num)         vis_w_num
                    ,SUM(xsvsr.vis_x_num)         vis_x_num
                    ,SUM(xsvsr.vis_y_num)         vis_y_num
                    ,SUM(xsvsr.vis_z_num)         vis_z_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                             ,xxcso_aff_base_v2         xabv
                      WHERE   xabv.base_code    = xablv.child_base_code
                        AND   xabv.summary_flag = cv_flg_n
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
                    ,xxcso_sum_visit_sale_rep     xsvsr
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
               AND   xsvsr.sum_org_type(+)        = cv_sum_org_type1
               AND   xsvsr.sum_org_code(+)        = xtrvp.account_number
               AND   xsvsr.group_base_code(+)     = xtrvp.base_code
               AND   xsvsr.month_date_div(+)      = cv_month_date_div1
               AND   xsvsr.sales_date(+)          = gv_year_month
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1029 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END get_ticket4;
--
  /**********************************************************************************
   * Procedure Name   : up_plsql_tab5
   * Description      : 帳票種別5-地域営業本部別別-PLSQL表の更新 (A-7-3)
  ***********************************************************************************/
  PROCEDURE up_plsql_tab5(
     i_month_square_rec  IN               g_month_rtype5                     -- 一ヶ月分データ
    ,in_m_cnt            IN               NUMBER                             -- 明細部のカウンタ
    ,io_m_tab            IN OUT NOCOPY    g_get_month_square_ttype           -- 明細部配列
    ,io_hon_tab          IN OUT NOCOPY    g_get_month_square_ttype           -- 本体部配列
    ,ov_errbuf           OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'up_plsql_tab5';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
    lv_gvm_type           VARCHAR2(1);                                       -- 一般／自販機／ＭＣ
    ln_m_cnt              NUMBER(9);                                         -- INパラメータを格納
    BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
      ln_m_cnt                            := in_m_cnt;                       -- INパラメータを格納
      -- DEBUGメッセージ
      -- PL/SQL表の更新
      debug(
         buff   => '地域営業本部-PL/SQL表の更新処理:' || TO_CHAR(ln_m_cnt)
      );
      BEGIN
        -- 売り上げ明細部
        io_m_tab(ln_m_cnt).up_base_code     := i_month_square_rec.base_code_par;       -- 拠点コード（親)
        io_m_tab(ln_m_cnt).up_hub_name      := i_month_square_rec.base_name_par;       -- 拠点名称（親）
        io_m_tab(ln_m_cnt).base_code        := i_month_square_rec.base_code_chi;       -- 業務地拠点コード
        io_m_tab(ln_m_cnt).hub_name         := i_month_square_rec.base_name_chi;       -- 業務地拠点名
        io_m_tab(ln_m_cnt).last_year_rslt_sales_amt :=i_month_square_rec.rslt_amty; -- 前年実績
        io_m_tab(ln_m_cnt).last_mon_rslt_sales_amt  :=i_month_square_rec.rslt_amtm; -- 先月実績
        io_m_tab(ln_m_cnt).new_customer_num :=i_month_square_rec.cust_new_num;      -- 顧客件数
        io_m_tab(ln_m_cnt).new_vendor_num   :=i_month_square_rec.cust_vd_new_num;   -- 顧客件数（VD 新規）
        io_m_tab(ln_m_cnt).plan_sales_amt   := i_month_square_rec.tgt_sales_prsn_total_amt;  -- 月別売上予算
        -- DEBUGメッセージ
        -- PL/SQL表の更新
        debug(
           buff   => '地域営業本部-PL/SQL表の更新処理' || '売り上げ明細部固定部完了'
        );
      EXCEPTION
        WHEN OTHERS THEN
          fnd_file.put_line(
           which  => FND_FILE.LOG,
           buff   => '地域営業本部-PL/SQL表の更新処理失敗:' || SQLERRM
          );
          RAISE global_api_others_expt;
      END;
      -- 本体部
      <<get_hontai_loop>>
      FOR i IN 1..cn_idx_max LOOP
        IF(i = cn_idx_sales_ippn) THEN         --売り上げ中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
        ELSIF(i = cn_idx_sales_vd) THEN      --売り上げ中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
        ELSIF(i = cn_idx_sales_sum) THEN      -- 売り上げ合計部
          NULL;
        ELSIF(i=cn_idx_visit_ippn)THEN       --訪問中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_g;                              -- 一般
        ELSIF(i=cn_idx_visit_vd)THEN       --訪問中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_v;                              -- 自販機
        ELSIF(i=cn_idx_visit_mc)THEN       --訪問中計部
          io_hon_tab(i).gvm_type                 := cv_gvm_m;                              -- MC
        END IF;
        io_hon_tab(i).up_base_code   := i_month_square_rec.base_code_par;  -- 拠点コード（親)
        io_hon_tab(i).up_hub_name    := i_month_square_rec.base_name_par;  -- 拠点名称（親）
      END LOOP get_hontai_loop;
--
      -- 売上中計部(一般)
      io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_ippn).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amty, 0);    -- 前年実績
      io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt  :=
        io_hon_tab(cn_idx_sales_ippn).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_other_amtm, 0);    -- 先月実績
      io_hon_tab(cn_idx_sales_ippn).new_customer_num :=
        io_hon_tab(cn_idx_sales_ippn).new_customer_num +
        NVL(i_month_square_rec.cust_other_new_num, 0); -- 顧客件数（新規）（一般）
      -- 売上中計部(自販機)
      io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_year_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amty, 0);       -- 前年実績
      io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt :=
        io_hon_tab(cn_idx_sales_vd).last_mon_rslt_sales_amt +
        NVL(i_month_square_rec.rslt_vd_amtm, 0);       -- 先月実績
      io_hon_tab(cn_idx_sales_vd).new_customer_num :=
        io_hon_tab(cn_idx_sales_vd).new_customer_num +
        NVL(i_month_square_rec.cust_vd_new_num, 0);    -- 顧客件数（新規）(自販機)
--
      <<get_all_day_data_loop>>
      FOR i IN 1..31 LOOP
        BEGIN
          -- DEBUGメッセージ
            -- PL/SQL表の更新
            debug(
               buff   => '地域営業本部-PL/SQL表の更新処理' || '1ヶ月分のデータ更新'
            );
          -- 売り上げ明細部
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_vs_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_amt;                 -- 売り上げ実績
          io_m_tab(ln_m_cnt).l_get_one_day_tab(i).rslt_other_sales_amt
            := i_month_square_rec.l_one_day_tab(i).rslt_center_amt;          -- 内他拠点＿売上実績
          -- 売り上げ中計部(一般)
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_other_amt,0);       -- 売上実績,訪問実績
          io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_other_sales_amt :=
            io_hon_tab(cn_idx_sales_ippn).l_get_one_day_tab(i).rslt_other_sales_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_center_other_amt,0);-- 内他拠点＿売上実績
          -- 売り上げ中計部(自販機)
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_vd_amt,0);          -- 売上実績,訪問実績
          io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_other_sales_amt :=
            io_hon_tab(cn_idx_sales_vd).l_get_one_day_tab(i).rslt_other_sales_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).rslt_center_vd_amt,0);   -- 内他拠点＿売上実績
          -- 売り上げ合計部
          -- 訪問中計部(一般)
          io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_ippn).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_other_num,0);        -- 売上実績,訪問実績
          -- 訪問中計部(自販機)
          io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_vd).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_vd_num,0);           -- 売上実績,訪問実績
          -- 訪問中計部(MC)
          io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt :=
            io_hon_tab(cn_idx_visit_mc).l_get_one_day_tab(i).rslt_vs_amt +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_mc_num,0);            -- 売上実績,訪問実績
          -- 訪問合計部
          io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num :=
            io_hon_tab(cn_idx_visit_sum).l_get_one_day_tab(i).effective_num +
            NVL(i_month_square_rec.l_one_day_tab(i).vis_sales_num,0);        -- 有効軒数
          -- 訪問内容合計部
          io_hon_tab(cn_idx_visit_dsc).vis_a_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_a_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_a_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_b_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_b_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_b_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_c_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_c_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_c_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_d_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_d_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_d_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_e_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_e_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_e_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_f_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_f_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_f_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_g_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_g_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_g_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_h_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_h_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_h_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_i_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_i_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_i_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_j_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_j_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_j_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_k_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_k_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_k_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_l_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_l_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_l_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_m_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_m_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_m_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_n_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_n_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_n_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_o_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_o_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_o_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_p_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_p_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_p_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_q_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_q_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_q_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_r_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_r_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_r_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_s_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_s_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_s_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_t_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_t_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_t_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_u_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_u_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_u_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_v_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_v_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_v_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_w_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_w_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_w_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_x_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_x_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_x_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_y_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_y_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_y_num,0);
          io_hon_tab(cn_idx_visit_dsc).vis_z_num :=
             io_hon_tab(cn_idx_visit_dsc).vis_z_num + NVL(i_month_square_rec.l_one_day_tab(i).vis_z_num,0);
        EXCEPTION
          WHEN OTHERS THEN
          fnd_file.put_line(
             which  => FND_FILE.LOG,
             buff   => '地域営業本部-PL/SQL表-本体部の更新処理でエラーになりました。' || SQLERRM ||
                      ''                         -- 空行の挿入
          );
          RAISE global_api_others_expt;
        END;
      END LOOP get_all_day_data_loop;
    EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
      -- *** 共通関数例外ハンドラ ***
      WHEN global_api_expt THEN
        ov_errmsg  := lv_errmsg;
        ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
        ov_retcode := cv_status_error;
      -- *** 共通関数OTHERS例外ハンドラ ***
      WHEN global_api_others_expt THEN
        ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
        ov_retcode := cv_status_error;
      -- *** OTHERS例外ハンドラ ***
      WHEN OTHERS THEN
        ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
        ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END up_plsql_tab5;
--
  /**********************************************************************************
   * Procedure Name   : get_ticket5
   * Description      : 帳票種別5-地域営業本部別 (A-7-1,A-7-2)
  ***********************************************************************************/
  PROCEDURE get_ticket5(
    ov_errbuf         OUT NOCOPY VARCHAR2           -- エラー・メッセージ            --# 固定 #
   ,ov_retcode        OUT NOCOPY VARCHAR2           -- リターン・コード              --# 固定 #
   ,ov_errmsg         OUT NOCOPY VARCHAR2           -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
  -- ===============================
  -- 固定ローカル定数
  -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'get_ticket5';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1031 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--  -- ローカル定数
--  -- ローカル変数
--  lb_boolean            BOOLEAN;      -- 判断用
--  ln_m_cnt              NUMBER(9);    -- 明細部カウンター数格納
--  ln_cnt                NUMBER(9);    -- 抽出されたレコード件数
--  ln_date               NUMBER(2);    -- 日付のナンバー型
--  ln_report_output_no   NUMBER(9);    -- 帳票出力セット番号
--  lv_bf_base_code_par   xxcso_aff_base_level_v.base_code%TYPE;
--  lv_bf_base_code_chi   xxcso_aff_base_level_v.child_base_code%TYPE;
--  -- *** ローカル・カーソル ***
--  CURSOR ticket_data_cur
--  IS
--    SELECT
--            xablv.base_code             base_code_par,          -- 勤務地拠点コード(親)(拠点コード)
--            xabvpar.base_name           base_name_par,          -- 勤務地拠点名(親)
--            xablv.child_base_code       base_code_chi,          -- 勤務地拠点コード
--            xabvchi.base_name           base_name_chi,          -- 勤務地拠点名
--            xsvsr.sales_date            sales_date,             -- 販売年月日
--            xsvsr.rslt_amt              rslt_amt,               -- 売上実績
--            xsvsr.rslt_new_amt          rslt_new_amt,           -- 売上実績（新規）
--            xsvsr.rslt_vd_new_amt       rslt_vd_new_amt,        -- 売上実績（VD：新規）
--            xsvsr.rslt_vd_amt           rslt_vd_amt,            -- 売上実績（VD）
--            xsvsr.rslt_other_new_amt    rslt_other_new_amt,     -- 売上実績（VD以外：新規）
--            xsvsr.rslt_other_amt        rslt_other_amt,         -- 売上実績（VD以外）
--            xsvsr.rslt_center_amt       rslt_center_amt,        -- 内他拠点＿売上実績
--            xsvsr.rslt_center_vd_amt    rslt_center_vd_amt,     -- 内他拠点＿売上実績（VD）
--            xsvsr.rslt_center_other_amt rslt_center_other_amt,  -- 内他拠点＿売上実績（VD以外）
--            xsvsr.vis_num               vis_num,                -- 訪問実績
--            xsvsr.vis_new_num           vis_new_num,            -- 訪問実績（新規）
--            xsvsr.vis_vd_new_num        vis_vd_new_num,         -- 訪問実績（VD：新規）
--            xsvsr.vis_vd_num            vis_vd_num,             -- 訪問実績（VD）
--            xsvsr.vis_other_new_num     vis_other_new_num,      -- 訪問実績（VD以外：新規）
--            xsvsr.vis_other_num         vis_other_num,          -- 訪問実績（VD以外）
--            xsvsr.vis_mc_num            vis_mc_num,             -- 訪問実績（MC）
--            xsvsr.vis_sales_num         vis_sales_num,          -- 有効軒数
--            xsvsr.vis_a_num             vis_a_num,              -- 訪問Ａ件数
--            xsvsr.vis_b_num             vis_b_num,              -- 訪問Ｂ件数
--            xsvsr.vis_c_num             vis_c_num,              -- 訪問Ｃ件数
--            xsvsr.vis_d_num             vis_d_num,              -- 訪問Ｄ件数
--            xsvsr.vis_e_num             vis_e_num,              -- 訪問Ｅ件数
--            xsvsr.vis_f_num             vis_f_num,              -- 訪問Ｆ件数
--            xsvsr.vis_g_num             vis_g_num,              -- 訪問Ｇ件数
--            xsvsr.vis_h_num             vis_h_num,              -- 訪問Ｈ件数
--            xsvsr.vis_i_num             vis_i_num,              -- 訪問ⅰ件数
--            xsvsr.vis_j_num             vis_j_num,              -- 訪問Ｊ件数
--            xsvsr.vis_k_num             vis_k_num,              -- 訪問Ｋ件数
--            xsvsr.vis_l_num             vis_l_num,              -- 訪問Ｌ件数
--            xsvsr.vis_m_num             vis_m_num,              -- 訪問Ｍ件数
--            xsvsr.vis_n_num             vis_n_num,              -- 訪問Ｎ件数
--            xsvsr.vis_o_num             vis_o_num,              -- 訪問Ｏ件数
--            xsvsr.vis_p_num             vis_p_num,              -- 訪問Ｐ件数
--            xsvsr.vis_q_num             vis_q_num,              -- 訪問Ｑ件数
--            xsvsr.vis_r_num             vis_r_num,              -- 訪問Ｒ件数
--            xsvsr.vis_s_num             vis_s_num,              -- 訪問Ｓ件数
--            xsvsr.vis_t_num             vis_t_num,              -- 訪問Ｔ件数
--            xsvsr.vis_u_num             vis_u_num,              -- 訪問Ｕ件数
--            xsvsr.vis_v_num             vis_v_num,              -- 訪問Ｖ件数
--            xsvsr.vis_w_num             vis_w_num,              -- 訪問Ｗ件数
--            xsvsr.vis_x_num             vis_x_num,              -- 訪問Ｘ件数
--            xsvsr.vis_y_num             vis_y_num,              -- 訪問Ｙ件数
--            xsvsr.vis_z_num             vis_z_num,              -- 訪問Ｚ件数
--            xsvsry.rslt_amt             rslt_amty,              -- 前年実績
--            xsvsry.rslt_vd_amt          rslt_vd_amty,           -- 前年実績（VD）
--            xsvsry.rslt_other_amt       rslt_other_amty,        -- 前年実績（VD以外）
--            xsvsrm.rslt_amt             rslt_amtm,              -- 先月実績
--            xsvsrm.rslt_vd_amt          rslt_vd_amtm,           -- 先月実績（VD）
--            xsvsrm.rslt_other_amt       rslt_other_amtm,        -- 先月実績（VD以外）
--            xsvsrn.cust_new_num         cust_new_num,           -- 顧客件数（新規）
--            xsvsrn.cust_vd_new_num      cust_vd_new_num,        -- 顧客件数（VD：新規）
--            xsvsrn.cust_other_new_num   cust_other_new_num,     -- 顧客件数（VD以外：新規）
--            xsvsrn.tgt_sales_prsn_total_amt  tgt_sales_prsn_total_amt  -- 月別売上予算
--    FROM    xxcso_aff_base_level_v      xablv         -- AFF部門階層マスタビュー
--           ,xxcso_aff_base_v2           xabvpar       -- AFF部門マスタ（最新）ビュー(親)
--           ,xxcso_aff_base_v2           xabvchi       -- AFF部門マスタ（最新）ビュー(子)
--           ,xxcso_sum_visit_sale_rep    xsvsr         -- 訪問売上計画管理表サマリテーブル
--           ,xxcso_sum_visit_sale_rep    xsvsry        -- 訪問売上計画管理表サマリ前年
--           ,xxcso_sum_visit_sale_rep    xsvsrm        -- 訪問売上計画管理表サマリ先月
--           ,xxcso_sum_visit_sale_rep    xsvsrn        -- 訪問売上計画管理表サマリ当月
--    WHERE   xablv.base_code = gv_base_code
--      /* 20090427_abe_売上計画出力対応 START*/
--      AND   xablv.child_base_code = xsvsr.sum_org_code(+)
--      AND   xablv.base_code = xabvpar.base_code(+)
--      AND   xablv.child_base_code = xabvchi.base_code(+)
--      AND   xsvsr.sum_org_type(+) = cv_sum_org_type5
--      AND   xsvsr.month_date_div(+) = cv_month_date_div2
--      AND   xsvsr.sales_date(+)
--              BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      --AND   xablv.child_base_code = xsvsr.sum_org_code
--      --AND   xablv.base_code = xabvpar.base_code
--      --AND   xablv.child_base_code = xabvchi.base_code
--      --AND   xsvsr.sum_org_type = cv_sum_org_type5
--      --AND   xsvsr.month_date_div = cv_month_date_div2
--      --AND   xsvsr.sales_date
--      --        BETWEEN TO_CHAR(gd_year_month_day,'YYYYMMDD') AND TO_CHAR(gd_year_month_lastday,'YYYYMMDD')
--      /* 20090427_abe_売上計画出力対応 END*/
--      AND   xsvsr.sum_org_type   = xsvsry.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsry.sum_org_code(+)
--      AND   xsvsry.month_date_div(+)= cv_month_date_div1
--      AND   xsvsry.sales_date(+) = gv_year_prev
--      AND   xsvsr.sum_org_type   = xsvsrm.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrm.sum_org_code(+)
--      AND   xsvsrm.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrm.sales_date(+) = gv_year_month_prev
--      AND   xsvsr.sum_org_type   = xsvsrn.sum_org_type(+)
--      AND   xsvsr.sum_org_code   = xsvsrn.sum_org_code(+)
--      AND   xsvsrn.month_date_div(+)= cv_month_date_div1
--      AND   xsvsrn.sales_date(+) = gv_year_month
--    /* 20090427_abe_売上計画出力対応 START*/
--    ORDER BY  xabvchi.row_order   ASC;
--    --ORDER BY  base_code_chi     ASC;
--    /* 20090427_abe_売上計画出力対応 END*/
--  -- ローカルレコード
--  -- 帳票変数格納用
--  l_cur_rec                  ticket_data_cur%ROWTYPE;
--  l_month_square_rec         g_month_rtype5;
--  l_get_month_square_tab     g_get_month_square_ttype;
--  l_get_month_square_hon_tab g_get_month_square_ttype;
--
--  CURSOR get_base_data_cur
--  IS
--    SELECT  xablv.child_base_code    child_base_code
--    FROM    xxcso_aff_base_level_v2  xablv
--    START WITH
--            xablv.base_code       = gv_base_code
--    CONNECT BY PRIOR
--            xablv.child_base_code = xablv.base_code
--    UNION ALL
--    SELECT  xabv.base_code           child_base_code
--    FROM    xxcso_aff_base_v2        xabv
--    WHERE   xabv.base_code        = gv_base_code
--    AND     NOT EXISTS(
--              SELECT  1
--              FROM    xxcso_aff_base_level_v2  xablv1
--              WHERE   xablv1.base_code = xabv.base_code
--            )
--    ;
--
--
    -- 配下部門取得カーソル
    CURSOR get_under_base_data_cur
    IS
      SELECT  xablv.child_base_code    child_base_code
      FROM    xxcso_aff_base_level_v2  xablv
      START WITH
              xablv.base_code       = gv_base_code
      CONNECT BY PRIOR
              xablv.child_base_code = xablv.base_code
      UNION ALL
      SELECT  xabv.base_code           child_base_code
      FROM    xxcso_aff_base_v2        xabv
      WHERE   xabv.base_code        = gv_base_code
      AND     NOT EXISTS (
                SELECT  1
                FROM    xxcso_aff_base_level_v2  xablv1
                WHERE   xablv1.base_code = xabv.base_code
              )
      ;
--
    -- 直下部門取得カーソル
    CURSOR get_child_base_data_cur
    IS
      SELECT  xablv.base_code          base_code
             ,xablv.child_base_code    child_base_code
             ,xabv.row_order           row_order
      FROM    xxcso_aff_base_level_v2  xablv
             ,xxcso_aff_base_v2        xabv
      WHERE   xablv.base_code = gv_base_code
        AND   xabv.base_code  = xablv.child_base_code
      UNION ALL
      SELECT  gv_base_code             base_code
             ,gv_base_code             child_base_code
             ,NULL                     row_order
      FROM    DUAL
      WHERE   NOT EXISTS (
                SELECT  1
                FROM    xxcso_aff_base_level_v2  xablv1
                WHERE   xablv1.base_code = gv_base_code
              )
      ORDER BY  row_order
               ,child_base_code
    ;
--
    ln_sum_emp_num             NUMBER;
    ln_line_num                NUMBER;
    lv_report_name             xxcso_rep_visit_sale_plan.report_name%TYPE;   -- 帳票タイトル
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1031 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
/* 20090519_Ogawa_T1_1021 START*/
/* 20090519_Ogawa_T1_1024 START*/
/* 20090519_Ogawa_T1_1031 START*/
/* 20090519_Ogawa_T1_1033 START*/
/* 20090519_Ogawa_T1_1037 START*/
/* 20090519_Ogawa_T1_1056 START*/
--    -- ローカル変数初期化
--    lb_boolean                := TRUE;        -- 初期処理判断
--    ln_m_cnt                  := 1;           -- 明細部の行数
--    ln_report_output_no       := 1;           -- 配列行数
--    ln_cnt                    := 0;           -- LOOP件数
--    -- PL/SQL表（本体部）の初期化
--    init_month_square_hon_tab(l_get_month_square_hon_tab);
--    -- ローカルレコードの初期化
--    init_month_square_rec5(l_month_square_rec);
--    BEGIN
--    --カーソルオープン
--    OPEN ticket_data_cur;
--
--DO_ERROR('A-7-2-1');
--
--    <<get_data_loop>>
--    LOOP
--        l_cur_rec                           := NULL;          -- カーソルレコードの初期化
--
--        FETCH ticket_data_cur INTO l_cur_rec;                 -- カーソルのデータをレコードに格納
--
--      -- 対象件数がO件の場合
--      EXIT WHEN ticket_data_cur%NOTFOUND
--        OR  ticket_data_cur%ROWCOUNT = 0;
--
--DO_ERROR('A-7-2-2');
--
--        debug(
--          buff   => l_cur_rec.base_code_par                         ||','||
--                    l_cur_rec.base_name_par                         ||','||
--                    l_cur_rec.base_code_chi                         ||','||
--                    l_cur_rec.base_name_chi                         ||','||
--                    l_cur_rec.sales_date                            ||','||
--                    TO_CHAR(l_cur_rec.rslt_amt)                     ||','||
--                    TO_CHAR(l_cur_rec.rslt_new_amt)                 ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_new_amt)              ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amt)                  ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_new_amt)           ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amt)               ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_amt)              ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_vd_amt)           ||','||
--                    TO_CHAR(l_cur_rec.rslt_center_other_amt)        ||','||
--                    TO_CHAR(l_cur_rec.vis_num)                      ||','||
--                    TO_CHAR(l_cur_rec.vis_new_num)                  ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_new_num)               ||','||
--                    TO_CHAR(l_cur_rec.vis_vd_num)                   ||','||
--                    TO_CHAR(l_cur_rec.vis_other_new_num)            ||','||
--                    TO_CHAR(l_cur_rec.vis_other_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_mc_num)                   ||','||
--                    TO_CHAR(l_cur_rec.vis_sales_num)                ||','||
--                    TO_CHAR(l_cur_rec.vis_a_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_b_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_c_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_d_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_e_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_f_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_g_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_h_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_i_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_j_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_k_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_l_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_m_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_n_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_o_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_p_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_q_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_r_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_s_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_t_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_u_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_v_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_w_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_x_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_y_num)                    ||','||
--                    TO_CHAR(l_cur_rec.vis_z_num)                    ||','||
--                    TO_CHAR(l_cur_rec.rslt_amty)                    ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amty)                 ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amty)              ||','||
--                    TO_CHAR(l_cur_rec.rslt_amtm)                    ||','||
--                    TO_CHAR(l_cur_rec.rslt_vd_amtm)                 ||','||
--                    TO_CHAR(l_cur_rec.rslt_other_amtm)              ||','||
--                    TO_CHAR(l_cur_rec.cust_new_num)                 ||','||
--                    TO_CHAR(l_cur_rec.cust_vd_new_num)              ||','||
--                    TO_CHAR(l_cur_rec.cust_other_new_num)           ||','||
--                    TO_CHAR(l_cur_rec.tgt_sales_prsn_total_amt)     ||','||
--                   cv_lf
--        );
--        -- 前回レコードと拠点コードが同じで業務地コードが違う場合、明細部配列と本体部配列を更新。
--        IF(lb_boolean=FALSE) THEN
--          IF((lv_bf_base_code_par = l_cur_rec.base_code_par)AND(lv_bf_base_code_chi <> l_cur_rec.base_code_chi))
--            THEN
--            -- DEBUGメッセージ
--            debug(
--               buff   => '業務地コードが違います。 :' ||'前回： '|| lv_bf_base_code_chi ||
--                          '今回：' || l_cur_rec.base_code_chi ||
--                          '明細部配列' || TO_CHAR(ln_m_cnt)
--            );
--            -- =================================================
--            -- A-7-2,A-7-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab5(
--               i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;
--            l_month_square_rec     := NULL;
--            init_month_square_rec5(l_month_square_rec);
--            ln_m_cnt          := ln_m_cnt + 1;       -- 明細部配列を＋１する。
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          ELSIF(lv_bf_base_code_par <> l_cur_rec.base_code_par) THEN
--            -- =================================================
--            -- A-7-2,A-7-3.PLSQL表の更新
--            -- =================================================
--            up_plsql_tab5(
--               i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--              ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--              ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--              ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--              ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--              ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--              ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--            );
--            IF (lv_retcode = cv_status_error) THEN
--              RAISE global_process_expt;
--            END IF;
--            l_month_square_rec.l_one_day_tab.DELETE;
--            l_month_square_rec     := NULL;
--            init_month_square_rec5(l_month_square_rec);
--            lb_boolean        := TRUE;               -- 初期処理のフラグオンする。
--          END IF;
--        END IF;
--        -- 拠点コードが前回取得した拠点コードと違う場合ワークテーブルに出力します。
--        IF ((ln_cnt > 0) AND
--            (lv_bf_base_code_par <> l_cur_rec.base_code_par)) THEN
--          debug(
--             buff   => '拠点コードが違います。 :' ||'前回： '|| lv_bf_base_code_par || ''||
--                        '今回：' || l_cur_rec.base_code_par
--          );
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- レコードの初期化
--        l_get_month_square_tab.DELETE;
--        l_get_month_square_hon_tab.DELETE;
--        init_month_square_hon_tab(l_get_month_square_hon_tab);
--        -- カウンタ数に１を足す
--        ln_report_output_no := ln_report_output_no + 1; -- 出力された帳票個数に＋１する
--        lb_boolean          := TRUE;                    -- 初期処理の状態に戻す
--        ln_m_cnt            := 1;                       -- 明細部配列の行数の初期化
--        END IF;
--        -- 初期処理の場合
--        IF(lb_boolean) THEN
--          -- 業務地コードをローカル変数に格納
--          lv_bf_base_code_par         := l_cur_rec.base_code_par;        -- 勤務地拠点コード(親)(拠点コード)
--          lv_bf_base_code_chi         := l_cur_rec.base_code_chi;        -- 勤務地拠点コード
--          -- ローカルレコードに格納
--          -- 勤務地拠点コード(親)(拠点コード)
--          l_month_square_rec.base_code_par     := l_cur_rec.base_code_par;
--          -- 勤務地拠点名(親)(拠点コード)
--          l_month_square_rec.base_name_par     := l_cur_rec.base_name_par;
--          -- 勤務地拠点コード
--          l_month_square_rec.base_code_chi     := l_cur_rec.base_code_chi;
--          -- 勤務地拠点名
--          l_month_square_rec.base_name_chi     := l_cur_rec.base_name_chi;
--          -- 新規顧客件数
--          l_month_square_rec.cust_new_num      := l_cur_rec.cust_new_num;
--          -- 新規VD件数
--          l_month_square_rec.cust_vd_new_num   := l_cur_rec.cust_vd_new_num;
--          -- 新規VD以外件数
--          l_month_square_rec.cust_other_new_num := l_cur_rec.cust_other_new_num;
--          -- 前年実績
--          l_month_square_rec.rslt_amty         := l_cur_rec.rslt_amty;
--          -- 前年実績（VD）
--          l_month_square_rec.rslt_vd_amty      := l_cur_rec.rslt_vd_amty;
--          -- 前年実績（VD以外））
--          l_month_square_rec.rslt_other_amty   := l_cur_rec.rslt_other_amty;
--          -- 先月実績
--          l_month_square_rec.rslt_amtm         := l_cur_rec.rslt_amtm;
--          -- 先月実績（VD）
--          l_month_square_rec.rslt_vd_amtm      := l_cur_rec.rslt_vd_amtm;
--          -- 先月実績（VD以外
--          l_month_square_rec.rslt_other_amtm   := l_cur_rec.rslt_other_amtm;
--          -- 月別売上予算
--          l_month_square_rec.tgt_sales_prsn_total_amt := l_cur_rec.tgt_sales_prsn_total_amt;
--          lb_boolean := FALSE;
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '初期処理フラグ:' || 'FALSE'
--          );
--        END IF;
--        /* 20090427_abe_売上計画出力対応 START*/
--        IF (l_cur_rec.sales_date IS NOT NULL) THEN
--          -- 日付を取得
--          ln_date := TO_NUMBER(SUBSTR(l_cur_rec.sales_date,7,2));
--          -- DEBUGメッセージ
--          -- 初期処理の場合
--          debug(
--             buff   => '日付:' || l_cur_rec.sales_date || cv_lf ||
--                       '日付けのナンバー型:'     || TO_CHAR(ln_date)
--          );
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_amt
--            := l_cur_rec.rslt_amt;              -- 売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_new_amt
--            := l_cur_rec.rslt_new_amt;          -- 売上実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_new_amt
--            := l_cur_rec.rslt_vd_new_amt;       -- 売上実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_vd_amt
--            := l_cur_rec.rslt_vd_amt;           -- 売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_new_amt
--            := l_cur_rec.rslt_other_new_amt;    -- 売上実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_other_amt
--            := l_cur_rec.rslt_other_amt;        -- 売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_amt
--            := l_cur_rec.rslt_center_amt;       -- 内他拠点＿売上実績
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_vd_amt
--            := l_cur_rec.rslt_center_vd_amt;    -- 内他拠点＿売上実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).rslt_center_other_amt
--            := l_cur_rec.rslt_center_other_amt; -- 内他拠点＿売上実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_num
--            := l_cur_rec.vis_num;               -- 訪問実績
--          l_month_square_rec.l_one_day_tab(ln_date).vis_new_num
--            := l_cur_rec.vis_new_num;           -- 訪問実績（新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_new_num
--            := l_cur_rec.vis_vd_new_num;        -- 訪問実績（VD：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_vd_num
--            := l_cur_rec.vis_vd_num;            -- 訪問実績（VD）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_new_num
--            := l_cur_rec.vis_other_new_num;     -- 訪問実績（VD以外：新規）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_other_num
--            := l_cur_rec.vis_other_num;         -- 訪問実績（VD以外）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_mc_num
--            := l_cur_rec.vis_mc_num;            -- 訪問実績（MC）
--          l_month_square_rec.l_one_day_tab(ln_date).vis_sales_num
--            := l_cur_rec.vis_sales_num;         -- 有効軒数
--          -- A0Z訪問件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_a_num := nvl(l_cur_rec.vis_a_num,0);  -- 訪問A件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_b_num := nvl(l_cur_rec.vis_b_num,0);  -- 訪問B件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_c_num := nvl(l_cur_rec.vis_c_num,0);  -- 訪問C件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_d_num := nvl(l_cur_rec.vis_d_num,0);  -- 訪問D件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_e_num := nvl(l_cur_rec.vis_e_num,0);  -- 訪問E件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_f_num := nvl(l_cur_rec.vis_f_num,0);  -- 訪問F件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_g_num := nvl(l_cur_rec.vis_g_num,0);  -- 訪問G件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_h_num := nvl(l_cur_rec.vis_h_num,0);  -- 訪問H件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_i_num := nvl(l_cur_rec.vis_i_num,0);  -- 訪問I件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_j_num := nvl(l_cur_rec.vis_j_num,0);  -- 訪問J件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_k_num := nvl(l_cur_rec.vis_k_num,0);  -- 訪問K件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_l_num := nvl(l_cur_rec.vis_l_num,0);  -- 訪問L件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_m_num := nvl(l_cur_rec.vis_m_num,0);  -- 訪問M件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_n_num := nvl(l_cur_rec.vis_n_num,0);  -- 訪問N件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_o_num := nvl(l_cur_rec.vis_o_num,0);  -- 訪問O件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_p_num := nvl(l_cur_rec.vis_p_num,0);  -- 訪問P件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_q_num := nvl(l_cur_rec.vis_q_num,0);  -- 訪問Q件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_r_num := nvl(l_cur_rec.vis_r_num,0);  -- 訪問R件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_s_num := nvl(l_cur_rec.vis_s_num,0);  -- 訪問S件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_t_num := nvl(l_cur_rec.vis_t_num,0);  -- 訪問T件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_u_num := nvl(l_cur_rec.vis_u_num,0);  -- 訪問U件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_v_num := nvl(l_cur_rec.vis_v_num,0);  -- 訪問V件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_w_num := nvl(l_cur_rec.vis_w_num,0);  -- 訪問W件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_x_num := nvl(l_cur_rec.vis_x_num,0);  -- 訪問X件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_y_num := nvl(l_cur_rec.vis_y_num,0);  -- 訪問Y件数
--          l_month_square_rec.l_one_day_tab(ln_date).vis_z_num := nvl(l_cur_rec.vis_z_num,0);  -- 訪問Z件数
--        END IF;
--        /* 20090427_abe_売上計画出力対応 END*/
--        -- 最初のレコードの場合
--        IF(lb_boolean) THEN
--          lb_boolean              := FALSE;                  -- 初期処理のフラグをオフする。
--        END IF;
--        -- 抽出件数カウンタに１を足す。
--        ln_cnt := ln_cnt + 1;
--        gn_target_cnt  := ln_cnt;
--        -- loop件数
--        debug(
--              buff   => 'loop件数' || TO_CHAR(ln_cnt)
--        );
--      END LOOP;
--      -- 最後のデータ登録
--      IF (ln_cnt > 0) THEN
--        debug(
--              buff   => '最後のデータの登録'
--        );
--        -- =================================================
--        -- A-7-2,A-7-3.PLSQL表の更新
--        -- =================================================
--        up_plsql_tab5(
--          i_month_square_rec   => l_month_square_rec          -- 一ヶ月分データ
--         ,in_m_cnt             => ln_m_cnt                    -- 明細部のカウンタ
--         ,io_m_tab             => l_get_month_square_tab      -- 明細部配列
--         ,io_hon_tab           => l_get_month_square_hon_tab  -- 本体部配列
--         ,ov_errbuf            => lv_errbuf         -- エラー・メッセージ            --# 固定 #
--         ,ov_retcode           => lv_retcode        -- リターン・コード              --# 固定 #
--         ,ov_errmsg            => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
--        );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--        -- =================================================
--        -- A-3-4,A-4-4,A-5-4,A-6-4,A-7-4.ワークテーブルへ出力
--        -- =================================================
--        insert_wrk_table(
--           ir_m_tab            => l_get_month_square_tab                      -- 明細部レコード
--          ,ir_hon_tab          => l_get_month_square_hon_tab                  -- 本体部レコード
--          ,in_m_cnt            => ln_m_cnt                                    -- 明細部行数
--          ,in_report_output_no => ln_report_output_no                         -- 帳票出力セット番号
--          ,ov_errbuf           => lv_errbuf            -- エラー・メッセージ            --# 固定 #
--          ,ov_retcode          => lv_retcode           -- リターン・コード              --# 固定 #
--          ,ov_errmsg           => lv_errmsg            -- ユーザー・エラー・メッセージ  --# 固定 #
--         );
--        IF (lv_retcode = cv_status_error) THEN
--          RAISE global_process_expt;
--        END IF;
--      END IF;
--    EXCEPTION
--      WHEN OTHERS THEN
--        -- メッセージ出力
--        lv_errmsg := xxccp_common_pkg.get_msg(
--                         iv_application  => cv_app_name              --アプリケーション短縮名
--                        ,iv_name         => cv_tkn_number_08         --メッセージコード
--                        ,iv_token_name1  => cv_tkn_table             --トークンコード1
--                        ,iv_token_value1 => cv_tab_samari            --トークン値1
--                        ,iv_token_name2  => cv_tkn_errmsg            --トークンコード２
--                        ,iv_token_value2 => SQLERRM                  --トークン値２
--        );
--        fnd_file.put_line(
--              which  => FND_FILE.LOG,
--              buff   => ''      || cv_lf ||     -- 空行の挿入
--                      lv_errmsg || cv_lf ||
--                       ''                         -- 空行の挿入
--        );
--        RAISE global_api_expt;
--    END;
--  -- カーソルクローズ
--  CLOSE ticket_data_cur;
--
    ln_sum_emp_num := 0;
    ln_line_num    := 0;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 開始');
--
    FOR l_cur_rec IN get_under_base_data_cur
    LOOP
--
      sum_resources(
        iv_base_code => l_cur_rec.child_base_code
      );
--
      ln_sum_emp_num := ln_sum_emp_num + SQL%ROWCOUNT;
--
    END LOOP;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 営業員情報集計 終了（件数：' || ln_sum_emp_num || '）');
--
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 開始');
--
    sum_visit_sales;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 顧客情報集計 終了（件数：' || SQL%ROWCOUNT || '）');
--
    lv_report_name := '≪'|| SUBSTR(gv_year_month,1,4) ||'年' ||
    SUBSTR(gv_year_month,5,2) || '月' || '売上訪問計画管理表（営業本部別）' || '≫';
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■ヘッダ部
    -- 対象部門を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,report_id                                 -- 帳票ＩＤ
      ,report_name                               -- 帳票タイトル
      ,output_date                               -- 出力日時
      ,year_month                                -- 基準年月
      ,operation_days                            -- 稼動日数
      ,operation_all_days                        -- 稼動可能日数
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,ROWNUM                               -- 帳票出力セット番号
           ,cn_line_kind1                        -- 帳票出力位置
           ,1                                    -- 行番
           ,cv_pkg_name                          -- 帳票ＩＤ
           ,lv_report_name                       -- 帳票タイトル
           ,SYSDATE                              -- 出力日時
           ,gd_year_month                        -- 基準年月
           ,gn_operation_days                    -- 稼動日数
           ,gn_operation_all_days                -- 稼動可能日数
           ,xabv.base_code                       -- 拠点コード（親）
           ,xabv.base_name                       -- 拠点名称（親）
    FROM    xxcso_aff_base_v2  xabv
    WHERE   xabv.base_code  = gv_base_code
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' ヘッダ部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■明細部
    -- 対象部門内の全拠点をすべて抽出し、拠点内の営業員が
    -- 担当する顧客の売上／訪問計画（日別）、売上／訪問実績（日別）、
    -- 売上実績（他拠点納品分）（日別）、新規顧客軒数、
    -- 新規ＶＤ軒数、売上予算の合計を取得する
    ------------------------------------------------------------------------
    FOR l_cur_rec IN get_child_base_data_cur
    LOOP
--
      ln_line_num := ln_line_num + 1;
--
      INSERT INTO xxcso_rep_visit_sale_plan(
         created_by                                -- 作成者
        ,creation_date                             -- 作成日
        ,last_updated_by                           -- 最終更新者
        ,last_update_date                          -- 最終更新日
        ,last_update_login                         -- 最終更新ログイン
        ,request_id                                -- 要求ID
        ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
        ,program_id                                -- コンカレント・プログラムID
        ,program_update_date                       -- プログラム更新日
        ,report_output_no                          -- 帳票出力セット番号
        ,line_kind                                 -- 帳票出力位置
        ,line_num                                  -- 行番号
        ,up_base_code                              -- 拠点コード（親）
        ,up_hub_name                               -- 拠点名称（親）
        ,base_code                                 -- 拠点コード
        ,hub_name                                  -- 拠点名称
        ,new_customer_num                          -- 新規顧客軒数
        ,new_vendor_num                            -- 新規ＶＤ軒数
        ,plan_sales_amt                            -- 売上予算
        ,last_year_rslt_sales_amt                  -- 前年実績
        ,last_mon_rslt_sales_amt                   -- 先月実績
        ,plan_vs_amt_1                             -- １日－売上／訪問計画
        ,plan_vs_amt_2                             -- ２日－売上／訪問計画
        ,plan_vs_amt_3                             -- ３日－売上／訪問計画
        ,plan_vs_amt_4                             -- ４日－売上／訪問計画
        ,plan_vs_amt_5                             -- ５日－売上／訪問計画
        ,plan_vs_amt_6                             -- ６日－売上／訪問計画
        ,plan_vs_amt_7                             -- ７日－売上／訪問計画
        ,plan_vs_amt_8                             -- ８日－売上／訪問計画
        ,plan_vs_amt_9                             -- ９日－売上／訪問計画
        ,plan_vs_amt_10                            -- １０日－売上／訪問計画
        ,plan_vs_amt_11                            -- １１日－売上／訪問計画
        ,plan_vs_amt_12                            -- １２日－売上／訪問計画
        ,plan_vs_amt_13                            -- １３日－売上／訪問計画
        ,plan_vs_amt_14                            -- １４日－売上／訪問計画
        ,plan_vs_amt_15                            -- １５日－売上／訪問計画
        ,plan_vs_amt_16                            -- １６日－売上／訪問計画
        ,plan_vs_amt_17                            -- １７日－売上／訪問計画
        ,plan_vs_amt_18                            -- １８日－売上／訪問計画
        ,plan_vs_amt_19                            -- １９日－売上／訪問計画
        ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
        ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
        ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
        ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
        ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
        ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
        ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
        ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
        ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
        ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
        ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
        ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
        ,rslt_vs_amt_1                             -- １日－売上／訪問実績
        ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
        ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
        ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
        ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
        ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
        ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
        ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
        ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
        ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
        ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
        ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
        ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
        ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
        ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
        ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
        ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
        ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
        ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
        ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
        ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
        ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
        ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
        ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
        ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
        ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
        ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
        ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
        ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
        ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
        ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
        ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
        ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
      )
      SELECT  cn_created_by                        -- 作成者
             ,cd_creation_date                     -- 作成日
             ,cn_last_updated_by                   -- 最終更新者
             ,cd_last_update_date                  -- 最終更新日
             ,cn_last_update_login                 -- 最終更新ログイン
             ,cn_request_id                        -- 要求ID
             ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
             ,cn_program_id                        -- コンカレント・プログラムID
             ,cd_program_update_date               -- プログラム更新日
             ,inn_v.report_output_no               -- 帳票出力セット番号
             ,cn_line_kind2                        -- 帳票出力位置
             ,ln_line_num                          -- 行番号
             ,inn_v.up_base_code                   -- 拠点コード（親）
             ,inn_v.up_hub_name                    -- 拠点名称（親）
             ,l_cur_rec.child_base_code            -- 拠点コード
             ,(SELECT  xabv.base_name
               FROM    xxcso_aff_base_v2 xabv
               WHERE   xabv.base_code = l_cur_rec.child_base_code
              )                                    -- 拠点名
             ,inn_v.new_customer_num               -- 新規顧客軒数
             ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
             ,inn_v.plan_sales_amt                 -- 売上予算
             ,inn_v.last_year_rslt_sales_amt       -- 前年実績
             ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
             ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
             ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
             ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
             ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
             ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
             ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
             ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
             ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
             ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
             ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
             ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
             ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
             ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
             ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
             ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
             ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
             ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
             ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
             ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
             ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
             ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
             ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
             ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
             ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
             ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
             ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
             ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
             ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
             ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
             ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
             ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
             ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
             ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
             ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
             ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
             ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
             ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
             ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
             ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
             ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
             ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
             ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
             ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
             ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
             ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
             ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
             ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
             ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
             ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
             ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
             ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
             ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
             ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
             ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
             ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
             ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
             ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
             ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
             ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
             ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
             ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
             ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
             ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
             ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
      FROM    (
               SELECT  xrvsp.report_output_no                  report_output_no
                      ,xrvsp.up_base_code                      up_base_code
                      ,xrvsp.up_hub_name                       up_hub_name
                      ,l_cur_rec.child_base_code               base_code
                      ,SUM(xtrvp.new_customer_num)             new_customer_num
                      ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                      ,SUM(
                         (CASE
                            WHEN (xdmp.sales_plan_rel_div = '1') THEN
                              xdmp.target_sales_total_amt
                            ELSE
                              xdmp.basic_sales_total_amt
                          END
                         )
                       )                                       plan_sales_amt
                      ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                      ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                      ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                      ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                      ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                      ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                      ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                      ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                      ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                      ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                      ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                      ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                      ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                      ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                      ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                      ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                      ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                      ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                      ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                      ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                      ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                      ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                      ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                      ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                      ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                      ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                      ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                      ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                      ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                      ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                      ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                      ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                      ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                      ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                      ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                      ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                      ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                      ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                      ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                      ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                      ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                      ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                      ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                      ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                      ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                      ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                      ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                      ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                      ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                      ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                      ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                      ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                      ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                      ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                      ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                      ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                      ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                      ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                      ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                      ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                      ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                      ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                      ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                      ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                      ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                      ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                      ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                      ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                      ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                      ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                      ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                      ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                      ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                      ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                      ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                      ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                      ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                      ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                      ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                      ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                      ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                      ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                      ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                      ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                      ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                      ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                      ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                      ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                      ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                      ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                      ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                      ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                      ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                      ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                      ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
               FROM    xxcso_rep_visit_sale_plan               xrvsp
                      ,(
                        --------------------------------------------
                        -- 孫あり
                        --------------------------------------------
                        SELECT  gv_base_code              base_code
                               ,xablv.child_base_code     under_base_code
                        FROM    xxcso_aff_base_level_v2   xablv
                        START WITH
                                xablv.base_code IN
                                  (SELECT  xablv1.child_base_code
                                   FROM    xxcso_aff_base_level_v2 xablv1
                                   WHERE   base_code = l_cur_rec.child_base_code
                                  )
                        CONNECT BY PRIOR
                                xablv.child_base_code = xablv.base_code
                        UNION ALL
                        --------------------------------------------
                        -- 孫なし
                        --------------------------------------------
                        SELECT  gv_base_code              base_code
                               ,xablv.child_base_code     under_base_code
                        FROM    xxcso_aff_base_level_v2   xablv
                        WHERE   xablv.base_code = l_cur_rec.child_base_code
                        UNION ALL
                        --------------------------------------------
                        -- 子なし
                        --------------------------------------------
                        SELECT gv_base_code               base_code
                              ,l_cur_rec.child_base_code  under_base_code
                        FROM   DUAL
                       )                                       xabv
                      ,xxcso_dept_monthly_plans                xdmp
                      ,(SELECT  xtrvp1.base_code                         base_code
                               ,SUM(xtrvp1.new_customer_num)             new_customer_num
                               ,SUM(xtrvp1.new_vendor_num)               new_vendor_num
                               ,SUM(xtrvp1.plan_sales_amt)               plan_sales_amt
                               ,SUM(xtrvp1.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                               ,SUM(xtrvp1.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                               ,SUM(xtrvp1.plan_vs_amt_1)                plan_vs_amt_1
                               ,SUM(xtrvp1.plan_vs_amt_2)                plan_vs_amt_2
                               ,SUM(xtrvp1.plan_vs_amt_3)                plan_vs_amt_3
                               ,SUM(xtrvp1.plan_vs_amt_4)                plan_vs_amt_4
                               ,SUM(xtrvp1.plan_vs_amt_5)                plan_vs_amt_5
                               ,SUM(xtrvp1.plan_vs_amt_6)                plan_vs_amt_6
                               ,SUM(xtrvp1.plan_vs_amt_7)                plan_vs_amt_7
                               ,SUM(xtrvp1.plan_vs_amt_8)                plan_vs_amt_8
                               ,SUM(xtrvp1.plan_vs_amt_9)                plan_vs_amt_9
                               ,SUM(xtrvp1.plan_vs_amt_10)               plan_vs_amt_10
                               ,SUM(xtrvp1.plan_vs_amt_11)               plan_vs_amt_11
                               ,SUM(xtrvp1.plan_vs_amt_12)               plan_vs_amt_12
                               ,SUM(xtrvp1.plan_vs_amt_13)               plan_vs_amt_13
                               ,SUM(xtrvp1.plan_vs_amt_14)               plan_vs_amt_14
                               ,SUM(xtrvp1.plan_vs_amt_15)               plan_vs_amt_15
                               ,SUM(xtrvp1.plan_vs_amt_16)               plan_vs_amt_16
                               ,SUM(xtrvp1.plan_vs_amt_17)               plan_vs_amt_17
                               ,SUM(xtrvp1.plan_vs_amt_18)               plan_vs_amt_18
                               ,SUM(xtrvp1.plan_vs_amt_19)               plan_vs_amt_19
                               ,SUM(xtrvp1.plan_vs_amt_20)               plan_vs_amt_20
                               ,SUM(xtrvp1.plan_vs_amt_21)               plan_vs_amt_21
                               ,SUM(xtrvp1.plan_vs_amt_22)               plan_vs_amt_22
                               ,SUM(xtrvp1.plan_vs_amt_23)               plan_vs_amt_23
                               ,SUM(xtrvp1.plan_vs_amt_24)               plan_vs_amt_24
                               ,SUM(xtrvp1.plan_vs_amt_25)               plan_vs_amt_25
                               ,SUM(xtrvp1.plan_vs_amt_26)               plan_vs_amt_26
                               ,SUM(xtrvp1.plan_vs_amt_27)               plan_vs_amt_27
                               ,SUM(xtrvp1.plan_vs_amt_28)               plan_vs_amt_28
                               ,SUM(xtrvp1.plan_vs_amt_29)               plan_vs_amt_29
                               ,SUM(xtrvp1.plan_vs_amt_30)               plan_vs_amt_30
                               ,SUM(xtrvp1.plan_vs_amt_31)               plan_vs_amt_31
                               ,SUM(xtrvp1.rslt_vs_amt_1)                rslt_vs_amt_1
                               ,SUM(xtrvp1.rslt_vs_amt_2)                rslt_vs_amt_2
                               ,SUM(xtrvp1.rslt_vs_amt_3)                rslt_vs_amt_3
                               ,SUM(xtrvp1.rslt_vs_amt_4)                rslt_vs_amt_4
                               ,SUM(xtrvp1.rslt_vs_amt_5)                rslt_vs_amt_5
                               ,SUM(xtrvp1.rslt_vs_amt_6)                rslt_vs_amt_6
                               ,SUM(xtrvp1.rslt_vs_amt_7)                rslt_vs_amt_7
                               ,SUM(xtrvp1.rslt_vs_amt_8)                rslt_vs_amt_8
                               ,SUM(xtrvp1.rslt_vs_amt_9)                rslt_vs_amt_9
                               ,SUM(xtrvp1.rslt_vs_amt_10)               rslt_vs_amt_10
                               ,SUM(xtrvp1.rslt_vs_amt_11)               rslt_vs_amt_11
                               ,SUM(xtrvp1.rslt_vs_amt_12)               rslt_vs_amt_12
                               ,SUM(xtrvp1.rslt_vs_amt_13)               rslt_vs_amt_13
                               ,SUM(xtrvp1.rslt_vs_amt_14)               rslt_vs_amt_14
                               ,SUM(xtrvp1.rslt_vs_amt_15)               rslt_vs_amt_15
                               ,SUM(xtrvp1.rslt_vs_amt_16)               rslt_vs_amt_16
                               ,SUM(xtrvp1.rslt_vs_amt_17)               rslt_vs_amt_17
                               ,SUM(xtrvp1.rslt_vs_amt_18)               rslt_vs_amt_18
                               ,SUM(xtrvp1.rslt_vs_amt_19)               rslt_vs_amt_19
                               ,SUM(xtrvp1.rslt_vs_amt_20)               rslt_vs_amt_20
                               ,SUM(xtrvp1.rslt_vs_amt_21)               rslt_vs_amt_21
                               ,SUM(xtrvp1.rslt_vs_amt_22)               rslt_vs_amt_22
                               ,SUM(xtrvp1.rslt_vs_amt_23)               rslt_vs_amt_23
                               ,SUM(xtrvp1.rslt_vs_amt_24)               rslt_vs_amt_24
                               ,SUM(xtrvp1.rslt_vs_amt_25)               rslt_vs_amt_25
                               ,SUM(xtrvp1.rslt_vs_amt_26)               rslt_vs_amt_26
                               ,SUM(xtrvp1.rslt_vs_amt_27)               rslt_vs_amt_27
                               ,SUM(xtrvp1.rslt_vs_amt_28)               rslt_vs_amt_28
                               ,SUM(xtrvp1.rslt_vs_amt_29)               rslt_vs_amt_29
                               ,SUM(xtrvp1.rslt_vs_amt_30)               rslt_vs_amt_30
                               ,SUM(xtrvp1.rslt_vs_amt_31)               rslt_vs_amt_31
                               ,SUM(xtrvp1.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                               ,SUM(xtrvp1.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                               ,SUM(xtrvp1.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                               ,SUM(xtrvp1.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                               ,SUM(xtrvp1.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                               ,SUM(xtrvp1.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                               ,SUM(xtrvp1.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                               ,SUM(xtrvp1.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                               ,SUM(xtrvp1.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                               ,SUM(xtrvp1.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                               ,SUM(xtrvp1.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                               ,SUM(xtrvp1.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                               ,SUM(xtrvp1.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                               ,SUM(xtrvp1.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                               ,SUM(xtrvp1.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                               ,SUM(xtrvp1.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                               ,SUM(xtrvp1.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                               ,SUM(xtrvp1.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                               ,SUM(xtrvp1.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                               ,SUM(xtrvp1.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                               ,SUM(xtrvp1.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                               ,SUM(xtrvp1.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                               ,SUM(xtrvp1.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                               ,SUM(xtrvp1.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                               ,SUM(xtrvp1.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                               ,SUM(xtrvp1.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                               ,SUM(xtrvp1.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                               ,SUM(xtrvp1.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                               ,SUM(xtrvp1.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                               ,SUM(xtrvp1.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                               ,SUM(xtrvp1.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
                        FROM    xxcso_tmp_rep_vs_plan  xtrvp1
                        GROUP BY xtrvp1.base_code
                       )                                      xtrvp
               WHERE    xrvsp.request_id         = cn_request_id
                 AND    xrvsp.line_kind          = cn_line_kind1
                 AND    xabv.base_code(+)        = xrvsp.up_base_code
                 AND    xdmp.base_code(+)        = xabv.under_base_code
                 AND    xdmp.year_month(+)       = gv_year_month
                 AND    xtrvp.base_code(+)       = xabv.under_base_code
               GROUP BY  xrvsp.report_output_no
                        ,xrvsp.up_base_code
                        ,xrvsp.up_hub_name
              ) inn_v
      ;
    END LOOP;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部
    -- 対象拠点に所属する営業員の担当する顧客の
    -- 日別合計を一般計、自販機計で集計する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,last_year_rslt_sales_amt                  -- 前年実績
      ,last_mon_rslt_sales_amt                   -- 先月実績
      ,plan_vs_amt_1                             -- １日－売上／訪問計画
      ,plan_vs_amt_2                             -- ２日－売上／訪問計画
      ,plan_vs_amt_3                             -- ３日－売上／訪問計画
      ,plan_vs_amt_4                             -- ４日－売上／訪問計画
      ,plan_vs_amt_5                             -- ５日－売上／訪問計画
      ,plan_vs_amt_6                             -- ６日－売上／訪問計画
      ,plan_vs_amt_7                             -- ７日－売上／訪問計画
      ,plan_vs_amt_8                             -- ８日－売上／訪問計画
      ,plan_vs_amt_9                             -- ９日－売上／訪問計画
      ,plan_vs_amt_10                            -- １０日－売上／訪問計画
      ,plan_vs_amt_11                            -- １１日－売上／訪問計画
      ,plan_vs_amt_12                            -- １２日－売上／訪問計画
      ,plan_vs_amt_13                            -- １３日－売上／訪問計画
      ,plan_vs_amt_14                            -- １４日－売上／訪問計画
      ,plan_vs_amt_15                            -- １５日－売上／訪問計画
      ,plan_vs_amt_16                            -- １６日－売上／訪問計画
      ,plan_vs_amt_17                            -- １７日－売上／訪問計画
      ,plan_vs_amt_18                            -- １８日－売上／訪問計画
      ,plan_vs_amt_19                            -- １９日－売上／訪問計画
      ,plan_vs_amt_20                            -- ２０日－売上／訪問計画
      ,plan_vs_amt_21                            -- ２１日－売上／訪問計画
      ,plan_vs_amt_22                            -- ２２日－売上／訪問計画
      ,plan_vs_amt_23                            -- ２３日－売上／訪問計画
      ,plan_vs_amt_24                            -- ２４日－売上／訪問計画
      ,plan_vs_amt_25                            -- ２５日－売上／訪問計画
      ,plan_vs_amt_26                            -- ２６日－売上／訪問計画
      ,plan_vs_amt_27                            -- ２７日－売上／訪問計画
      ,plan_vs_amt_28                            -- ２８日－売上／訪問計画
      ,plan_vs_amt_29                            -- ２９日－売上／訪問計画
      ,plan_vs_amt_30                            -- ３０日－売上／訪問計画
      ,plan_vs_amt_31                            -- ３１日－売上／訪問計画
      ,rslt_vs_amt_1                             -- １日－売上／訪問実績
      ,rslt_vs_amt_2                             -- ２日－売上／訪問実績
      ,rslt_vs_amt_3                             -- ３日－売上／訪問実績
      ,rslt_vs_amt_4                             -- ４日－売上／訪問実績
      ,rslt_vs_amt_5                             -- ５日－売上／訪問実績
      ,rslt_vs_amt_6                             -- ６日－売上／訪問実績
      ,rslt_vs_amt_7                             -- ７日－売上／訪問実績
      ,rslt_vs_amt_8                             -- ８日－売上／訪問実績
      ,rslt_vs_amt_9                             -- ９日－売上／訪問実績
      ,rslt_vs_amt_10                            -- １０日－売上／訪問実績
      ,rslt_vs_amt_11                            -- １１日－売上／訪問実績
      ,rslt_vs_amt_12                            -- １２日－売上／訪問実績
      ,rslt_vs_amt_13                            -- １３日－売上／訪問実績
      ,rslt_vs_amt_14                            -- １４日－売上／訪問実績
      ,rslt_vs_amt_15                            -- １５日－売上／訪問実績
      ,rslt_vs_amt_16                            -- １６日－売上／訪問実績
      ,rslt_vs_amt_17                            -- １７日－売上／訪問実績
      ,rslt_vs_amt_18                            -- １８日－売上／訪問実績
      ,rslt_vs_amt_19                            -- １９日－売上／訪問実績
      ,rslt_vs_amt_20                            -- ２０日－売上／訪問実績
      ,rslt_vs_amt_21                            -- ２１日－売上／訪問実績
      ,rslt_vs_amt_22                            -- ２２日－売上／訪問実績
      ,rslt_vs_amt_23                            -- ２３日－売上／訪問実績
      ,rslt_vs_amt_24                            -- ２４日－売上／訪問実績
      ,rslt_vs_amt_25                            -- ２５日－売上／訪問実績
      ,rslt_vs_amt_26                            -- ２６日－売上／訪問実績
      ,rslt_vs_amt_27                            -- ２７日－売上／訪問実績
      ,rslt_vs_amt_28                            -- ２８日－売上／訪問実績
      ,rslt_vs_amt_29                            -- ２９日－売上／訪問実績
      ,rslt_vs_amt_30                            -- ３０日－売上／訪問実績
      ,rslt_vs_amt_31                            -- ３１日－売上／訪問実績
      ,rslt_other_sales_amt_1                    -- １日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_2                    -- ２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_3                    -- ３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_4                    -- ４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_5                    -- ５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_6                    -- ６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_7                    -- ７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_8                    -- ８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_9                    -- ９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_10                   -- １０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_11                   -- １１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_12                   -- １２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_13                   -- １３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_14                   -- １４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_15                   -- １５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_16                   -- １６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_17                   -- １７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_18                   -- １８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_19                   -- １９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_20                   -- ２０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_21                   -- ２１日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_22                   -- ２２日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_23                   -- ２３日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_24                   -- ２４日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_25                   -- ２５日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_26                   -- ２６日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_27                   -- ２７日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_28                   -- ２８日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_29                   -- ２９日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_30                   -- ３０日－売上実績（他拠点納品分）
      ,rslt_other_sales_amt_31                   -- ３１日－売上実績（他拠点納品分）
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.last_year_rslt_sales_amt       -- 前年実績
           ,inn_v.last_mon_rslt_sales_amt        -- 先月実績
           ,inn_v.plan_vs_amt_1                  -- １日－売上／訪問計画
           ,inn_v.plan_vs_amt_2                  -- ２日－売上／訪問計画
           ,inn_v.plan_vs_amt_3                  -- ３日－売上／訪問計画
           ,inn_v.plan_vs_amt_4                  -- ４日－売上／訪問計画
           ,inn_v.plan_vs_amt_5                  -- ５日－売上／訪問計画
           ,inn_v.plan_vs_amt_6                  -- ６日－売上／訪問計画
           ,inn_v.plan_vs_amt_7                  -- ７日－売上／訪問計画
           ,inn_v.plan_vs_amt_8                  -- ８日－売上／訪問計画
           ,inn_v.plan_vs_amt_9                  -- ９日－売上／訪問計画
           ,inn_v.plan_vs_amt_10                 -- １０日－売上／訪問計画
           ,inn_v.plan_vs_amt_11                 -- １１日－売上／訪問計画
           ,inn_v.plan_vs_amt_12                 -- １２日－売上／訪問計画
           ,inn_v.plan_vs_amt_13                 -- １３日－売上／訪問計画
           ,inn_v.plan_vs_amt_14                 -- １４日－売上／訪問計画
           ,inn_v.plan_vs_amt_15                 -- １５日－売上／訪問計画
           ,inn_v.plan_vs_amt_16                 -- １６日－売上／訪問計画
           ,inn_v.plan_vs_amt_17                 -- １７日－売上／訪問計画
           ,inn_v.plan_vs_amt_18                 -- １８日－売上／訪問計画
           ,inn_v.plan_vs_amt_19                 -- １９日－売上／訪問計画
           ,inn_v.plan_vs_amt_20                 -- ２０日－売上／訪問計画
           ,inn_v.plan_vs_amt_21                 -- ２１日－売上／訪問計画
           ,inn_v.plan_vs_amt_22                 -- ２２日－売上／訪問計画
           ,inn_v.plan_vs_amt_23                 -- ２３日－売上／訪問計画
           ,inn_v.plan_vs_amt_24                 -- ２４日－売上／訪問計画
           ,inn_v.plan_vs_amt_25                 -- ２５日－売上／訪問計画
           ,inn_v.plan_vs_amt_26                 -- ２６日－売上／訪問計画
           ,inn_v.plan_vs_amt_27                 -- ２７日－売上／訪問計画
           ,inn_v.plan_vs_amt_28                 -- ２８日－売上／訪問計画
           ,inn_v.plan_vs_amt_29                 -- ２９日－売上／訪問計画
           ,inn_v.plan_vs_amt_30                 -- ３０日－売上／訪問計画
           ,inn_v.plan_vs_amt_31                 -- ３１日－売上／訪問計画
           ,inn_v.rslt_vs_amt_1                  -- １日－売上／訪問実績
           ,inn_v.rslt_vs_amt_2                  -- ２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_3                  -- ３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_4                  -- ４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_5                  -- ５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_6                  -- ６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_7                  -- ７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_8                  -- ８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_9                  -- ９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_10                 -- １０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_11                 -- １１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_12                 -- １２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_13                 -- １３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_14                 -- １４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_15                 -- １５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_16                 -- １６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_17                 -- １７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_18                 -- １８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_19                 -- １９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_20                 -- ２０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_21                 -- ２１日－売上／訪問実績
           ,inn_v.rslt_vs_amt_22                 -- ２２日－売上／訪問実績
           ,inn_v.rslt_vs_amt_23                 -- ２３日－売上／訪問実績
           ,inn_v.rslt_vs_amt_24                 -- ２４日－売上／訪問実績
           ,inn_v.rslt_vs_amt_25                 -- ２５日－売上／訪問実績
           ,inn_v.rslt_vs_amt_26                 -- ２６日－売上／訪問実績
           ,inn_v.rslt_vs_amt_27                 -- ２７日－売上／訪問実績
           ,inn_v.rslt_vs_amt_28                 -- ２８日－売上／訪問実績
           ,inn_v.rslt_vs_amt_29                 -- ２９日－売上／訪問実績
           ,inn_v.rslt_vs_amt_30                 -- ３０日－売上／訪問実績
           ,inn_v.rslt_vs_amt_31                 -- ３１日－売上／訪問実績
           ,inn_v.rslt_other_sales_amt_1         -- １日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_2         -- ２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_3         -- ３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_4         -- ４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_5         -- ５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_6         -- ６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_7         -- ７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_8         -- ８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_9         -- ９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_10        -- １０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_11        -- １１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_12        -- １２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_13        -- １３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_14        -- １４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_15        -- １５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_16        -- １６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_17        -- １７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_18        -- １８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_19        -- １９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_20        -- ２０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_21        -- ２１日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_22        -- ２２日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_23        -- ２３日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_24        -- ２４日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_25        -- ２５日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_26        -- ２６日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_27        -- ２７日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_28        -- ２８日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_29        -- ２９日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_30        -- ３０日－売上実績（他拠点納品分）
           ,inn_v.rslt_other_sales_amt_31        -- ３１日－売上実績（他拠点納品分）
    FROM    (
             SELECT  xrvsp.report_output_no                  report_output_no
                    ,xrvsp.up_base_code                      up_base_code
                    ,xrvsp.up_hub_name                       up_hub_name
                    ,xrvsp.gvm_type                          gvm_type
                    ,SUM(xtrvp.new_customer_num)             new_customer_num
                    ,SUM(xtrvp.new_vendor_num)               new_vendor_num
                    ,SUM(xtrvp.last_year_rslt_sales_amt)     last_year_rslt_sales_amt
                    ,SUM(xtrvp.last_mon_rslt_sales_amt)      last_mon_rslt_sales_amt
                    ,SUM(xtrvp.plan_vs_amt_1)                plan_vs_amt_1
                    ,SUM(xtrvp.plan_vs_amt_2)                plan_vs_amt_2
                    ,SUM(xtrvp.plan_vs_amt_3)                plan_vs_amt_3
                    ,SUM(xtrvp.plan_vs_amt_4)                plan_vs_amt_4
                    ,SUM(xtrvp.plan_vs_amt_5)                plan_vs_amt_5
                    ,SUM(xtrvp.plan_vs_amt_6)                plan_vs_amt_6
                    ,SUM(xtrvp.plan_vs_amt_7)                plan_vs_amt_7
                    ,SUM(xtrvp.plan_vs_amt_8)                plan_vs_amt_8
                    ,SUM(xtrvp.plan_vs_amt_9)                plan_vs_amt_9
                    ,SUM(xtrvp.plan_vs_amt_10)               plan_vs_amt_10
                    ,SUM(xtrvp.plan_vs_amt_11)               plan_vs_amt_11
                    ,SUM(xtrvp.plan_vs_amt_12)               plan_vs_amt_12
                    ,SUM(xtrvp.plan_vs_amt_13)               plan_vs_amt_13
                    ,SUM(xtrvp.plan_vs_amt_14)               plan_vs_amt_14
                    ,SUM(xtrvp.plan_vs_amt_15)               plan_vs_amt_15
                    ,SUM(xtrvp.plan_vs_amt_16)               plan_vs_amt_16
                    ,SUM(xtrvp.plan_vs_amt_17)               plan_vs_amt_17
                    ,SUM(xtrvp.plan_vs_amt_18)               plan_vs_amt_18
                    ,SUM(xtrvp.plan_vs_amt_19)               plan_vs_amt_19
                    ,SUM(xtrvp.plan_vs_amt_20)               plan_vs_amt_20
                    ,SUM(xtrvp.plan_vs_amt_21)               plan_vs_amt_21
                    ,SUM(xtrvp.plan_vs_amt_22)               plan_vs_amt_22
                    ,SUM(xtrvp.plan_vs_amt_23)               plan_vs_amt_23
                    ,SUM(xtrvp.plan_vs_amt_24)               plan_vs_amt_24
                    ,SUM(xtrvp.plan_vs_amt_25)               plan_vs_amt_25
                    ,SUM(xtrvp.plan_vs_amt_26)               plan_vs_amt_26
                    ,SUM(xtrvp.plan_vs_amt_27)               plan_vs_amt_27
                    ,SUM(xtrvp.plan_vs_amt_28)               plan_vs_amt_28
                    ,SUM(xtrvp.plan_vs_amt_29)               plan_vs_amt_29
                    ,SUM(xtrvp.plan_vs_amt_30)               plan_vs_amt_30
                    ,SUM(xtrvp.plan_vs_amt_31)               plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vs_amt_1)                rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vs_amt_2)                rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vs_amt_3)                rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vs_amt_4)                rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vs_amt_5)                rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vs_amt_6)                rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vs_amt_7)                rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vs_amt_8)                rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vs_amt_9)                rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vs_amt_10)               rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vs_amt_11)               rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vs_amt_12)               rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vs_amt_13)               rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vs_amt_14)               rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vs_amt_15)               rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vs_amt_16)               rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vs_amt_17)               rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vs_amt_18)               rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vs_amt_19)               rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vs_amt_20)               rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vs_amt_21)               rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vs_amt_22)               rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vs_amt_23)               rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vs_amt_24)               rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vs_amt_25)               rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vs_amt_26)               rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vs_amt_27)               rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vs_amt_28)               rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vs_amt_29)               rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vs_amt_30)               rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vs_amt_31)               rslt_vs_amt_31
                    ,SUM(xtrvp.rslt_other_sales_amt_1)       rslt_other_sales_amt_1
                    ,SUM(xtrvp.rslt_other_sales_amt_2)       rslt_other_sales_amt_2
                    ,SUM(xtrvp.rslt_other_sales_amt_3)       rslt_other_sales_amt_3
                    ,SUM(xtrvp.rslt_other_sales_amt_4)       rslt_other_sales_amt_4
                    ,SUM(xtrvp.rslt_other_sales_amt_5)       rslt_other_sales_amt_5
                    ,SUM(xtrvp.rslt_other_sales_amt_6)       rslt_other_sales_amt_6
                    ,SUM(xtrvp.rslt_other_sales_amt_7)       rslt_other_sales_amt_7
                    ,SUM(xtrvp.rslt_other_sales_amt_8)       rslt_other_sales_amt_8
                    ,SUM(xtrvp.rslt_other_sales_amt_9)       rslt_other_sales_amt_9
                    ,SUM(xtrvp.rslt_other_sales_amt_10)      rslt_other_sales_amt_10
                    ,SUM(xtrvp.rslt_other_sales_amt_11)      rslt_other_sales_amt_11
                    ,SUM(xtrvp.rslt_other_sales_amt_12)      rslt_other_sales_amt_12
                    ,SUM(xtrvp.rslt_other_sales_amt_13)      rslt_other_sales_amt_13
                    ,SUM(xtrvp.rslt_other_sales_amt_14)      rslt_other_sales_amt_14
                    ,SUM(xtrvp.rslt_other_sales_amt_15)      rslt_other_sales_amt_15
                    ,SUM(xtrvp.rslt_other_sales_amt_16)      rslt_other_sales_amt_16
                    ,SUM(xtrvp.rslt_other_sales_amt_17)      rslt_other_sales_amt_17
                    ,SUM(xtrvp.rslt_other_sales_amt_18)      rslt_other_sales_amt_18
                    ,SUM(xtrvp.rslt_other_sales_amt_19)      rslt_other_sales_amt_19
                    ,SUM(xtrvp.rslt_other_sales_amt_20)      rslt_other_sales_amt_20
                    ,SUM(xtrvp.rslt_other_sales_amt_21)      rslt_other_sales_amt_21
                    ,SUM(xtrvp.rslt_other_sales_amt_22)      rslt_other_sales_amt_22
                    ,SUM(xtrvp.rslt_other_sales_amt_23)      rslt_other_sales_amt_23
                    ,SUM(xtrvp.rslt_other_sales_amt_24)      rslt_other_sales_amt_24
                    ,SUM(xtrvp.rslt_other_sales_amt_25)      rslt_other_sales_amt_25
                    ,SUM(xtrvp.rslt_other_sales_amt_26)      rslt_other_sales_amt_26
                    ,SUM(xtrvp.rslt_other_sales_amt_27)      rslt_other_sales_amt_27
                    ,SUM(xtrvp.rslt_other_sales_amt_28)      rslt_other_sales_amt_28
                    ,SUM(xtrvp.rslt_other_sales_amt_29)      rslt_other_sales_amt_29
                    ,SUM(xtrvp.rslt_other_sales_amt_30)      rslt_other_sales_amt_30
                    ,SUM(xtrvp.rslt_other_sales_amt_31)      rslt_other_sales_amt_31
             FROM    xxcso_rep_visit_sale_plan               xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                                       xabv
                    ,xxcso_tmp_rep_vs_plan                   xtrvp
             WHERE   xrvsp.request_id         = cn_request_id
               AND   xrvsp.line_kind          = cn_line_kind1
               AND   xabv.base_code(+)        = xrvsp.up_base_code
               AND   xtrvp.base_code(+)       = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
                      ,xrvsp.gvm_type
             ORDER BY  report_output_no
                      ,xrvsp.gvm_type
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－中計部(補足)
    -- 売上－中計部で一般計、自販機計で０件だったグループの中計部を作成する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,gvm_type                                  -- 一般／自販機／ＭＣ
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind3                        -- 帳票出力位置
           ,(SELECT  MAX(xrvsp3.line_num)
             FROM    xxcso_rep_visit_sale_plan  xrvsp3
             WHERE   xrvsp3.request_id = cn_request_id
               AND   xrvsp3.line_kind  = cn_line_kind3
            ) + ROWNUM                           -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
    FROM    (
             -- 一般計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.up_base_code                    up_base_code
                    ,xrvsp.up_hub_name                     up_hub_name
                    ,cv_gvm_g                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   xrvsp3.gvm_type               = cv_gvm_g
                     )
             UNION ALL
             -- 自販機計が存在しない営業員
             SELECT  xrvsp.report_output_no                report_output_no
                    ,xrvsp.up_base_code                    up_base_code
                    ,xrvsp.up_hub_name                     up_hub_name
                    ,cv_gvm_v                              gvm_type
             FROM    xxcso_rep_visit_sale_plan    xrvsp     -- ヘッダ部
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   NOT EXISTS (
                       SELECT  1
                       FROM    xxcso_rep_visit_sale_plan  xrvsp3
                       WHERE   xrvsp3.request_id             = cn_request_id
                         AND   xrvsp3.line_kind              = cn_line_kind3
                         AND   xrvsp3.gvm_type               = cv_gvm_v
                     )
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－中計部（補足）取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■売上－計部
    -- 対象拠点の新規顧客軒数、新規ＶＤ軒数、売上予算を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,new_customer_num                          -- 新規顧客軒数
      ,new_vendor_num                            -- 新規ＶＤ軒数
      ,plan_sales_amt                            -- 売上予算
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind4                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.new_customer_num               -- 新規顧客軒数
           ,inn_v.new_vendor_num                 -- 新規ＶＤ軒数
           ,inn_v.plan_sales_amt                 -- 売上予算
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.up_base_code           up_base_code
                    ,xrvsp.up_hub_name            up_hub_name
                    ,SUM(
                       (CASE
                          WHEN (xdmp.sales_plan_rel_div = '1') THEN
                            xdmp.target_sales_total_amt
                          ELSE
                            xdmp.basic_sales_total_amt
                        END
                       )
                     )                            plan_sales_amt
                    ,SUM(xrvsp.new_customer_num)  new_customer_num
                    ,SUM(xrvsp.new_vendor_num)    new_vendor_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_dept_monthly_plans     xdmp
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xdmp.base_code(+)            = xabv.under_base_code
               AND   xdmp.year_month(+)           = gv_year_month
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 売上－計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－中計部
    -- 対象拠点に所属する営業員の訪問計画／訪問実績（日別）を
    -- 一般計、自販機計、ＭＣ計で取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,gvm_type                                  -- 一般／自販機／ＭＣ
      ,plan_vs_amt_1                             -- １日－訪問計画
      ,plan_vs_amt_2                             -- ２日－訪問計画
      ,plan_vs_amt_3                             -- ３日－訪問計画
      ,plan_vs_amt_4                             -- ４日－訪問計画
      ,plan_vs_amt_5                             -- ５日－訪問計画
      ,plan_vs_amt_6                             -- ６日－訪問計画
      ,plan_vs_amt_7                             -- ７日－訪問計画
      ,plan_vs_amt_8                             -- ８日－訪問計画
      ,plan_vs_amt_9                             -- ９日－訪問計画
      ,plan_vs_amt_10                            -- １０日－訪問計画
      ,plan_vs_amt_11                            -- １１日－訪問計画
      ,plan_vs_amt_12                            -- １２日－訪問計画
      ,plan_vs_amt_13                            -- １３日－訪問計画
      ,plan_vs_amt_14                            -- １４日－訪問計画
      ,plan_vs_amt_15                            -- １５日－訪問計画
      ,plan_vs_amt_16                            -- １６日－訪問計画
      ,plan_vs_amt_17                            -- １７日－訪問計画
      ,plan_vs_amt_18                            -- １８日－訪問計画
      ,plan_vs_amt_19                            -- １９日－訪問計画
      ,plan_vs_amt_20                            -- ２０日－訪問計画
      ,plan_vs_amt_21                            -- ２１日－訪問計画
      ,plan_vs_amt_22                            -- ２２日－訪問計画
      ,plan_vs_amt_23                            -- ２３日－訪問計画
      ,plan_vs_amt_24                            -- ２４日－訪問計画
      ,plan_vs_amt_25                            -- ２５日－訪問計画
      ,plan_vs_amt_26                            -- ２６日－訪問計画
      ,plan_vs_amt_27                            -- ２７日－訪問計画
      ,plan_vs_amt_28                            -- ２８日－訪問計画
      ,plan_vs_amt_29                            -- ２９日－訪問計画
      ,plan_vs_amt_30                            -- ３０日－訪問計画
      ,plan_vs_amt_31                            -- ３１日－訪問計画
      ,rslt_vs_amt_1                             -- １日－訪問実績
      ,rslt_vs_amt_2                             -- ２日－訪問実績
      ,rslt_vs_amt_3                             -- ３日－訪問実績
      ,rslt_vs_amt_4                             -- ４日－訪問実績
      ,rslt_vs_amt_5                             -- ５日－訪問実績
      ,rslt_vs_amt_6                             -- ６日－訪問実績
      ,rslt_vs_amt_7                             -- ７日－訪問実績
      ,rslt_vs_amt_8                             -- ８日－訪問実績
      ,rslt_vs_amt_9                             -- ９日－訪問実績
      ,rslt_vs_amt_10                            -- １０日－訪問実績
      ,rslt_vs_amt_11                            -- １１日－訪問実績
      ,rslt_vs_amt_12                            -- １２日－訪問実績
      ,rslt_vs_amt_13                            -- １３日－訪問実績
      ,rslt_vs_amt_14                            -- １４日－訪問実績
      ,rslt_vs_amt_15                            -- １５日－訪問実績
      ,rslt_vs_amt_16                            -- １６日－訪問実績
      ,rslt_vs_amt_17                            -- １７日－訪問実績
      ,rslt_vs_amt_18                            -- １８日－訪問実績
      ,rslt_vs_amt_19                            -- １９日－訪問実績
      ,rslt_vs_amt_20                            -- ２０日－訪問実績
      ,rslt_vs_amt_21                            -- ２１日－訪問実績
      ,rslt_vs_amt_22                            -- ２２日－訪問実績
      ,rslt_vs_amt_23                            -- ２３日－訪問実績
      ,rslt_vs_amt_24                            -- ２４日－訪問実績
      ,rslt_vs_amt_25                            -- ２５日－訪問実績
      ,rslt_vs_amt_26                            -- ２６日－訪問実績
      ,rslt_vs_amt_27                            -- ２７日－訪問実績
      ,rslt_vs_amt_28                            -- ２８日－訪問実績
      ,rslt_vs_amt_29                            -- ２９日－訪問実績
      ,rslt_vs_amt_30                            -- ３０日－訪問実績
      ,rslt_vs_amt_31                            -- ３１日－訪問実績
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind5                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.gvm_type                       -- 一般／自販機／ＭＣ
           ,plan_vs_amt_1                        -- １日－訪問計画
           ,plan_vs_amt_2                        -- ２日－訪問計画
           ,plan_vs_amt_3                        -- ３日－訪問計画
           ,plan_vs_amt_4                        -- ４日－訪問計画
           ,plan_vs_amt_5                        -- ５日－訪問計画
           ,plan_vs_amt_6                        -- ６日－訪問計画
           ,plan_vs_amt_7                        -- ７日－訪問計画
           ,plan_vs_amt_8                        -- ８日－訪問計画
           ,plan_vs_amt_9                        -- ９日－訪問計画
           ,plan_vs_amt_10                       -- １０日－訪問計画
           ,plan_vs_amt_11                       -- １１日－訪問計画
           ,plan_vs_amt_12                       -- １２日－訪問計画
           ,plan_vs_amt_13                       -- １３日－訪問計画
           ,plan_vs_amt_14                       -- １４日－訪問計画
           ,plan_vs_amt_15                       -- １５日－訪問計画
           ,plan_vs_amt_16                       -- １６日－訪問計画
           ,plan_vs_amt_17                       -- １７日－訪問計画
           ,plan_vs_amt_18                       -- １８日－訪問計画
           ,plan_vs_amt_19                       -- １９日－訪問計画
           ,plan_vs_amt_20                       -- ２０日－訪問計画
           ,plan_vs_amt_21                       -- ２１日－訪問計画
           ,plan_vs_amt_22                       -- ２２日－訪問計画
           ,plan_vs_amt_23                       -- ２３日－訪問計画
           ,plan_vs_amt_24                       -- ２４日－訪問計画
           ,plan_vs_amt_25                       -- ２５日－訪問計画
           ,plan_vs_amt_26                       -- ２６日－訪問計画
           ,plan_vs_amt_27                       -- ２７日－訪問計画
           ,plan_vs_amt_28                       -- ２８日－訪問計画
           ,plan_vs_amt_29                       -- ２９日－訪問計画
           ,plan_vs_amt_30                       -- ３０日－訪問計画
           ,plan_vs_amt_31                       -- ３１日－訪問計画
           ,rslt_vs_amt_1                        -- １日－訪問実績
           ,rslt_vs_amt_2                        -- ２日－訪問実績
           ,rslt_vs_amt_3                        -- ３日－訪問実績
           ,rslt_vs_amt_4                        -- ４日－訪問実績
           ,rslt_vs_amt_5                        -- ５日－訪問実績
           ,rslt_vs_amt_6                        -- ６日－訪問実績
           ,rslt_vs_amt_7                        -- ７日－訪問実績
           ,rslt_vs_amt_8                        -- ８日－訪問実績
           ,rslt_vs_amt_9                        -- ９日－訪問実績
           ,rslt_vs_amt_10                       -- １０日－訪問実績
           ,rslt_vs_amt_11                       -- １１日－訪問実績
           ,rslt_vs_amt_12                       -- １２日－訪問実績
           ,rslt_vs_amt_13                       -- １３日－訪問実績
           ,rslt_vs_amt_14                       -- １４日－訪問実績
           ,rslt_vs_amt_15                       -- １５日－訪問実績
           ,rslt_vs_amt_16                       -- １６日－訪問実績
           ,rslt_vs_amt_17                       -- １７日－訪問実績
           ,rslt_vs_amt_18                       -- １８日－訪問実績
           ,rslt_vs_amt_19                       -- １９日－訪問実績
           ,rslt_vs_amt_20                       -- ２０日－訪問実績
           ,rslt_vs_amt_21                       -- ２１日－訪問実績
           ,rslt_vs_amt_22                       -- ２２日－訪問実績
           ,rslt_vs_amt_23                       -- ２３日－訪問実績
           ,rslt_vs_amt_24                       -- ２４日－訪問実績
           ,rslt_vs_amt_25                       -- ２５日－訪問実績
           ,rslt_vs_amt_26                       -- ２６日－訪問実績
           ,rslt_vs_amt_27                       -- ２７日－訪問実績
           ,rslt_vs_amt_28                       -- ２８日－訪問実績
           ,rslt_vs_amt_29                       -- ２９日－訪問実績
           ,rslt_vs_amt_30                       -- ３０日－訪問実績
           ,rslt_vs_amt_31                       -- ３１日－訪問実績
    FROM    (
             -------------------------------------------
             --一般計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.up_base_code                     up_base_code
                    ,xrvsp.up_hub_name                      up_hub_name
                    ,cv_gvm_g                               gvm_type
                    ,SUM(xtrvp.tgt_vis_i_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_i_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_i_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_i_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_i_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_i_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_i_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_i_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_i_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_i_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_i_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_i_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_i_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_i_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_i_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_i_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_i_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_i_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_i_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_i_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_i_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_i_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_i_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_i_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_i_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_i_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_i_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_i_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_i_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_i_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_i_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_i_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_i_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_i_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_i_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_i_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_i_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_i_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_i_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_i_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_i_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_i_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_i_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_i_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_i_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_i_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_i_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_i_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_i_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_i_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_i_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_i_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_i_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_i_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_i_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_i_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_i_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_i_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_i_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_i_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_i_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_i_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             UNION ALL
             -------------------------------------------
             -- 自販機計
             -------------------------------------------
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.up_base_code                     up_base_code
                    ,xrvsp.up_hub_name                      up_hub_name
                    ,cv_gvm_v                               gvm_type
                    ,SUM(xtrvp.tgt_vis_v_num_1)             plan_vs_amt_1
                    ,SUM(xtrvp.tgt_vis_v_num_2)             plan_vs_amt_2
                    ,SUM(xtrvp.tgt_vis_v_num_3)             plan_vs_amt_3
                    ,SUM(xtrvp.tgt_vis_v_num_4)             plan_vs_amt_4
                    ,SUM(xtrvp.tgt_vis_v_num_5)             plan_vs_amt_5
                    ,SUM(xtrvp.tgt_vis_v_num_6)             plan_vs_amt_6
                    ,SUM(xtrvp.tgt_vis_v_num_7)             plan_vs_amt_7
                    ,SUM(xtrvp.tgt_vis_v_num_8)             plan_vs_amt_8
                    ,SUM(xtrvp.tgt_vis_v_num_9)             plan_vs_amt_9
                    ,SUM(xtrvp.tgt_vis_v_num_10)            plan_vs_amt_10
                    ,SUM(xtrvp.tgt_vis_v_num_11)            plan_vs_amt_11
                    ,SUM(xtrvp.tgt_vis_v_num_12)            plan_vs_amt_12
                    ,SUM(xtrvp.tgt_vis_v_num_13)            plan_vs_amt_13
                    ,SUM(xtrvp.tgt_vis_v_num_14)            plan_vs_amt_14
                    ,SUM(xtrvp.tgt_vis_v_num_15)            plan_vs_amt_15
                    ,SUM(xtrvp.tgt_vis_v_num_16)            plan_vs_amt_16
                    ,SUM(xtrvp.tgt_vis_v_num_17)            plan_vs_amt_17
                    ,SUM(xtrvp.tgt_vis_v_num_18)            plan_vs_amt_18
                    ,SUM(xtrvp.tgt_vis_v_num_19)            plan_vs_amt_19
                    ,SUM(xtrvp.tgt_vis_v_num_20)            plan_vs_amt_20
                    ,SUM(xtrvp.tgt_vis_v_num_21)            plan_vs_amt_21
                    ,SUM(xtrvp.tgt_vis_v_num_22)            plan_vs_amt_22
                    ,SUM(xtrvp.tgt_vis_v_num_23)            plan_vs_amt_23
                    ,SUM(xtrvp.tgt_vis_v_num_24)            plan_vs_amt_24
                    ,SUM(xtrvp.tgt_vis_v_num_25)            plan_vs_amt_25
                    ,SUM(xtrvp.tgt_vis_v_num_26)            plan_vs_amt_26
                    ,SUM(xtrvp.tgt_vis_v_num_27)            plan_vs_amt_27
                    ,SUM(xtrvp.tgt_vis_v_num_28)            plan_vs_amt_28
                    ,SUM(xtrvp.tgt_vis_v_num_29)            plan_vs_amt_29
                    ,SUM(xtrvp.tgt_vis_v_num_30)            plan_vs_amt_30
                    ,SUM(xtrvp.tgt_vis_v_num_31)            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_v_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_v_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_v_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_v_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_v_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_v_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_v_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_v_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_v_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_v_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_v_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_v_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_v_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_v_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_v_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_v_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_v_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_v_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_v_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_v_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_v_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_v_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_v_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_v_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_v_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_v_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_v_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_v_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_v_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_v_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_v_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                        --------------------------------------------
                        -- 子あり
                        --------------------------------------------
                        SELECT  gv_base_code              base_code
                               ,xablv.child_base_code     under_base_code
                        FROM    xxcso_aff_base_level_v2   xablv
                        START WITH
                                xablv.base_code = gv_base_code
                        CONNECT BY PRIOR
                                xablv.child_base_code = xablv.base_code
                        UNION ALL
                        --------------------------------------------
                        -- 子なし
                        --------------------------------------------
                        SELECT gv_base_code               base_code
                              ,gv_base_code               under_base_code
                        FROM   DUAL
                        WHERE  NOT EXISTS (
                                 SELECT  1
                                 FROM    xxcso_aff_base_level_v2  xablv
                                 WHERE   xablv.base_code = gv_base_code
                               )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             UNION ALL
             -------------------------------------------
             -- ＭＣ計
             -------------------------------------------
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.up_base_code           up_base_code
                    ,xrvsp.up_hub_name            up_hub_name
                    ,cv_gvm_m                     gvm_type
                    ,0                            plan_vs_amt_1
                    ,0                            plan_vs_amt_2
                    ,0                            plan_vs_amt_3
                    ,0                            plan_vs_amt_4
                    ,0                            plan_vs_amt_5
                    ,0                            plan_vs_amt_6
                    ,0                            plan_vs_amt_7
                    ,0                            plan_vs_amt_8
                    ,0                            plan_vs_amt_9
                    ,0                            plan_vs_amt_10
                    ,0                            plan_vs_amt_11
                    ,0                            plan_vs_amt_12
                    ,0                            plan_vs_amt_13
                    ,0                            plan_vs_amt_14
                    ,0                            plan_vs_amt_15
                    ,0                            plan_vs_amt_16
                    ,0                            plan_vs_amt_17
                    ,0                            plan_vs_amt_18
                    ,0                            plan_vs_amt_19
                    ,0                            plan_vs_amt_20
                    ,0                            plan_vs_amt_21
                    ,0                            plan_vs_amt_22
                    ,0                            plan_vs_amt_23
                    ,0                            plan_vs_amt_24
                    ,0                            plan_vs_amt_25
                    ,0                            plan_vs_amt_26
                    ,0                            plan_vs_amt_27
                    ,0                            plan_vs_amt_28
                    ,0                            plan_vs_amt_29
                    ,0                            plan_vs_amt_30
                    ,0                            plan_vs_amt_31
                    ,SUM(xtrvp.rslt_vis_m_num_1)            rslt_vs_amt_1
                    ,SUM(xtrvp.rslt_vis_m_num_2)            rslt_vs_amt_2
                    ,SUM(xtrvp.rslt_vis_m_num_3)            rslt_vs_amt_3
                    ,SUM(xtrvp.rslt_vis_m_num_4)            rslt_vs_amt_4
                    ,SUM(xtrvp.rslt_vis_m_num_5)            rslt_vs_amt_5
                    ,SUM(xtrvp.rslt_vis_m_num_6)            rslt_vs_amt_6
                    ,SUM(xtrvp.rslt_vis_m_num_7)            rslt_vs_amt_7
                    ,SUM(xtrvp.rslt_vis_m_num_8)            rslt_vs_amt_8
                    ,SUM(xtrvp.rslt_vis_m_num_9)            rslt_vs_amt_9
                    ,SUM(xtrvp.rslt_vis_m_num_10)           rslt_vs_amt_10
                    ,SUM(xtrvp.rslt_vis_m_num_11)           rslt_vs_amt_11
                    ,SUM(xtrvp.rslt_vis_m_num_12)           rslt_vs_amt_12
                    ,SUM(xtrvp.rslt_vis_m_num_13)           rslt_vs_amt_13
                    ,SUM(xtrvp.rslt_vis_m_num_14)           rslt_vs_amt_14
                    ,SUM(xtrvp.rslt_vis_m_num_15)           rslt_vs_amt_15
                    ,SUM(xtrvp.rslt_vis_m_num_16)           rslt_vs_amt_16
                    ,SUM(xtrvp.rslt_vis_m_num_17)           rslt_vs_amt_17
                    ,SUM(xtrvp.rslt_vis_m_num_18)           rslt_vs_amt_18
                    ,SUM(xtrvp.rslt_vis_m_num_19)           rslt_vs_amt_19
                    ,SUM(xtrvp.rslt_vis_m_num_20)           rslt_vs_amt_20
                    ,SUM(xtrvp.rslt_vis_m_num_21)           rslt_vs_amt_21
                    ,SUM(xtrvp.rslt_vis_m_num_22)           rslt_vs_amt_22
                    ,SUM(xtrvp.rslt_vis_m_num_23)           rslt_vs_amt_23
                    ,SUM(xtrvp.rslt_vis_m_num_24)           rslt_vs_amt_24
                    ,SUM(xtrvp.rslt_vis_m_num_25)           rslt_vs_amt_25
                    ,SUM(xtrvp.rslt_vis_m_num_26)           rslt_vs_amt_26
                    ,SUM(xtrvp.rslt_vis_m_num_27)           rslt_vs_amt_27
                    ,SUM(xtrvp.rslt_vis_m_num_28)           rslt_vs_amt_28
                    ,SUM(xtrvp.rslt_vis_m_num_29)           rslt_vs_amt_29
                    ,SUM(xtrvp.rslt_vis_m_num_30)           rslt_vs_amt_30
                    ,SUM(xtrvp.rslt_vis_m_num_31)           rslt_vs_amt_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－中計部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－有効訪問部
    -- 対象拠点に所属する営業員の有効訪問（日別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,effective_num_1                           -- １日－有効軒数
      ,effective_num_2                           -- ２日－有効軒数
      ,effective_num_3                           -- ３日－有効軒数
      ,effective_num_4                           -- ４日－有効軒数
      ,effective_num_5                           -- ５日－有効軒数
      ,effective_num_6                           -- ６日－有効軒数
      ,effective_num_7                           -- ７日－有効軒数
      ,effective_num_8                           -- ８日－有効軒数
      ,effective_num_9                           -- ９日－有効軒数
      ,effective_num_10                          -- １０日－有効軒数
      ,effective_num_11                          -- １１日－有効軒数
      ,effective_num_12                          -- １２日－有効軒数
      ,effective_num_13                          -- １３日－有効軒数
      ,effective_num_14                          -- １４日－有効軒数
      ,effective_num_15                          -- １５日－有効軒数
      ,effective_num_16                          -- １６日－有効軒数
      ,effective_num_17                          -- １７日－有効軒数
      ,effective_num_18                          -- １８日－有効軒数
      ,effective_num_19                          -- １９日－有効軒数
      ,effective_num_20                          -- ２０日－有効軒数
      ,effective_num_21                          -- ２１日－有効軒数
      ,effective_num_22                          -- ２２日－有効軒数
      ,effective_num_23                          -- ２３日－有効軒数
      ,effective_num_24                          -- ２４日－有効軒数
      ,effective_num_25                          -- ２５日－有効軒数
      ,effective_num_26                          -- ２６日－有効軒数
      ,effective_num_27                          -- ２７日－有効軒数
      ,effective_num_28                          -- ２８日－有効軒数
      ,effective_num_29                          -- ２９日－有効軒数
      ,effective_num_30                          -- ３０日－有効軒数
      ,effective_num_31                          -- ３１日－有効軒数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind6                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.effective_num_1                -- １日－有効軒数
           ,inn_v.effective_num_2                -- ２日－有効軒数
           ,inn_v.effective_num_3                -- ３日－有効軒数
           ,inn_v.effective_num_4                -- ４日－有効軒数
           ,inn_v.effective_num_5                -- ５日－有効軒数
           ,inn_v.effective_num_6                -- ６日－有効軒数
           ,inn_v.effective_num_7                -- ７日－有効軒数
           ,inn_v.effective_num_8                -- ８日－有効軒数
           ,inn_v.effective_num_9                -- ９日－有効軒数
           ,inn_v.effective_num_10               -- １０日－有効軒数
           ,inn_v.effective_num_11               -- １１日－有効軒数
           ,inn_v.effective_num_12               -- １２日－有効軒数
           ,inn_v.effective_num_13               -- １３日－有効軒数
           ,inn_v.effective_num_14               -- １４日－有効軒数
           ,inn_v.effective_num_15               -- １５日－有効軒数
           ,inn_v.effective_num_16               -- １６日－有効軒数
           ,inn_v.effective_num_17               -- １７日－有効軒数
           ,inn_v.effective_num_18               -- １８日－有効軒数
           ,inn_v.effective_num_19               -- １９日－有効軒数
           ,inn_v.effective_num_20               -- ２０日－有効軒数
           ,inn_v.effective_num_21               -- ２１日－有効軒数
           ,inn_v.effective_num_22               -- ２２日－有効軒数
           ,inn_v.effective_num_23               -- ２３日－有効軒数
           ,inn_v.effective_num_24               -- ２４日－有効軒数
           ,inn_v.effective_num_25               -- ２５日－有効軒数
           ,inn_v.effective_num_26               -- ２６日－有効軒数
           ,inn_v.effective_num_27               -- ２７日－有効軒数
           ,inn_v.effective_num_28               -- ２８日－有効軒数
           ,inn_v.effective_num_29               -- ２９日－有効軒数
           ,inn_v.effective_num_30               -- ３０日－有効軒数
           ,inn_v.effective_num_31               -- ３１日－有効軒数
    FROM    (
             SELECT  xrvsp.report_output_no                 report_output_no
                    ,xrvsp.up_base_code                     up_base_code
                    ,xrvsp.up_hub_name                      up_hub_name
                    ,SUM(xtrvp.rslt_vis_e_num_1)            effective_num_1
                    ,SUM(xtrvp.rslt_vis_e_num_2)            effective_num_2
                    ,SUM(xtrvp.rslt_vis_e_num_3)            effective_num_3
                    ,SUM(xtrvp.rslt_vis_e_num_4)            effective_num_4
                    ,SUM(xtrvp.rslt_vis_e_num_5)            effective_num_5
                    ,SUM(xtrvp.rslt_vis_e_num_6)            effective_num_6
                    ,SUM(xtrvp.rslt_vis_e_num_7)            effective_num_7
                    ,SUM(xtrvp.rslt_vis_e_num_8)            effective_num_8
                    ,SUM(xtrvp.rslt_vis_e_num_9)            effective_num_9
                    ,SUM(xtrvp.rslt_vis_e_num_10)           effective_num_10
                    ,SUM(xtrvp.rslt_vis_e_num_11)           effective_num_11
                    ,SUM(xtrvp.rslt_vis_e_num_12)           effective_num_12
                    ,SUM(xtrvp.rslt_vis_e_num_13)           effective_num_13
                    ,SUM(xtrvp.rslt_vis_e_num_14)           effective_num_14
                    ,SUM(xtrvp.rslt_vis_e_num_15)           effective_num_15
                    ,SUM(xtrvp.rslt_vis_e_num_16)           effective_num_16
                    ,SUM(xtrvp.rslt_vis_e_num_17)           effective_num_17
                    ,SUM(xtrvp.rslt_vis_e_num_18)           effective_num_18
                    ,SUM(xtrvp.rslt_vis_e_num_19)           effective_num_19
                    ,SUM(xtrvp.rslt_vis_e_num_20)           effective_num_20
                    ,SUM(xtrvp.rslt_vis_e_num_21)           effective_num_21
                    ,SUM(xtrvp.rslt_vis_e_num_22)           effective_num_22
                    ,SUM(xtrvp.rslt_vis_e_num_23)           effective_num_23
                    ,SUM(xtrvp.rslt_vis_e_num_24)           effective_num_24
                    ,SUM(xtrvp.rslt_vis_e_num_25)           effective_num_25
                    ,SUM(xtrvp.rslt_vis_e_num_26)           effective_num_26
                    ,SUM(xtrvp.rslt_vis_e_num_27)           effective_num_27
                    ,SUM(xtrvp.rslt_vis_e_num_28)           effective_num_28
                    ,SUM(xtrvp.rslt_vis_e_num_29)           effective_num_29
                    ,SUM(xtrvp.rslt_vis_e_num_30)           effective_num_30
                    ,SUM(xtrvp.rslt_vis_e_num_31)           effective_num_31
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
             ORDER BY  report_output_no
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－有効訪問部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 開始');
--
    ------------------------------------------------------------------------
    -- ■訪問－明細部
    -- 対象拠点の訪問記号計（月別）を取得する
    ------------------------------------------------------------------------
    INSERT INTO xxcso_rep_visit_sale_plan(
       created_by                                -- 作成者
      ,creation_date                             -- 作成日
      ,last_updated_by                           -- 最終更新者
      ,last_update_date                          -- 最終更新日
      ,last_update_login                         -- 最終更新ログイン
      ,request_id                                -- 要求ID
      ,program_application_id                    -- コンカレント・プログラム・アプリケーションID
      ,program_id                                -- コンカレント・プログラムID
      ,program_update_date                       -- プログラム更新日
      ,report_output_no                          -- 帳票出力セット番号
      ,line_kind                                 -- 帳票出力位置
      ,line_num                                  -- 行番号
      ,up_base_code                              -- 拠点コード（親）
      ,up_hub_name                               -- 拠点名称（親）
      ,vis_a_num                                 -- 訪問Ａ件数
      ,vis_b_num                                 -- 訪問Ｂ件数
      ,vis_c_num                                 -- 訪問Ｃ件数
      ,vis_d_num                                 -- 訪問Ｄ件数
      ,vis_e_num                                 -- 訪問Ｅ件数
      ,vis_f_num                                 -- 訪問Ｆ件数
      ,vis_g_num                                 -- 訪問Ｇ件数
      ,vis_h_num                                 -- 訪問Ｈ件数
      ,vis_i_num                                 -- 訪問Ｉ件数
      ,vis_j_num                                 -- 訪問Ｊ件数
      ,vis_k_num                                 -- 訪問Ｋ件数
      ,vis_l_num                                 -- 訪問Ｌ件数
      ,vis_m_num                                 -- 訪問Ｍ件数
      ,vis_n_num                                 -- 訪問Ｎ件数
      ,vis_o_num                                 -- 訪問Ｏ件数
      ,vis_p_num                                 -- 訪問Ｐ件数
      ,vis_q_num                                 -- 訪問Ｑ件数
      ,vis_r_num                                 -- 訪問Ｒ件数
      ,vis_s_num                                 -- 訪問Ｓ件数
      ,vis_t_num                                 -- 訪問Ｔ件数
      ,vis_u_num                                 -- 訪問Ｕ件数
      ,vis_v_num                                 -- 訪問Ｖ件数
      ,vis_w_num                                 -- 訪問Ｗ件数
      ,vis_x_num                                 -- 訪問Ｘ件数
      ,vis_y_num                                 -- 訪問Ｙ件数
      ,vis_z_num                                 -- 訪問Ｚ件数
    )
    SELECT  cn_created_by                        -- 作成者
           ,cd_creation_date                     -- 作成日
           ,cn_last_updated_by                   -- 最終更新者
           ,cd_last_update_date                  -- 最終更新日
           ,cn_last_update_login                 -- 最終更新ログイン
           ,cn_request_id                        -- 要求ID
           ,cn_program_application_id            -- コンカレント・プログラム・アプリケーションID
           ,cn_program_id                        -- コンカレント・プログラムID
           ,cd_program_update_date               -- プログラム更新日
           ,inn_v.report_output_no               -- 帳票出力セット番号
           ,cn_line_kind7                        -- 帳票出力位置
           ,ROWNUM                               -- 行番号
           ,inn_v.up_base_code                   -- 拠点コード（親）
           ,inn_v.up_hub_name                    -- 拠点名称（親）
           ,inn_v.vis_a_num                      -- 訪問Ａ件数
           ,inn_v.vis_b_num                      -- 訪問Ｂ件数
           ,inn_v.vis_c_num                      -- 訪問Ｃ件数
           ,inn_v.vis_d_num                      -- 訪問Ｄ件数
           ,inn_v.vis_e_num                      -- 訪問Ｅ件数
           ,inn_v.vis_f_num                      -- 訪問Ｆ件数
           ,inn_v.vis_g_num                      -- 訪問Ｇ件数
           ,inn_v.vis_h_num                      -- 訪問Ｈ件数
           ,inn_v.vis_i_num                      -- 訪問Ｉ件数
           ,inn_v.vis_j_num                      -- 訪問Ｊ件数
           ,inn_v.vis_k_num                      -- 訪問Ｋ件数
           ,inn_v.vis_l_num                      -- 訪問Ｌ件数
           ,inn_v.vis_m_num                      -- 訪問Ｍ件数
           ,inn_v.vis_n_num                      -- 訪問Ｎ件数
           ,inn_v.vis_o_num                      -- 訪問Ｏ件数
           ,inn_v.vis_p_num                      -- 訪問Ｐ件数
           ,inn_v.vis_q_num                      -- 訪問Ｑ件数
           ,inn_v.vis_r_num                      -- 訪問Ｒ件数
           ,inn_v.vis_s_num                      -- 訪問Ｓ件数
           ,inn_v.vis_t_num                      -- 訪問Ｔ件数
           ,inn_v.vis_u_num                      -- 訪問Ｕ件数
           ,inn_v.vis_v_num                      -- 訪問Ｖ件数
           ,inn_v.vis_w_num                      -- 訪問Ｗ件数
           ,inn_v.vis_x_num                      -- 訪問Ｘ件数
           ,inn_v.vis_y_num                      -- 訪問Ｙ件数
           ,inn_v.vis_z_num                      -- 訪問Ｚ件数
    FROM    (
             SELECT  xrvsp.report_output_no       report_output_no
                    ,xrvsp.up_base_code           up_base_code
                    ,xrvsp.up_hub_name            up_hub_name
                    ,SUM(xsvsr.vis_a_num)         vis_a_num
                    ,SUM(xsvsr.vis_b_num)         vis_b_num
                    ,SUM(xsvsr.vis_c_num)         vis_c_num
                    ,SUM(xsvsr.vis_d_num)         vis_d_num
                    ,SUM(xsvsr.vis_e_num)         vis_e_num
                    ,SUM(xsvsr.vis_f_num)         vis_f_num
                    ,SUM(xsvsr.vis_g_num)         vis_g_num
                    ,SUM(xsvsr.vis_h_num)         vis_h_num
                    ,SUM(xsvsr.vis_i_num)         vis_i_num
                    ,SUM(xsvsr.vis_j_num)         vis_j_num
                    ,SUM(xsvsr.vis_k_num)         vis_k_num
                    ,SUM(xsvsr.vis_l_num)         vis_l_num
                    ,SUM(xsvsr.vis_m_num)         vis_m_num
                    ,SUM(xsvsr.vis_n_num)         vis_n_num
                    ,SUM(xsvsr.vis_o_num)         vis_o_num
                    ,SUM(xsvsr.vis_p_num)         vis_p_num
                    ,SUM(xsvsr.vis_q_num)         vis_q_num
                    ,SUM(xsvsr.vis_r_num)         vis_r_num
                    ,SUM(xsvsr.vis_s_num)         vis_s_num
                    ,SUM(xsvsr.vis_t_num)         vis_t_num
                    ,SUM(xsvsr.vis_u_num)         vis_u_num
                    ,SUM(xsvsr.vis_v_num)         vis_v_num
                    ,SUM(xsvsr.vis_w_num)         vis_w_num
                    ,SUM(xsvsr.vis_x_num)         vis_x_num
                    ,SUM(xsvsr.vis_y_num)         vis_y_num
                    ,SUM(xsvsr.vis_z_num)         vis_z_num
             FROM    xxcso_rep_visit_sale_plan    xrvsp
                    ,(
                      --------------------------------------------
                      -- 子あり
                      --------------------------------------------
                      SELECT  gv_base_code              base_code
                             ,xablv.child_base_code     under_base_code
                      FROM    xxcso_aff_base_level_v2   xablv
                      START WITH
                              xablv.base_code = gv_base_code
                      CONNECT BY PRIOR
                              xablv.child_base_code = xablv.base_code
                      UNION ALL
                      --------------------------------------------
                      -- 子なし
                      --------------------------------------------
                      SELECT gv_base_code               base_code
                            ,gv_base_code               under_base_code
                      FROM   DUAL
                      WHERE  NOT EXISTS (
                               SELECT  1
                               FROM    xxcso_aff_base_level_v2  xablv
                               WHERE   xablv.base_code = gv_base_code
                             )
                     )                            xabv
                    ,xxcso_tmp_rep_vs_plan        xtrvp
                    ,xxcso_sum_visit_sale_rep     xsvsr
             WHERE   xrvsp.request_id             = cn_request_id
               AND   xrvsp.line_kind              = cn_line_kind1
               AND   xabv.base_code(+)            = xrvsp.up_base_code
               AND   xtrvp.base_code(+)           = xabv.under_base_code
               AND   xsvsr.sum_org_type(+)        = cv_sum_org_type1
               AND   xsvsr.sum_org_code(+)        = xtrvp.account_number
               AND   xsvsr.group_base_code(+)     = xtrvp.base_code
               AND   xsvsr.month_date_div(+)      = cv_month_date_div1
               AND   xsvsr.sales_date(+)          = gv_year_month
             GROUP BY  xrvsp.report_output_no
                      ,xrvsp.up_base_code
                      ,xrvsp.up_hub_name
            ) inn_v
    ;
--
    debug(TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') || ' 訪問－明細部取得 終了（件数：' || SQL%ROWCOUNT || '）');
--
    -- 抽出件数を保存
    gn_target_cnt := gn_target_cnt + SQL%ROWCOUNT;
    gn_normal_cnt := gn_normal_cnt + SQL%ROWCOUNT;
--
/* 20090519_Ogawa_T1_1056 END*/
/* 20090519_Ogawa_T1_1037 END*/
/* 20090519_Ogawa_T1_1033 END*/
/* 20090519_Ogawa_T1_1031 END*/
/* 20090519_Ogawa_T1_1024 END*/
/* 20090519_Ogawa_T1_1021 END*/
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END get_ticket5;
--
  /**********************************************************************************
   * Procedure Name   : act_svf
   * Description      : SVF起動処理 (A-8)
   ***********************************************************************************/
  PROCEDURE act_svf(
    ov_errbuf     OUT NOCOPY VARCHAR2,     --   エラー・メッセージ           --# 固定 #
    ov_retcode    OUT NOCOPY VARCHAR2,     --   リターン・コード             --# 固定 #
    ov_errmsg     OUT NOCOPY VARCHAR2)     --   ユーザー・エラー・メッセージ --# 固定 #
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name   CONSTANT VARCHAR2(100) := 'act_svf'; -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(5000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(5000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
    cv_svf_api_name    CONSTANT VARCHAR2(50) := 'SVF起動';     -- SVF起動API名
--
    -- *** ローカル変数 ***
    lv_svf_file_name   VARCHAR2(100);
    lv_file_id         VARCHAR2(30)  := NULL;
    lv_conc_name       VARCHAR2(30)  := NULL;
    lv_user_name       VARCHAR2(240) := NULL;
    lv_resp_name       VARCHAR2(240) := NULL;
--
    -- *** ローカル・カーソル ***
--
    -- *** ローカル・レコード ***
--
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
--
    -- ファイル名の設定
    lv_svf_file_name := cv_pkg_name
                     || TO_CHAR(cd_creation_date, 'YYYYMMDD')
                     || TO_CHAR(cn_request_id);
--
      BEGIN
        SELECT  user_concurrent_program_name,
                xx00_global_pkg.user_name   ,
                xx00_global_pkg.resp_name
        INTO    lv_conc_name,
                lv_user_name,
                lv_resp_name
        FROM    fnd_concurrent_programs_tl
        WHERE   concurrent_program_id =cn_request_id
        AND     LANGUAGE = 'JA'
        ;
      EXCEPTION
        WHEN OTHERS THEN
          lv_conc_name := cv_pkg_name;
      END;
--
      lv_file_id := cv_pkg_name;
--
-- 帳票サーバ立上時に有効化
    xxccp_svfcommon_pkg.submit_svf_request(
       ov_errbuf       => lv_errbuf            -- エラー・メッセージ           --# 固定 #
      ,ov_retcode      => lv_retcode           -- リターン・コード             --# 固定 #
      ,ov_errmsg       => lv_errmsg            -- ユーザー・エラー・メッセージ --# 固定 #
      ,iv_conc_name    => lv_conc_name         -- コンカレント名
      ,iv_file_name    => lv_svf_file_name     -- 出力ファイル名
      ,iv_file_id      => lv_file_id           -- 帳票ID
      ,iv_output_mode  => '1'                  -- 出力区分(=1：PDF出力）
      ,iv_frm_file     => gv_svf_form_name     -- フォーム様式ファイル名
      ,iv_vrq_file     => gv_svf_query_name    -- クエリー様式ファイル名
      ,iv_org_id       => fnd_global.org_id    -- ORG_ID
      ,iv_user_name    => lv_user_name         -- ログイン・ユーザ名
      ,iv_resp_name    => lv_resp_name         -- ログイン・ユーザの職責名
      ,iv_doc_name     => NULL                 -- 文書名
      ,iv_printer_name => NULL                 -- プリンタ名
      ,iv_request_id   => cn_request_id        -- 要求ID
      ,iv_nodata_msg   => NULL                 -- データなしメッセージ
    );
--
DO_ERROR('A-8');
--
    debug(
       buff   => 'SVF起動処理 (A-8)'
    );
--
    IF (lv_retcode <> cv_status_normal) THEN
--
      lv_errmsg := xxccp_common_pkg.get_msg(
                              iv_application  => cv_app_name              --アプリケーション短縮名
                             ,iv_name         => cv_tkn_number_09         --メッセージコード
                             ,iv_token_name1  => cv_tkn_api_name          --トークンコード1
                             ,iv_token_value1 => cv_svf_api_name          --「SVF起動」
                   );
      lv_errbuf := lv_errmsg;
      RAISE global_api_expt;
    END IF;
--
  EXCEPTION
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END act_svf;
--
  /**********************************************************************************
   * Procedure Name   : del_wrk_tbl_data
   * Description      : ワークテーブルデータ削除 (A-9)
   ***********************************************************************************/
  PROCEDURE del_wrk_tbl_data(
    ov_errbuf               OUT NOCOPY VARCHAR2,         -- エラー・メッセージ           --# 固定 #
    ov_retcode              OUT NOCOPY VARCHAR2,         -- リターン・コード             --# 固定 #
    ov_errmsg               OUT NOCOPY VARCHAR2          -- ユーザー・エラー・メッセージ --# 固定 #
  )
  IS
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name              CONSTANT VARCHAR2(100)    := 'del_wrk_tbl_data';         -- プログラム名
    cv_table_name            CONSTANT VARCHAR2(100)    := '訪問売上計画管理表帳票ワークテーブル';
      -- 訪問売上計画管理表帳票ワークテーブル名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf   VARCHAR2(5000);   -- エラー・メッセージ
    lv_retcode  VARCHAR2(1);      -- リターン・コード
    lv_errmsg   VARCHAR2(5000);   -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル定数 ***
--
    -- *** ローカル変数 ***
--
    -- *** ローカル・カーソル ***
--
    -- *** ローカル・レコード ***
--
    -- *** ローカル・例外 ***
    del_tbl_data_expt     EXCEPTION;
--
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
    -- *******************************************************
    -- ***  訪問売上計画管理表帳票ワークテーブルデータ削除 ***
    -- *******************************************************
--TODO 単体テスト終了時に有効化
    BEGIN
      IF ( CB_DO_DELETE ) THEN
        DELETE
        FROM  xxcso_rep_visit_sale_plan
        WHERE request_id = cn_request_id;
        debug(
           buff   => 'ワークテーブルデータ削除実行 (A-9)'
        );
      ELSE
        debug(
           buff   => 'ワークテーブルデータ削除実行スキップ (A-9)'
        );
      END IF;
--
    EXCEPTION
      -- *** OTHERS例外ハンドラ ***
      WHEN OTHERS THEN
        -- エラーメッセージ作成
        lv_errmsg := xxccp_common_pkg.get_msg(
                        iv_application  => cv_app_name                   -- アプリケーション短縮名
                       ,iv_name         => cv_tkn_number_10              -- メッセージコード データ削除エラー
                       ,iv_token_name1  => cv_tkn_table                  -- トークンコード1
                       ,iv_token_value1 => cv_table_name                 -- エラー発生のテーブル名
                       ,iv_token_name2  => cv_tkn_errmsg                 -- トークンコード2
                       ,iv_token_value2 => SQLERRM                       -- ORACLEエラー
                      );
        lv_errbuf  := lv_errmsg||SQLERRM;
        RAISE del_tbl_data_expt;
    END;
--
DO_ERROR('A-9');
--
  EXCEPTION
    -- *** データ削除時の例外ハンドラ ***
    WHEN del_tbl_data_expt THEN
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
--
--#################################  固定例外処理部 START   ####################################
--
    -- *** 共通関数例外ハンドラ ***
    WHEN global_api_expt THEN
      lv_errbuf  := lv_errmsg;
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,5000);
      ov_retcode := cv_status_error;
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM||lv_errbuf;
      ov_retcode := cv_status_error;
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END del_wrk_tbl_data;
--
  /**********************************************************************************
   * Procedure Name   : submain
   * Description      : メイン処理プロシージャ
   ***********************************************************************************/
  PROCEDURE submain(
     iv_year_month        IN        VARCHAR2   -- 基準年月
    ,iv_report_type       IN        VARCHAR2   -- 帳票種別
    ,iv_base_code         IN        VARCHAR2   -- 拠点コード
    ,ov_errbuf           OUT NOCOPY VARCHAR2   -- エラー・メッセージ            --# 固定 #
    ,ov_retcode          OUT NOCOPY VARCHAR2   -- リターン・コード              --# 固定 #
    ,ov_errmsg           OUT NOCOPY VARCHAR2   -- ユーザー・エラー・メッセージ  --# 固定 #
  )
  IS
        -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name             CONSTANT VARCHAR2(100)   := 'submain';     -- プログラム名
--
--#####################  固定ローカル変数宣言部 START   ########################
--
    lv_errbuf  VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode VARCHAR2(1);     -- リターン・コード
    lv_errmsg  VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
--
--###########################  固定部 END   ####################################
--
    -- ===============================
    -- ユーザー宣言部
    -- ===============================
    -- *** ローカル変数 ***
    lv_year_month      VARCHAR2(6);     -- 基準年月
    lv_report_type     VARCHAR2(9);     -- 帳票種別
    lv_base_code       VARCHAR2(9);     -- 拠点コード
    -- SVF起動API戻り値格納用
    lv_errbuf_svf      VARCHAR2(5000);  -- エラー・メッセージ
    lv_retcode_svf     VARCHAR2(1);     -- リターン・コード
    lv_errmsg_svf      VARCHAR2(5000);  -- ユーザー・エラー・メッセージ
    -- OUTパラメータ格納用
    -- メッセージ出力用
    lv_msg               VARCHAR2(2000);
--
    -- *** ローカル・レコード ***
    -- *** ローカル例外 ***
  BEGIN
--
--##################  固定ステータス初期化部 START   ###################
--
    ov_retcode := cv_status_normal;
--
--###########################  固定部 END   ############################
--
--
    -- グローバル変数の初期化
    gd_online_sysdate     := XXCSO_UTIL_COMMON_PKG.GET_ONLINE_SYSDATE();
    gv_online_sysdate     := TO_CHAR(gd_online_sysdate,'YYYYMMDD');
    gn_target_cnt         := 0;
    gn_normal_cnt         := 0;
    gn_error_cnt          := 0;
    gn_warn_cnt           := 0;
    lv_year_month         := iv_year_month;
    lv_report_type        := iv_report_type;
    lv_base_code          := iv_base_code;
--
  -- ========================================
  -- A-1.初期処理
  -- ========================================
    init(
       iv_year_month => lv_year_month     -- 基準年月
      ,iv_report_type=> lv_report_type    -- 帳票種別
      ,iv_base_code  => lv_base_code      -- 拠点コード
      ,ov_errbuf     => lv_errbuf         -- エラー・メッセージ            --# 固定 #
      ,ov_retcode    => lv_retcode        -- リターン・コード              --# 固定 #
      ,ov_errmsg     => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
    );
    IF (lv_retcode = cv_status_error) THEN
      RAISE global_process_expt;
    END IF;
  -- ======================================
  -- A-2.パラメータチェック
  -- =======================================
    chek_param(
       ov_errbuf     => lv_errbuf         -- エラー・メッセージ            --# 固定 #
      ,ov_retcode    => lv_retcode        -- リターン・コード              --# 固定 #
      ,ov_errmsg     => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
    );
    IF (lv_retcode = cv_status_error) THEN
      RAISE global_process_expt;
    END IF;
--
DO_ERROR('submain');
--
    IF (gv_report_type = cv_report_1) THEN
      -- ======================================
      -- A-3-1,A-3-2.帳票種別1-営業員別
      -- ======================================
      get_ticket1(
         ov_errbuf    => lv_errbuf         -- エラー・メッセージ            --# 固定 #
        ,ov_retcode   => lv_retcode        -- リターン・コード              --# 固定 #
        ,ov_errmsg    => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
      );
      IF (lv_retcode = cv_status_error) THEN
        RAISE global_process_expt;
      END IF;
    ELSIF (gv_report_type = cv_report_2) THEN
      -- ======================================
      -- A-4-1,A-4-2 帳票種別2-営業員グループ別
      -- ======================================
      get_ticket2(
         ov_errbuf    => lv_errbuf         -- エラー・メッセージ            --# 固定 #
        ,ov_retcode   => lv_retcode        -- リターン・コード              --# 固定 #
        ,ov_errmsg    => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
      );
      IF (lv_retcode = cv_status_error) THEN
        RAISE global_process_expt;
      END IF;
    ELSIF (gv_report_type = cv_report_3) THEN
      -- ======================================
      -- A-5-1,A-5-2 帳票種別3-拠点/課別
      -- ======================================
      get_ticket3(
         ov_errbuf    => lv_errbuf         -- エラー・メッセージ            --# 固定 #
        ,ov_retcode   => lv_retcode        -- リターン・コード              --# 固定 #
        ,ov_errmsg    => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
      );
      IF (lv_retcode = cv_status_error) THEN
        RAISE global_process_expt;
      END IF;
    ELSIF (gv_report_type = cv_report_4) THEN
      -- ======================================
      -- A-6-1,A-6-2 帳票種別4-地区営業部別
      -- ======================================
      get_ticket4(
         ov_errbuf    => lv_errbuf         -- エラー・メッセージ            --# 固定 #
        ,ov_retcode   => lv_retcode        -- リターン・コード              --# 固定 #
        ,ov_errmsg    => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
      );
      IF (lv_retcode = cv_status_error) THEN
        RAISE global_process_expt;
      END IF;
    ELSIF (gv_report_type = cv_report_5) THEN
      -- ======================================
      -- A-7-1,A-7-2 帳票種別5-地域営業本部別
      -- ======================================
      get_ticket5(
         ov_errbuf    => lv_errbuf         -- エラー・メッセージ            --# 固定 #
        ,ov_retcode   => lv_retcode        -- リターン・コード              --# 固定 #
        ,ov_errmsg    => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
      );
      IF (lv_retcode = cv_status_error) THEN
        RAISE global_process_expt;
      END IF;
    END IF;
--
    -- 処理対象データが0件の場合
    IF gn_target_cnt = 0 THEN
      -- 0件メッセージ出力
      lv_errmsg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_app_name         --アプリケーション短縮名
                    ,iv_name         => cv_tkn_number_11    --メッセージコード
                   );
      fnd_file.put_line(
         which  => FND_FILE.LOG
        ,buff   => lv_errmsg                                 --ユーザー・エラーメッセージ
      );
      RETURN;
    END IF;
--
    -- ======================================
    -- A-8 SVF起動
    -- ======================================
    act_svf(
       ov_errbuf    => lv_errbuf_svf     -- エラー・メッセージ            --# 固定 #
      ,ov_retcode   => lv_retcode_svf    -- リターン・コード              --# 固定 #
      ,ov_errmsg    => lv_errmsg_svf     -- ユーザー・エラー・メッセージ  --# 固定 #
    );
--
    -- ======================================
    -- A-9 ワークテーブルデータ削除
    -- ======================================
    del_wrk_tbl_data(
       ov_errbuf    => lv_errbuf         -- エラー・メッセージ            --# 固定 #
      ,ov_retcode   => lv_retcode        -- リターン・コード              --# 固定 #
      ,ov_errmsg    => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
    );
    IF (lv_retcode = cv_status_error) THEN
      RAISE global_process_expt;
    END IF;
--
    -- ======================================
    -- A-10 SVF起動APIエラーチェック
    -- ======================================
    IF (lv_retcode_svf = cv_status_error) THEN
      lv_errmsg := lv_errmsg_svf;
      lv_errbuf := lv_errbuf_svf;
      RAISE global_process_expt;
    END IF;
--
--
--#################################  固定例外処理部 START   ####################################
--
    EXCEPTION
    -- *** 処理部共通例外ハンドラ ***
    WHEN global_process_expt THEN
      -- エラー件数カウント
      gn_error_cnt := gn_error_cnt + 1;
--
      -- カーソルがクローズされていない場合
--
      ov_errmsg  := lv_errmsg;
      ov_errbuf  := SUBSTRB(cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||lv_errbuf,1,4000);
      ov_retcode := cv_status_error;
--
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      -- エラー件数カウント
      gn_error_cnt := gn_error_cnt + 1;
--
      -- カーソルがクローズされていない場合
--
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM||lv_errbuf;
      ov_retcode := cv_status_error;
--
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      -- エラー件数カウント
      gn_error_cnt := gn_error_cnt + 1;
--
      -- カーソルがクローズされていない場合
--
      ov_errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      ov_retcode := cv_status_error;
--
--#####################################  固定部 END   ##########################################
--
  END submain;
--
  /**********************************************************************************
   * Procedure Name   : main
   * Description      : コンカレント実行ファイル登録プロシージャ
   **********************************************************************************/
--
  PROCEDURE main(
    errbuf            OUT NOCOPY VARCHAR2          -- エラーメッセージ #固定#
   ,retcode           OUT NOCOPY VARCHAR2          -- エラーコード     #固定#
   ,iv_year_month     IN         VARCHAR2          -- 基準年月
   ,iv_report_type    IN         VARCHAR2          -- 帳票種別
   ,iv_base_code      IN         VARCHAR2          -- 拠点コード
    )
--
--###########################  固定部 START   ###########################
--
  IS
--
    -- ===============================
    -- 固定ローカル定数
    -- ===============================
    cv_prg_name        CONSTANT VARCHAR2(100) := 'main';  -- プログラム名
--
    cv_appl_short_name CONSTANT VARCHAR2(10)  := 'XXCCP';            -- アドオン：共通・IF領域
    cv_target_rec_msg  CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90000'; -- 対象件数メッセージ
    cv_success_rec_msg CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90001'; -- 成功件数メッセージ
    cv_error_rec_msg   CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90002'; -- エラー件数メッセージ
    cv_skip_rec_msg    CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90003'; -- スキップ件数メッセージ
    cv_cnt_token       CONSTANT VARCHAR2(10)  := 'COUNT';            -- 件数メッセージ用トークン名
    cv_normal_msg      CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90004'; -- 正常終了メッセージ
    cv_warn_msg        CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90005'; -- 警告終了メッセージ
    cv_error_msg       CONSTANT VARCHAR2(100) := 'APP-XXCCP1-90006'; -- エラー終了全ロールバック
    -- ===============================
    -- ローカル変数
    -- ===============================
    lv_errbuf          VARCHAR2(4000);  -- エラー・メッセージ
    lv_retcode         VARCHAR2(1);     -- リターン・コード
    lv_errmsg          VARCHAR2(4000);  -- ユーザー・エラー・メッセージ
    lv_message_code    VARCHAR2(100);   -- 終了メッセージコード
    lv_year_month      VARCHAR2(6);     -- 基準年月
    lv_report_type     VARCHAR2(9);     -- 帳票種別
    lv_base_code       VARCHAR2(9);     -- 拠点コード
--
  BEGIN
--###########################  固定部 START   #####################################################
--
    -- 固定出力
    -- コンカレントヘッダメッセージ出力関数の呼び出し
    xxccp_common_pkg.put_log_header(
       ov_retcode => lv_retcode
      ,ov_errbuf  => lv_errbuf
      ,ov_errmsg  => lv_errmsg
    );
    --
    IF (lv_retcode = cv_status_error) THEN
      RAISE global_api_others_expt;
    END IF;
--
--###########################  固定部 END   #############################
--
    lv_year_month      := iv_year_month;
    lv_report_type     := iv_report_type;
    lv_base_code       := iv_base_code;
    -- ===============================================
    -- submainの呼び出し（実際の処理はsubmainで行う）
    -- ===============================================
    submain(
       iv_year_month    => lv_year_month     -- 基準年月
      ,iv_report_type   => lv_report_type    -- 帳票種別
      ,iv_base_code     => lv_base_code      -- 拠点コード
      ,ov_errbuf        => lv_errbuf         -- エラー・メッセージ            --# 固定 #
      ,ov_retcode       => lv_retcode        -- リターン・コード              --# 固定 #
      ,ov_errmsg        => lv_errmsg         -- ユーザー・エラー・メッセージ  --# 固定 #
    );
--
DO_ERROR('main');
--
    IF (lv_retcode = cv_status_error) THEN
       --エラー出力
       fnd_file.put_line(
          which  => FND_FILE.LOG
         ,buff   => lv_errmsg                  --ユーザー・エラーメッセージ
       );
       fnd_file.put_line(
          which  => FND_FILE.LOG
         ,buff   => cv_pkg_name||cv_msg_cont||
                    cv_prg_name||cv_msg_part||
                    lv_errbuf                  --エラーメッセージ
       );
    END IF;
--
    -- =======================
    -- A-11.終了処理
    -- =======================
    --空行の出力
    fnd_file.put_line(
       which  => FND_FILE.LOG
      ,buff   => ''
    );
    --対象件数出力
    gv_out_msg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_appl_short_name
                    ,iv_name         => cv_target_rec_msg
                    ,iv_token_name1  => cv_cnt_token
                    ,iv_token_value1 => TO_CHAR(gn_target_cnt)
                   );
    fnd_file.put_line(
       which  => FND_FILE.LOG
      ,buff   => gv_out_msg
    );
    --
    --成功件数出力
    gv_out_msg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_appl_short_name
                    ,iv_name         => cv_success_rec_msg
                    ,iv_token_name1  => cv_cnt_token
                    ,iv_token_value1 => TO_CHAR(gn_normal_cnt)
                   );
    fnd_file.put_line(
       which  => FND_FILE.LOG
      ,buff   => gv_out_msg
    );
    --
    --エラー件数出力
    gv_out_msg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_appl_short_name
                    ,iv_name         => cv_error_rec_msg
                    ,iv_token_name1  => cv_cnt_token
                    ,iv_token_value1 => TO_CHAR(gn_error_cnt)
                   );
    fnd_file.put_line(
       which  => FND_FILE.LOG
      ,buff   => gv_out_msg
    );
    --
    --終了メッセージ
    IF (lv_retcode = cv_status_normal) THEN
      lv_message_code := cv_normal_msg;
    ELSIF(lv_retcode = cv_status_error) THEN
      lv_message_code := cv_error_msg;
    END IF;
    --
    gv_out_msg := xxccp_common_pkg.get_msg(
                     iv_application  => cv_appl_short_name
                    ,iv_name         => lv_message_code
                   );
    fnd_file.put_line(
       which  => FND_FILE.LOG
      ,buff   => gv_out_msg
    );
--
    --ステータスセット
    retcode := lv_retcode;
--
  EXCEPTION
    -- *** 共通関数OTHERS例外ハンドラ ***
    WHEN global_api_others_expt THEN
      errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM||lv_errbuf;
      retcode := cv_status_error;
      --エラー出力
      fnd_file.put_line(
        which  => FND_FILE.LOG
       ,buff   => errbuf                  --ユーザー・エラーメッセージ
      );
      fnd_file.put_line(
        which  => FND_FILE.LOG
       ,buff   => cv_pkg_name||cv_msg_cont||
                  cv_prg_name||cv_msg_part||
                  errbuf                  --エラーメッセージ
      );
    -- *** OTHERS例外ハンドラ ***
    WHEN OTHERS THEN
      errbuf  := cv_pkg_name||cv_msg_cont||cv_prg_name||cv_msg_part||SQLERRM;
      retcode := cv_status_error;
      --エラー出力
      fnd_file.put_line(
        which  => FND_FILE.LOG
       ,buff   => errbuf                  --ユーザー・エラーメッセージ
      );
      fnd_file.put_line(
        which  => FND_FILE.LOG
       ,buff   => cv_pkg_name||cv_msg_cont||
                  cv_prg_name||cv_msg_part||
                  errbuf                  --エラーメッセージ
      );
  END main;
--
--###########################  固定部 END   #######################################################
END XXCSO019A05C;
/
